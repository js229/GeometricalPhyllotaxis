(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31930,        948]
NotebookOptionsPosition[     28361,        876]
NotebookOutlinePosition[     29067,        899]
CellTagsIndexPosition[     29024,        896]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855708557192008*^9, 3.855708558082427*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"0c63ea52-7fb0-493b-bb7d-4edd448cd6cb"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "uses", " ", "the", " ", "_definitions", "_", " ", "in", " ", "the", " ", 
   "book", " ", "Mathematical", " ", 
   RowBox[{"Phyllotaxis", ".", " ", "Not"}], " ", "currently", " ", "the", 
   " ", "code", " ", "used", " ", "for", " ", "Figures", " ", 
   RowBox[{"there", " ", "!"}]}], "*)"}]], "Input",ExpressionUUID->"ce36aca0-\
840f-4319-97cb-06a09362bdd8"],

Cell[CellGroupData[{

Cell["Find winding number pairs", "Section",ExpressionUUID->"baa52565-2a69-4366-a1bc-dc70d7b3420b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpEuclideanQCoefficients", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "q", ",", "i", ",", "j"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ";", "\n", "\t", 
       RowBox[{
        RowBox[{"r", "[", 
         RowBox[{"-", "1"}], "]"}], "=", "n"}], ";", " ", "\n", "\t", 
       RowBox[{
        RowBox[{"r", "[", "0", "]"}], " ", "=", " ", "m"}], ";", "\n", "\t", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "[", "i", "]"}], " ", ">", " ", "0"}], "  ", ",", " ", 
         "\n", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"q", "[", "i", "]"}], " ", "=", " ", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"i", "-", "1"}], "]"}], "/", 
             RowBox[{"r", "[", "i", "]"}]}], "]"}]}], ";", "\n", "\t\t", 
          RowBox[{
           RowBox[{"r", "[", 
            RowBox[{"i", "+", "1"}], "]"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"i", "-", "1"}], "]"}], " ", "-", " ", 
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], "*", 
             RowBox[{"r", "[", "i", "]"}]}]}]}], ";", "\n", "\t\t", 
          RowBox[{"i", "++"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"q", "[", "j", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "0", ",", 
           RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpEuclideanMatrixProduct", "[", "mn_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"q", ",", "res", ",", "eMatrix", ",", "sMatrix"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"eMatrix", " ", "=", " ", 
        RowBox[{"(", GridBox[{
           {"1", "1"},
           {"0", "1"}
          }], ")"}]}], ";", 
       RowBox[{"sMatrix", "=", 
        RowBox[{"(", GridBox[{
           {"0", "1"},
           {"1", "0"}
          }], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"q", " ", "=", " ", 
        RowBox[{"mpEuclideanQCoefficients", "[", "mn", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", " ", 
        RowBox[{"(", 
         RowBox[{"Map", "[", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"MatrixPower", "[", 
              RowBox[{"eMatrix", ",", "#"}], "]"}], ".", " ", "sMatrix"}], 
            " ", "&"}], ",", "q"}], "]"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
          RowBox[{"Dot", "@@", "res"}], ",", 
          RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpWindingNumberPair", "[", "mn_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m", ",", "n", ",", "u", ",", "v"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"n", ",", "v"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "u"}], "}"}]}], "}"}], "=", 
        RowBox[{"mpEuclideanMatrixProduct", "[", "mn", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mpDelta", "[", "mn_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"-", "1"}], " ", "*", " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"EvenQ", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"mpEuclideanQCoefficients", "[", "mn", "]"}], "]"}], "]"}], 
      ",", "1", ",", 
      RowBox[{"-", "1"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellLabel->"In[32]:=",ExpressionUUID->"f241a7d1-6e46-4348-9a35-11930f0cd914"],

Cell[BoxData[""], "Input",ExpressionUUID->"a84173c9-f0eb-46b4-9db7-ce90769b6f85"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General renormalisation map", "Section",ExpressionUUID->"ef5f5ef8-d0d3-4b09-8ddb-0a53e9a8fc86"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "m", ",", "n", ",", "u", ",", "v", ",", "w", ",", "d0", ",", "h0"}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ComplexExpand", "@", 
     RowBox[{"ReIm", "@", 
      RowBox[{"ComplexExpand", "[", 
       RowBox[{
        RowBox[{"gmn", " ", "=", 
         FractionBox[
          RowBox[{" ", 
           RowBox[{
            RowBox[{"u", " ", "w"}], "-", " ", "v", " "}]}], 
          RowBox[{
           RowBox[{"m", " ", "w"}], " ", "-", " ", "n"}]]}], ";", 
        RowBox[{"gmn", " ", "/.", " ", 
         RowBox[{"w", "->", " ", 
          RowBox[{"(", 
           RowBox[{"d0", "+", " ", 
            RowBox[{"I", " ", "h0"}]}], ")"}]}]}]}], "]"}]}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellLabel->
  "In[195]:=",ExpressionUUID->"2a6ce253-755f-4b9c-9fc2-2f40970867f1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["d0", "2"], " ", "m", " ", "u"}], "+", 
     RowBox[{
      SuperscriptBox["h0", "2"], " ", "m", " ", "u"}], "+", 
     RowBox[{"n", " ", "v"}], "-", 
     RowBox[{"d0", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", "u"}], "+", 
        RowBox[{"m", " ", "v"}]}], ")"}]}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["d0", "2"], " ", 
      SuperscriptBox["m", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h0", "2"], " ", 
      SuperscriptBox["m", "2"]}], "-", 
     RowBox[{"2", " ", "d0", " ", "m", " ", "n"}], "+", 
     SuperscriptBox["n", "2"]}]], ",", 
   FractionBox[
    RowBox[{"h0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "n"}], " ", "u"}], "+", 
       RowBox[{"m", " ", "v"}]}], ")"}]}], 
    RowBox[{
     RowBox[{
      SuperscriptBox["d0", "2"], " ", 
      SuperscriptBox["m", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["h0", "2"], " ", 
      SuperscriptBox["m", "2"]}], "-", 
     RowBox[{"2", " ", "d0", " ", "m", " ", "n"}], "+", 
     SuperscriptBox["n", "2"]}]]}], "}"}]], "Output",
 CellLabel->
  "Out[196]=",ExpressionUUID->"cfa54f3d-8efc-480c-a4c0-b2c73fac71b2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComplexExpand", "@", 
   RowBox[{"ReIm", "@", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"gmn", " ", "=", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{
          RowBox[{"u", " ", "w"}], "-", " ", "v", " "}]}], 
        RowBox[{
         RowBox[{"m", " ", "w"}], " ", "-", " ", "n"}]]}], ";", 
      RowBox[{"gmn", " ", "/.", " ", 
       RowBox[{"w", "->", " ", 
        RowBox[{"Exp", "[", " ", 
         RowBox[{"I", " ", "\[Theta]"}], "]"}]}]}]}], "]"}]}]}], "//", 
  "Simplify"}]], "Input",
 CellLabel->"In[62]:=",ExpressionUUID->"f0b3446a-d4ab-49a0-87a5-67644ad1f1a2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"m", " ", "u"}], "+", 
     RowBox[{"n", " ", "v"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", "u"}], "+", 
        RowBox[{"m", " ", "v"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
    RowBox[{
     SuperscriptBox["m", "2"], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "m", " ", "n", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "n"}], " ", "u"}], "+", 
       RowBox[{"m", " ", "v"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
    RowBox[{
     SuperscriptBox["m", "2"], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "m", " ", "n", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], "}"}]], "Input",
 CellChangeTimes->{3.908361352594251*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"d7498559-008e-4135-9120-92a8acbbccc7"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"m", " ", "u"}], "+", 
     RowBox[{"n", " ", "v"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", "u"}], "+", 
        RowBox[{"m", " ", "v"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
    RowBox[{
     SuperscriptBox["m", "2"], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "m", " ", "n", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "n"}], " ", "u"}], "+", 
       RowBox[{"m", " ", "v"}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
    RowBox[{
     SuperscriptBox["m", "2"], "+", 
     SuperscriptBox["n", "2"], "-", 
     RowBox[{"2", " ", "m", " ", "n", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], "}"}]], "Output",
 CellLabel->"Out[12]=",ExpressionUUID->"f93aa92d-3cd8-4cae-a375-5a957cb55e47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"vl", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"m", " ", "u"}], "+", 
      RowBox[{"n", " ", "v"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "u"}], "+", 
         RowBox[{"m", " ", "v"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "m", " ", "n", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], " ", "/.", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", "1"}]}], " ", "//", " ", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"vr", " ", "=", " ", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"m", " ", "u"}], "+", 
      RowBox[{"n", " ", "v"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "u"}], "+", 
         RowBox[{"m", " ", "v"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "m", " ", "n", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], " ", "/.", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], "->", 
     RowBox[{"-", "1"}]}]}], " ", "//", " ", "Simplify"}]}]}], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"dcadc471-3291-4750-86a8-56b5a8da1081"],

Cell[BoxData[
 FractionBox[
  RowBox[{"u", "-", "v"}], 
  RowBox[{"m", "-", "n"}]]], "Output",
 CellLabel->"Out[87]=",ExpressionUUID->"525432c5-ecbe-4ddd-814d-cd715ceed028"],

Cell[BoxData[
 FractionBox[
  RowBox[{"u", "+", "v"}], 
  RowBox[{"m", "+", "n"}]]], "Output",
 CellLabel->"Out[88]=",ExpressionUUID->"fa9e7b0c-5e13-463a-a51e-cb4d2d63a27c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vRadius", " ", "=", " ", 
   FractionBox[
    RowBox[{"-", "\[CapitalDelta]"}], 
    RowBox[{
     SuperscriptBox["m", "2"], "-", 
     SuperscriptBox["n", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vZero", " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m", " ", "u"}], "  ", "-", "  ", 
      RowBox[{"n", " ", "v"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      SuperscriptBox["n", "2"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z1", "=", " ", 
   RowBox[{
    RowBox[{"ComplexExpand", "[", 
     RowBox[{
      RowBox[{"\[CapitalDelta]", 
       FractionBox[
        RowBox[{" ", 
         RowBox[{
          RowBox[{"u", " ", "w"}], "-", " ", "v", " "}]}], 
        RowBox[{
         RowBox[{"m", " ", "w"}], " ", "-", " ", "n"}]]}], " ", "/.", " ", 
      RowBox[{"w", "->", " ", 
       RowBox[{"Exp", "[", " ", 
        RowBox[{"I", " ", "\[Theta]"}], "]"}]}]}], "]"}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"ComplexExpand", "[", 
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"z1", "-", " ", 
          RowBox[{"\[CapitalDelta]", " ", "vZero"}]}], ")"}], "/", 
        "vRadius"}], "]"}], "]"}], "//", " ", "Simplify"}], " ", ")"}], "/.", 
   " ", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", "^", "2"}], "->", "1"}]}], "/.", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"n", " ", "u"}], "-", 
      RowBox[{"m", " ", "v"}]}], ")"}], "2"], "->", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"cospsi", ",", "sinpsi"}], "}"}], " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"ReIm", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"z1", "-", " ", 
         RowBox[{"\[CapitalDelta]", " ", "vZero"}]}], ")"}], "/", "vRadius"}],
       "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"tanpsi", " ", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"sinpsi", "/", "cospsi"}], " ", 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellLabel->
  "In[321]:=",ExpressionUUID->"91d56f77-bc81-4891-845b-34720c4a90ea"],

Cell[BoxData[
 RowBox[{
  SqrtBox[
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       SuperscriptBox["n", "2"]}], ")"}], "2"]]], " ", 
  SqrtBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      SuperscriptBox["n", "2"]}], ")"}], "2"]]}]], "Output",
 CellLabel->
  "Out[324]=",ExpressionUUID->"7ac03a96-3cec-4559-98a2-500ef2c14228"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["m", "2"], "-", 
      SuperscriptBox["n", "2"]}], ")"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", "m", " ", "n"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "+", 
       SuperscriptBox["n", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}]], "Output",
 CellLabel->
  "Out[326]=",ExpressionUUID->"f5c93d98-8c47-4660-aebc-cc1373c0ac5f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mpTouchingCircleCentre", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], "=", 
       RowBox[{"mpWindingNumberPair", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", " ", 
          RowBox[{
           RowBox[{"m", " ", "u"}], " ", "-", " ", 
           RowBox[{"n", " ", "v"}]}], "]"}], "/", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["n", "2"], "-", 
           SuperscriptBox["m", "2"]}], ")"}]}], ",", "0"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mpTouchingCircleRadius", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["n", "2"], "-", 
        SuperscriptBox["m", "2"]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpTouchingCircle", "[", "mn_", "]"}], " ", ":=", " ", 
    RowBox[{"Circle", "[", 
     RowBox[{
      RowBox[{"mpTouchingCircleCentre", "[", "mn", "]"}], ",", 
      RowBox[{"mpTouchingCircleRadius", "[", "mn", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpTouchingCircleTanPsiOfTheta", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "[", "\[Theta]_", "]"}], " ", ":=",
    " ", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       SuperscriptBox["n", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}]}], 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", "m", " ", "n"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["m", "2"], "+", 
        SuperscriptBox["n", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpTouchingCirclePsiOfTheta", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "[", "\[Theta]_", "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "atan", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"atan", "=", 
       RowBox[{"ArcTan", "[", 
        RowBox[{
         RowBox[{"mpTouchingCircleTanPsiOfTheta", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", "\[Theta]", "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"atan", "<", "0"}], ",", 
        RowBox[{"atan", "=", 
         RowBox[{"atan", "+", "\[Pi]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "atan"}]}], "\[IndentingNewLine]", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpTouchingCircleHexagonalPointPsiOne", "[", 
   RowBox[{"{", 
    RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"mpTouchingCirclePsiOfTheta", "[", 
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", 
   RowBox[{"\[Pi]", "/", "3"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mpTouchingCircleHexagonalPointPsiTwo", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"mpTouchingCirclePsiOfTheta", "[", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", 
    RowBox[{"2", " ", 
     RowBox[{"\[Pi]", "/", "3"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "needs", " ", "to", " ", "be", " ", "Delta", " ", "aware", " ", "to", " ", 
    "get", " ", "the", " ", "right", " ", "orientation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpTouchingCirclePrimary", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mpDelta", "[", 
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], "]"}], "==", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"psione", "=", " ", 
           RowBox[{"\[Pi]", "-", " ", 
            RowBox[{"mpTouchingCircleHexagonalPointPsiOne", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psitwo", " ", "=", " ", 
           RowBox[{"\[Pi]", "-", " ", 
            RowBox[{"mpTouchingCircleHexagonalPointPsiTwo", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}]}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"psione", "=", " ", 
           RowBox[{"mpTouchingCircleHexagonalPointPsiOne", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"psitwo", " ", "=", " ", 
           RowBox[{"mpTouchingCircleHexagonalPointPsiTwo", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"mpTouchingCircleCentre", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}], ",", 
         RowBox[{"mpTouchingCircleRadius", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"psione", ",", "psitwo"}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mpTouchingCirclePrimaryNonOpposed", "[", "mn_", "]"}], ":=", " ", 
    RowBox[{"vanItersonTouchingCirclePrimaryNonOpposed", "[", "mn", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "mpTouchingCirclePrimaryOpposed", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpTouchingCirclePrimaryOpposed", "[", 
   RowBox[{"{", 
    RowBox[{"m_", ",", "n_"}], "}"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"mpTouchingCirclePrimaryOpposed", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", "m"}], "}"}], "]"}], " ", "/;", " ", 
   RowBox[{"m", ">", "n"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpTouchingCirclePrimaryOpposed", "[", 
   RowBox[{"{", 
    RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"mpTouchingCirclePrimary", "[", 
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], "]"}], " ", "/;", " ", 
   RowBox[{"m", ">", " ", 
    RowBox[{"n", "/", "2"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mpTouchingCirclePrimaryOpposed", "[", 
   RowBox[{"{", 
    RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "centre", ",", "radius", ",", "psis", ",", "psilower", ",", 
      "psihigher"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"centre", ",", "radius", ",", "psis"}], "}"}], "=", " ", 
      RowBox[{"List", "@@", " ", 
       RowBox[{"mpTouchingCirclePrimary", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"psilower", ",", "psihigher"}], "}"}], "=", "psis"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"psi", "=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"m", "/", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Circle", "[", 
      RowBox[{"centre", ",", "radius", ",", 
       RowBox[{"{", 
        RowBox[{"psi", ",", "psihigher"}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[251]:=",ExpressionUUID->"f6a54992-0e03-46e7-996e-9c59cb0d5aaa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mpTouchingCirclePrimaryOpposed", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], "]"}], "//", "N"}]], "Input",
 CellLabel->
  "In[265]:=",ExpressionUUID->"a29a4d3b-49aa-4070-928f-ce5a79fbf82f"],

Cell[BoxData[
 RowBox[{"Circle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.4375`", ",", "0.`"}], "}"}], ",", "0.0625`", ",", 
   RowBox[{"{", 
    RowBox[{"2.3243169433946083`", ",", "2.8548975157790624`"}], "}"}]}], 
  "]"}]], "Output",
 CellLabel->
  "Out[265]=",ExpressionUUID->"2e984b09-3b5d-414b-94fc-e705002e95c2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ArcCos", "[", 
   RowBox[{"2", "/", "5"}], "]"}], "//", "N"}]], "Input",
 CellLabel->
  "In[236]:=",ExpressionUUID->"d052cc7a-6290-4c92-bf04-03015c5a994d"],

Cell[BoxData["1.1592794807274085`"], "Output",
 CellLabel->
  "Out[236]=",ExpressionUUID->"9e409d05-dc13-426a-8644-7d4ee00b9f44"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Vertical parastichies", "Section",ExpressionUUID->"84c0120d-64d0-4fb0-9906-f319b8ad3f52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"m", " ", "u"}], "+", 
      RowBox[{"n", " ", "v"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "u"}], "+", 
         RowBox[{"m", " ", "v"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "m", " ", "n", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], "==", " ", 
    RowBox[{"v", "/", "n"}]}], ",", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"4379e8f7-f567-4bef-96fb-33b575ead470"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rule]", 
    FractionBox["m", "n"]}], "}"}], "}"}]], "Output",
 CellLabel->"Out[68]=",ExpressionUUID->"7b28c248-cd7e-4860-aef4-439e92987698"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"m", " ", "u"}], "+", 
      RowBox[{"n", " ", "v"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"n", " ", "u"}], "+", 
         RowBox[{"m", " ", "v"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      SuperscriptBox["n", "2"], "-", 
      RowBox[{"2", " ", "m", " ", "n", " ", 
       RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]], "==", " ", 
    RowBox[{"u", "/", "m"}]}], ",", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "]"}]], "Input",
 CellLabel->"In[75]:=",ExpressionUUID->"e3720d11-9ed7-4e45-8ac0-057b6e173773"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "\[Rule]", 
    FractionBox["n", "m"]}], "}"}], "}"}]], "Output",
 CellLabel->"Out[75]=",ExpressionUUID->"c1ac574f-a8e3-40c9-8b6f-bd86be0a9efb"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{960, 532.75},
WindowMargins->{{-4.5, Automatic}, {Automatic, -4.5}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, 
  "CodeFormatter" -> {
   "ToolbarState" -> False, "ToolbarAccentColor" -> RGBColor["#2497b7"]}},
Magnification:>0.85,
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "ProgrammingLabDefault.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"f4b5020d-ead1-4307-a5d6-65537a21f51e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 351, 7, 38, "Input",ExpressionUUID->"0c63ea52-7fb0-493b-bb7d-4edd448cd6cb",
 InitializationCell->True],
Cell[912, 29, 408, 8, 24, "Input",ExpressionUUID->"ce36aca0-840f-4319-97cb-06a09362bdd8"],
Cell[CellGroupData[{
Cell[1345, 41, 99, 0, 57, "Section",ExpressionUUID->"baa52565-2a69-4366-a1bc-dc70d7b3420b"],
Cell[1447, 43, 4550, 125, 523, "Input",ExpressionUUID->"f241a7d1-6e46-4348-9a35-11930f0cd914",
 InitializationCell->True],
Cell[6000, 170, 81, 0, 24, "Input",ExpressionUUID->"a84173c9-f0eb-46b4-9db7-ce90769b6f85"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6118, 175, 101, 0, 57, "Section",ExpressionUUID->"ef5f5ef8-d0d3-4b09-8ddb-0a53e9a8fc86"],
Cell[CellGroupData[{
Cell[6244, 179, 923, 27, 74, "Input",ExpressionUUID->"2a6ce253-755f-4b9c-9fc2-2f40970867f1"],
Cell[7170, 208, 1270, 41, 46, "Output",ExpressionUUID->"cfa54f3d-8efc-480c-a4c0-b2c73fac71b2"]
}, Open  ]],
Cell[8455, 252, 645, 18, 38, "Input",ExpressionUUID->"f0b3446a-d4ab-49a0-87a5-67644ad1f1a2"],
Cell[CellGroupData[{
Cell[9125, 274, 1054, 32, 44, "Input",ExpressionUUID->"d7498559-008e-4135-9120-92a8acbbccc7"],
Cell[10182, 308, 1013, 31, 47, "Output",ExpressionUUID->"f93aa92d-3cd8-4cae-a375-5a957cb55e47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11232, 344, 1471, 43, 81, "Input",ExpressionUUID->"dcadc471-3291-4750-86a8-56b5a8da1081"],
Cell[12706, 389, 173, 4, 41, "Output",ExpressionUUID->"525432c5-ecbe-4ddd-814d-cd715ceed028"],
Cell[12882, 395, 173, 4, 41, "Output",ExpressionUUID->"fa9e7b0c-5e13-463a-a51e-cb4d2d63a27c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13092, 404, 2331, 73, 163, "Input",ExpressionUUID->"91d56f77-bc81-4891-845b-34720c4a90ea"],
Cell[15426, 479, 448, 16, 56, "Output",ExpressionUUID->"7ac03a96-3cec-4559-98a2-500ef2c14228"],
Cell[15877, 497, 575, 19, 53, "Output",ExpressionUUID->"f5c93d98-8c47-4660-aebc-cc1373c0ac5f"]
}, Open  ]],
Cell[16467, 519, 8747, 245, 814, "Input",ExpressionUUID->"f6a54992-0e03-46e7-996e-9c59cb0d5aaa",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[25239, 768, 239, 6, 24, "Input",ExpressionUUID->"a29a4d3b-49aa-4070-928f-ce5a79fbf82f"],
Cell[25481, 776, 327, 9, 28, "Output",ExpressionUUID->"2e984b09-3b5d-414b-94fc-e705002e95c2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25845, 790, 190, 5, 24, "Input",ExpressionUUID->"d052cc7a-6290-4c92-bf04-03015c5a994d"],
Cell[26038, 797, 129, 2, 28, "Output",ExpressionUUID->"9e409d05-dc13-426a-8644-7d4ee00b9f44"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26216, 805, 95, 0, 57, "Section",ExpressionUUID->"84c0120d-64d0-4fb0-9906-f319b8ad3f52"],
Cell[CellGroupData[{
Cell[26336, 809, 733, 21, 43, "Input",ExpressionUUID->"4379e8f7-f567-4bef-96fb-33b575ead470"],
Cell[27072, 832, 244, 6, 41, "Output",ExpressionUUID->"7b28c248-cd7e-4860-aef4-439e92987698"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27353, 843, 733, 21, 43, "Input",ExpressionUUID->"e3720d11-9ed7-4e45-8ac0-057b6e173773"],
Cell[28089, 866, 244, 6, 41, "Output",ExpressionUUID->"c1ac574f-a8e3-40c9-8b6f-bd86be0a9efb"]
}, Open  ]]
}, Open  ]]
}
]
*)

