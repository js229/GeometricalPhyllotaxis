(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    225618,       4469]
NotebookOptionsPosition[    221373,       4388]
NotebookOutlinePosition[    221845,       4406]
CellTagsIndexPosition[    221802,       4403]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[120]:=",ExpressionUUID->"7d77eaad-7cce-48eb-b198-8dc4dd759adc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"addAnnotationsToGraph", " ", "=", " ", "True"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8719506898585205`*^9, 3.871950711928313*^9}, {
  3.8719507949408407`*^9, 3.8719508192108*^9}, {3.8724004884657497`*^9, 
  3.8724004889153714`*^9}},
 CellLabel->
  "In[121]:=",ExpressionUUID->"65d66766-36ea-4adb-931e-70f6c27cd42b"],

Cell[CellGroupData[{

Cell["Chain code", "Section",
 CellChangeTimes->{{3.8595354332704773`*^9, 
  3.8595354401520576`*^9}},ExpressionUUID->"6ab48122-af17-4dcf-b0ec-\
7c9b2b450180"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskZ", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "z_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", "z"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", "x"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskXZ", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskRightX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"x", "+", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskLeftX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"x", "-", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskTopZ", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"z", "+", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskR", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", "r"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberRight", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"right", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberRight", "[", 
      RowBox[{"left", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberLeft", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"left", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberLeft", "[", 
      RowBox[{"right", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"leftAndRightNumbers", "[", "n_List", "]"}], " ", ":=", " ", 
     RowBox[{"Join", "@@", 
      RowBox[{"{", 
       RowBox[{"n", ",", 
        RowBox[{"moveNumberRight", "/@", "n"}], ",", 
        RowBox[{"moveNumberLeft", "/@", "n"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"left", "[", "n_", "]"}], "]"}], "  ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"right", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", "n_", "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveDiskRight", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "+", "1"}], ",", "z"}], "}"}], ",", "r"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveDiskLeft", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "-", "1"}], ",", "z"}], "}"}], ",", "r"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberedDiskRight", "[", 
      RowBox[{"n_", "->", "d_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"moveNumberRight", "[", "n", "]"}], "->", 
      RowBox[{"moveDiskRight", "[", "d", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberedDiskLeft", "[", 
      RowBox[{"n_", "->", "d_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"moveNumberLeft", "[", "n", "]"}], "->", 
      RowBox[{"moveDiskLeft", "[", "d", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getDisk", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"KeyExistsQ", "[", 
        RowBox[{
         RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], ",", "n"}], "]"}],
        ",", 
       RowBox[{
        RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], "[", "n", "]"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"KeyExistsQ", "[", 
          RowBox[{
           RowBox[{"run", "[", "\"\<PastDisks\>\"", "]"}], ",", "n"}], "]"}], 
         ",", 
         RowBox[{
          RowBox[{"run", "[", "\"\<PastDisks\>\"", "]"}], "[", "n", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"Missing", "[", 
          RowBox[{
           RowBox[{"StringTemplate", "[", "\"\<No disk ``\>\"", "]"}], "[", 
           RowBox[{"{", "n", "}"}], "]"}], "]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getDisk", "[", 
      RowBox[{
       RowBox[{"right", "[", "n_", "]"}], ",", "run_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"moveDiskRight", "[", 
      RowBox[{"getDisk", "[", 
       RowBox[{"n", ",", "run"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getDisk", "[", 
      RowBox[{
       RowBox[{"left", "[", "n_", "]"}], ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"moveDiskLeft", "[", 
      RowBox[{"getDisk", "[", 
       RowBox[{"n", ",", "run"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diskIsLeft", "[", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=", 
    RowBox[{"x", "<", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diskIsRight", "[", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=", 
    RowBox[{"x", ">", 
     RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskIsNormalised", "[", "d_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"!", " ", 
        RowBox[{"diskIsLeft", "[", "d", "]"}]}], ")"}], " ", "&&", " ", 
      RowBox[{"(", 
       RowBox[{"!", " ", 
        RowBox[{"diskIsRight", "[", "d", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskAndVisibleCopies", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "+", "r"}], ">", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{"moveDiskLeft", "[", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], "]"}], ",", 
         RowBox[{"Nothing", "[", "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "-", "r"}], "<", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], ",", 
         RowBox[{"moveDiskRight", "[", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], "]"}], ",", 
         RowBox[{"Nothing", "[", "]"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"disksMaximum", "[", "run_", "]"}], " ", ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Max", "@", 
      RowBox[{"Map", "[", 
       RowBox[{"diskTopZ", ",", 
        RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}], "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"highestDiskZ", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Max", "@", 
      RowBox[{"Map", "[", 
       RowBox[{"diskZ", ",", 
        RowBox[{"Values", "@", 
         RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"smallestRadius", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Min", "@", 
      RowBox[{"Map", "[", 
       RowBox[{"diskR", ",", 
        RowBox[{"Values", "@", 
         RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}]}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextRadius", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "highestZ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"highestZ", "=", 
         RowBox[{"highestDiskZ", "[", "run", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
          "\"\<rFunction\>\"", "]"}], "[", "highestZ", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextDiskNumber", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Max", "@", 
       RowBox[{"Keys", "[", 
        RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], "]"}]}], "+", 
      "1"}]}], ";", 
    RowBox[{
     RowBox[{"nextChainNumber", "[", "run_", "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"Keys", "[", 
        RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "]"}], 
       "]"}], "+", "1"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.8616891647790556`*^9, {3.8617683530486383`*^9, 
   3.8617683859390097`*^9}, 3.86176864328798*^9, {3.8618567493688416`*^9, 
   3.8618567645549335`*^9}, {3.8665216697653346`*^9, 
   3.8665216723509045`*^9}, {3.866521769758848*^9, 3.866521890765486*^9}, {
   3.8665219339070044`*^9, 3.8665220158325877`*^9}, {3.866537907363763*^9, 
   3.866537953611257*^9}, {3.8665464859544363`*^9, 3.8665465212176056`*^9}, {
   3.869732714486958*^9, 3.8697327518382096`*^9}, {3.869732809826713*^9, 
   3.869732818282772*^9}, {3.869732865846592*^9, 3.869732868015668*^9}, {
   3.8697992781887197`*^9, 3.8697993141058307`*^9}, {3.8704192270610323`*^9, 
   3.8704192520962534`*^9}, {3.8708652378592086`*^9, 3.870865252241334*^9}, {
   3.872402965145998*^9, 3.872403053731039*^9}, {3.872937778360072*^9, 
   3.872937779771941*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"c79fdebc-f9ae-4df7-a656-4383f6352b8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksRight", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extendedDisks", ",", "extendedDisksRight"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", "=", " ", 
       RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extendedDisksRight", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", 
        RowBox[{"extendedDisks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diskLeftX", "[", "#", "]"}], "+", "1"}], "     ", "<=", 
           " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], " ", "+", "nextR"}]}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"extendedDisksRight", " ", "=", " ", 
       RowBox[{"Association", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberedDiskRight", ",", 
          RowBox[{"Normal", "[", "extendedDisksRight", "]"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "extendedDisksRight"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksLeft", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extendedDisks", ",", "extendedDisksLeft"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", "=", " ", 
       RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"extendedDisksLeft", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"extendedDisks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diskRightX", "[", "#", "]"}], "-", "1", " ", "+", " ", 
            "nextR"}], " ", ">=", 
           RowBox[{
            RowBox[{"-", " ", "1"}], "/", "2"}]}], " ", "&"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"extendedDisksLeft", " ", "=", " ", 
       RowBox[{"Association", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberedDiskLeft", ",", 
          RowBox[{"Normal", "[", "extendedDisksLeft", "]"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "extendedDisksLeft"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksLeftRight", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "extendedDisks", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], ",", " ", 
         RowBox[{"extendDisksRight", "[", 
          RowBox[{"run", ",", "nextR"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extendedDisks", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{"extendedDisks", ",", " ", 
         RowBox[{"extendDisksLeft", "[", 
          RowBox[{"run", ",", "nextR"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "extendedDisks"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.86176811167383*^9, 3.8617682597197723`*^9}, {
   3.8617682940446005`*^9, 3.8617683208015947`*^9}, {3.861768396085757*^9, 
   3.861768466468691*^9}, {3.8617685127149725`*^9, 3.8617685274257803`*^9}, {
   3.8617685607421083`*^9, 3.8617685613503017`*^9}, {3.8617686239130816`*^9, 
   3.8617686243819647`*^9}, {3.8617686618849783`*^9, 
   3.8617686637751493`*^9}, {3.86176870938266*^9, 3.861768732367918*^9}, {
   3.8617701791317883`*^9, 3.861770256473044*^9}, {3.8617703228119564`*^9, 
   3.8617706374593897`*^9}, {3.8617706674910555`*^9, 3.861770854104594*^9}, 
   3.8617709024525056`*^9, {3.861771049078973*^9, 3.861771086242021*^9}, {
   3.861771117016026*^9, 3.8617712281706324`*^9}, {3.861771288493409*^9, 
   3.861771288633948*^9}, {3.861771380372183*^9, 3.8617714035295935`*^9}, {
   3.8617717107871904`*^9, 3.8617717354626474`*^9}, {3.8618558187788935`*^9, 
   3.8618558541525946`*^9}, {3.861855897042087*^9, 3.8618560184508553`*^9}, {
   3.8618560728951387`*^9, 3.861856109387108*^9}, {3.8618561406783648`*^9, 
   3.8618562129205*^9}, {3.8618562503742313`*^9, 3.861856262851577*^9}, {
   3.861856738894947*^9, 3.861856741225368*^9}, {3.8618606232744007`*^9, 
   3.861860627379337*^9}, {3.861860671745571*^9, 3.8618606728382387`*^9}, {
   3.8618607071326227`*^9, 3.861860707523094*^9}, {3.861860759939664*^9, 
   3.8618607622057204`*^9}, {3.8618688416478133`*^9, 3.861868867189494*^9}, {
   3.8618689713267174`*^9, 3.861868995260337*^9}, 3.861869120738061*^9, {
   3.861869260209362*^9, 3.861869408995321*^9}, {3.8618694821002164`*^9, 
   3.8618694873020487`*^9}, {3.8618695207349653`*^9, 3.861869537897152*^9}, {
   3.8618696514563837`*^9, 3.8618696550676675`*^9}, {3.8618702166609*^9, 
   3.861870220472766*^9}, {3.86187085672344*^9, 3.8618708744693584`*^9}, {
   3.866518939333186*^9, 3.866518946023529*^9}, {3.8665191316191864`*^9, 
   3.8665191373837123`*^9}, {3.866521409889783*^9, 3.8665215098822126`*^9}, 
   3.86652322563101*^9, {3.866523291328253*^9, 3.866523295878974*^9}, 
   3.866525403542487*^9, 3.866532356979581*^9, {3.8665334549299164`*^9, 
   3.866533529194491*^9}, {3.866533633323496*^9, 3.8665336393403454`*^9}, {
   3.8665336798892093`*^9, 3.8665337209045835`*^9}, {3.866534738666405*^9, 
   3.866534743469593*^9}, {3.8665347783179736`*^9, 3.866534778693857*^9}, {
   3.866534820013294*^9, 3.866534848661617*^9}, {3.86653494045367*^9, 
   3.8665349529254184`*^9}, 3.8665350680528946`*^9, 3.869732628037418*^9, {
   3.8697988083899965`*^9, 3.869798811826223*^9}, 3.869921839093239*^9, 
   3.8699220672291107`*^9, {3.869922139806282*^9, 3.8699221482906322`*^9}, {
   3.869922442883154*^9, 3.86992244388381*^9}, {3.870417378839363*^9, 
   3.870417416533455*^9}, {3.8704177694859543`*^9, 3.870417792536235*^9}, 
   3.8704179653556557`*^9, 3.870418012495679*^9, 3.8706009588990326`*^9, {
   3.8729377591133423`*^9, 3.872937770317047*^9}},
 CellLabel->
  "In[153]:=",ExpressionUUID->"10f5e5c5-8a50-4c6c-955c-3ca976dfbb0d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run set up", "Section",
 CellChangeTimes->{{3.872937330240281*^9, 
  3.8729373494510107`*^9}},ExpressionUUID->"77a3141e-802f-42c1-8a57-\
5eddf8adc775"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"runCompletesArena", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
            "\"\<ChainMax\>\"", "]"}], "==", "\"\<Fill\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", 
           RowBox[{
            RowBox[{"disksMaximum", "[", "run", "]"}], ">", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
               "\"\<CylinderLU\>\"", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "+", " ", 
             RowBox[{"2", " ", "*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
                "\"\<rFunction\>\"", "]"}], "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
                 "\"\<CylinderLU\>\"", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"res", " ", "=", " ", 
            RowBox[{
             RowBox[{"nextChainNumber", "[", "run", "]"}], " ", ">", " ", 
             RowBox[{
              RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
              "\"\<ChainMax\>\"", "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861684358629258*^9, 3.861684524240922*^9}, 
   3.861684576473754*^9, {3.8616846176312237`*^9, 3.8616847132073975`*^9}, {
   3.8616850134328413`*^9, 3.86168501704149*^9}, {3.861685048105015*^9, 
   3.8616850784193096`*^9}, {3.8616851234082212`*^9, 
   3.8616852027446823`*^9}, {3.861685371069314*^9, 3.8616853712842484`*^9}, {
   3.8616859082014556`*^9, 3.8616859210857525`*^9}, {3.861686056906653*^9, 
   3.861686123610694*^9}, {3.861688774038667*^9, 3.861688774198612*^9}, {
   3.8616888216547055`*^9, 3.861688828539577*^9}, {3.861688866608322*^9, 
   3.861688874186267*^9}, {3.8616889140833178`*^9, 3.861688950502099*^9}, 
   3.861689001171564*^9, {3.861689204822542*^9, 3.8616892759751277`*^9}, {
   3.861689413105137*^9, 3.861689421578429*^9}, {3.8616894718935575`*^9, 
   3.861689545046216*^9}, {3.861689613115652*^9, 3.8616896296398883`*^9}, 
   3.861689777517949*^9, 3.861689923485132*^9, {3.861690349412821*^9, 
   3.861690375698805*^9}, {3.8617713082464485`*^9, 3.8617713200718336`*^9}, {
   3.861772807301606*^9, 3.861772810800974*^9}, 3.861772872800007*^9, 
   3.8617734237668533`*^9, {3.861773566079151*^9, 3.86177359053448*^9}, {
   3.8617736209803843`*^9, 3.8617736407257657`*^9}, {3.8618596208212905`*^9, 
   3.8618596239807587`*^9}, {3.8618697184427385`*^9, 
   3.8618697186145725`*^9}, {3.8618703757759724`*^9, 3.8618703759634113`*^9}, 
   3.8618707268751297`*^9, {3.8665189808319173`*^9, 3.8665189849499197`*^9}, {
   3.866520516693599*^9, 3.866520528193391*^9}, 3.8665209197269783`*^9, {
   3.8665210125520844`*^9, 3.8665210626885443`*^9}, 3.866532591882633*^9, {
   3.8665326805866437`*^9, 3.866532683002239*^9}, 3.866532771963004*^9, {
   3.8665353835915704`*^9, 3.866535397448186*^9}, {3.866546341800876*^9, 
   3.866546342031291*^9}, {3.8665479154232206`*^9, 3.8665479432892227`*^9}, 
   3.8665480981356897`*^9, {3.8665481558457327`*^9, 3.8665482562440033`*^9}, 
   3.866606186616213*^9, 3.866606220904422*^9, {3.866606257460112*^9, 
   3.866606344518056*^9}, {3.8666104115820384`*^9, 3.8666104579668503`*^9}, {
   3.8666105122196684`*^9, 3.866610548625079*^9}, {3.8666106682677794`*^9, 
   3.86661067668945*^9}, {3.8666107464094114`*^9, 3.866610777397222*^9}, {
   3.8666108364355145`*^9, 3.866610846526102*^9}, {3.866611288228443*^9, 
   3.866611288244074*^9}, {3.869726375498214*^9, 3.869726421793993*^9}, {
   3.8697981856877155`*^9, 3.8697981998485003`*^9}, {3.8697982871295567`*^9, 
   3.8697985850865693`*^9}, 3.8697986463239536`*^9, {3.869798681111512*^9, 
   3.8697987030720844`*^9}, {3.8697987513376675`*^9, 
   3.8697987584888744`*^9}, {3.8697988308736744`*^9, 
   3.8697988994649253`*^9}, {3.8697990094501896`*^9, 3.86979915655697*^9}, {
   3.8697991923436065`*^9, 3.869799264714652*^9}, {3.8697993346541643`*^9, 
   3.869799488454625*^9}, {3.86982274394658*^9, 3.8698228895331182`*^9}, {
   3.8698230243111973`*^9, 3.8698230256593795`*^9}, {3.8698230672101555`*^9, 
   3.8698231948442183`*^9}, {3.869823313291215*^9, 3.869823330792934*^9}, {
   3.869891617557027*^9, 3.869891737793434*^9}, {3.869891769058402*^9, 
   3.869891955179182*^9}, 3.869892356436333*^9, {3.8699228701917844`*^9, 
   3.86992287789316*^9}, {3.870414845838695*^9, 3.870414846557075*^9}, 
   3.870418074757024*^9, 3.8704181767953324`*^9, 3.8704184356869884`*^9, {
   3.870419286588849*^9, 3.8704194074598284`*^9}, {3.870419443386533*^9, 
   3.870419467456215*^9}, {3.870523493709098*^9, 3.8705234987751074`*^9}, {
   3.870524401000214*^9, 3.8705244303295174`*^9}, {3.870524579091002*^9, 
   3.870524652527469*^9}, {3.870524736585949*^9, 3.87052484784743*^9}, {
   3.8705249078648295`*^9, 3.8705249082603903`*^9}, {3.870525181933323*^9, 
   3.870525231562318*^9}, {3.870525294294423*^9, 3.870525312587715*^9}, {
   3.8705953106908627`*^9, 3.870595312849454*^9}, {3.87059574049737*^9, 
   3.870595751844956*^9}, {3.870596098269575*^9, 3.8705961592920146`*^9}, 
   3.8705962399704037`*^9, {3.870596335656187*^9, 3.8705963497025566`*^9}, 
   3.870599050868951*^9, 3.8705992290136175`*^9, 3.870690964513497*^9, 
   3.870692312889798*^9, {3.870695124471425*^9, 3.87069513274988*^9}, {
   3.8706953579367437`*^9, 3.8706953882850347`*^9}, {3.8707749080220923`*^9, 
   3.870774953417694*^9}, {3.8707750062657723`*^9, 3.8707750369819217`*^9}, {
   3.8707753742744007`*^9, 3.8707753876817245`*^9}, {3.87077659939155*^9, 
   3.8707766145452285`*^9}, {3.8707766669238048`*^9, 3.8707767099986973`*^9}, 
   3.8707767560183105`*^9, 3.8707775419698687`*^9, {3.870781994354768*^9, 
   3.870782014801423*^9}, 3.872937756160636*^9, {3.8731004408586726`*^9, 
   3.8731004809811497`*^9}},
 CellLabel->
  "In[929]:=",ExpressionUUID->"6dbf7845-f16b-4a34-8ebf-111941a4cda1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addDisksFromGraph", "[", 
     RowBox[{"seedRun_", ",", 
      RowBox[{"chainNumber_", ":", "1"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"run", ",", "currentDisks", ",", "g"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"seedRun", "[", "\"\<ContactGraph\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"Graph", "[", 
         RowBox[{"g", ",", 
          RowBox[{"VertexCoordinates", "->", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"diskXZ", "[", 
               RowBox[{"getDisk", "[", 
                RowBox[{"#", ",", "seedRun"}], "]"}], "]"}], "&"}], ",", 
             RowBox[{"VertexList", "[", "g", "]"}]}], "]"}]}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"Graph", "[", 
         RowBox[{"g", ",", 
          RowBox[{"PlotTheme", "->", "\"\<Labeled\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"EdgeForm", "[", "None", "]"}], ",", 
             RowBox[{"FaceForm", "[", "None", "]"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"VertexLabels", "\[Rule]", 
           RowBox[{"Placed", "[", 
            RowBox[{"Automatic", ",", "Center"}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"Graph", "[", 
         RowBox[{"g", ",", 
          RowBox[{"AnnotationRules", "\[Rule]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", 
               RowBox[{"{", 
                RowBox[{"EdgeStyle", "->", "Gray"}], "}"}]}], "&"}], ",", 
             RowBox[{"EdgeList", "[", "g", "]"}]}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"run", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"seedRun", ",", "\[IndentingNewLine]", 
          RowBox[{"<|", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\"\<CurrentDisks\>\"", "->", 
             RowBox[{"Association", "@", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"#", "->", 
                  RowBox[{"getDisk", "[", 
                   RowBox[{"#", ",", "seedRun"}], "]"}]}], "&"}], ",", " ", 
                RowBox[{"Select", "[", 
                 RowBox[{
                  RowBox[{"VertexList", "[", "g", "]"}], ",", 
                  RowBox[{
                   RowBox[{"#", "==", 
                    RowBox[{"bareNumber", "[", "#", "]"}]}], "&"}]}], "]"}]}],
                "]"}]}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<PastDisks\>\"", "->", " ", 
             RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<Parastichy\>\"", "->", " ", 
             RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<ContactGraph\>\"", "->", "  ", "g"}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<CompletedChainGraphs\>\"", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"chainNumber", "->", "g"}], "|>"}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<CompletedChainNodePaths\>\"", " ", "->", " ", 
             RowBox[{"<|", 
              RowBox[{"chainNumber", "->", 
               RowBox[{"{", "}"}]}], "|>"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<UsedOverlaps\>\"", "->", 
             RowBox[{"{", "}"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<CurrentChain\>\"", "->", 
             RowBox[{"{", "}"}]}], "\[IndentingNewLine]", ",", 
            RowBox[{"\"\<CurrentChainGraph\>\"", "->", 
             RowBox[{"Missing", "[", "]"}]}]}], "\[IndentingNewLine]", 
           "|>"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", "run"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.870782218434901*^9, 3.870782232662108*^9}, 
   3.8707822674591665`*^9, {3.8707823785124536`*^9, 3.8707823789185476`*^9}, {
   3.870782436240833*^9, 3.870782436677994*^9}, {3.870866476755181*^9, 
   3.8708664971174445`*^9}, {3.870866563855597*^9, 3.8708665776720967`*^9}, 
   3.870866737148793*^9, 3.872398361978322*^9},
 CellLabel->
  "In[157]:=",ExpressionUUID->"bc32d9cc-1052-4f4b-861f-147ea2f87ce8"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"restartRunFromChain", "[", 
    RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "chainGraph"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", "run"}], ";", "\[IndentingNewLine]", 
      RowBox[{"chainGraph", " ", "=", " ", 
       RowBox[{
        RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "[", 
        "chain", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}], " ", "=", " ", 
       "chainGraph"}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"addDisksFromGraph", "[", 
        RowBox[{"res", ",", "chain"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861684358629258*^9, 3.861684524240922*^9}, 
   3.861684576473754*^9, {3.8616846176312237`*^9, 3.8616847132073975`*^9}, {
   3.8616850134328413`*^9, 3.86168501704149*^9}, {3.861685048105015*^9, 
   3.8616850784193096`*^9}, {3.8616851234082212`*^9, 
   3.8616852027446823`*^9}, {3.861685371069314*^9, 3.8616853712842484`*^9}, {
   3.8616859082014556`*^9, 3.8616859210857525`*^9}, {3.861686056906653*^9, 
   3.861686123610694*^9}, {3.861688774038667*^9, 3.861688774198612*^9}, {
   3.8616888216547055`*^9, 3.861688828539577*^9}, {3.861688866608322*^9, 
   3.861688874186267*^9}, {3.8616889140833178`*^9, 3.861688950502099*^9}, 
   3.861689001171564*^9, {3.861689204822542*^9, 3.8616892759751277`*^9}, {
   3.861689413105137*^9, 3.861689421578429*^9}, {3.8616894718935575`*^9, 
   3.861689545046216*^9}, {3.861689613115652*^9, 3.8616896296398883`*^9}, 
   3.861689777517949*^9, 3.861689923485132*^9, {3.861690349412821*^9, 
   3.861690375698805*^9}, {3.8617713082464485`*^9, 3.8617713200718336`*^9}, {
   3.861772807301606*^9, 3.861772810800974*^9}, 3.861772872800007*^9, 
   3.8617734237668533`*^9, {3.861773566079151*^9, 3.86177359053448*^9}, {
   3.8617736209803843`*^9, 3.8617736407257657`*^9}, {3.8618596208212905`*^9, 
   3.8618596239807587`*^9}, {3.8618697184427385`*^9, 
   3.8618697186145725`*^9}, {3.8618703757759724`*^9, 3.8618703759634113`*^9}, 
   3.8618707268751297`*^9, {3.8665189808319173`*^9, 3.8665189849499197`*^9}, {
   3.866520516693599*^9, 3.866520528193391*^9}, 3.8665209197269783`*^9, {
   3.8665210125520844`*^9, 3.8665210626885443`*^9}, 3.866532591882633*^9, {
   3.8665326805866437`*^9, 3.866532683002239*^9}, 3.866532771963004*^9, {
   3.8665353835915704`*^9, 3.866535397448186*^9}, {3.866546341800876*^9, 
   3.866546342031291*^9}, {3.8665479154232206`*^9, 3.8665479432892227`*^9}, 
   3.8665480981356897`*^9, {3.8665481558457327`*^9, 3.8665482562440033`*^9}, 
   3.866606186616213*^9, 3.866606220904422*^9, {3.866606257460112*^9, 
   3.866606344518056*^9}, {3.8666104115820384`*^9, 3.8666104579668503`*^9}, {
   3.8666105122196684`*^9, 3.866610548625079*^9}, {3.8666106682677794`*^9, 
   3.86661067668945*^9}, {3.8666107464094114`*^9, 3.866610777397222*^9}, {
   3.8666108364355145`*^9, 3.866610846526102*^9}, {3.866611288228443*^9, 
   3.866611288244074*^9}, {3.869726375498214*^9, 3.869726421793993*^9}, {
   3.8697981856877155`*^9, 3.8697981998485003`*^9}, {3.8697982871295567`*^9, 
   3.8697985850865693`*^9}, 3.8697986463239536`*^9, {3.869798681111512*^9, 
   3.8697987030720844`*^9}, {3.8697987513376675`*^9, 
   3.8697987584888744`*^9}, {3.8697988308736744`*^9, 
   3.8697988994649253`*^9}, {3.8697990094501896`*^9, 3.86979915655697*^9}, {
   3.8697991923436065`*^9, 3.869799264714652*^9}, {3.8697993346541643`*^9, 
   3.869799488454625*^9}, {3.86982274394658*^9, 3.8698228895331182`*^9}, {
   3.8698230243111973`*^9, 3.8698230256593795`*^9}, {3.8698230672101555`*^9, 
   3.8698231948442183`*^9}, {3.869823313291215*^9, 3.869823330792934*^9}, {
   3.869891617557027*^9, 3.869891737793434*^9}, {3.869891769058402*^9, 
   3.869891955179182*^9}, 3.869892356436333*^9, {3.8699228701917844`*^9, 
   3.86992287789316*^9}, {3.870414845838695*^9, 3.870414846557075*^9}, 
   3.870418074757024*^9, 3.8704181767953324`*^9, 3.8704184356869884`*^9, {
   3.870419286588849*^9, 3.8704194074598284`*^9}, {3.870419443386533*^9, 
   3.870419467456215*^9}, {3.870523493709098*^9, 3.8705234987751074`*^9}, {
   3.870524401000214*^9, 3.8705244303295174`*^9}, {3.870524579091002*^9, 
   3.870524652527469*^9}, {3.870524736585949*^9, 3.87052484784743*^9}, {
   3.8705249078648295`*^9, 3.8705249082603903`*^9}, {3.870525181933323*^9, 
   3.870525231562318*^9}, {3.870525294294423*^9, 3.870525312587715*^9}, {
   3.8705953106908627`*^9, 3.870595312849454*^9}, {3.87059574049737*^9, 
   3.870595751844956*^9}, {3.870596098269575*^9, 3.8705961592920146`*^9}, 
   3.8705962399704037`*^9, {3.870596335656187*^9, 3.8705963497025566`*^9}, 
   3.870599050868951*^9, 3.8705992290136175`*^9, 3.870690964513497*^9, 
   3.870692312889798*^9, {3.870695124471425*^9, 3.87069513274988*^9}, {
   3.8706953579367437`*^9, 3.8706953882850347`*^9}, {3.8707749080220923`*^9, 
   3.870774953417694*^9}, {3.8707750062657723`*^9, 3.8707750369819217`*^9}, {
   3.8707753742744007`*^9, 3.8707753876817245`*^9}, {3.87077659939155*^9, 
   3.8707766145452285`*^9}, {3.8707766669238048`*^9, 3.8707767099986973`*^9}, 
   3.8707767560183105`*^9, 3.8707775419698687`*^9, {3.870781994354768*^9, 
   3.870782014801423*^9}, {3.8708664018260994`*^9, 3.8708664467142563`*^9}, {
   3.8719064973275795`*^9, 3.8719065506310377`*^9}, {3.871907214100464*^9, 
   3.8719072336049476`*^9}, 3.872066128235659*^9, {3.8720665181634235`*^9, 
   3.872066580484194*^9}, 3.8723983619861794`*^9, {3.8724001011013484`*^9, 
   3.872400147896209*^9}, {3.8724001795181065`*^9, 3.8724001796922894`*^9}, {
   3.872400223273884*^9, 3.872400229374332*^9}, {3.872401269460249*^9, 
   3.872401275860113*^9}, {3.872401309113552*^9, 3.8724014002220445`*^9}, {
   3.8724018991208353`*^9, 3.872401905991184*^9}, {3.8724023868809986`*^9, 
   3.872402397969055*^9}, 3.87240295968653*^9, {3.87240382877649*^9, 
   3.872403839324546*^9}, {3.8724038713718605`*^9, 3.872403876158942*^9}, 
   3.872403912631796*^9, {3.872937359274167*^9, 3.872937368460971*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"728cb4e0-2952-4aa4-9d9c-cade43159d50"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"executeRun", "[", 
      RowBox[{"run_", ",", 
       RowBox[{"chainMax_", ":", 
        RowBox[{"Missing", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "imax", ",", "res", ",", "timing"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Off", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MissingQ", "[", "chainMax", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", "\"\<Arena\>\"", "]"}], "[", 
            "\"\<ChainMax\>\"", "]"}], "=", "chainMax"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"imax", " ", "=", " ", 
         RowBox[{
          RowBox[{"res", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<ChainMax\>\"",
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"NumericQ", "[", "imax", "]"}]}], ",", 
          RowBox[{"imax", "=", "500"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<=", " ", "imax"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"runCompletesArena", "[", "res", "]"}], ",", 
                RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"timing", ",", "res"}], "}"}], " ", "=", " ", 
               RowBox[{"Timing", "[", 
                RowBox[{"completeChain", "[", "res", "]"}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{
           "StringTemplate", "[", 
            "\"\<parastichy `parastichy`; chain `chain`; disk `disk`; Z `Z`; \
per-chain time `timing`; per-disk time `disktime`\>\"", "]"}], "[", 
           RowBox[{"<|", 
            RowBox[{
             RowBox[{"\"\<chain\>\"", "->", 
              RowBox[{
               RowBox[{"nextChainNumber", "[", "res", "]"}], "-", "1"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"\"\<disk\>\"", "->", " ", 
              RowBox[{
               RowBox[{"nextDiskNumber", "[", "res", "]"}], "-", "1"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"\"\<Z\>\"", "->", " ", 
              RowBox[{"highestDiskZ", "[", "res", "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"\"\<parastichy\>\"", "->", "  ", 
              RowBox[{"Last", "[", 
               RowBox[{"res", "[", "\"\<Parastichy\>\"", "]"}], "]"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"\"\<timing\>\"", "->", "timing"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"\"\<disktime\>\"", "->", " ", 
              RowBox[{"res", "[", "\"\<CurrentTimePerDisk\>\"", "]"}]}]}], 
            "|>"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861684358629258*^9, 3.861684524240922*^9}, 
   3.861684576473754*^9, {3.8616846176312237`*^9, 3.8616847132073975`*^9}, {
   3.8616850134328413`*^9, 3.86168501704149*^9}, {3.861685048105015*^9, 
   3.8616850784193096`*^9}, {3.8616851234082212`*^9, 
   3.8616852027446823`*^9}, {3.861685371069314*^9, 3.8616853712842484`*^9}, {
   3.8616859082014556`*^9, 3.8616859210857525`*^9}, {3.861686056906653*^9, 
   3.861686123610694*^9}, {3.861688774038667*^9, 3.861688774198612*^9}, {
   3.8616888216547055`*^9, 3.861688828539577*^9}, {3.861688866608322*^9, 
   3.861688874186267*^9}, {3.8616889140833178`*^9, 3.861688950502099*^9}, 
   3.861689001171564*^9, {3.861689204822542*^9, 3.8616892759751277`*^9}, {
   3.861689413105137*^9, 3.861689421578429*^9}, {3.8616894718935575`*^9, 
   3.861689545046216*^9}, {3.861689613115652*^9, 3.8616896296398883`*^9}, 
   3.861689777517949*^9, 3.861689923485132*^9, {3.861690349412821*^9, 
   3.861690375698805*^9}, {3.8617713082464485`*^9, 3.8617713200718336`*^9}, {
   3.861772807301606*^9, 3.861772810800974*^9}, 3.861772872800007*^9, 
   3.8617734237668533`*^9, {3.861773566079151*^9, 3.86177359053448*^9}, {
   3.8617736209803843`*^9, 3.8617736407257657`*^9}, {3.8618596208212905`*^9, 
   3.8618596239807587`*^9}, {3.8618697184427385`*^9, 
   3.8618697186145725`*^9}, {3.8618703757759724`*^9, 3.8618703759634113`*^9}, 
   3.8618707268751297`*^9, {3.8665189808319173`*^9, 3.8665189849499197`*^9}, {
   3.866520516693599*^9, 3.866520528193391*^9}, 3.8665209197269783`*^9, {
   3.8665210125520844`*^9, 3.8665210626885443`*^9}, 3.866532591882633*^9, {
   3.8665326805866437`*^9, 3.866532683002239*^9}, 3.866532771963004*^9, {
   3.8665353835915704`*^9, 3.866535397448186*^9}, {3.866546341800876*^9, 
   3.866546342031291*^9}, {3.8665479154232206`*^9, 3.8665479432892227`*^9}, 
   3.8665480981356897`*^9, {3.8665481558457327`*^9, 3.8665482562440033`*^9}, 
   3.866606186616213*^9, 3.866606220904422*^9, {3.866606257460112*^9, 
   3.866606344518056*^9}, {3.8666104115820384`*^9, 3.8666104579668503`*^9}, {
   3.8666105122196684`*^9, 3.866610548625079*^9}, {3.8666106682677794`*^9, 
   3.86661067668945*^9}, {3.8666107464094114`*^9, 3.866610777397222*^9}, {
   3.8666108364355145`*^9, 3.866610846526102*^9}, {3.866611288228443*^9, 
   3.866611288244074*^9}, {3.869726375498214*^9, 3.869726421793993*^9}, {
   3.8697981856877155`*^9, 3.8697981998485003`*^9}, {3.8697982871295567`*^9, 
   3.8697985850865693`*^9}, 3.8697986463239536`*^9, {3.869798681111512*^9, 
   3.8697987030720844`*^9}, {3.8697987513376675`*^9, 
   3.8697987584888744`*^9}, {3.8697988308736744`*^9, 
   3.8697988994649253`*^9}, {3.8697990094501896`*^9, 3.86979915655697*^9}, {
   3.8697991923436065`*^9, 3.869799264714652*^9}, {3.8697993346541643`*^9, 
   3.869799488454625*^9}, {3.86982274394658*^9, 3.8698228895331182`*^9}, {
   3.8698230243111973`*^9, 3.8698230256593795`*^9}, {3.8698230672101555`*^9, 
   3.8698231948442183`*^9}, {3.869823313291215*^9, 3.869823330792934*^9}, {
   3.869891617557027*^9, 3.869891737793434*^9}, {3.869891769058402*^9, 
   3.869891955179182*^9}, 3.869892356436333*^9, {3.8699228701917844`*^9, 
   3.86992287789316*^9}, {3.870414845838695*^9, 3.870414846557075*^9}, 
   3.870418074757024*^9, 3.8704181767953324`*^9, 3.8704184356869884`*^9, {
   3.870419286588849*^9, 3.8704194074598284`*^9}, {3.870419443386533*^9, 
   3.870419467456215*^9}, {3.870523493709098*^9, 3.8705234987751074`*^9}, {
   3.870524401000214*^9, 3.8705244303295174`*^9}, {3.870524579091002*^9, 
   3.870524652527469*^9}, {3.870524736585949*^9, 3.87052484784743*^9}, {
   3.8705249078648295`*^9, 3.8705249082603903`*^9}, {3.870525181933323*^9, 
   3.870525231562318*^9}, {3.870525294294423*^9, 3.870525312587715*^9}, {
   3.8705953106908627`*^9, 3.870595312849454*^9}, {3.87059574049737*^9, 
   3.870595751844956*^9}, {3.870596098269575*^9, 3.8705961592920146`*^9}, 
   3.8705962399704037`*^9, {3.870596335656187*^9, 3.8705963497025566`*^9}, 
   3.870599050868951*^9, 3.8705992290136175`*^9, 3.870690964513497*^9, 
   3.870692312889798*^9, {3.870695124471425*^9, 3.87069513274988*^9}, {
   3.8706953579367437`*^9, 3.8706953882850347`*^9}, {3.8707749080220923`*^9, 
   3.870774953417694*^9}, {3.8707750062657723`*^9, 3.8707750369819217`*^9}, {
   3.8707753742744007`*^9, 3.8707753876817245`*^9}, {3.87077659939155*^9, 
   3.8707766145452285`*^9}, {3.8707766669238048`*^9, 3.8707767099986973`*^9}, 
   3.8707767560183105`*^9, 3.8707775419698687`*^9, {3.870781994354768*^9, 
   3.870782014801423*^9}, {3.8708664018260994`*^9, 3.8708664467142563`*^9}, {
   3.8719064973275795`*^9, 3.8719065506310377`*^9}, {3.871907214100464*^9, 
   3.8719072336049476`*^9}, 3.872066128235659*^9, {3.8720665181634235`*^9, 
   3.872066580484194*^9}, 3.8723983619861794`*^9, {3.8724001011013484`*^9, 
   3.872400147896209*^9}, {3.8724001795181065`*^9, 3.8724001796922894`*^9}, {
   3.872400223273884*^9, 3.872400229374332*^9}, {3.872401269460249*^9, 
   3.872401275860113*^9}, {3.872401309113552*^9, 3.8724014002220445`*^9}, {
   3.8724018991208353`*^9, 3.872401905991184*^9}, {3.8724023868809986`*^9, 
   3.872402397969055*^9}, 3.87240295968653*^9, {3.87240382877649*^9, 
   3.872403839324546*^9}, {3.8724038713718605`*^9, 3.872403876158942*^9}, 
   3.872403912631796*^9, {3.872937359274167*^9, 3.872937368460971*^9}, {
   3.8730839378496184`*^9, 3.873083947389787*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"15e75fbe-967c-44f1-86aa-fa34b59eca50"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Adding statistics", "Section",
 CellChangeTimes->{{3.872937409635434*^9, 
  3.8729374155865755`*^9}},ExpressionUUID->"82926184-1112-44a0-be3d-\
e9cd6ea8da45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chainCodeExecute", "[", "experiment_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "run"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "=", "experiment"}], ";", "\[IndentingNewLine]", 
       RowBox[{"run", " ", "=", " ", 
        RowBox[{"executeRun", "[", "experiment", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"experiment", ",", 
          RowBox[{"\"\<Results\>\"", "->", "run"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"res", ",", 
          RowBox[{"\"\<ChainStatistics\>\"", "->", 
           RowBox[{"chainStatistics", "[", "run", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"res", ",", 
          RowBox[{"\"\<NodeStatistics\>\"", "->", 
           RowBox[{"nodeStatistics", "[", "run", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"disksNumbersInChain", "[", 
   RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "diskNumbers", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"diskNumbers", " ", "=", " ", 
      RowBox[{"VertexList", "[", " ", 
       RowBox[{
        RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "[", 
        "chain", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"diskNumbers", " ", "=", " ", 
      RowBox[{"Select", "[", 
       RowBox[{"diskNumbers", ",", 
        RowBox[{
         RowBox[{"#", "==", 
          RowBox[{"bareNumber", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "diskNumbers"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"disksInChain", "[", 
     RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"getDisk", "[", 
        RowBox[{"#", ",", "run"}], "]"}], "&"}], ",", 
      RowBox[{"disksNumbersInChain", "[", 
       RowBox[{"run", ",", "chain"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chainMeanRise", "[", 
     RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "zValues", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"zValues", " ", "=", " ", 
        RowBox[{"diskZ", " ", "/@", " ", 
         RowBox[{"disksInChain", "[", 
          RowBox[{"run", ",", "chain"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"zValues", " ", "=", " ", 
        RowBox[{"Sort", "[", "zValues", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"zValues", "  ", "=", " ", 
        RowBox[{"Differences", "[", "zValues", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", "zValues", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainMeanZ", "[", 
    RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{"diskZ", " ", "/@", " ", 
     RowBox[{"disksInChain", "[", 
      RowBox[{"run", ",", "chain"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainMeanR", "[", 
    RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Mean", "[", 
    RowBox[{"diskR", " ", "/@", " ", 
     RowBox[{"disksInChain", "[", 
      RowBox[{"run", ",", "chain"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"chainMeanAngle", "[", 
     RowBox[{"run_", ",", "chain_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"diskNumbers", ",", "diskDifferences"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"diskNumbers", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"disksNumbersInChain", "[", 
           RowBox[{"run", ",", "chain"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "==", 
            RowBox[{"bareNumber", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"diskDifferences", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"diskX", "@", 
                RowBox[{"getDisk", "[", 
                 RowBox[{
                  RowBox[{"#", "-", "1"}], ",", "run"}], "]"}]}], ",", 
               RowBox[{"diskX", "@", 
                RowBox[{"getDisk", "[", 
                 RowBox[{"#", ",", "run"}], "]"}]}]}], "}"}]}], "&"}], ",", 
           "diskNumbers"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diskDifferences", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", 
          "diskDifferences"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"diskDifferences", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "<", "0"}], ",", 
             RowBox[{"1", "+", "#"}], ",", "#"}], "]"}], "&"}], ",", 
          "diskDifferences"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mean", "@", "diskDifferences"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainStatistics", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paras", ",", "chainNumbers"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"run", "[", "\"\<Parastichy\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Chain\>\"", "->", "#1"}], ",", 
            RowBox[{"\"\<Parastichy\>\"", "->", 
             RowBox[{"KeySort", "[", "#2", "]"}]}]}], "|>"}], "&"}], ",", 
         "paras"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<MeanZ\>\"", "->", 
             RowBox[{"chainMeanZ", "[", 
              RowBox[{"run", ",", "#Chain"}], "]"}]}]}], "]"}], "&"}], ",", 
         "paras"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<MeanR\>\"", "->", 
             RowBox[{"chainMeanR", "[", 
              RowBox[{"run", ",", "#Chain"}], "]"}]}]}], "]"}], "&"}], ",", 
         "paras"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<MeanRise\>\"", "->", 
             RowBox[{"chainMeanRise", "[", 
              RowBox[{"run", ",", "#Chain"}], "]"}]}]}], "]"}], "&"}], ",", 
         "paras"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"paras", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<MeanTheta\>\"", "->", 
             RowBox[{"chainMeanAngle", "[", 
              RowBox[{"run", ",", "#Chain"}], "]"}]}]}], "]"}], "&"}], ",", 
         "paras"}], "]"}]}], ";", " ", "\[IndentingNewLine]", "paras"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nodeStatistics", "[", "run_", "]"}], " ", ":=", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"doNode", ",", "nodes"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"doNode", "[", "n_", "]"}], " ", ":=", " ", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"disk", ",", "lastDisk", ",", "res"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"disk", " ", "=", " ", 
            RowBox[{"getDisk", "[", 
             RowBox[{"n", ",", "run"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"lastDisk", " ", "=", " ", 
            RowBox[{"getDisk", "[", 
             RowBox[{
              RowBox[{"n", "-", "1"}], ",", "run"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"res", "=", " ", 
            RowBox[{"<|", 
             RowBox[{
              RowBox[{"\"\<DiskNumber\>\"", "->", "n"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"\"\<Area\>\"", "->", 
               RowBox[{"areaPerNode", "[", 
                RowBox[{"run", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"\"\<Z\>\"", "->", 
               RowBox[{"diskZ", "[", "disk", "]"}]}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"\"\<R\>\"", "->", 
               RowBox[{"diskR", "[", "disk", "]"}]}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"\"\<Rise\>\"", "->", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MissingQ", "[", " ", "lastDisk", "]"}], ",", 
                 "lastDisk", ",", 
                 RowBox[{
                  RowBox[{"diskZ", "[", "disk", "]"}], "-", 
                  RowBox[{"diskZ", "[", "lastDisk", "]"}]}]}], "]"}]}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"\"\<DeltaX\>\"", "->", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"MissingQ", "[", " ", "lastDisk", "]"}], ",", 
                 "lastDisk", ",", 
                 RowBox[{
                  RowBox[{"diskX", "[", "disk", "]"}], "-", 
                  RowBox[{"diskX", "[", "lastDisk", "]"}]}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"res", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"res", ",", 
              RowBox[{"\"\<Theta\>\"", "->", " ", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"res", "[", "\"\<DeltaX\>\"", "]"}], "<", 
                  RowBox[{
                   RowBox[{"-", "1"}], "/", "2"}]}], ",", 
                 RowBox[{
                  RowBox[{"res", "[", "\"\<DeltaX\>\"", "]"}], "+", "1"}], 
                 ",", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"res", "[", "\"\<DeltaX\>\"", "]"}], ">", 
                    RowBox[{"1", "/", "2"}]}], ",", 
                   RowBox[{
                    RowBox[{"res", "[", "\"\<DeltaX\>\"", "]"}], "-", "1"}], 
                   ",", 
                   RowBox[{"res", "[", "\"\<DeltaX\>\"", "]"}]}], "]"}]}], 
                "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], 
         "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nodes", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"doNode", ",", "\[IndentingNewLine]", 
          RowBox[{"Keys", "[", 
           RowBox[{"run", "[", "\"\<PastDisks\>\"", "]"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"vList", " ", "=", " ", 
        RowBox[{"VertexList", "/@", 
         RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nodeChainLookup", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "->", 
             RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"KeyValueMap", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Outer", "[", 
                 RowBox[{"List", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
               RowBox[{"GroupBy", "[", 
                RowBox[{
                 RowBox[{"Normal", "[", "vList", "]"}], ",", 
                 RowBox[{"Last", "->", "First"}]}], "]"}]}], "]"}], ",", 
             "2"}], "]"}]}], "]"}]}]}], ";", "\n", "\[IndentingNewLine]", 
       RowBox[{"nodes", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<Chain\>\"", "->", " ", 
              RowBox[{"nodeChainLookup", "[", "#DiskNumber", "]"}]}]}], "]"}],
            "&"}], ",", "nodes"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nodes", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\"\<Parastichy\>\"", "->", " ", 
              RowBox[{
               RowBox[{"run", "[", "\"\<Parastichy\>\"", "]"}], "[", "#Chain",
                "]"}]}]}], "]"}], "&"}], ",", "nodes"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "nodes"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"areaPerNode", "[", 
    RowBox[{"run_", ",", "node_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g", ",", "nodes", ",", "nodeNeighbours", ",", "nodeAreas", ",", 
       "disks", ",", "vDisk", ",", "vectors", ",", "areas"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "  ", "=", " ", 
       RowBox[{"run", "[", "\"\<ContactGraph\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nodeNeighbours", " ", "=", "  ", 
       RowBox[{"VertexList", "@", 
        RowBox[{"NeighborhoodGraph", "[", 
         RowBox[{"g", ",", "node"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"disks", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", " ", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "run"}], "]"}]}], "&"}], ",", 
          "nodeNeighbours"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vDisk", " ", "=", " ", 
       RowBox[{"disks", "[", "node", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"disks", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"diskXZ", ",", 
         RowBox[{"Select", "[", 
          RowBox[{"disks", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"diskZ", "[", "#", "]"}], "<", 
             RowBox[{"diskZ", "[", "vDisk", "]"}]}], "&"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vectors", " ", "=", " ", 
       RowBox[{"Map", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", " ", 
           RowBox[{"diskXZ", "[", "vDisk", "]"}]}], "&"}], ",", "disks"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"areas", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "vectors", "]"}], "==", "2"}], ",", 
         RowBox[{"Abs", "@", 
          RowBox[{"Det", "@", " ", 
           RowBox[{"(", 
            RowBox[{"Values", "@", "vectors"}], ")"}]}]}], ",", 
         RowBox[{"Missing", "[", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "areas"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8723324982198586`*^9, 3.8723326276017904`*^9}, {
   3.8723977001952763`*^9, 3.872397735964402*^9}, {3.8723980106589384`*^9, 
   3.8723980350543737`*^9}, {3.872398065286047*^9, 3.8723981721574492`*^9}, {
   3.8723982062041297`*^9, 3.8723982705759473`*^9}, {3.8723983851943707`*^9, 
   3.8723983851943707`*^9}, {3.8723984231671762`*^9, 3.872398474085377*^9}, {
   3.872398571249192*^9, 3.8723987221356783`*^9}, {3.872399096875741*^9, 
   3.872399109079203*^9}, {3.872399191254609*^9, 3.8723992278492165`*^9}, {
   3.8723993602131405`*^9, 3.872399371929714*^9}, {3.8723994603912354`*^9, 
   3.872399510236354*^9}, {3.8723995518575435`*^9, 3.872399558977643*^9}, {
   3.87239969898246*^9, 3.8723997258113737`*^9}, 3.872401946457533*^9, {
   3.872402208416772*^9, 3.8724022135670214`*^9}, {3.87240365015877*^9, 
   3.8724036542472343`*^9}, {3.8724037274444246`*^9, 3.8724037299617805`*^9}, 
   3.872588398014097*^9, {3.872588500062867*^9, 3.872588569657287*^9}, {
   3.872588611306198*^9, 3.8725886552520213`*^9}, {3.872588687736684*^9, 
   3.872588692578096*^9}, 3.8725910507074623`*^9, {3.872591176781574*^9, 
   3.8725911911826954`*^9}, {3.8725915977619667`*^9, 
   3.8725916765122085`*^9}, {3.8725917162043014`*^9, 
   3.8725917233965807`*^9}, {3.87259238084608*^9, 3.8725924096670847`*^9}, {
   3.872592445410539*^9, 3.8725924815904646`*^9}, {3.8725926786371884`*^9, 
   3.8725926944100337`*^9}, 3.8725929123093014`*^9, {3.8727572791453*^9, 
   3.872757282903966*^9}, 3.8729099560910687`*^9, {3.872910387262169*^9, 
   3.872910414732231*^9}, {3.8729111400144176`*^9, 3.872911144155642*^9}, {
   3.8729111784118013`*^9, 3.8729111810456676`*^9}, {3.872911219874485*^9, 
   3.8729112209837875`*^9}, 3.872911272081191*^9, {3.872937460661058*^9, 
   3.8729375123629093`*^9}, {3.8729375796377087`*^9, 3.872937606259457*^9}, 
   3.8729376373648787`*^9, {3.872938006054778*^9, 3.872938026152614*^9}, {
   3.8729423772610254`*^9, 3.872942402440152*^9}, 3.8739731837765455`*^9, {
   3.873973226741705*^9, 
   3.8739732271381083`*^9}},ExpressionUUID->"212d93fc-bb9c-4366-ad03-\
6e622e848fbe"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run implementation", "Section",
 CellChangeTimes->{{3.87293737412249*^9, 
  3.872937381676175*^9}},ExpressionUUID->"fe596e68-0dda-4801-93e2-\
f79621326472"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"completeChain", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "i", ",", 
        RowBox[{"complete", "=", "False"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<=", " ", "500"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"initializeCurrentOverlaps", "[", "res", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"res", "=", " ", 
           RowBox[{"addNextDisk", "[", "res", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"initializeCurrentOverlaps", "[", "res", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"tryToCompleteCurrentChain", "[", "res", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"complete", " ", "=", " ", 
           RowBox[{"!", 
            RowBox[{"MissingQ", "[", 
             RowBox[{"res", "[", "\"\<CurrentChainNodePath\>\"", "]"}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"complete", ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"debugRes", " ", "=", " ", "res"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", "complete"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
            RowBox[{
            "StringTemplate", "[", 
             "\"\<chain incomplete after `` iterations\>\"", "]"}], "[", "i", 
            "]"}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"setUpNewChain", "[", "res", "]"}]}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"setUpNewChain", "[", "run_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "chainNumber", ",", "completedChainGraph"}], "}"}], 
    ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
     RowBox[{"completedChainGraph", " ", "=", " ", 
      RowBox[{"res", "[", "\"\<CurrentChainGraph\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chainNumber", " ", "=", " ", 
      RowBox[{"nextChainNumber", "[", "res", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CompletedChainGraphs\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"chainNumber", "->", "completedChainGraph"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CompletedChainNodePaths\>\"", "]"}], "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CompletedChainNodePaths\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"chainNumber", "->", 
         RowBox[{"res", "[", "\"\<CurrentChainNodePath\>\"", "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<Parastichy\>\"", "]"}], " ", "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<Parastichy\>\"", "]"}], ",", 
        RowBox[{"computeChainParastichy", "[", "res", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<PastDisks\>\"", "]"}], "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<PastDisks\>\"", "]"}], ",", 
        RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], "=", " ", 
      RowBox[{"KeyTake", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], ",", 
        RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentOverlaps\>\"", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<UsedOverlaps\>\"", "]"}], "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentChainGraph\>\"", "]"}], " ", "=", " ", 
      RowBox[{"Graph", "[", 
       RowBox[{"{", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861684358629258*^9, 3.861684524240922*^9}, 
   3.861684576473754*^9, {3.8616846176312237`*^9, 3.8616847132073975`*^9}, {
   3.8616850134328413`*^9, 3.86168501704149*^9}, {3.861685048105015*^9, 
   3.8616850784193096`*^9}, {3.8616851234082212`*^9, 
   3.8616852027446823`*^9}, {3.861685371069314*^9, 3.8616853712842484`*^9}, {
   3.8616859082014556`*^9, 3.8616859210857525`*^9}, {3.861686056906653*^9, 
   3.861686123610694*^9}, {3.861688774038667*^9, 3.861688774198612*^9}, {
   3.8616888216547055`*^9, 3.861688828539577*^9}, {3.861688866608322*^9, 
   3.861688874186267*^9}, {3.8616889140833178`*^9, 3.861688950502099*^9}, 
   3.861689001171564*^9, {3.861689204822542*^9, 3.8616892759751277`*^9}, {
   3.861689413105137*^9, 3.861689421578429*^9}, {3.8616894718935575`*^9, 
   3.861689545046216*^9}, {3.861689613115652*^9, 3.8616896296398883`*^9}, 
   3.861689777517949*^9, 3.861689923485132*^9, {3.861690349412821*^9, 
   3.861690375698805*^9}, {3.8617713082464485`*^9, 3.8617713200718336`*^9}, {
   3.861772807301606*^9, 3.861772810800974*^9}, 3.861772872800007*^9, 
   3.8617734237668533`*^9, {3.861773566079151*^9, 3.86177359053448*^9}, {
   3.8617736209803843`*^9, 3.8617736407257657`*^9}, {3.8618596208212905`*^9, 
   3.8618596239807587`*^9}, {3.8618697184427385`*^9, 
   3.8618697186145725`*^9}, {3.8618703757759724`*^9, 3.8618703759634113`*^9}, 
   3.8618707268751297`*^9, {3.8665189808319173`*^9, 3.8665189849499197`*^9}, {
   3.866520516693599*^9, 3.866520528193391*^9}, 3.8665209197269783`*^9, {
   3.8665210125520844`*^9, 3.8665210626885443`*^9}, 3.866532591882633*^9, {
   3.8665326805866437`*^9, 3.866532683002239*^9}, 3.866532771963004*^9, {
   3.8665353835915704`*^9, 3.866535397448186*^9}, {3.866546341800876*^9, 
   3.866546342031291*^9}, {3.8665479154232206`*^9, 3.8665479432892227`*^9}, 
   3.8665480981356897`*^9, {3.8665481558457327`*^9, 3.8665482562440033`*^9}, 
   3.866606186616213*^9, 3.866606220904422*^9, {3.866606257460112*^9, 
   3.866606344518056*^9}, {3.8666104115820384`*^9, 3.8666104579668503`*^9}, {
   3.8666105122196684`*^9, 3.866610548625079*^9}, {3.8666106682677794`*^9, 
   3.86661067668945*^9}, {3.8666107464094114`*^9, 3.866610777397222*^9}, {
   3.8666108364355145`*^9, 3.866610846526102*^9}, {3.866611288228443*^9, 
   3.866611288244074*^9}, {3.869726375498214*^9, 3.869726421793993*^9}, {
   3.8697981856877155`*^9, 3.8697981998485003`*^9}, {3.8697982871295567`*^9, 
   3.8697985850865693`*^9}, 3.8697986463239536`*^9, {3.869798681111512*^9, 
   3.8697987030720844`*^9}, {3.8697987513376675`*^9, 
   3.8697987584888744`*^9}, {3.8697988308736744`*^9, 
   3.8697988994649253`*^9}, {3.8697990094501896`*^9, 3.86979915655697*^9}, {
   3.8697991923436065`*^9, 3.869799264714652*^9}, {3.8697993346541643`*^9, 
   3.869799488454625*^9}, {3.86982274394658*^9, 3.8698228895331182`*^9}, {
   3.8698230243111973`*^9, 3.8698230256593795`*^9}, {3.8698230672101555`*^9, 
   3.8698231948442183`*^9}, {3.869823313291215*^9, 3.869823330792934*^9}, {
   3.869891617557027*^9, 3.869891737793434*^9}, {3.869891769058402*^9, 
   3.869891955179182*^9}, 3.869892356436333*^9, {3.8699228701917844`*^9, 
   3.86992287789316*^9}, {3.870414845838695*^9, 3.870414846557075*^9}, 
   3.870418074757024*^9, 3.8704181767953324`*^9, 3.8704184356869884`*^9, {
   3.870419286588849*^9, 3.8704194074598284`*^9}, {3.870419443386533*^9, 
   3.870419467456215*^9}, {3.870523493709098*^9, 3.8705234987751074`*^9}, {
   3.870524401000214*^9, 3.8705244303295174`*^9}, {3.870524579091002*^9, 
   3.870524652527469*^9}, {3.870524736585949*^9, 3.87052484784743*^9}, {
   3.8705249078648295`*^9, 3.8705249082603903`*^9}, {3.870525181933323*^9, 
   3.870525231562318*^9}, {3.870525294294423*^9, 3.870525312587715*^9}, {
   3.8705953106908627`*^9, 3.870595312849454*^9}, {3.87059574049737*^9, 
   3.870595751844956*^9}, {3.870596098269575*^9, 3.8705961592920146`*^9}, 
   3.8705962399704037`*^9, {3.870596335656187*^9, 3.8705963497025566`*^9}, 
   3.870599050868951*^9, 3.8705992290136175`*^9, 3.870690964513497*^9, 
   3.870692312889798*^9, {3.870695124471425*^9, 3.87069513274988*^9}, {
   3.8706953579367437`*^9, 3.8706953882850347`*^9}, {3.8707749080220923`*^9, 
   3.870774953417694*^9}, {3.8707750062657723`*^9, 3.8707750369819217`*^9}, {
   3.8707753742744007`*^9, 3.8707753876817245`*^9}, {3.87077659939155*^9, 
   3.8707766145452285`*^9}, {3.8707766669238048`*^9, 3.8707767099986973`*^9}, 
   3.8707767560183105`*^9, 3.8707775419698687`*^9, {3.870781994354768*^9, 
   3.870782014801423*^9}, {3.8708664018260994`*^9, 3.8708664467142563`*^9}, {
   3.8719064973275795`*^9, 3.8719065506310377`*^9}, {3.871907214100464*^9, 
   3.8719072336049476`*^9}, 3.872066128235659*^9, {3.8720665181634235`*^9, 
   3.872066580484194*^9}, 3.8723983619861794`*^9, {3.8724001011013484`*^9, 
   3.872400147896209*^9}, {3.8724001795181065`*^9, 3.8724001796922894`*^9}, {
   3.872400223273884*^9, 3.872400229374332*^9}, {3.872401269460249*^9, 
   3.872401275860113*^9}, {3.872401309113552*^9, 3.8724014002220445`*^9}, {
   3.8724018991208353`*^9, 3.872401905991184*^9}, {3.8724023868809986`*^9, 
   3.872402397969055*^9}, 3.87240295968653*^9, {3.87240382877649*^9, 
   3.872403839324546*^9}, {3.8724038713718605`*^9, 3.872403876158942*^9}, 
   3.872403912631796*^9, 3.872937359274167*^9},
 CellLabel->
  "In[169]:=",ExpressionUUID->"8b12ee36-315e-467a-93be-2af9a85bf88d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"computeChainParastichy", "[", "run_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "completedChainNumber", ",", "completedChainGraph", ",", "edges", ",", 
      "res", ",", "g", ",", "lines"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"completedChainNumber", " ", "=", " ", 
      RowBox[{"Last", "[", 
       RowBox[{"Keys", "[", 
        RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", " ", "=", " ", 
      RowBox[{
       RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}], "[", 
       "completedChainNumber", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Apply", "[", 
          RowBox[{"UndirectedEdge", ",", "#"}], "]"}], "&"}], ",", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{"run", "[", "\"\<CurrentChainNodePath\>\"", "]"}], ",", "2",
           ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"leftOrRight", "[", " ", 
       RowBox[{"a_", " ", "\[UndirectedEdge]", " ", "b_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "z1", ",", "x2", ",", "z2"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x1", ",", "z1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x2", ",", "z2"}], "}"}]}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"diskXZ", "[", 
             RowBox[{"getDisk", "[", 
              RowBox[{"a", ",", "run"}], "]"}], "]"}], ",", 
            RowBox[{"diskXZ", "[", 
             RowBox[{"getDisk", "[", 
              RowBox[{"b", ",", "run"}], "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"z2", "-", "z1"}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{"x2", "-", "x1"}], ")"}]}], " ", ">", "0"}], " ", ",", 
           " ", "\"\<Right\>\"", ",", "\"\<Left\>\""}], "]"}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"edges", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"leftOrRight", ",", "edges"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"edges", "=", " ", 
      RowBox[{"Counts", "[", "edges", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"completedChainNumber", "->", " ", "edges"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8707750456827207`*^9, 3.870775163209838*^9}, {
   3.8707752055144863`*^9, 3.8707752115756407`*^9}, {3.870775610115407*^9, 
   3.8707756926173906`*^9}, {3.8707758698669662`*^9, 
   3.8707758853318663`*^9}, {3.8707759387568607`*^9, 3.870776026960251*^9}, {
   3.8707761156581764`*^9, 3.8707761389808426`*^9}, {3.870776184760375*^9, 
   3.870776286122629*^9}, {3.8707763281624427`*^9, 3.870776328802908*^9}, {
   3.870776368809241*^9, 3.870776488498263*^9}, {3.8719773921664495`*^9, 
   3.8719774317201443`*^9}, 3.871977551841748*^9, {3.8719786209462595`*^9, 
   3.8719786418148174`*^9}, {3.871978678134206*^9, 3.8719787015060077`*^9}, {
   3.871978826819386*^9, 3.8719788455939536`*^9}, {3.871982783718419*^9, 
   3.87198278513268*^9}, {3.871983165128827*^9, 3.8719831658359084`*^9}, {
   3.8722155073222675`*^9, 3.872215513021062*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"74b52111-1d23-4f8e-9305-7dd8994af4ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tryToCompleteCurrentChain", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "res", ",", "nodeList", ",", "lrNodes", ",", "lrCases", ",", 
        "lrPaths"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentChainNodePath\>\"", "]"}], "=", 
        RowBox[{"Missing", "[", "\"\<No chain\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nodeList", " ", "=", " ", 
        RowBox[{"VertexList", "@", 
         RowBox[{"res", "[", "\"\<CurrentChainGraph\>\"", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lrNodes", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"nodeList", ",", 
          RowBox[{
           RowBox[{"left", "[", "_", "]"}], " ", "|", " ", 
           RowBox[{"right", "[", "_", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lrCases", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", 
             RowBox[{"MemberQ", "[", 
              RowBox[{"nodeList", ",", 
               RowBox[{"bareNumber", "[", "#", "]"}]}], "]"}]}], "&"}], ",", 
           "lrNodes"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lrCases", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"lrCases", ",", "TrueQ"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lrCases", "]"}], "==", "0"}], ",", 
         RowBox[{"Return", "[", "res", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lrPaths", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", 
             RowBox[{"lrNodePath", "[", 
              RowBox[{"#", ",", 
               RowBox[{"res", "[", "\"\<CurrentChainGraph\>\"", "]"}]}], 
              "]"}]}], "&"}], ",", 
           RowBox[{"Keys", "@", "lrCases"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lrPaths", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"lrPaths", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], ">", "0"}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "lrPaths", "]"}], "==", "0"}], ",", 
         RowBox[{"Return", "[", "res", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentChainNodePath\>\"", "]"}], "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"First", "[", "lrPaths", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lrNodePath", "[", 
   RowBox[{"lrNode_", ",", "g_"}], "]"}], " ", ":=", " ", 
  RowBox[{"FindPath", "[", 
   RowBox[{"g", ",", "lrNode", ",", 
    RowBox[{"bareNumber", "[", "lrNode", "]"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8616839026344147`*^9, 3.8616839520673313`*^9}, {
   3.861683999119978*^9, 3.8616840041373234`*^9}, {3.8616840511513433`*^9, 
   3.861684168167019*^9}, {3.8616842013933973`*^9, 3.86168423611084*^9}, {
   3.8616842750865345`*^9, 3.8616843373281612`*^9}, {3.866535478022271*^9, 
   3.866535501132549*^9}, {3.866535812667658*^9, 3.8665358147032614`*^9}, {
   3.8665459393766794`*^9, 3.8665460885764937`*^9}, {3.866546150929517*^9, 
   3.8665461713402023`*^9}, {3.866546206137893*^9, 3.8665462155887384`*^9}, {
   3.866546245797874*^9, 3.8665462548174114`*^9}, {3.8665464067971687`*^9, 
   3.866546446575143*^9}, {3.866546550943343*^9, 3.8665465954749193`*^9}, {
   3.8665466291760216`*^9, 3.866546632375708*^9}, {3.8665466795964403`*^9, 
   3.8665466872931232`*^9}, {3.866546718277402*^9, 3.8665467407269793`*^9}, {
   3.8665467945384684`*^9, 3.8665468519055853`*^9}, {3.8665469295754514`*^9, 
   3.866546934424985*^9}, {3.866546970767816*^9, 3.866547013624983*^9}, {
   3.8665471706566195`*^9, 3.866547233749716*^9}, {3.8665472682959538`*^9, 
   3.8665472798817425`*^9}, {3.8665473242518187`*^9, 
   3.8665473472982492`*^9}, {3.866547808388521*^9, 3.8665478406233015`*^9}, {
   3.866548018737077*^9, 3.866548061418183*^9}, {3.8697253182684307`*^9, 
   3.869725342980695*^9}, {3.8697256139118834`*^9, 3.8697256674994044`*^9}, {
   3.8697257260651045`*^9, 3.869725744284723*^9}, {3.8697257816172934`*^9, 
   3.8697258122188673`*^9}, {3.869725843896308*^9, 3.869725861632268*^9}, {
   3.8697261385697603`*^9, 3.8697261659169207`*^9}, {3.869726438364998*^9, 
   3.8697264518429437`*^9}, {3.8697265148144674`*^9, 
   3.8697266507765093`*^9}, {3.869726884161798*^9, 3.8697269388796988`*^9}, {
   3.8697269832119737`*^9, 3.869727034020703*^9}, {3.8697270976538553`*^9, 
   3.8697271252993712`*^9}, {3.86972715582773*^9, 3.8697271982374754`*^9}, 
   3.8697272293766546`*^9, {3.869727324398678*^9, 3.8697274114813566`*^9}, {
   3.8697274721184483`*^9, 3.8697274739963427`*^9}, {3.869731976242262*^9, 
   3.869732003532915*^9}, {3.8697321115793524`*^9, 3.8697321125940723`*^9}, {
   3.8697322663071437`*^9, 3.8697322706769056`*^9}, 3.8697323638839498`*^9, {
   3.869737290971903*^9, 3.869737313928529*^9}, {3.869741696806182*^9, 
   3.8697417033271017`*^9}, 3.870522901958747*^9, {3.870522964516466*^9, 
   3.8705229818232203`*^9}, 3.8705983193279953`*^9, {3.8705984193074408`*^9, 
   3.870598448890874*^9}, {3.870598552484592*^9, 3.870598703942067*^9}, {
   3.8705987351733*^9, 3.870598741933963*^9}, {3.8705987723750095`*^9, 
   3.870598887449967*^9}, {3.8705989401026173`*^9, 3.8705989442325044`*^9}, {
   3.87077540605235*^9, 3.8707754801190624`*^9}, {3.8707759282749314`*^9, 
   3.8707759300713863`*^9}},
 CellLabel->
  "In[172]:=",ExpressionUUID->"13d281b0-6a41-489c-b446-b5db095d3c80"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initializeCurrentOverlaps", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nextR", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextR", "=", " ", 
        RowBox[{"nextRadius", "[", "run", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"possibleOverlaps", " ", "=", " ", 
        RowBox[{"potentialHorizontalOverlaps", "[", 
         RowBox[{"run", ",", "nextR"}], "]"}]}], ";", "\[IndentingNewLine]", 
       " ", 
       RowBox[{"possibleOverlaps", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"possibleOverlaps", ",", 
          RowBox[{"run", "[", "\"\<UsedOverlaps\>\"", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "run"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentOverlaps\>\"", "]"}], "=", " ", 
        "possibleOverlaps"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.8616891647790556`*^9, {3.86168991404274*^9, 
   3.8616899178617325`*^9}, {3.8616904359936657`*^9, 
   3.8616904612958555`*^9}, {3.8617713554075007`*^9, 3.86177136615466*^9}, {
   3.861771529586708*^9, 3.8617715651251936`*^9}, {3.8617717150362234`*^9, 
   3.861771724387151*^9}, 3.861771969724106*^9, 3.861772130778466*^9, {
   3.8618707759742775`*^9, 3.861870776552259*^9}, {3.861870823540469*^9, 
   3.8618708260418425`*^9}, 3.8697347707309113`*^9, {3.869892309209867*^9, 
   3.8698923103817077`*^9}, 3.869892352569871*^9, {3.8699227044693546`*^9, 
   3.869922705229658*^9}, {3.8706002573779097`*^9, 3.870600308449979*^9}, 
   3.8706003596921015`*^9, {3.872589685371546*^9, 3.872589718189305*^9}, {
   3.8725897819042006`*^9, 3.872589795871311*^9}, {3.8725898315402555`*^9, 
   3.872589836705862*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"42f9121c-e31e-4ddf-88fc-a070f493771f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"potentialHorizontalOverlaps", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"supportDisks", ",", "supportPairs", ",", "can"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"supportDisks", " ", "=", " ", 
       RowBox[{"currentSupportDisks", "[", 
        RowBox[{"run", ",", "nextR"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "these", " ", "are", " ", "sorted", " ", "in", " ", "X", " ", 
         "order"}], ",", " ", 
        RowBox[{
        "so", " ", "the", " ", "pairs", " ", "will", " ", "always", " ", "be",
          " ", "left", " ", "right", " ", "\[IndentingNewLine]", "and", " ", 
         "we", " ", "only", " ", "need", " ", "test", " ", "one", " ", 
         "overlap"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"supportPairs", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<", " ", 
         RowBox[{"Length", "[", "supportDisks", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{"j", "<=", " ", 
           RowBox[{"Length", "[", "supportDisks", "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"can", " ", "=", " ", 
            RowBox[{"diskPairCanSupport", "[", 
             RowBox[{"run", ",", "nextR", ",", 
              RowBox[{"supportDisks", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"supportDisks", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"can", ",", "\[IndentingNewLine]", 
             RowBox[{"supportPairs", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"supportPairs", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"supportDisks", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"supportDisks", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "supportPairs"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.86176811167383*^9, 3.8617682597197723`*^9}, {
   3.8617682940446005`*^9, 3.8617683208015947`*^9}, {3.861768396085757*^9, 
   3.861768466468691*^9}, {3.8617685127149725`*^9, 3.8617685274257803`*^9}, {
   3.8617685607421083`*^9, 3.8617685613503017`*^9}, {3.8617686239130816`*^9, 
   3.8617686243819647`*^9}, {3.8617686618849783`*^9, 
   3.8617686637751493`*^9}, {3.86176870938266*^9, 3.861768732367918*^9}, {
   3.8617701791317883`*^9, 3.861770256473044*^9}, {3.8617703228119564`*^9, 
   3.8617706374593897`*^9}, {3.8617706674910555`*^9, 3.861770854104594*^9}, 
   3.8617709024525056`*^9, {3.861771049078973*^9, 3.861771086242021*^9}, {
   3.861771117016026*^9, 3.8617712281706324`*^9}, {3.861771288493409*^9, 
   3.861771288633948*^9}, {3.861771380372183*^9, 3.8617714035295935`*^9}, {
   3.8617717107871904`*^9, 3.8617717354626474`*^9}, {3.8618558187788935`*^9, 
   3.8618558541525946`*^9}, {3.861855897042087*^9, 3.8618560184508553`*^9}, {
   3.8618560728951387`*^9, 3.861856109387108*^9}, {3.8618561406783648`*^9, 
   3.8618562129205*^9}, {3.8618562503742313`*^9, 3.861856262851577*^9}, {
   3.861856738894947*^9, 3.861856741225368*^9}, {3.8618606232744007`*^9, 
   3.861860627379337*^9}, {3.861860671745571*^9, 3.8618606728382387`*^9}, {
   3.8618607071326227`*^9, 3.861860707523094*^9}, {3.861860759939664*^9, 
   3.8618607622057204`*^9}, {3.8618688416478133`*^9, 3.861868867189494*^9}, {
   3.8618689713267174`*^9, 3.861868995260337*^9}, 3.861869120738061*^9, {
   3.861869260209362*^9, 3.861869408995321*^9}, {3.8618694821002164`*^9, 
   3.8618694873020487`*^9}, {3.8618695207349653`*^9, 3.861869537897152*^9}, {
   3.8618696514563837`*^9, 3.8618696550676675`*^9}, {3.8618702166609*^9, 
   3.861870220472766*^9}, {3.86187085672344*^9, 3.8618708744693584`*^9}, {
   3.866518939333186*^9, 3.866518946023529*^9}, {3.8665191316191864`*^9, 
   3.8665191373837123`*^9}, {3.866521409889783*^9, 3.8665215098822126`*^9}, 
   3.86652322563101*^9, {3.866523291328253*^9, 3.866523295878974*^9}, 
   3.866525403542487*^9, 3.866532356979581*^9, {3.8665334549299164`*^9, 
   3.866533529194491*^9}, {3.866533633323496*^9, 3.8665336393403454`*^9}, {
   3.8665336798892093`*^9, 3.8665337209045835`*^9}, {3.866534738666405*^9, 
   3.866534743469593*^9}, {3.8665347783179736`*^9, 3.866534778693857*^9}, {
   3.866534820013294*^9, 3.866534848661617*^9}, {3.86653494045367*^9, 
   3.8665349529254184`*^9}, 3.8665350680528946`*^9, 3.869732628037418*^9, {
   3.8697988083899965`*^9, 3.869798811826223*^9}, 3.869921839093239*^9, 
   3.8699220672291107`*^9, {3.869922139806282*^9, 3.8699221482906322`*^9}, {
   3.869922442883154*^9, 3.86992244388381*^9}, {3.870417378839363*^9, 
   3.870417416533455*^9}, {3.8704177694859543`*^9, 3.870417792536235*^9}, 
   3.8704179653556557`*^9, 3.870418012495679*^9, 3.8706009588990326`*^9, {
   3.870691380383738*^9, 3.8706913812901382`*^9}, {3.8706916341613975`*^9, 
   3.8706916351026926`*^9}, {3.870691698247822*^9, 3.870691755181956*^9}},
 CellLabel->
  "In[175]:=",ExpressionUUID->"0d48f50d-3e32-4b1e-860d-a7823b19968a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"currentSupportDisks", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"chain", ",", "lefts", ",", "rights"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"VertexList", "@", 
        RowBox[{"Last", "@", 
         RowBox[{"run", "[", "\"\<CompletedChainGraphs\>\"", "]"}]}]}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"chain", ",", 
         RowBox[{"run", "[", "\"\<CurrentChain\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"chain", ",", 
         RowBox[{
          RowBox[{"diskX", "[", 
           RowBox[{"getDisk", "[", 
            RowBox[{"#", ",", "run"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lefts", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"moveNumberedDiskLeft", "[", 
           RowBox[{"#", "->", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "run"}], "]"}]}], "]"}], "&"}], ",", "chain"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lefts", " ", "=", " ", 
       RowBox[{"First", " ", "/@", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"lefts", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diskRightX", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], "+", "nextR"}], ">=", 
            " ", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], " ", "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rights", " ", "=", "  ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"moveNumberedDiskRight", "[", 
           RowBox[{"#", "->", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "run"}], "]"}]}], "]"}], "&"}], ",", "chain"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rights", " ", "=", 
       RowBox[{"First", " ", "/@", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"rights", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diskLeftX", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], "-", "nextR"}], "<=", 
            " ", 
            RowBox[{"1", "/", "2"}]}], " ", "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{"Join", "[", 
        RowBox[{"lefts", ",", "chain", ",", "rights"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskPairCanSupport", "[", 
   RowBox[{"run_", ",", "nextR_", ",", "n1_", ",", "n2_"}], "]"}], " ", ":=", 
  " ", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"assumes", " ", "lr", " ", "ordering"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskLeftX", "[", 
     RowBox[{"getDisk", "[", 
      RowBox[{"n2", ",", "run"}], "]"}], "]"}], "-", 
    RowBox[{"diskRightX", "[", 
     RowBox[{"getDisk", "[", 
      RowBox[{"n1", ",", "run"}], "]"}], "]"}]}], "<=", " ", 
   RowBox[{"2", "*", "nextR"}]}]}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8618609832942944`*^9, 3.861861061074704*^9}, {
   3.861861110410298*^9, 3.8618611849953966`*^9}, {3.8618612835319247`*^9, 
   3.861861293180356*^9}, {3.86186148247342*^9, 3.8618615591943808`*^9}, {
   3.86186759473781*^9, 3.861867635995823*^9}, {3.8618682143968873`*^9, 
   3.8618682191102877`*^9}, {3.861868356297555*^9, 3.861868366856969*^9}, {
   3.861868401097106*^9, 3.8618684788548923`*^9}, {3.861868517852971*^9, 
   3.8618685682815886`*^9}, {3.8618686017215767`*^9, 3.861868803803029*^9}, {
   3.861869057053732*^9, 3.861869228341298*^9}, {3.8618701303426723`*^9, 
   3.861870190027537*^9}, {3.8618702800840073`*^9, 3.8618703073118696`*^9}, 
   3.8618704425420823`*^9, 3.8666112882129107`*^9, {3.866611447720155*^9, 
   3.8666114518295593`*^9}, {3.8666115010895348`*^9, 3.866611505675701*^9}, {
   3.8699223101149006`*^9, 3.8699223658651705`*^9}, {3.8707755514936695`*^9, 
   3.8707755558051558`*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"0a65e49c-b2c5-44c1-beed-0dda6949a9df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "timeResults", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "timeCheck", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeResults", " ", "=", " ", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeLabels", " ", "=", " ", 
   RowBox[{"{", "\"\<General\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStart", "[", "label_", "]"}], " ", ":=", 
   RowBox[{"AppendTo", "[", 
    RowBox[{"timeLabels", ",", "label"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStop", " ", ":=", " ", 
   RowBox[{"Drop", "[", 
    RowBox[{"timeLabels", ",", 
     RowBox[{"-", "1"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeCheck", "[", "f_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tim", ",", "res", ",", "label"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"label", " ", "=", " ", 
       RowBox[{"Last", "[", "timeLabels", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tim", ",", "res"}], "}"}], "=", 
       RowBox[{"Timing", "[", "f", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"KeyExistsQ", "[", 
         RowBox[{"timeResults", ",", "label"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"timeResults", "[", "label", "]"}], " ", "+=", " ", "tim"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"timeResults", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"timeResults", ",", 
           RowBox[{"label", "->", "0"}]}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeStart", "[", "label_", "]"}], " ", ":=", " ", "Null"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStop", " ", ":=", " ", "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"timeCheck", "[", "f_", "]"}], " ", ":=", " ", "f"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SetAttributes", "[", 
  RowBox[{"timeCheck", ",", "HoldAll"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"timeCheck", "[", "label_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"timeCheck", "[", 
      RowBox[{"#", ",", "label"}], "]"}], "&"}]}], "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.861684567380087*^9, {3.861685253020944*^9, 
   3.8616853458383093`*^9}, {3.861685457877714*^9, 3.861685524343441*^9}, {
   3.861685566060768*^9, 3.8616856175873985`*^9}, 3.8616857932526894`*^9, {
   3.861685829506477*^9, 3.8616858299597845`*^9}, {3.861688603446192*^9, 
   3.861688615129272*^9}, {3.86169034328926*^9, 3.8616903641702642`*^9}, {
   3.8616906028614054`*^9, 3.861690613889862*^9}, {3.8616906847476935`*^9, 
   3.8616906922771196`*^9}, 3.861690764753615*^9, {3.861772170133756*^9, 
   3.8617722079492044`*^9}, {3.8617722871804495`*^9, 3.86177231837619*^9}, 
   3.861772380747596*^9, 3.861772972599372*^9, {3.8617730788870215`*^9, 
   3.861773116019061*^9}, {3.861773236570961*^9, 3.861773237133318*^9}, 
   3.8617733085850763`*^9, {3.8618544290335045`*^9, 3.8618544339073277`*^9}, {
   3.8618545247340236`*^9, 3.8618545691624084`*^9}, 3.8618546263267117`*^9, {
   3.8618547123451824`*^9, 3.8618547198592353`*^9}, {3.861854927478796*^9, 
   3.86185495453036*^9}, {3.8618549923765907`*^9, 3.8618550751680417`*^9}, {
   3.8618552098386374`*^9, 3.861855210136306*^9}, {3.8618554045898485`*^9, 
   3.861855475183138*^9}, {3.8618563608325615`*^9, 3.8618564345676575`*^9}, {
   3.8618565114209447`*^9, 3.861856512327812*^9}, {3.8618566113717766`*^9, 
   3.861856611527938*^9}, {3.8618568248134055`*^9, 3.8618568368332787`*^9}, {
   3.861856924970784*^9, 3.8618570384314375`*^9}, {3.8618571729812574`*^9, 
   3.861857351538889*^9}, {3.861857480053604*^9, 3.8618575189173813`*^9}, {
   3.8618575508223395`*^9, 3.8618575787857976`*^9}, {3.861857610256908*^9, 
   3.861857623584346*^9}, {3.8618576564143443`*^9, 3.8618576566173725`*^9}, {
   3.8618576875291414`*^9, 3.861857783072259*^9}, 3.8618597252801557`*^9, {
   3.861870578647255*^9, 3.8618706222833543`*^9}, {3.866519105220563*^9, 
   3.866519107290676*^9}, {3.866520251927141*^9, 3.866520294522225*^9}, {
   3.8665208744296412`*^9, 3.866520882039946*^9}, {3.8665236376713457`*^9, 
   3.8665236926548643`*^9}, {3.866523795187729*^9, 3.866523864806645*^9}, {
   3.866524003523258*^9, 3.866524046268936*^9}, {3.8665241384125104`*^9, 
   3.8665241647643795`*^9}, {3.8665241975357885`*^9, 3.86652423776758*^9}, {
   3.8665243261190443`*^9, 3.8665244274195013`*^9}, {3.866524497782097*^9, 
   3.866524501816389*^9}, {3.86652456710385*^9, 3.866524584682516*^9}, {
   3.866524623366629*^9, 3.8665246407137637`*^9}, 3.8665247552838326`*^9, {
   3.866524880403557*^9, 3.8665248834179616`*^9}, {3.866524927110199*^9, 
   3.866524932478689*^9}, 3.866524977776678*^9, {3.866525324960269*^9, 
   3.8665253756153436`*^9}, {3.8665254615691423`*^9, 
   3.8665255465638466`*^9}, {3.8665312471644554`*^9, 
   3.8665312544075828`*^9}, {3.8665313215564375`*^9, 3.866531371385373*^9}, {
   3.86653140440658*^9, 3.8665314250151*^9}, {3.8665314704650736`*^9, 
   3.8665315810594635`*^9}, {3.8665318696856117`*^9, 
   3.8665318700951877`*^9}, {3.866532013885068*^9, 3.8665320181585035`*^9}, {
   3.866532298934456*^9, 3.866532332171548*^9}, 3.866532793466457*^9, {
   3.8665329123068433`*^9, 3.8665329204361277`*^9}, 3.866532980490587*^9, {
   3.8665330498400264`*^9, 3.866533054907532*^9}, {3.866533116748412*^9, 
   3.8665331410862885`*^9}, {3.8665333701434574`*^9, 3.866533418827178*^9}, {
   3.86653508612512*^9, 3.8665351023375535`*^9}, 3.8665351516226263`*^9, {
   3.866535617193274*^9, 3.8665356401868443`*^9}, {3.866535707759061*^9, 
   3.8665357257851076`*^9}, {3.866537984625264*^9, 3.86653799821967*^9}, {
   3.8666124178653955`*^9, 3.8666124609208746`*^9}, {3.8697333575631237`*^9, 
   3.8697333658130517`*^9}, 3.86973383675366*^9, {3.8697428566499977`*^9, 
   3.8697428664626427`*^9}, 3.8697979783483944`*^9, {3.869823824076408*^9, 
   3.869823897817015*^9}, {3.8698239351161127`*^9, 3.8698239507666297`*^9}, 
   3.869824060834675*^9, {3.869824143416043*^9, 3.8698241650567865`*^9}, {
   3.869891550994026*^9, 3.869891556307846*^9}, {3.8699226857014914`*^9, 
   3.869922691201561*^9}, {3.8704142305169983`*^9, 3.870414236364176*^9}, {
   3.87041427549467*^9, 3.8704143480771894`*^9}, 3.8704148725337625`*^9, {
   3.8704153297898526`*^9, 3.8704153332376103`*^9}, {3.8704154130955524`*^9, 
   3.870415462090645*^9}, 3.870415529941433*^9, {3.8704155919508924`*^9, 
   3.8704158454779778`*^9}, {3.8704160445105057`*^9, 
   3.8704160663757715`*^9}, {3.8704161209149733`*^9, 3.870416395361977*^9}, {
   3.87041645462037*^9, 3.8704164570148706`*^9}, 3.870417885402197*^9, {
   3.870418080658276*^9, 3.870418116840454*^9}, {3.8705217272430515`*^9, 
   3.8705217661482506`*^9}, {3.8705218040996084`*^9, 
   3.8705218062620974`*^9}, {3.8705218646106873`*^9, 3.870521872821912*^9}, {
   3.870521959330102*^9, 3.870521960031231*^9}, {3.8705231720281963`*^9, 
   3.870523173872707*^9}, 3.870600143150921*^9, {3.870600380815623*^9, 
   3.870600388751789*^9}, 3.8706007494442406`*^9, 3.870690216373376*^9, {
   3.8706907129401245`*^9, 3.8706907252083263`*^9}, {3.870690910826184*^9, 
   3.870690910841803*^9}, {3.870690964530489*^9, 3.8706909645628915`*^9}, {
   3.8706919383961124`*^9, 3.870691944266342*^9}, {3.870691980426237*^9, 
   3.8706920698905354`*^9}, {3.870692100489912*^9, 3.8706921384315434`*^9}, {
   3.8706921966216345`*^9, 3.870692257743017*^9}, {3.870692350730891*^9, 
   3.8706923760142584`*^9}, {3.8706924173671293`*^9, 
   3.8706924187534842`*^9}, {3.8706925751223383`*^9, 
   3.8706925762480946`*^9}, {3.870692620196228*^9, 3.8706926391662245`*^9}, {
   3.870692685450226*^9, 3.870692866461268*^9}, {3.8706929300952806`*^9, 
   3.870692939645688*^9}, {3.870693008403079*^9, 3.870693047811989*^9}, {
   3.870693120934204*^9, 3.870693160487589*^9}, {3.870693190839684*^9, 
   3.870693237839079*^9}, 3.8706932973793354`*^9, {3.870693343553604*^9, 
   3.8706934973270483`*^9}, {3.8706935296062813`*^9, 3.870693530043091*^9}, {
   3.8706935719095755`*^9, 3.8706936154866233`*^9}, {3.870693683351451*^9, 
   3.870693690582508*^9}, 3.870693744346345*^9, {3.8706937809879913`*^9, 
   3.8706938268293552`*^9}, {3.8706939464446526`*^9, 
   3.8706940687035513`*^9}, {3.8706941434065456`*^9, 3.870694245223572*^9}, {
   3.8706942794562073`*^9, 3.870694287171955*^9}, {3.870694320138788*^9, 
   3.870694349796641*^9}, 3.8706947563624363`*^9, {3.870777809495863*^9, 
   3.870777842526822*^9}, {3.87077793713608*^9, 3.870777938307744*^9}, {
   3.8707779749545994`*^9, 3.8707779766260767`*^9}, {3.870778081214616*^9, 
   3.870778088973708*^9}, {3.870778171552161*^9, 3.8707782417084284`*^9}, {
   3.87077827571611*^9, 3.8707782800746408`*^9}, {3.8707783126784286`*^9, 
   3.8707783432857957`*^9}, {3.8707784399438887`*^9, 3.870778460610714*^9}, {
   3.870778504975315*^9, 3.8707785180975924`*^9}, {3.8707792163966913`*^9, 
   3.8707792785303073`*^9}, {3.870779352320467*^9, 3.870779383424775*^9}, {
   3.870779665378265*^9, 3.8707798513386993`*^9}, {3.8707798892381964`*^9, 
   3.870779954133399*^9}, {3.8707800015438275`*^9, 3.8707800026216745`*^9}, {
   3.870780066669222*^9, 3.870780070205654*^9}, {3.87078010708764*^9, 
   3.870780111524453*^9}, {3.870780218676334*^9, 3.8707803041243787`*^9}, 
   3.8707803384288335`*^9, {3.870780455575138*^9, 3.8707804689626055`*^9}, {
   3.8707805027398415`*^9, 3.870780536722166*^9}, 3.870780577634493*^9, {
   3.8707806174688797`*^9, 3.8707806463058844`*^9}, {3.8707806771580067`*^9, 
   3.8707807492676716`*^9}, {3.870780811493569*^9, 3.8707808119934545`*^9}, {
   3.8707808451332245`*^9, 3.870780957991088*^9}, {3.870781103929324*^9, 
   3.8707811601644754`*^9}, {3.871702686692773*^9, 3.8717026980837965`*^9}, {
   3.8717028541335487`*^9, 3.87170285435492*^9}, {3.87188983939585*^9, 
   3.871889981178873*^9}, {3.8718900469881735`*^9, 3.8718900538027368`*^9}, {
   3.87189011808248*^9, 3.8718901559209213`*^9}, {3.871890186152749*^9, 
   3.8718902157010326`*^9}, {3.871890246407813*^9, 3.8718903385755825`*^9}, {
   3.871890371532744*^9, 3.87189042487824*^9}, {3.871890489401913*^9, 
   3.8718904970197935`*^9}, {3.871890593953652*^9, 3.8718907085642347`*^9}, {
   3.8718910208905163`*^9, 3.871891034312228*^9}, 3.8718910910320573`*^9, {
   3.8718911400549383`*^9, 3.871891241432935*^9}, {3.8718919680440784`*^9, 
   3.8718920175830507`*^9}, {3.8718922549600797`*^9, 3.8718922887840204`*^9}, 
   3.8718924864066453`*^9, 3.871892594435005*^9, 3.871892784354626*^9, {
   3.8719020690809355`*^9, 3.8719020910827074`*^9}, 3.871902168861684*^9, 
   3.8719022326151295`*^9, {3.8719022692069674`*^9, 3.871902528166887*^9}, {
   3.871902771593007*^9, 3.8719027749396224`*^9}, {3.8719028524503403`*^9, 
   3.87190285713874*^9}, {3.871902897648734*^9, 3.8719029024860296`*^9}, {
   3.8719030902690787`*^9, 3.8719030919042797`*^9}, {3.871903124245538*^9, 
   3.8719032164082494`*^9}, {3.871903248332734*^9, 3.8719032488047285`*^9}, 
   3.871903288386325*^9, {3.871903422414344*^9, 3.871903432763877*^9}, {
   3.87190363947515*^9, 3.871903668312849*^9}, {3.871903698694239*^9, 
   3.871903704704777*^9}, {3.8719037367360373`*^9, 3.871903930704871*^9}, {
   3.8719040633759975`*^9, 3.871904116274131*^9}, {3.871904165643697*^9, 
   3.8719041662815943`*^9}, {3.8719049710376883`*^9, 
   3.8719049795659466`*^9}, {3.871905031324972*^9, 3.871905043970645*^9}, {
   3.871905090428382*^9, 3.8719051774557147`*^9}, {3.871905245717371*^9, 
   3.871905269741889*^9}, {3.8719053665766935`*^9, 3.8719053882368517`*^9}, {
   3.871905431175785*^9, 3.871905460520578*^9}, {3.8719054921243825`*^9, 
   3.87190549911416*^9}, 3.871905652115905*^9, {3.8719056881351814`*^9, 
   3.8719056994158487`*^9}, {3.871905755520421*^9, 3.871905814209324*^9}, {
   3.871906830088071*^9, 3.871906902122342*^9}, {3.8719070529474754`*^9, 
   3.8719070601193705`*^9}, {3.8719071213348675`*^9, 
   3.8719071331656036`*^9}, {3.8719073454263353`*^9, 
   3.8719073553734674`*^9}, {3.8719074299430623`*^9, 3.871907485806511*^9}, {
   3.871907544294566*^9, 3.871907556540681*^9}, {3.871907591199269*^9, 
   3.8719076038414106`*^9}, {3.8719076842273006`*^9, 
   3.8719077118570213`*^9}, {3.8719081201255817`*^9, 3.8719083402381344`*^9}, 
   3.871908390284568*^9, {3.871976385975218*^9, 3.8719764266786165`*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"a4d8a1bc-875c-4d47-ad94-9f8b2ad81bca"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"addNextDisk", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "res", ",", "next", ",", "path", ",", "n", ",", "g", ",", "timing"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"runForNextDisk", " ", "=", " ", "run"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"timing", ",", "res"}], "}"}], "=", " ", 
        RowBox[{"Timing", "[", 
         RowBox[{"timeCheck", "@", 
          RowBox[{"findNextNormalizedDisk", "[", "run", "]"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"n", "=", " ", 
        RowBox[{"nextDiskNumber", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentTimePerDisk\>\"", "]"}], "=", " ", 
        "timing"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], ",", 
          RowBox[{"n", "->", 
           RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], ",", "n"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", ",", 
          RowBox[{
           RowBox[{"diskX", "[", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "res"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"checkDiskPair", "[", 
        RowBox[{"res", ",", "n"}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}], "=", 
        RowBox[{"updateContactGraph", "[", 
         RowBox[{"res", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentChainGraph\>\"", "]"}], " ", "=", " ", 
        RowBox[{"subgraphPreservingCoordinates", "[", 
         RowBox[{
          RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}], ",", 
          RowBox[{"leftAndRightNumbers", "@", 
           RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"timeStop", "[", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.861684567380087*^9, {3.861685253020944*^9, 
   3.8616853458383093`*^9}, {3.861685457877714*^9, 3.861685524343441*^9}, {
   3.861685566060768*^9, 3.8616856175873985`*^9}, 3.8616857932526894`*^9, {
   3.861685829506477*^9, 3.8616858299597845`*^9}, {3.861688603446192*^9, 
   3.861688615129272*^9}, {3.86169034328926*^9, 3.8616903641702642`*^9}, {
   3.8616906028614054`*^9, 3.861690613889862*^9}, {3.8616906847476935`*^9, 
   3.8616906922771196`*^9}, 3.861690764753615*^9, {3.861772170133756*^9, 
   3.8617722079492044`*^9}, {3.8617722871804495`*^9, 3.86177231837619*^9}, 
   3.861772380747596*^9, 3.861772972599372*^9, {3.8617730788870215`*^9, 
   3.861773116019061*^9}, {3.861773236570961*^9, 3.861773237133318*^9}, 
   3.8617733085850763`*^9, {3.8618544290335045`*^9, 3.8618544339073277`*^9}, {
   3.8618545247340236`*^9, 3.8618545691624084`*^9}, 3.8618546263267117`*^9, {
   3.8618547123451824`*^9, 3.8618547198592353`*^9}, {3.861854927478796*^9, 
   3.86185495453036*^9}, {3.8618549923765907`*^9, 3.8618550751680417`*^9}, {
   3.8618552098386374`*^9, 3.861855210136306*^9}, {3.8618554045898485`*^9, 
   3.861855475183138*^9}, {3.8618563608325615`*^9, 3.8618564345676575`*^9}, {
   3.8618565114209447`*^9, 3.861856512327812*^9}, {3.8618566113717766`*^9, 
   3.861856611527938*^9}, {3.8618568248134055`*^9, 3.8618568368332787`*^9}, {
   3.861856924970784*^9, 3.8618570384314375`*^9}, {3.8618571729812574`*^9, 
   3.861857351538889*^9}, {3.861857480053604*^9, 3.8618575189173813`*^9}, {
   3.8618575508223395`*^9, 3.8618575787857976`*^9}, {3.861857610256908*^9, 
   3.861857623584346*^9}, {3.8618576564143443`*^9, 3.8618576566173725`*^9}, {
   3.8618576875291414`*^9, 3.861857783072259*^9}, 3.8618597252801557`*^9, {
   3.861870578647255*^9, 3.8618706222833543`*^9}, {3.866519105220563*^9, 
   3.866519107290676*^9}, {3.866520251927141*^9, 3.866520294522225*^9}, {
   3.8665208744296412`*^9, 3.866520882039946*^9}, {3.8665236376713457`*^9, 
   3.8665236926548643`*^9}, {3.866523795187729*^9, 3.866523864806645*^9}, {
   3.866524003523258*^9, 3.866524046268936*^9}, {3.8665241384125104`*^9, 
   3.8665241647643795`*^9}, {3.8665241975357885`*^9, 3.86652423776758*^9}, {
   3.8665243261190443`*^9, 3.8665244274195013`*^9}, {3.866524497782097*^9, 
   3.866524501816389*^9}, {3.86652456710385*^9, 3.866524584682516*^9}, {
   3.866524623366629*^9, 3.8665246407137637`*^9}, 3.8665247552838326`*^9, {
   3.866524880403557*^9, 3.8665248834179616`*^9}, {3.866524927110199*^9, 
   3.866524932478689*^9}, 3.866524977776678*^9, {3.866525324960269*^9, 
   3.8665253756153436`*^9}, {3.8665254615691423`*^9, 
   3.8665255465638466`*^9}, {3.8665312471644554`*^9, 
   3.8665312544075828`*^9}, {3.8665313215564375`*^9, 3.866531371385373*^9}, {
   3.86653140440658*^9, 3.8665314250151*^9}, {3.8665314704650736`*^9, 
   3.8665315810594635`*^9}, {3.8665318696856117`*^9, 
   3.8665318700951877`*^9}, {3.866532013885068*^9, 3.8665320181585035`*^9}, {
   3.866532298934456*^9, 3.866532332171548*^9}, 3.866532793466457*^9, {
   3.8665329123068433`*^9, 3.8665329204361277`*^9}, 3.866532980490587*^9, {
   3.8665330498400264`*^9, 3.866533054907532*^9}, {3.866533116748412*^9, 
   3.8665331410862885`*^9}, {3.8665333701434574`*^9, 3.866533418827178*^9}, {
   3.86653508612512*^9, 3.8665351023375535`*^9}, 3.8665351516226263`*^9, {
   3.866535617193274*^9, 3.8665356401868443`*^9}, {3.866535707759061*^9, 
   3.8665357257851076`*^9}, {3.866537984625264*^9, 3.86653799821967*^9}, {
   3.8666124178653955`*^9, 3.8666124609208746`*^9}, {3.8697333575631237`*^9, 
   3.8697333658130517`*^9}, {3.86973383675366*^9, 3.8697338590775986`*^9}, 
   3.8697339769295583`*^9, {3.8697349085558467`*^9, 3.8697349412639384`*^9}, {
   3.8697349815885625`*^9, 3.869734988785375*^9}, {3.86973510972943*^9, 
   3.869735116190412*^9}, {3.8697369758890934`*^9, 3.869736976772236*^9}, {
   3.869737094742881*^9, 3.869737138286728*^9}, {3.8697374130865746`*^9, 
   3.869737417506748*^9}, 3.86973755338323*^9, {3.8697416353192263`*^9, 
   3.8697416388745885`*^9}, 3.869741715629155*^9, {3.8705251024716253`*^9, 
   3.870525159329245*^9}, {3.8705998757648025`*^9, 3.870599876860015*^9}, 
   3.8706001682085342`*^9, {3.8706900310488777`*^9, 3.870690175101564*^9}, {
   3.8706902518717775`*^9, 3.870690336292557*^9}, {3.870690752583165*^9, 
   3.870690804452223*^9}, 3.8706909645225105`*^9, 3.870693110982233*^9, {
   3.8719033169236317`*^9, 3.8719033359125977`*^9}, {3.8719035470724344`*^9, 
   3.8719035540621214`*^9}, 3.8719039722514353`*^9, {3.8719040082026834`*^9, 
   3.871904013390169*^9}, 3.8719041416299076`*^9, {3.8719046320960035`*^9, 
   3.871904641436033*^9}, {3.8719053085591555`*^9, 3.871905313754899*^9}, {
   3.8719055182776628`*^9, 3.8719055419320607`*^9}, {3.8719057032334595`*^9, 
   3.871905713231981*^9}, {3.87190575212346*^9, 3.8719057872334194`*^9}, {
   3.8719064568773975`*^9, 3.8719064813483458`*^9}, {3.8719069130668817`*^9, 
   3.871906938048805*^9}, {3.871908719436571*^9, 3.8719087400953894`*^9}, {
   3.871908873535022*^9, 3.8719088986786585`*^9}, {3.871909048948781*^9, 
   3.8719090549399347`*^9}, {3.8719519552494664`*^9, 3.871951955735366*^9}, {
   3.8719763236484823`*^9, 3.8719763438906775`*^9}, {3.87240040265844*^9, 
   3.872400432995657*^9}, 3.872400477970075*^9, {3.87240076195885*^9, 
   3.8724007722312145`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"513aff78-73d8-4540-b0a3-eb2e825bb45a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateContactGraph", "[", 
    RowBox[{"res_", ",", "n_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "g", ",", "n1", ",", "n2", ",", "d", ",", "d1", ",", "d2", ",", 
       "d1Left"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1", ",", "n2"}], "}"}], "=", " ", 
       RowBox[{"res", "[", "\"\<NextDiskRestsOn\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"addAnnotationsToGraph", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", "d1", ",", "d2"}], "}"}], " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"getDisk", "[", 
             RowBox[{"n", ",", "res"}], "]"}], ",", 
            RowBox[{"getDisk", "[", 
             RowBox[{"n1", ",", "res"}], "]"}], ",", 
            RowBox[{"getDisk", "[", 
             RowBox[{"n2", ",", "res"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"g", " ", "=", " ", 
          RowBox[{"vertexAddWithCoordinates", "[", 
           RowBox[{"g", ",", "n", ",", 
            RowBox[{"diskXZ", "[", "d", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"g", " ", "=", " ", 
          RowBox[{"vertexAddWithCoordinates", "[", 
           RowBox[{"g", ",", "n1", ",", 
            RowBox[{"diskXZ", "[", "d1", "]"}]}], "]"}]}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{"surely", " ", "not", " ", "needed"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"g", " ", "=", " ", 
          RowBox[{"vertexAddWithCoordinates", "[", 
           RowBox[{"g", ",", "n2", ",", 
            RowBox[{"diskXZ", "[", "d2", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"g", "=", " ", 
          RowBox[{"EdgeAdd", "[", 
           RowBox[{"g", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n1", " ", "\[UndirectedEdge]", " ", "n"}], ",", 
              RowBox[{"n", " ", "\[UndirectedEdge]", " ", "n2"}]}], " ", 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"g", " ", "=", " ", 
          RowBox[{"Graph", "[", 
           RowBox[{"g", ",", 
            RowBox[{"AnnotationRules", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"n1", " ", "\[UndirectedEdge]", " ", "n"}], "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"EdgeStyle", "\[Rule]", " ", "Red"}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"n", " ", "\[UndirectedEdge]", " ", "n2"}], " ", "->", 
                RowBox[{"{", " ", 
                 RowBox[{"EdgeStyle", "->", "Blue"}], "}"}]}]}], "}"}]}]}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", " ", "=", " ", 
          RowBox[{"VertexAdd", "[", 
           RowBox[{"g", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"g", "=", " ", 
          RowBox[{"EdgeAdd", "[", 
           RowBox[{"g", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n1", " ", "\[UndirectedEdge]", " ", "n"}], ",", 
              RowBox[{"n", " ", "\[UndirectedEdge]", " ", "n2"}]}], " ", 
             "}"}]}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "g"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.870690850000827*^9, 3.870690910810564*^9}, {
   3.8707724878615847`*^9, 3.8707725737235975`*^9}, {3.87077270032854*^9, 
   3.870772797429328*^9}, {3.8707728438579855`*^9, 3.870773269106784*^9}, {
   3.870774640812944*^9, 3.8707746530470386`*^9}, {3.8707767929350243`*^9, 
   3.8707768181635485`*^9}, {3.8707771795542393`*^9, 3.870777180163258*^9}, {
   3.8707772610882177`*^9, 3.8707772832080517`*^9}, {3.8719508434411983`*^9, 
   3.8719508474305315`*^9}, {3.871950912039645*^9, 3.8719509208449764`*^9}, {
   3.87195117935925*^9, 3.871951182147027*^9}, 3.8719514003612723`*^9, {
   3.871951450167694*^9, 3.871951464547039*^9}, {3.8719515815963993`*^9, 
   3.87195160123932*^9}, {3.871951786623267*^9, 3.8719517872430353`*^9}, 
   3.8719519451758404`*^9, {3.871952009811678*^9, 3.871952107541315*^9}, {
   3.8719521567958517`*^9, 3.8719522012919064`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"7b6e07ad-c2cf-4ede-864a-e066b48066f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkDiskPair", "[", 
   RowBox[{"run_", ",", "n_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d", ",", "n1", ",", "n2", ",", "d1", ",", "d2"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n1", ",", "n2"}], "}"}], "=", " ", 
      RowBox[{"run", "[", "\"\<NextDiskRestsOn\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "d1", ",", "d2"}], "}"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"getDisk", "[", 
         RowBox[{"n", ",", "run"}], "]"}], ",", 
        RowBox[{"getDisk", "[", 
         RowBox[{"n1", ",", "run"}], "]"}], ",", 
        RowBox[{"getDisk", "[", 
         RowBox[{"n2", ",", "run"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"diskX", "[", "d2", "]"}], "<", " ", 
        RowBox[{"diskX", "[", "d", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<Both disks on left\>\"", "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"diskX", "[", "d1", "]"}], ">", " ", 
        RowBox[{"diskX", "[", "d", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Both disks \>\"", ",", "n1", ",", "\"\< \>\"", ",", " ", "n2", 
          ",", "\"\< on right in chain adding: \>\"", ",", "n", ",", " ", 
          "\"\<  in chain \>\"", ",", " ", 
          RowBox[{
           RowBox[{"nextChainNumber", "[", "run", "]"}], "-", "1"}], ",", 
          "run"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"bugReportRun", "=", " ", "run"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "assumes", " ", "n1", " ", "n2", " ", "provided", " ", "in", " ", "x"}], 
     "-", "order"}], " ", "*)"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.871951089108676*^9, 3.8719511477291613`*^9}, {
  3.871951511077938*^9, 3.871951522298233*^9}, {3.871951630214363*^9, 
  3.8719516559939103`*^9}, {3.871951715858798*^9, 3.8719517170933895`*^9}, {
  3.871951772612178*^9, 3.8719517794153194`*^9}, {3.871951820472211*^9, 
  3.8719518384751463`*^9}, {3.8720647064975247`*^9, 3.87206471510629*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"f2039743-db9d-4f7f-b141-a26391233b17"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vertexAddWithCoordinates", "[", 
    RowBox[{"g_", ",", "v_", ",", "vxy_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"vc", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"VertexList", "[", "g", "]"}], ",", "v"}], "]"}], ",", 
        RowBox[{"Return", "[", "g", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"VertexAdd", "[", 
        RowBox[{"g", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"vc", " ", "=", " ", 
       RowBox[{"AnnotationValue", "[", 
        RowBox[{"g", ",", "VertexCoordinates"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vc", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"vc", ",", "vxy"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Annotate", "[", 
        RowBox[{"res", ",", 
         RowBox[{"VertexCoordinates", "->", "vc"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"subgraphPreservingCoordinates", "[", 
    RowBox[{"g_", ",", "vList_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"Subgraph", "[", 
       RowBox[{"g", ",", "vList"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.869737144756712*^9, 3.869737175231513*^9}, {
  3.869741492443333*^9, 3.8697415495166736`*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"a9cf26b1-be1e-4622-b662-546cfd655b8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"findNextNormalizedDisk", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", " ", 
       RowBox[{"findNextDisk", "[", "run", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"diskIsLeft", "[", 
         RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "=", 
          RowBox[{"moveDiskRight", "[", 
           RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", "[", "\"\<NextDiskRestsOn\>\"", "]"}], "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"moveNumberRight", ",", 
            RowBox[{"res", "[", "\"\<NextDiskRestsOn\>\"", "]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"diskIsRight", "[", 
         RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "=", 
          RowBox[{"moveDiskLeft", "[", 
           RowBox[{"res", "[", "\"\<NextDisk\>\"", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", "[", "\"\<NextDiskRestsOn\>\"", "]"}], "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"moveNumberLeft", ",", 
            RowBox[{"res", "[", "\"\<NextDiskRestsOn\>\"", "]"}]}], 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.861684567380087*^9, {3.861685253020944*^9, 
   3.8616853458383093`*^9}, {3.861685457877714*^9, 3.861685524343441*^9}, {
   3.861685566060768*^9, 3.8616856175873985`*^9}, 3.8616857932526894`*^9, {
   3.861685829506477*^9, 3.8616858299597845`*^9}, {3.861688603446192*^9, 
   3.861688615129272*^9}, {3.86169034328926*^9, 3.8616903641702642`*^9}, {
   3.8616906028614054`*^9, 3.861690613889862*^9}, {3.8616906847476935`*^9, 
   3.8616906922771196`*^9}, 3.861690764753615*^9, {3.861772170133756*^9, 
   3.8617722079492044`*^9}, {3.8617722871804495`*^9, 3.86177231837619*^9}, 
   3.861772380747596*^9, 3.861772972599372*^9, {3.8617730788870215`*^9, 
   3.861773116019061*^9}, {3.861773236570961*^9, 3.861773237133318*^9}, 
   3.8617733085850763`*^9, {3.8618544290335045`*^9, 3.8618544339073277`*^9}, {
   3.8618545247340236`*^9, 3.8618545691624084`*^9}, 3.8618546263267117`*^9, {
   3.8618547123451824`*^9, 3.8618547198592353`*^9}, {3.861854927478796*^9, 
   3.86185495453036*^9}, {3.8618549923765907`*^9, 3.8618550751680417`*^9}, {
   3.8618552098386374`*^9, 3.861855210136306*^9}, {3.8618554045898485`*^9, 
   3.861855475183138*^9}, {3.8618563608325615`*^9, 3.8618564345676575`*^9}, {
   3.8618565114209447`*^9, 3.861856512327812*^9}, {3.8618566113717766`*^9, 
   3.861856611527938*^9}, {3.8618568248134055`*^9, 3.8618568368332787`*^9}, {
   3.861856924970784*^9, 3.8618570384314375`*^9}, {3.8618571729812574`*^9, 
   3.861857351538889*^9}, {3.861857480053604*^9, 3.8618575189173813`*^9}, {
   3.8618575508223395`*^9, 3.8618575787857976`*^9}, {3.861857610256908*^9, 
   3.861857623584346*^9}, {3.8618576564143443`*^9, 3.8618576566173725`*^9}, {
   3.8618576875291414`*^9, 3.861857783072259*^9}, 3.8618597252801557`*^9, {
   3.861870578647255*^9, 3.8618706222833543`*^9}, {3.866519105220563*^9, 
   3.866519107290676*^9}, {3.866520251927141*^9, 3.866520294522225*^9}, {
   3.8665208744296412`*^9, 3.866520882039946*^9}, {3.8665236376713457`*^9, 
   3.8665236926548643`*^9}, {3.866523795187729*^9, 3.866523864806645*^9}, {
   3.866524003523258*^9, 3.866524046268936*^9}, {3.8665241384125104`*^9, 
   3.8665241647643795`*^9}, {3.8665241975357885`*^9, 3.86652423776758*^9}, {
   3.8665243261190443`*^9, 3.8665244274195013`*^9}, {3.866524497782097*^9, 
   3.866524501816389*^9}, {3.86652456710385*^9, 3.866524584682516*^9}, {
   3.866524623366629*^9, 3.8665246407137637`*^9}, 3.8665247552838326`*^9, {
   3.866524880403557*^9, 3.8665248834179616`*^9}, {3.866524927110199*^9, 
   3.866524932478689*^9}, 3.866524977776678*^9, {3.866525324960269*^9, 
   3.8665253756153436`*^9}, {3.8665254615691423`*^9, 
   3.8665255465638466`*^9}, {3.8665312471644554`*^9, 
   3.8665312544075828`*^9}, {3.8665313215564375`*^9, 3.866531371385373*^9}, {
   3.86653140440658*^9, 3.8665314250151*^9}, {3.8665314704650736`*^9, 
   3.8665315810594635`*^9}, {3.8665318696856117`*^9, 
   3.8665318700951877`*^9}, {3.866532013885068*^9, 3.8665320181585035`*^9}, {
   3.866532298934456*^9, 3.866532332171548*^9}, 3.866532793466457*^9, {
   3.8665329123068433`*^9, 3.8665329204361277`*^9}, 3.866532980490587*^9, {
   3.8665330498400264`*^9, 3.866533054907532*^9}, {3.866533116748412*^9, 
   3.8665331410862885`*^9}, {3.8665333701434574`*^9, 3.866533418827178*^9}, {
   3.86653508612512*^9, 3.8665351023375535`*^9}, 3.8665351516226263`*^9, {
   3.866535617193274*^9, 3.8665356401868443`*^9}, {3.866535707759061*^9, 
   3.8665357257851076`*^9}, {3.866537984625264*^9, 3.86653799821967*^9}, {
   3.8666124178653955`*^9, 3.8666124609208746`*^9}, {3.8697333575631237`*^9, 
   3.8697333658130517`*^9}, 3.86973383675366*^9, {3.8697428566499977`*^9, 
   3.8697428664626427`*^9}, 3.8697979783483944`*^9, {3.869823824076408*^9, 
   3.869823897817015*^9}, {3.8698239351161127`*^9, 3.8698239507666297`*^9}, 
   3.869824060834675*^9, {3.869824143416043*^9, 3.8698241650567865`*^9}, {
   3.869891550994026*^9, 3.869891556307846*^9}, {3.8699226857014914`*^9, 
   3.869922691201561*^9}, {3.8704142305169983`*^9, 3.870414236364176*^9}, {
   3.87041427549467*^9, 3.8704143480771894`*^9}, 3.8704148725337625`*^9, {
   3.8704153297898526`*^9, 3.8704153332376103`*^9}, {3.8704154130955524`*^9, 
   3.870415462090645*^9}, 3.870415529941433*^9, {3.8704155919508924`*^9, 
   3.8704158454779778`*^9}, {3.8704160445105057`*^9, 
   3.8704160663757715`*^9}, {3.8704161209149733`*^9, 3.870416395361977*^9}, {
   3.87041645462037*^9, 3.8704164570148706`*^9}, 3.870417885402197*^9, {
   3.870418080658276*^9, 3.870418116840454*^9}, {3.8705217272430515`*^9, 
   3.8705217661482506`*^9}, {3.8705218040996084`*^9, 
   3.8705218062620974`*^9}, {3.8705218646106873`*^9, 3.870521872821912*^9}, {
   3.870521959330102*^9, 3.870521960031231*^9}, {3.8705231720281963`*^9, 
   3.870523173872707*^9}, 3.870600143150921*^9, {3.870600380815623*^9, 
   3.870600388751789*^9}, 3.8706007494442406`*^9, 3.870690216373376*^9, {
   3.8706907129401245`*^9, 3.8706907252083263`*^9}, {3.870690910826184*^9, 
   3.870690910841803*^9}, {3.870690964530489*^9, 3.8706909645628915`*^9}, {
   3.8706919383961124`*^9, 3.870691944266342*^9}, {3.870691980426237*^9, 
   3.8706920698905354`*^9}, {3.870692100489912*^9, 3.8706921384315434`*^9}, {
   3.8706921966216345`*^9, 3.870692257743017*^9}, {3.870692350730891*^9, 
   3.8706923760142584`*^9}, {3.8706924173671293`*^9, 
   3.8706924187534842`*^9}, {3.8706925751223383`*^9, 
   3.8706925762480946`*^9}, {3.870692620196228*^9, 3.8706926391662245`*^9}, {
   3.870692685450226*^9, 3.870692866461268*^9}, {3.8706929300952806`*^9, 
   3.870692939645688*^9}, {3.870693008403079*^9, 3.870693047811989*^9}, {
   3.870693120934204*^9, 3.870693160487589*^9}, {3.870693190839684*^9, 
   3.870693237839079*^9}, 3.8706932973793354`*^9, {3.870693343553604*^9, 
   3.8706934973270483`*^9}, {3.8706935296062813`*^9, 3.870693530043091*^9}, {
   3.8706935719095755`*^9, 3.8706936154866233`*^9}, {3.870693683351451*^9, 
   3.870693690582508*^9}, 3.870693744346345*^9, {3.8706937809879913`*^9, 
   3.8706938268293552`*^9}, {3.8706939464446526`*^9, 
   3.8706940687035513`*^9}, {3.8706941434065456`*^9, 3.870694245223572*^9}, {
   3.8706942794562073`*^9, 3.870694287171955*^9}, {3.870694320138788*^9, 
   3.870694349796641*^9}, 3.8706947563624363`*^9, {3.870777809495863*^9, 
   3.870777842526822*^9}, {3.87077793713608*^9, 3.870777938307744*^9}, {
   3.8707779749545994`*^9, 3.8707779766260767`*^9}, {3.870778081214616*^9, 
   3.870778088973708*^9}, {3.870778171552161*^9, 3.8707782417084284`*^9}, {
   3.87077827571611*^9, 3.8707782800746408`*^9}, {3.8707783126784286`*^9, 
   3.8707783432857957`*^9}, {3.8707784399438887`*^9, 3.870778460610714*^9}, {
   3.870778504975315*^9, 3.8707785180975924`*^9}, {3.8707792163966913`*^9, 
   3.8707792785303073`*^9}, {3.870779352320467*^9, 3.870779383424775*^9}, {
   3.870779665378265*^9, 3.8707798513386993`*^9}, {3.8707798892381964`*^9, 
   3.870779954133399*^9}, {3.8707800015438275`*^9, 3.8707800026216745`*^9}, {
   3.870780066669222*^9, 3.870780070205654*^9}, {3.87078010708764*^9, 
   3.870780111524453*^9}, {3.870780218676334*^9, 3.8707803041243787`*^9}, 
   3.8707803384288335`*^9, {3.870780455575138*^9, 3.8707804689626055`*^9}, {
   3.8707805027398415`*^9, 3.870780536722166*^9}, 3.870780577634493*^9, {
   3.8707806174688797`*^9, 3.8707806463058844`*^9}, {3.8707806771580067`*^9, 
   3.8707807492676716`*^9}, {3.870780811493569*^9, 3.8707808119934545`*^9}, {
   3.8707808451332245`*^9, 3.870780957991088*^9}, {3.870781103929324*^9, 
   3.8707811601644754`*^9}, {3.871702686692773*^9, 3.8717026980837965`*^9}, {
   3.8717028541335487`*^9, 3.87170285435492*^9}, {3.87188983939585*^9, 
   3.871889981178873*^9}, {3.8718900469881735`*^9, 3.8718900538027368`*^9}, {
   3.87189011808248*^9, 3.8718901559209213`*^9}, {3.871890186152749*^9, 
   3.8718902157010326`*^9}, {3.871890246407813*^9, 3.8718903385755825`*^9}, {
   3.871890371532744*^9, 3.87189042487824*^9}, {3.871890489401913*^9, 
   3.8718904970197935`*^9}, {3.871890593953652*^9, 3.8718907085642347`*^9}, {
   3.8718910208905163`*^9, 3.871891034312228*^9}, 3.8718910910320573`*^9, {
   3.8718911400549383`*^9, 3.871891241432935*^9}, {3.8718919680440784`*^9, 
   3.8718920175830507`*^9}, {3.8718922549600797`*^9, 3.8718922887840204`*^9}, 
   3.8718924864066453`*^9, 3.871892594435005*^9, 3.871892784354626*^9, {
   3.8719020690809355`*^9, 3.8719020910827074`*^9}, 3.871902168861684*^9, 
   3.8719022326151295`*^9, {3.8719022692069674`*^9, 3.871902528166887*^9}, {
   3.871902771593007*^9, 3.8719027749396224`*^9}, {3.8719028524503403`*^9, 
   3.87190285713874*^9}, {3.871902897648734*^9, 3.8719029024860296`*^9}, {
   3.8719030902690787`*^9, 3.8719030919042797`*^9}, {3.871903124245538*^9, 
   3.8719032164082494`*^9}, {3.871903248332734*^9, 3.8719032488047285`*^9}, 
   3.871903288386325*^9, 3.871903422414344*^9, {3.8719058896710258`*^9, 
   3.871905901480533*^9}, {3.871906115344904*^9, 3.871906121435999*^9}, {
   3.8719067158886213`*^9, 3.8719067233870335`*^9}, {3.871951013356229*^9, 
   3.8719510198589787`*^9}, {3.871951055045294*^9, 3.8719510809742556`*^9}, {
   3.8719511319900317`*^9, 3.8719511663294315`*^9}, 3.8719518818573027`*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"a04cc5cb-f6d3-44cb-948c-5de7b31d7bb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findNextDisk", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "res", ",", "nextR", ",", "locations", ",", "nonIntersectingLocations",
         ",", "nextPair", ",", "nextDisk", ",", "nextDiskZ", ",", 
        "pairsLowerThanDisk"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nextR", "=", " ", 
        RowBox[{"N", "@", 
         RowBox[{"nextRadius", "[", "res", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"debug", " ", "=", " ", 
        RowBox[{
         RowBox[{"nextDiskNumber", "[", "res", "]"}], "==", "13"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"locations", " ", "=", " ", "\[IndentingNewLine]", 
        RowBox[{"Association", "@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", 
             RowBox[{"overlapLocations", "[", 
              RowBox[{"#", ",", "nextR", ",", "res"}], "]"}]}], "&"}], ",", 
           RowBox[{"run", "[", "\"\<CurrentOverlaps\>\"", "]"}]}], "]"}]}]}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"True", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"assumes", " ", "nonincreasing", " ", "r"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tooWidePairs", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"locations", ",", 
             RowBox[{"Missing", "[", "\"\<interdisk too large\>\"", "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"addUsedOverlaps", "[", 
            RowBox[{"res", ",", 
             RowBox[{"Keys", "@", "tooWidePairs"}], ",", "\"\<too wide\>\""}],
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"locations", " ", "=", " ", 
        RowBox[{"DeleteMissing", "[", "locations", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"locations", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"locations", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diskX", "[", "#", "]"}], ">=", 
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"diskX", "[", "#", "]"}], "<=", 
             RowBox[{"1", "/", "2"}]}]}], " ", "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"locations", " ", "=", " ", 
        RowBox[{"SortBy", "[", 
         RowBox[{"locations", ",", "diskZ"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nonIntersectingLocations", " ", "=", "   ", 
        RowBox[{"deleteIntersectingDisks", "[", 
         RowBox[{"res", ",", "locations", ",", "nextR"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nonIntersectingLocations", "]"}], "==", 
          "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Can't find a location\>\"", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dumpRun", " ", "=", " ", "res"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nonIntersectingLocations", "=", " ", 
        RowBox[{"List", "@@", 
         RowBox[{"First", "@", 
          RowBox[{"Normal", "@", "nonIntersectingLocations"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"were", " ", "sorted", " ", "in", " ", "z"}], "-", 
         RowBox[{
         "order", " ", "so", " ", "this", " ", "is", " ", "the", " ", 
          "lowest"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextPair", ",", "nextDisk"}], "}"}], "=", 
        "nonIntersectingLocations"}], ";", "\[IndentingNewLine]", 
       RowBox[{"nextDiskZ", " ", "=", " ", 
        RowBox[{"diskZ", "[", "nextDisk", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"pairsLowerThanDisk", " ", "=", " ", 
        RowBox[{"Keys", "@", 
         RowBox[{"Select", "[", 
          RowBox[{"locations", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"diskZ", "[", "#", "]"}], "<", " ", "nextDiskZ"}], 
            "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"res", ",", 
          RowBox[{"\"\<NextDiskRestsOn\>\"", "->", "nextPair"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"res", ",", 
          RowBox[{"\"\<NextDisk\>\"", "->", "nextDisk"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", "\"\<Arena\>\"", "]"}], "[", 
          "\"\<ExcludePreviousIntersectors\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"res", " ", "=", " ", 
          RowBox[{"addUsedOverlaps", "[", 
           RowBox[{"res", ",", "pairsLowerThanDisk", ",", "\"\<lower\>\""}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"don", "'"}], "t", " ", "try", " ", "this", " ", "pair", " ",
          "again"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"addUsedOverlaps", "[", 
         RowBox[{"res", ",", 
          RowBox[{"{", 
           RowBox[{"nextPair", ",", "\[IndentingNewLine]", 
            RowBox[{"moveNumberLeft", "/@", "nextPair"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"moveNumberRight", "/@", " ", "nextPair"}]}], "}"}], ",", 
          "\"\<pair copies\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "res", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addUsedOverlaps", "[", 
    RowBox[{"run_", ",", "pairs_", ",", 
     RowBox[{"reason_", ":", 
      RowBox[{"Missing", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "=", "run"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "[", "\"\<UsedOverlaps\>\"", "]"}], "=", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<UsedOverlaps\>\"", "]"}], ",", "pairs"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]",
     "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dPrint", "[", "x__", "]"}], " ", ":=", " ", 
    RowBox[{"If", "[", 
     RowBox[{"debug", ",", " ", 
      RowBox[{"Print", "[", "x", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"deleteIntersectingDisks", "[", 
     RowBox[{"run_", ",", "locations_", ",", "nextR_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "extendedDisks", ",", "r2", ",", "locationIntersectsQ", ",", 
        "intersectionLocationNumbers"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extendedDisks", " ", "=", " ", 
        RowBox[{"extendDisksLeftRight", "[", 
         RowBox[{"run", ",", " ", "nextR"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"locationIntersectsQ", "[", "d_", "]"}], " ", ":=", " ", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"diskdiskIntersectionQ", "[", 
            RowBox[{"d", ",", "#"}], "]"}], "&"}], ",", "extendedDisks"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"intersectionLocationNumbers", "[", "d_", "]"}], " ", ":=", 
        " ", 
        RowBox[{"Keys", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"locationIntersectsQ", "[", "d", "]"}], ",", "TrueQ"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"for", " ", "each", " ", "location", " ", "key", " ", 
          RowBox[{"(", 
           RowBox[{"pair", " ", "of", " ", "disk", " ", "numbers"}], ")"}]}], 
         ",", " ", 
         RowBox[{
         "find", " ", "the", " ", "list", " ", "of", " ", "disks", " ", "it", 
          " ", "intersects"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"intersectionLocationNumbers", "[", "#", "]"}], "&"}], ",",
           "locations"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"exclude", " ", "self", " ", "intersections", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"could", " ", "just", " ", "not", " ", "look"}], 
           "..."}]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"Association", "@", 
         RowBox[{"KeyValueMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "->", 
             RowBox[{"Complement", "[", 
              RowBox[{"#2", ",", "#1"}], "]"}]}], "&"}], ",", "r2"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "#", "]"}], "==", "0"}], "&"}], ",", 
          "r2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"r2", ",", "TrueQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r2", " ", "=", " ", 
        RowBox[{"KeyTake", "[", 
         RowBox[{"locations", ",", 
          RowBox[{"Keys", "@", "r2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "r2"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"diskdiskIntersectionQ", "[", 
     RowBox[{
      RowBox[{"Disk", "[", 
       RowBox[{"xy1_", ",", "r1_"}], "]"}], ",", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy2_", ",", "r2_"}], "]"}]}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"Norm", "[", 
      RowBox[{
       RowBox[{"xy1", "-", "xy2"}], ",", "2"}], "]"}], " ", "<", " ", 
     RowBox[{"(", 
      RowBox[{"r1", "+", " ", "r2"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"overlapLocations", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1_", ",", "n2_"}], "}"}], ",", "r_", ",", "run_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "res", ",", "d1", ",", "d2", ",", "xl", ",", "xr", ",", "xres"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d1", " ", "=", " ", 
       RowBox[{"getDisk", "[", 
        RowBox[{"n1", ",", "run"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2", " ", "=", " ", 
       RowBox[{"getDisk", "[", 
        RowBox[{"n2", ",", "run"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"diskdiskUpperTouchingPoint", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d1", ",", "d2"}], "}"}], ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", "res", "]"}], ",", 
        RowBox[{"Return", "[", "res", "]"}]}], "]"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"no", " ", "overlap"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xl", ",", "xr"}], "}"}], "=", " ", 
       RowBox[{"Sort", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"diskX", "[", "d1", "]"}], ",", 
          RowBox[{"diskX", "[", "d2", "]"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xres", " ", "=", " ", 
       RowBox[{"First", "[", "res", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"xres", " ", "<", " ", "xl"}], " ", "||", " ", 
         RowBox[{"xres", " ", ">", " ", "xr"}]}], ",", " ", 
        RowBox[{"Return", "[", 
         RowBox[{"Missing", "[", "\"\<Both disks left or right\>\"", "]"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Disk", "[", 
       RowBox[{"res", ",", "r"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.861684567380087*^9, {3.861685253020944*^9, 
   3.8616853458383093`*^9}, {3.861685457877714*^9, 3.861685524343441*^9}, {
   3.861685566060768*^9, 3.8616856175873985`*^9}, 3.8616857932526894`*^9, {
   3.861685829506477*^9, 3.8616858299597845`*^9}, {3.861688603446192*^9, 
   3.861688615129272*^9}, {3.86169034328926*^9, 3.8616903641702642`*^9}, {
   3.8616906028614054`*^9, 3.861690613889862*^9}, {3.8616906847476935`*^9, 
   3.8616906922771196`*^9}, 3.861690764753615*^9, {3.861772170133756*^9, 
   3.8617722079492044`*^9}, {3.8617722871804495`*^9, 3.86177231837619*^9}, 
   3.861772380747596*^9, 3.861772972599372*^9, {3.8617730788870215`*^9, 
   3.861773116019061*^9}, {3.861773236570961*^9, 3.861773237133318*^9}, 
   3.8617733085850763`*^9, {3.8618544290335045`*^9, 3.8618544339073277`*^9}, {
   3.8618545247340236`*^9, 3.8618545691624084`*^9}, 3.8618546263267117`*^9, {
   3.8618547123451824`*^9, 3.8618547198592353`*^9}, {3.861854927478796*^9, 
   3.86185495453036*^9}, {3.8618549923765907`*^9, 3.8618550751680417`*^9}, {
   3.8618552098386374`*^9, 3.861855210136306*^9}, {3.8618554045898485`*^9, 
   3.861855475183138*^9}, {3.8618563608325615`*^9, 3.8618564345676575`*^9}, {
   3.8618565114209447`*^9, 3.861856512327812*^9}, {3.8618566113717766`*^9, 
   3.861856611527938*^9}, {3.8618568248134055`*^9, 3.8618568368332787`*^9}, {
   3.861856924970784*^9, 3.8618570384314375`*^9}, {3.8618571729812574`*^9, 
   3.861857351538889*^9}, {3.861857480053604*^9, 3.8618575189173813`*^9}, {
   3.8618575508223395`*^9, 3.8618575787857976`*^9}, {3.861857610256908*^9, 
   3.861857623584346*^9}, {3.8618576564143443`*^9, 3.8618576566173725`*^9}, {
   3.8618576875291414`*^9, 3.861857783072259*^9}, 3.8618597252801557`*^9, {
   3.861870578647255*^9, 3.8618706222833543`*^9}, {3.866519105220563*^9, 
   3.866519107290676*^9}, {3.866520251927141*^9, 3.866520294522225*^9}, {
   3.8665208744296412`*^9, 3.866520882039946*^9}, {3.8665236376713457`*^9, 
   3.8665236926548643`*^9}, {3.866523795187729*^9, 3.866523864806645*^9}, {
   3.866524003523258*^9, 3.866524046268936*^9}, {3.8665241384125104`*^9, 
   3.8665241647643795`*^9}, {3.8665241975357885`*^9, 3.86652423776758*^9}, {
   3.8665243261190443`*^9, 3.8665244274195013`*^9}, {3.866524497782097*^9, 
   3.866524501816389*^9}, {3.86652456710385*^9, 3.866524584682516*^9}, {
   3.866524623366629*^9, 3.8665246407137637`*^9}, 3.8665247552838326`*^9, {
   3.866524880403557*^9, 3.8665248834179616`*^9}, {3.866524927110199*^9, 
   3.866524932478689*^9}, 3.866524977776678*^9, {3.866525324960269*^9, 
   3.8665253756153436`*^9}, {3.8665254615691423`*^9, 
   3.8665255465638466`*^9}, {3.8665312471644554`*^9, 
   3.8665312544075828`*^9}, {3.8665313215564375`*^9, 3.866531371385373*^9}, {
   3.86653140440658*^9, 3.8665314250151*^9}, {3.8665314704650736`*^9, 
   3.8665315810594635`*^9}, {3.8665318696856117`*^9, 
   3.8665318700951877`*^9}, {3.866532013885068*^9, 3.8665320181585035`*^9}, {
   3.866532298934456*^9, 3.866532332171548*^9}, 3.866532793466457*^9, {
   3.8665329123068433`*^9, 3.8665329204361277`*^9}, 3.866532980490587*^9, {
   3.8665330498400264`*^9, 3.866533054907532*^9}, {3.866533116748412*^9, 
   3.8665331410862885`*^9}, {3.8665333701434574`*^9, 3.866533418827178*^9}, {
   3.86653508612512*^9, 3.8665351023375535`*^9}, 3.8665351516226263`*^9, {
   3.866535617193274*^9, 3.8665356401868443`*^9}, {3.866535707759061*^9, 
   3.8665357257851076`*^9}, {3.866537984625264*^9, 3.86653799821967*^9}, {
   3.8666124178653955`*^9, 3.8666124609208746`*^9}, {3.8697333575631237`*^9, 
   3.8697333658130517`*^9}, 3.86973383675366*^9, {3.8697428566499977`*^9, 
   3.8697428664626427`*^9}, 3.8697979783483944`*^9, {3.869823824076408*^9, 
   3.869823897817015*^9}, {3.8698239351161127`*^9, 3.8698239507666297`*^9}, 
   3.869824060834675*^9, {3.869824143416043*^9, 3.8698241650567865`*^9}, {
   3.869891550994026*^9, 3.869891556307846*^9}, {3.8699226857014914`*^9, 
   3.869922691201561*^9}, {3.8704142305169983`*^9, 3.870414236364176*^9}, {
   3.87041427549467*^9, 3.8704143480771894`*^9}, 3.8704148725337625`*^9, {
   3.8704153297898526`*^9, 3.8704153332376103`*^9}, {3.8704154130955524`*^9, 
   3.870415462090645*^9}, 3.870415529941433*^9, {3.8704155919508924`*^9, 
   3.8704158454779778`*^9}, {3.8704160445105057`*^9, 
   3.8704160663757715`*^9}, {3.8704161209149733`*^9, 3.870416395361977*^9}, {
   3.87041645462037*^9, 3.8704164570148706`*^9}, 3.870417885402197*^9, {
   3.870418080658276*^9, 3.870418116840454*^9}, {3.8705217272430515`*^9, 
   3.8705217661482506`*^9}, {3.8705218040996084`*^9, 
   3.8705218062620974`*^9}, {3.8705218646106873`*^9, 3.870521872821912*^9}, {
   3.870521959330102*^9, 3.870521960031231*^9}, {3.8705231720281963`*^9, 
   3.870523173872707*^9}, 3.870600143150921*^9, {3.870600380815623*^9, 
   3.870600388751789*^9}, 3.8706007494442406`*^9, 3.870690216373376*^9, {
   3.8706907129401245`*^9, 3.8706907252083263`*^9}, {3.870690910826184*^9, 
   3.870690910841803*^9}, {3.870690964530489*^9, 3.8706909645628915`*^9}, {
   3.8706919383961124`*^9, 3.870691944266342*^9}, {3.870691980426237*^9, 
   3.8706920698905354`*^9}, {3.870692100489912*^9, 3.8706921384315434`*^9}, {
   3.8706921966216345`*^9, 3.870692257743017*^9}, {3.870692350730891*^9, 
   3.8706923760142584`*^9}, {3.8706924173671293`*^9, 
   3.8706924187534842`*^9}, {3.8706925751223383`*^9, 
   3.8706925762480946`*^9}, {3.870692620196228*^9, 3.8706926391662245`*^9}, {
   3.870692685450226*^9, 3.870692866461268*^9}, {3.8706929300952806`*^9, 
   3.870692939645688*^9}, {3.870693008403079*^9, 3.870693047811989*^9}, {
   3.870693120934204*^9, 3.870693160487589*^9}, {3.870693190839684*^9, 
   3.870693237839079*^9}, 3.8706932973793354`*^9, {3.870693343553604*^9, 
   3.8706934973270483`*^9}, {3.8706935296062813`*^9, 3.870693530043091*^9}, {
   3.8706935719095755`*^9, 3.8706936154866233`*^9}, {3.870693683351451*^9, 
   3.870693690582508*^9}, 3.870693744346345*^9, {3.8706937809879913`*^9, 
   3.8706938268293552`*^9}, {3.8706939464446526`*^9, 
   3.8706940687035513`*^9}, {3.8706941434065456`*^9, 3.870694245223572*^9}, {
   3.8706942794562073`*^9, 3.870694287171955*^9}, {3.870694320138788*^9, 
   3.870694349796641*^9}, 3.8706947563624363`*^9, {3.870777809495863*^9, 
   3.870777842526822*^9}, {3.87077793713608*^9, 3.870777938307744*^9}, {
   3.8707779749545994`*^9, 3.8707779766260767`*^9}, {3.870778081214616*^9, 
   3.870778088973708*^9}, {3.870778171552161*^9, 3.8707782417084284`*^9}, {
   3.87077827571611*^9, 3.8707782800746408`*^9}, {3.8707783126784286`*^9, 
   3.8707783432857957`*^9}, {3.8707784399438887`*^9, 3.870778460610714*^9}, {
   3.870778504975315*^9, 3.8707785180975924`*^9}, {3.8707792163966913`*^9, 
   3.8707792785303073`*^9}, {3.870779352320467*^9, 3.870779383424775*^9}, {
   3.870779665378265*^9, 3.8707798513386993`*^9}, {3.8707798892381964`*^9, 
   3.870779954133399*^9}, {3.8707800015438275`*^9, 3.8707800026216745`*^9}, {
   3.870780066669222*^9, 3.870780070205654*^9}, {3.87078010708764*^9, 
   3.870780111524453*^9}, {3.870780218676334*^9, 3.8707803041243787`*^9}, 
   3.8707803384288335`*^9, {3.870780455575138*^9, 3.8707804689626055`*^9}, {
   3.8707805027398415`*^9, 3.870780536722166*^9}, 3.870780577634493*^9, {
   3.8707806174688797`*^9, 3.8707806463058844`*^9}, {3.8707806771580067`*^9, 
   3.8707807492676716`*^9}, {3.870780811493569*^9, 3.8707808119934545`*^9}, {
   3.8707808451332245`*^9, 3.870780957991088*^9}, {3.870781103929324*^9, 
   3.8707811601644754`*^9}, {3.871702686692773*^9, 3.8717026980837965`*^9}, {
   3.8717028541335487`*^9, 3.87170285435492*^9}, {3.87188983939585*^9, 
   3.871889981178873*^9}, {3.8718900469881735`*^9, 3.8718900538027368`*^9}, {
   3.87189011808248*^9, 3.8718901559209213`*^9}, {3.871890186152749*^9, 
   3.8718902157010326`*^9}, {3.871890246407813*^9, 3.8718903385755825`*^9}, {
   3.871890371532744*^9, 3.87189042487824*^9}, {3.871890489401913*^9, 
   3.8718904970197935`*^9}, {3.871890593953652*^9, 3.8718907085642347`*^9}, {
   3.8718910208905163`*^9, 3.871891034312228*^9}, 3.8718910910320573`*^9, {
   3.8718911400549383`*^9, 3.871891241432935*^9}, {3.8718919680440784`*^9, 
   3.8718920175830507`*^9}, {3.8718922549600797`*^9, 3.8718922887840204`*^9}, 
   3.8718924864066453`*^9, 3.871892594435005*^9, 3.871892784354626*^9, {
   3.8719020690809355`*^9, 3.8719020910827074`*^9}, 3.871902168861684*^9, 
   3.8719022326151295`*^9, {3.8719022692069674`*^9, 3.871902528166887*^9}, {
   3.871902771593007*^9, 3.8719027749396224`*^9}, {3.8719028524503403`*^9, 
   3.87190285713874*^9}, {3.871902897648734*^9, 3.8719029024860296`*^9}, {
   3.8719030902690787`*^9, 3.8719030919042797`*^9}, {3.871903124245538*^9, 
   3.8719032164082494`*^9}, {3.871903248332734*^9, 3.8719032488047285`*^9}, 
   3.871903288386325*^9, {3.871903422414344*^9, 3.8719034243621407`*^9}, {
   3.871906202280119*^9, 3.87190624682097*^9}, {3.871906278043277*^9, 
   3.871906308465008*^9}, {3.8719069696642084`*^9, 3.8719070060153856`*^9}, 
   3.871907309805729*^9, {3.871976355724594*^9, 3.8719763698976903`*^9}, {
   3.87206498662891*^9, 3.8720649990929546`*^9}, {3.8720650359263144`*^9, 
   3.87206505417159*^9}, {3.8720651588953886`*^9, 3.8720651658104825`*^9}, {
   3.872065202609998*^9, 3.87206521320763*^9}, {3.872065243957788*^9, 
   3.872065251432061*^9}, {3.8720654038686867`*^9, 3.8720654472041583`*^9}, {
   3.872065527454914*^9, 3.8720655482863464`*^9}, {3.872065580095414*^9, 
   3.872065766715853*^9}, 3.872066137739314*^9, {3.8724007992094407`*^9, 
   3.872400833266249*^9}, {3.8724008679699554`*^9, 3.87240088597217*^9}, 
   3.8724019170711164`*^9, {3.8724039280608935`*^9, 3.872403938947139*^9}, {
   3.8724039770196404`*^9, 3.872403985121415*^9}, {3.8724040372490206`*^9, 
   3.872404039544938*^9}, {3.872588934219646*^9, 3.872588934501472*^9}, 
   3.8725889668060703`*^9, {3.8725890580435944`*^9, 3.872589068453785*^9}, {
   3.8725898607417126`*^9, 3.872589890462967*^9}, {3.872589950240076*^9, 
   3.8725900836082325`*^9}, {3.8725901359100204`*^9, 3.872590194810912*^9}, {
   3.87259022633529*^9, 3.8725902570080338`*^9}, 3.8725902944101267`*^9, {
   3.872590328595456*^9, 3.8725903937488003`*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"7ab97dfc-16f0-46d4-b3f5-7645f6742ffd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"sssTriangleInteriorAngle", "[", 
     RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tri", ",", "angle"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tri", " ", "=", 
        RowBox[{"SSSTriangle", "[", 
         RowBox[{"a", ",", "b", ",", "c"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Head", "[", "tri", "]"}], "==", "SSSTriangle"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"Missing", "[", "\"\<Not a triangle\>\"", "]"}], "]"}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"angle", " ", "=", " ", 
        RowBox[{"TriangleMeasurement", "[", 
         RowBox[{"tri", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<InteriorAngle\>\"", ",", "1"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "angle"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"newdiskdiskTouchingPoint", "[", 
   RowBox[{"diskPair_", ",", "r_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "c1", ",", "c2", ",", "r1", ",", "r2", ",", "interdisk", ",", 
      "interdiskVectorNorm", ",", "interdiskNormal", ",", 
      "\[IndentingNewLine]", "angle", ",", "vector", ",", "normal", ",", 
      "interdiskVector"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1", ",", "c2"}], "}"}], "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"diskXZ", ",", "diskPair"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "r2"}], "}"}], "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"diskR", ",", "diskPair"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskVector", " ", "=", " ", 
      RowBox[{"c2", "-", "c1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interdisk", " ", "=", " ", 
      RowBox[{"Norm", "[", "interdiskVector", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskVectorNorm", " ", "=", " ", 
      RowBox[{"interdiskVector", "/", 
       RowBox[{"Norm", "[", "interdiskVector", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskNormal", " ", "=", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"interdiskVectorNorm", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"interdiskVectorNorm", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"angle", " ", "=", " ", 
      RowBox[{"sssTriangleInteriorAngle", "[", 
       RowBox[{
        RowBox[{"r2", "+", "r"}], ",", 
        RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vector", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], "*", 
       RowBox[{"Cos", "[", "angle", "]"}], "*", "interdiskVectorNorm"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"normal", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], "*", 
       RowBox[{"Sin", "[", "angle", "]"}], "*", " ", "interdiskNormal"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "+", "vector", "+", "normal"}], ",", 
       RowBox[{"c1", "+", "vector", "-", "normal"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8730833516850986`*^9, 3.873083421006345*^9}, {
  3.873084012228471*^9, 3.8730841618440323`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"852c2853-bfd6-4866-bf92-ccc59ded20a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"for", " ", "some", " ", "ics"}], ",", " ", 
    RowBox[{
     RowBox[{"couldn", "'"}], "t", " ", "guarantee", " ", "the", " ", "lower",
      " ", "one", " ", "is", " ", "discardable"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "but", " ", "should", " ", "be", " ", "provided", " ", "pattern", " ", 
     "is", " ", "a", " ", "dropped", " ", "coin", " ", "one"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskdiskUpperTouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "lrPoints", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lrPoints", "=", " ", 
         RowBox[{"newdiskdiskTouchingPoint", "[", 
          RowBox[{"pairDisks", ",", "r"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "lrPoints", "]"}], ",", 
          RowBox[{"Return", "[", "lrPoints", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Last", "[", 
         RowBox[{"SortBy", "[", 
          RowBox[{"lrPoints", ",", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"diskdiskTouchingPoint", "[", 
       RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "xy1", ",", "xy2", ",", "r1", ",", "r2", ",", "interdisk", ",", 
          "sTriangle", ",", "triangle", "\[IndentingNewLine]", ",", 
          "rTrianglePT", ",", "lTrianglePT", ",", "transform"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xy1", ",", "r1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xy2", ",", "r2"}], "}"}]}], "}"}], "=", " ", 
          RowBox[{"List", "@@@", " ", "pairDisks"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"interdisk", " ", "=", " ", 
          RowBox[{"Norm", "[", 
           RowBox[{"xy1", "-", "xy2"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"interdisk", " ", ">", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"r1", "+", "r"}], ")"}], " ", "+", 
             RowBox[{"(", " ", 
              RowBox[{"r2", " ", "+", " ", "r"}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "\"\<interdisk too large\>\"", "]"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "if", " ", "we", " ", "knew", " ", "r", " ", "was", " ", 
           "decreasing", " ", "could", " ", "filter", " ", "out", " ", "this",
            " ", "disk", " ", "at", " ", "this", " ", "point"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Off", "[", 
          RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sTriangle", " ", "=", 
          RowBox[{"SSSTriangle", "[", 
           RowBox[{
            RowBox[{"r", "+", "r2"}], ",", 
            RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"On", "[", 
          RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "sTriangle", "]"}], "===", "SSSTriangle"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "\"\<not a triangle\>\"", "]"}], "]"}]}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]",
           "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"triangle", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"List", "@", "sTriangle"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"transform", " ", "=", 
          RowBox[{"Composition", "[", 
           RowBox[{
            RowBox[{"TranslationTransform", "[", "xy1", "]"}], ",", 
            RowBox[{"RotationTransform", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"triangle", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", 
                RowBox[{"triangle", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", 
               RowBox[{"xy2", "-", "xy1"}]}], "}"}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rTrianglePT", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"transform", "[", "triangle", "]"}], ")"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"lTrianglePT", " ", "=", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ReflectionTransform", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"RotationTransform", "[", 
                RowBox[{"90", " ", "Degree"}], "]"}], "[", 
               RowBox[{"xy2", "-", "xy1"}], "]"}], ",", "xy1"}], "]"}], ")"}],
            "[", "rTrianglePT", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856890650008703*^9, 3.85689067286756*^9}, {
   3.8568920185899725`*^9, 3.8568920625893984`*^9}, {3.8571152866804256`*^9, 
   3.8571153034394283`*^9}, {3.8571171134824324`*^9, 
   3.8571171413767424`*^9}, {3.8571171853168*^9, 3.8571172283028445`*^9}, 
   3.8571269932151995`*^9, {3.857127151449848*^9, 3.857127168930334*^9}, {
   3.8571273299195204`*^9, 3.8571273327408686`*^9}, {3.8571273879771347`*^9, 
   3.8571274361429415`*^9}, {3.8571274968993864`*^9, 
   3.8571275846370783`*^9}, {3.8571277374939375`*^9, 3.857127777817645*^9}, {
   3.8595520546920843`*^9, 3.8595521077101665`*^9}, {3.866519729650925*^9, 
   3.866519763060012*^9}, {3.8665200021203227`*^9, 3.86652001638052*^9}, {
   3.866520072028064*^9, 3.86652009168478*^9}, {3.8665201824392138`*^9, 
   3.8665202129287567`*^9}, {3.8665206311964407`*^9, 
   3.8665206382302966`*^9}, {3.872942452026597*^9, 3.8729424533077607`*^9}, {
   3.8729425042387223`*^9, 3.8729425616169806`*^9}, {3.872942765725312*^9, 
   3.8729427682637024`*^9}, 3.8729428523247423`*^9, {3.8730265601502943`*^9, 
   3.8730265605723314`*^9}},
 CellLabel->
  "In[880]:=",ExpressionUUID->"f84550c7-7952-4387-a527-80b00981d42e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ddTouchingCompilable", "[", 
     RowBox[{"parameterList_", ",", 
      RowBox[{"useCompiled_", ":", "True"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "rTrianglePT", ",", "lTrianglePT"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"useCompiled", ",", "\[IndentingNewLine]", 
          RowBox[{"ddTouchingCompiled", "[", "parameterList", "]"}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{
          "ddTouchingCompilableRealVectorFunction", "[", "parameterList", 
           "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}], " ", "=", " ", 
        RowBox[{"Partition", "[", 
         RowBox[{"res", ",", "2"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parameterList", "=", 
     RowBox[{"{", 
      RowBox[{
      "0.`", ",", "0.`", ",", "1.`", ",", "0.`", ",", "0.5`", ",", 
       "0.8660254037844386`", ",", "0.`", ",", "0.`", ",", "1.`", ",", 
       "0.`"}], "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"ddTouchingCompilable", "[", 
       RowBox[{"parameterList", ",", "True"}], "]"}], "//", 
      RowBox[{"RepeatedTiming", " ", 
       RowBox[{"(*", 
        RowBox[{" ", 
         RowBox[{"0.001020937890625`", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.5`", ",", "0.8660254037844386`"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0.5`", ",", 
              RowBox[{"-", "0.8660254037844386`"}]}], "}"}]}], "}"}]}], "}"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ddTouchingCompilable", "[", 
        RowBox[{"parameterList", ",", "False"}], "]"}]}]}], "//", 
     "RepeatedTiming"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"{", 
     RowBox[{"0.0009218720703125`", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5`", ",", "0.8660254037844386`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5`", ",", 
          RowBox[{"-", "0.8660254037844386`"}]}], "}"}]}], "}"}]}], "}"}], 
    " ", "*)"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "ddTouchingCompilableRealVectorFunction", "[", "parameterList_", "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "xy1", ",", "xy2", ",", "triangleList", ",", "triangle", ",", 
       "transform", ",", "rTrianglePT", ",", "lTrianglePT", ",", "a", ",", 
       "b", ",", "xy21Rotated"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"triangleList", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"parameterList", ",", "6"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xy1", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"parameterList", ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "8"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xy2", " ", "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{"parameterList", ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "10"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"triangle", "=", " ", 
       RowBox[{"Partition", "[", 
        RowBox[{"triangleList", ",", "2"}], "]"}]}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{"3", " ", "sets", " ", "of", " ", "xy", " ", "points"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"transform", " ", "=", 
       RowBox[{"Composition", "[", 
        RowBox[{
         RowBox[{"TranslationTransform", "[", "xy1", "]"}], ",", 
         RowBox[{"RotationTransform", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"triangle", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"triangle", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"xy2", "-", "xy1"}]}], "}"}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rTrianglePT", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"transform", "[", "triangle", "]"}], ")"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], " ", "=", " ", 
       RowBox[{"xy2", "-", "xy1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xy21Rotated", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "b"}], ",", "a"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lTrianglePT", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ReflectionTransform", "[", 
          RowBox[{"xy21Rotated", ",", "xy1"}], "]"}], ")"}], "[", 
        "rTrianglePT", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Flatten", "@", 
       RowBox[{"{", 
        RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddTouchingCompiled", " ", "=", " ", 
    RowBox[{
    "compileRealVectorFunction", "[", 
     "ddTouchingCompilableRealVectorFunction", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856890650008703*^9, 3.85689067286756*^9}, {
   3.8568920185899725`*^9, 3.8568920625893984`*^9}, {3.8571152866804256`*^9, 
   3.8571153034394283`*^9}, {3.8571171134824324`*^9, 
   3.8571171413767424`*^9}, {3.8571171853168*^9, 3.8571172283028445`*^9}, 
   3.8571269932151995`*^9, {3.857127151449848*^9, 3.857127168930334*^9}, {
   3.8571273299195204`*^9, 3.8571273327408686`*^9}, {3.8571273879771347`*^9, 
   3.8571274361429415`*^9}, {3.8571274968993864`*^9, 
   3.8571275846370783`*^9}, {3.8571277374939375`*^9, 3.857127777817645*^9}, {
   3.8595520546920843`*^9, 3.8595521077101665`*^9}, {3.866519729650925*^9, 
   3.866519763060012*^9}, {3.8665200021203227`*^9, 3.86652001638052*^9}, {
   3.866520072028064*^9, 3.86652009168478*^9}, {3.8665201824392138`*^9, 
   3.8665202129287567`*^9}, {3.8665206311964407`*^9, 
   3.8665206382302966`*^9}, {3.872942452026597*^9, 3.872942496352426*^9}, {
   3.8729425879252415`*^9, 3.872942808086774*^9}, {3.872958346550427*^9, 
   3.872958533289711*^9}, {3.872959334698487*^9, 3.872959545979537*^9}, {
   3.87295958019713*^9, 3.8729596899780655`*^9}, {3.8729597253140535`*^9, 
   3.872959769605405*^9}, {3.8729598008803606`*^9, 3.8729600191404657`*^9}, {
   3.8729600557945814`*^9, 3.872960122317001*^9}, {3.872960332096947*^9, 
   3.872960381462576*^9}, {3.8729604215092044`*^9, 3.8729604402921095`*^9}, 
   3.872960519668038*^9, {3.8730005206775484`*^9, 3.873000524758088*^9}, 
   3.8730008885455*^9, 3.873006559323778*^9, {3.8730066040223083`*^9, 
   3.873006735116179*^9}, {3.8730069865559907`*^9, 3.8730069980208926`*^9}, {
   3.8730070524578533`*^9, 3.873007245168335*^9}, 3.8730073129613075`*^9, {
   3.8730073778562007`*^9, 3.87300738932983*^9}, 3.8730074418079224`*^9, {
   3.8730075025844927`*^9, 3.8730075795285015`*^9}, {3.873012702542139*^9, 
   3.873012717759649*^9}, {3.873012839107319*^9, 3.8730129475475936`*^9}, {
   3.873013133483074*^9, 3.8730131451334047`*^9}, {3.873013210211589*^9, 
   3.8730132388204813`*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"3128a188-5c1c-4d25-8a9b-47c693cc3557"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskdiskTouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xy1", ",", "xy2", ",", "r1", ",", "r2", ",", "interdisk", ",", 
         "sTriangle", ",", "triangle", "\[IndentingNewLine]", ",", "res"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xy1", ",", "r1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xy2", ",", "r2"}], "}"}]}], "}"}], "=", " ", 
         RowBox[{"List", "@@@", " ", "pairDisks"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"interdisk", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"xy1", "-", "xy2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"interdisk", " ", ">", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1", "+", "r"}], ")"}], " ", "+", 
            RowBox[{"(", " ", 
             RowBox[{"r2", " ", "+", " ", "r"}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<interdisk too large\>\"", "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "we", " ", "knew", " ", "r", " ", "was", " ", 
          "decreasing", " ", "could", " ", "filter", " ", "out", " ", "this", 
          " ", "disk", " ", "at", " ", "this", " ", "point"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Off", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sTriangle", " ", "=", 
         RowBox[{"SSSTriangle", "[", 
          RowBox[{
           RowBox[{"r", "+", "r2"}], ",", 
           RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"On", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sTriangle", "]"}], "===", "SSSTriangle"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<not a triangle\>\"", "]"}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"triangle", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@", "sTriangle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"{", 
          RowBox[{"xy1", ",", "xy2", ",", "xy3"}], "}"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"triangleList", "=", " ", 
         RowBox[{"Flatten", "[", "triangle", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"parameterList", "=", " ", 
         RowBox[{"N", "/@", " ", 
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{"triangleList", ",", "xy1", ",", "xy2"}], "}"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", 
         RowBox[{"ddTouchingCompilable", "[", 
          RowBox[{"parameterList", ",", "True"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856890650008703*^9, 3.85689067286756*^9}, {
   3.8568920185899725`*^9, 3.8568920625893984`*^9}, {3.8571152866804256`*^9, 
   3.8571153034394283`*^9}, {3.8571171134824324`*^9, 
   3.8571171413767424`*^9}, {3.8571171853168*^9, 3.8571172283028445`*^9}, 
   3.8571269932151995`*^9, {3.857127151449848*^9, 3.857127168930334*^9}, {
   3.8571273299195204`*^9, 3.8571273327408686`*^9}, {3.8571273879771347`*^9, 
   3.8571274361429415`*^9}, {3.8571274968993864`*^9, 
   3.8571275846370783`*^9}, {3.8571277374939375`*^9, 3.857127777817645*^9}, {
   3.8595520546920843`*^9, 3.8595521077101665`*^9}, {3.866519729650925*^9, 
   3.866519763060012*^9}, {3.8665200021203227`*^9, 3.86652001638052*^9}, {
   3.866520072028064*^9, 3.86652009168478*^9}, {3.8665201824392138`*^9, 
   3.8665202129287567`*^9}, {3.8665206311964407`*^9, 
   3.8665206382302966`*^9}, {3.872942452026597*^9, 3.872942496352426*^9}, {
   3.8729425879252415`*^9, 3.872942808086774*^9}, {3.872958346550427*^9, 
   3.872958533289711*^9}, {3.872959334698487*^9, 3.872959545979537*^9}, {
   3.87295958019713*^9, 3.8729596899780655`*^9}, {3.8729597253140535`*^9, 
   3.872959769605405*^9}, {3.8729598008803606`*^9, 3.8729600191404657`*^9}, {
   3.8729600557945814`*^9, 3.872960122317001*^9}, {3.872960332096947*^9, 
   3.872960381462576*^9}, {3.8729604215092044`*^9, 3.8729604402921095`*^9}, 
   3.872960519668038*^9, {3.8730005206775484`*^9, 3.873000524758088*^9}, 
   3.8730008885455*^9, 3.873006559323778*^9, {3.8730066040223083`*^9, 
   3.873006721943677*^9}, {3.8730067793997498`*^9, 3.873006807085163*^9}, {
   3.873013024254447*^9, 3.8730130821245217`*^9}, {3.873013403366649*^9, 
   3.8730134076110277`*^9}, {3.8730134712727327`*^9, 3.8730134743314857`*^9}},
 CellLabel->
  "In[205]:=",ExpressionUUID->"dbcd4870-d590-4edc-9959-269a0ebe0f96"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"compileRealVectorFunction", "[", "kf_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "f", ",", "arg"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"f", " ", "=", " ", 
        RowBox[{"Function", "[", "\[IndentingNewLine]", " ", 
         RowBox[{
          RowBox[{"Typed", "[", 
           RowBox[{"arg", ",", 
            RowBox[{"\"\<PackedArray\>\"", 
             RowBox[{"::", "["}], 
             RowBox[{"\"\<Real64\>\"", ",", " ", "1"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Typed", "[", 
            RowBox[{
             RowBox[{"KernelFunction", "[", "kf", "]"}], ",", 
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{"\"\<PackedArray\>\"", 
                RowBox[{"::", "["}], 
                RowBox[{"\"\<Real64\>\"", ",", " ", "1"}], "]"}], "}"}], 
              "\[Rule]", " ", 
              RowBox[{"\"\<PackedArray\>\"", 
               RowBox[{"::", "["}], 
               RowBox[{"\"\<Real64\>\"", ",", " ", "1"}], "]"}]}]}], "]"}], 
           "[", "arg", "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"FunctionCompile", "[", "f", "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8730022594765644`*^9, 3.8730023092824416`*^9}, {
   3.873002381549158*^9, 3.8730026614205933`*^9}, {3.873002873605785*^9, 
   3.873002929102605*^9}, {3.8730029722594914`*^9, 3.87300304339202*^9}, {
   3.8730030881930046`*^9, 3.873003284784194*^9}, {3.873003330802623*^9, 
   3.8730034073618865`*^9}, {3.873003526144925*^9, 3.873003561408139*^9}, {
   3.8730035941499033`*^9, 3.8730036419731455`*^9}, {3.8730047107103024`*^9, 
   3.8730047494677486`*^9}, {3.87300482730241*^9, 3.8730048567260275`*^9}, {
   3.8730049384851837`*^9, 3.87300518400764*^9}, {3.8730052147943535`*^9, 
   3.873005245820277*^9}, {3.873005295822999*^9, 3.8730053006601667`*^9}, {
   3.8730053385048914`*^9, 3.8730054506797543`*^9}, {3.8730054825823936`*^9, 
   3.873005503224249*^9}, {3.873005564156555*^9, 3.87300561149039*^9}, {
   3.873005653053917*^9, 3.8730057025571976`*^9}, {3.87300574176147*^9, 
   3.8730058085036783`*^9}, {3.8730058519560547`*^9, 
   3.8730061884569073`*^9}, {3.873006225418749*^9, 3.8730064596190615`*^9}, 
   3.8730065106799335`*^9, {3.8730069211439533`*^9, 3.8730069776775146`*^9}, 
   3.8730073094773192`*^9, {3.8730124449103713`*^9, 3.8730124470166826`*^9}, {
   3.873012619995207*^9, 3.8730126249450307`*^9}},
 CellLabel->
  "In[206]:=",ExpressionUUID->"c6c97b88-1480-46d1-9cb2-3405fa847775"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{951., 524.25},
WindowMargins->{{Automatic, 156}, {Automatic, 66.75}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"14aa494a-606b-44d7-82d1-08e951e26cf7"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 336, 10, 70, "Input",ExpressionUUID->"7d77eaad-7cce-48eb-b198-8dc4dd759adc",
 InitializationCell->True],
Cell[897, 32, 420, 10, 70, "Input",ExpressionUUID->"65d66766-36ea-4adb-931e-70f6c27cd42b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[1342, 46, 159, 3, 74, "Section",ExpressionUUID->"6ab48122-af17-4dcf-b0ec-7c9b2b450180"],
Cell[1504, 51, 16417, 395, 1217, "Input",ExpressionUUID->"c79fdebc-f9ae-4df7-a656-4383f6352b8d",
 InitializationCell->True],
Cell[17924, 448, 6568, 128, 595, "Input",ExpressionUUID->"10f5e5c5-8a50-4c6c-955c-3ca976dfbb0d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[24529, 581, 157, 3, 74, "Section",ExpressionUUID->"77a3141e-802f-42c1-8a57-5eddf8adc775"],
Cell[24689, 586, 6580, 113, 280, "Input",ExpressionUUID->"6dbf7845-f16b-4a34-8ebf-111941a4cda1",
 InitializationCell->True],
Cell[31272, 701, 4767, 105, 573, "Input",ExpressionUUID->"bc32d9cc-1052-4f4b-861f-147ea2f87ce8",
 InitializationCell->True],
Cell[36042, 808, 6334, 96, 175, "Input",ExpressionUUID->"728cb4e0-2952-4aa4-9d9c-cade43159d50",
 InitializationCell->True],
Cell[42379, 906, 9199, 163, 594, "Input",ExpressionUUID->"15e75fbe-967c-44f1-86aa-fa34b59eca50",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[51615, 1074, 164, 3, 74, "Section",ExpressionUUID->"82926184-1112-44a0-be3d-e9cd6ea8da45"],
Cell[51782, 1079, 18880, 449, 1834, "Input",ExpressionUUID->"212d93fc-bb9c-4366-ad03-6e622e848fbe",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[70699, 1533, 162, 3, 74, "Section",ExpressionUUID->"fe596e68-0dda-4801-93e2-f79621326472"],
Cell[70864, 1538, 11230, 204, 1180, "Input",ExpressionUUID->"8b12ee36-315e-467a-93be-2af9a85bf88d",
 InitializationCell->True],
Cell[82097, 1744, 3793, 86, 301, "Input",ExpressionUUID->"74b52111-1d23-4f8e-9305-7dd8994af4ca",
 InitializationCell->True],
Cell[85893, 1832, 6417, 126, 532, "Input",ExpressionUUID->"13d281b0-6a41-489c-b446-b5db095d3c80",
 InitializationCell->True],
Cell[92313, 1960, 6661, 104, 259, "Input",ExpressionUUID->"42f9121c-e31e-4ddf-88fc-a070f493771f",
 InitializationCell->True],
Cell[98977, 2066, 5866, 105, 405, "Input",ExpressionUUID->"0d48f50d-3e32-4b1e-860d-a7823b19968a",
 InitializationCell->True],
Cell[104846, 2173, 4485, 108, 343, "Input",ExpressionUUID->"0a65e49c-b2c5-44c1-beed-0dda6949a9df",
 InitializationCell->True],
Cell[109334, 2283, 17367, 272, 491, "Input",ExpressionUUID->"a4d8a1bc-875c-4d47-ad94-9f8b2ad81bca",
 InitializationCell->True],
Cell[126704, 2557, 12930, 204, 468, "Input",ExpressionUUID->"513aff78-73d8-4540-b0a3-eb2e825bb45a",
 InitializationCell->True],
Cell[139637, 2763, 4939, 105, 552, "Input",ExpressionUUID->"7b6e07ad-c2cf-4ede-864a-e066b48066f4",
 InitializationCell->True],
Cell[144579, 2870, 2613, 64, 217, "Input",ExpressionUUID->"f2039743-db9d-4f7f-b141-a26391233b17",
 InitializationCell->True],
Cell[147195, 2936, 1917, 48, 280, "Input",ExpressionUUID->"a9cf26b1-be1e-4622-b662-546cfd655b8a",
 InitializationCell->True],
Cell[149115, 2986, 15812, 237, 405, "Input",ExpressionUUID->"a04cc5cb-f6d3-44cb-948c-5de7b31d7bb1",
 InitializationCell->True],
Cell[164930, 3225, 28589, 533, 2167, "Input",ExpressionUUID->"7ab97dfc-16f0-46d4-b3f5-7645f6742ffd",
 InitializationCell->True],
Cell[193522, 3760, 3995, 99, 573, "Input",ExpressionUUID->"852c2853-bfd6-4866-bf92-ccc59ded20a4",
 InitializationCell->True],
Cell[197520, 3861, 7325, 163, 761, "Input",ExpressionUUID->"f84550c7-7952-4387-a527-80b00981d42e",
 InitializationCell->True],
Cell[204848, 4026, 7882, 176, 804, "Input",ExpressionUUID->"3128a188-5c1c-4d25-8a9b-47c693cc3557",
 InitializationCell->True],
Cell[212733, 4204, 5751, 121, 594, "Input",ExpressionUUID->"dbcd4870-d590-4edc-9959-269a0ebe0f96",
 InitializationCell->True],
Cell[218487, 4327, 2870, 58, 238, "Input",ExpressionUUID->"c6c97b88-1480-46d1-9cb2-3405fa847775",
 InitializationCell->True]
}, Open  ]]
}
]
*)

