(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      6918,        189]
NotebookOptionsPosition[      6343,        171]
NotebookOutlinePosition[      6743,        187]
CellTagsIndexPosition[      6700,        184]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"r1", "=", " ", "2"}], ";", 
  RowBox[{"r2", "=", "3"}], ";", 
  RowBox[{"r3", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2"}], "}"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "3"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d1", " ", "=", " ", 
   RowBox[{"Disk", "[", 
    RowBox[{"c1", ",", "r1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d2", " ", "=", " ", 
   RowBox[{"Disk", "[", 
    RowBox[{"c2", ",", "r2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"c31", ",", "c32"}], "}"}], " ", "=", " ", 
  RowBox[{"diskdiskTouchingPoint", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d1", ",", "d2"}], "}"}], ",", "r3"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8730007222219925`*^9, 3.8730008282448626`*^9}, {
  3.8730009737386994`*^9, 3.8730011664627757`*^9}, {3.873001214729673*^9, 
  3.8730013018588123`*^9}, {3.873002788115307*^9, 3.873002792599338*^9}, {
  3.873007775633471*^9, 3.873007777424921*^9}, {3.8730078150844965`*^9, 
  3.8730079790193005`*^9}, {3.8730080135908337`*^9, 3.8730080147548466`*^9}, {
  3.873008059535286*^9, 3.8730082777348146`*^9}, {3.873011108467773*^9, 
  3.8730111791476374`*^9}, {3.873011311152991*^9, 3.873011395105166*^9}, {
  3.8730115838129325`*^9, 3.873011584058446*^9}, {3.873011615110351*^9, 
  3.8730116152844825`*^9}, {3.8730242218845997`*^9, 3.873024278144109*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"7ded151e-8f5f-49b7-935e-a0c98c1c21ac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.5000000000000002`", ",", "3.0000000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.4655172413793105`", ",", "0.5862068965517244`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8730242826090975`*^9, 3.8730243251249824`*^9},
 CellLabel->
  "Out[211]=",ExpressionUUID->"f4e752f3-bfac-473f-8b8a-3d19075dc451"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newdiskdiskTouchingPoint", "[", 
   RowBox[{"diskPair_", ",", "r_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "c1", ",", "c2", ",", "r1", ",", "r2", ",", "interdisk", ",", 
      "interdiskVectorNorm", ",", "interdiskNormal", ",", 
      "\[IndentingNewLine]", "tri", ",", "angle", ",", "vector", ",", 
      "normal", ",", "interdiskVector"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"c1", ",", "c2"}], "}"}], "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"diskXZ", ",", "diskPair"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r1", ",", "r2"}], "}"}], "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{"diskR", ",", "diskPair"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskVector", " ", "=", " ", 
      RowBox[{"c2", "-", "c1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"interdisk", " ", "=", " ", 
      RowBox[{"Norm", "[", "interdiskVector", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskVectorNorm", " ", "=", " ", 
      RowBox[{"interdiskVector", "/", 
       RowBox[{"Norm", "[", "interdiskVector", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"interdiskNormal", " ", "=", "  ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"interdiskVectorNorm", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", 
        RowBox[{"interdiskVectorNorm", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"tri", " ", "=", 
      RowBox[{"SSSTriangle", "[", 
       RowBox[{
        RowBox[{"r2", "+", "r"}], ",", 
        RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"angle", " ", "=", " ", 
      RowBox[{"TriangleMeasurement", "[", 
       RowBox[{"tri", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<InteriorAngle\>\"", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vector", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], "*", 
       RowBox[{"Cos", "[", "angle", "]"}], "*", "interdiskVectorNorm"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"normal", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", "r"}], ")"}], "*", 
       RowBox[{"Sin", "[", "angle", "]"}], "*", " ", "interdiskNormal"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "+", "vector", "+", "normal"}], ",", 
       RowBox[{"c1", "+", "vector", "-", "normal"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskdiskTouchingPoint", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d1", ",", "d2"}], "}"}], ",", "r3"}], "]"}], " ", "//", 
  "RepeatedTiming"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "@", 
   RowBox[{"newdiskdiskTouchingPoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d1", ",", "d2"}], "}"}], ",", "r3"}], "]"}]}], " ", "//", " ", 
  "RepeatedTiming"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8730256830474925`*^9, 3.873025871669131*^9}, {
  3.8730259109566154`*^9, 3.8730259579093943`*^9}, {3.873026003002002*^9, 
  3.873026265592887*^9}, {3.8730263030946712`*^9, 3.873026390128317*^9}, {
  3.8730264581317215`*^9, 3.873026486568651*^9}},
 CellLabel->
  "In[877]:=",ExpressionUUID->"97bc159c-2a10-4db5-b367-277937631d3c"]
},
WindowSize->{951., 528.25},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Microsoft Windows (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"19104eef-212f-4d37-99a2-1d5d7bcf9ab5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1717, 41, 105, "Input",ExpressionUUID->"7ded151e-8f5f-49b7-935e-a0c98c1c21ac"],
Cell[2300, 65, 397, 10, 32, "Output",ExpressionUUID->"f4e752f3-bfac-473f-8b8a-3d19075dc451"]
}, Open  ]],
Cell[2712, 78, 3627, 91, 371, "Input",ExpressionUUID->"97bc159c-2a10-4db5-b367-277937631d3c"]
}
]
*)

