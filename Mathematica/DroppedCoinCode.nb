(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    234021,       4900]
NotebookOptionsPosition[    230105,       4827]
NotebookOutlinePosition[    230574,       4845]
CellTagsIndexPosition[    230531,       4842]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Dropped coin model ", "Section",
 CellChangeTimes->{{3.7771818580920444`*^9, 3.7771818869468756`*^9}, {
   3.777444976808712*^9, 3.777444980622511*^9}, {3.77815133774113*^9, 
   3.7781513433467703`*^9}, 
   3.845844314817604*^9},ExpressionUUID->"e55015fc-a79b-4df9-961d-\
01036e6cf397"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[44]:=",ExpressionUUID->"ff2e94a6-5c48-4dce-90d5-bda2729443a1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"coinD", ",", "coinZ"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinNumber", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", "n"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareCoinNumber", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"bareNumber", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"isPrincipal", "[", "coin_", "]"}], " ", ":=", " ", 
     RowBox[{"IntegerQ", "[", 
      RowBox[{"coinNumber", "[", "coin", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"isBare", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"IntegerQ", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", "n_", "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"left", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"right", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"lastCoinNumber", "[", "coinCollection_", "]"}], " ", ":=", " ", 
      RowBox[{"Max", "[", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"coinNumber", ",", "coinCollection"}], "]"}], ",", 
         "IntegerQ"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"subsetCoinCollection", "[", 
       RowBox[{"coinCollection_", ",", "coinNumbers_"}], "]"}], " ", ":=", 
      " ", 
      RowBox[{"Select", "[", 
       RowBox[{"coinCollection", ",", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"coinNumbers", ",", 
           RowBox[{"coinNumber", "[", "#", "]"}]}], " ", "]"}], "&"}]}], 
       "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"highestCoinNumber", "[", "run_", "]"}], " ", ":=", "  ", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{"bareNumber", ",", 
        RowBox[{"Keys", "@", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CoinAssociation", 
          "]"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"getCoinByNumber", "[", 
       RowBox[{"n_", ",", "coinCollection_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "coinSet", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coinSet", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"coinCollection", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"coinNumber", "[", "#", "]"}], "\[Equal]", "n"}], " ", 
             "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "coinSet", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<Can't find coin \>\"", ",", " ", "n"}], "]"}], ";", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"First", "[", "coinSet", "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getCoinFromRun", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coinSet", ",", "coinCollection", ",", "\[IndentingNewLine]", 
         "coinAssociation", ",", "baren", ",", "coin", ",", 
         "cylinderCircumference"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinAssociation", " ", "=", " ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CoinAssociation", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coin", "=", " ", 
         RowBox[{"coinAssociation", "[", 
          RowBox[{"bareNumber", "[", "n", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "coin", "]"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<gCFR Can't find coin \>\"", ",", " ", "n", ",", 
             RowBox[{"bareNumber", "[", "n", "]"}], ",", "coin", ",", 
             "coinAssociation"}], "]"}], ";", 
           RowBox[{"Abort", "[", "]"}], ";", 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cylinderCircumference", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
          RowBox[{"coinH", "[", "coin", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "n", "]"}], "==", " ", "left"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coin", "  ", "=", " ", 
           RowBox[{"coinTranslateL", "[", 
            RowBox[{"coin", ",", 
             RowBox[{
              RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
              "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "n", "]"}], "==", " ", "right"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coin", "  ", "=", " ", 
           RowBox[{"coinTranslateR", "[", 
            RowBox[{"coin", ",", 
             RowBox[{
              RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
              "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "coin", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"getCoinFromRun", "[", 
       RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", "  ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coinSet", ",", "coinCollection", ",", "baren", ",", "coin", ",", 
          "cylinderCircumference"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coinCollection", " ", "=", " ", 
          RowBox[{
           RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "Coins", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"coinSet", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"coinCollection", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"coinNumber", "[", "#", "]"}], "\[Equal]", 
              RowBox[{"bareNumber", "[", "n", "]"}]}], " ", "&"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "coinSet", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<gCFR Can't find coin \>\"", ",", " ", "n", ",", 
              RowBox[{"bareNumber", "[", "n", "]"}], ",", "coinSet", ",", 
              "coinCollection"}], "]"}], ";", 
            RowBox[{"Abort", "[", "]"}], ";", 
            RowBox[{"Return", "[", 
             RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"coin", " ", "=", " ", 
          RowBox[{"First", "[", "coinSet", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"cylinderCircumference", " ", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
            "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
           RowBox[{"coinH", "[", "coin", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "n", "]"}], "==", " ", "left"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coin", "  ", "=", " ", 
            RowBox[{"coinTranslateL", "[", 
             RowBox[{"coin", ",", 
              RowBox[{
               RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"",
                "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "n", "]"}], "==", " ", "right"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coin", "  ", "=", " ", 
            RowBox[{"coinTranslateR", "[", 
             RowBox[{"coin", ",", 
              RowBox[{
               RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"",
                "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "coin", "]"}], ";"}]}], "\[IndentingNewLine]",
        "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getCoinAndCopiesFromRun", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"nbare", "=", 
          RowBox[{"bareNumber", "[", "n", "]"}]}], ",", "coinset", ",", 
         "coinCollection", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{"nbare", ",", "run"}], "]"}], ",", 
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{
             RowBox[{"left", "[", "nbare", "]"}], ",", "run"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{
             RowBox[{"right", "[", "nbare", "]"}], ",", "run"}], "]"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"res", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MissingQ", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"getCoinAndCopiesByNumber", "[", 
       RowBox[{"n_", ",", "coinCollection_"}], "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"nbare", "=", 
           RowBox[{"bareNumber", "[", "n", "]"}]}], ",", "coinset"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Select", "[", 
         RowBox[{"coinCollection", ",", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"nbare", ",", 
               RowBox[{"left", "[", "nbare", "]"}], ",", 
               RowBox[{"right", "[", "nbare", "]"}]}], "}"}], ",", 
             RowBox[{"coinNumber", "[", "#", "]"}]}], " ", "]"}], " ", 
           "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateL", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", " ", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"xy", "-", 
          RowBox[{"{", 
           RowBox[{"cylinderCircumference", ",", "0"}], "}"}]}], ",", "r"}], 
        "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"2", "phi"}], "]"}], "[", "xy", "]"}], ",", "r"}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateR", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"xy", "+", 
          RowBox[{"{", 
           RowBox[{"cylinderCircumference", ",", "0"}], "}"}]}], ",", "r"}], 
        "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "phi"}], "]"}], "[", "xy", "]"}], ",", "r"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateL", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"left", "[", "n", "]"}], ",", 
       RowBox[{"coinTranslateL", "[", 
        RowBox[{"coin", ",", "phi", ",", "cylinderCircumference"}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateR", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"right", "[", "n", "]"}], ",", 
       RowBox[{"coinTranslateR", "[", 
        RowBox[{"coin", ",", "phi", ",", "cylinderCircumference"}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinH", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"xy", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinH", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinH", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinD", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"xy", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinD", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinD", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinR", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", "r"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinR", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinR", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinXY", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{"xy_", ",", "r_"}], "]"}]}], "}"}], "]"}], " ", ":=", " ", 
     "xy"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinXY", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", "xy"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinZ", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"xy", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"xy", ".", "xy"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinZ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"coinZ", "[", 
      RowBox[{"coin", ",", "phi"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTheta", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_"}], "]"}], ",", "phi_"}],
       "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"coinD", "[", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "r"}], "]"}], "]"}]}], ",", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTheta", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"coinTheta", "[", 
      RowBox[{"coin", ",", "phi"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDisk", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     "coin"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extendRadius", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "inhibition_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Disk", "[", 
      RowBox[{"xy", ",", 
       RowBox[{"r", "+", "inhibition"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extendRadius", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "inhibition_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"extendRadius", "[", 
      RowBox[{"coin", ",", "inhibition"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"leftOf", "[", 
       RowBox[{"n_", ",", "m_", ",", " ", "coinCollection_", ",", "phi_"}], 
       "]"}], " ", ":=", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"phi", ">", "0"}], ",", 
        RowBox[{
         RowBox[{"coinTheta", "[", 
          RowBox[{
           RowBox[{"getCoinByNumber", "[", 
            RowBox[{"n", ",", "coinCollection"}], "]"}], ",", "phi"}], "]"}], 
         " ", ">", "  ", 
         RowBox[{"coinTheta", "[", 
          RowBox[{
           RowBox[{"getCoinByNumber", "[", 
            RowBox[{"m", ",", "coinCollection"}], "]"}], ",", "phi"}], 
          "]"}]}], ",", "\[IndentingNewLine]", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"coinXY", "[", 
           RowBox[{"getCoinByNumber", "[", 
            RowBox[{"n", ",", "coinCollection"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "<", " ", 
         RowBox[{
          RowBox[{"coinXY", "[", 
           RowBox[{"getCoinByNumber", "[", 
            RowBox[{"m", ",", "coinCollection"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinsOverZ", "[", 
      RowBox[{"coinFront_", ",", "z_", ",", "phi_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"coinFront", "[", 
      RowBox[{"[", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coinZ", "[", 
               RowBox[{"#", ",", "phi"}], "]"}], ">", "z"}], " ", "&"}], ",", 
            "coinFront"}], "]"}], ",", "True"}], "]"}]}], " ", "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDistance", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy1_", ",", "r1_"}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"xy2_", ",", "r2_"}], "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"xy1", "-", "xy2"}]}], ";", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"v", ".", "v"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDistance", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1_", ",", "coin1_Disk"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n2_", ",", "coin2_Disk"}], "}"}]}], "]"}], " ", ":=", 
     RowBox[{"coinDistance", "[", 
      RowBox[{"coin1", ",", "coin2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"whichMinConeRegionPoint", "[", 
      RowBox[{"region_", ",", "phi_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pts", ",", "hpts", ",", "x"}], 
        RowBox[{"(*", 
         RowBox[{"y", ",", "xy"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pts", " ", "=", " ", 
         RowBox[{"MeshPrimitives", "[", 
          RowBox[{"region", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"hpts", " ", "=", " ", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "y", "}"}], ",", 
             RowBox[{"pts", " ", "/.", " ", 
              RowBox[{
               RowBox[{"Point", "[", 
                RowBox[{"{", 
                 RowBox[{"x_", ",", "y_"}], "}"}], "]"}], " ", "\[Rule]", " ",
                "y"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"hpts", "=", "  ", 
           RowBox[{"Block", "[", 
            RowBox[{
             RowBox[{"{", "xy", "}"}], ",", 
             RowBox[{"pts", " ", "/.", 
              RowBox[{
               RowBox[{"Point", "[", "xy_", "]"}], " ", "\[Rule]", " ", 
               RowBox[{"xy", ".", "xy"}]}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"pts", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"Ordering", "[", "hpts", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearestCoinPair", "[", 
      RowBox[{"coin_", ",", "coinFront_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coinDistances", ",", "nearestCoins"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coinDistance", "[", 
             RowBox[{"coin", ",", "#"}], "]"}], "&"}], ",", "coinFront"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"coinFront", "[", 
            RowBox[{"[", " ", 
             RowBox[{"Ordering", "[", "coinDistances", "]"}], " ", "]"}], 
            "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "nearestCoins"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinLowerPair", "[", 
      RowBox[{"coin_", ",", "coinFront_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nearestCoins", " ", ",", "res"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"nearestCoinPair", "[", 
          RowBox[{"coin", ",", "coinFront"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"isPrincipal", "[", "coin", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"nearestCoins", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"nearestCoins", ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"coinDistance", "[", 
                RowBox[{"#", ",", "coin"}], "]"}], "<", " ", 
               RowBox[{"2.1", " ", 
                RowBox[{"coinR", "[", "#", "]"}]}]}], " ", "&"}]}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nearestNumbers", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"coinNumber", ",", "nearestCoins"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"coinNumber", "[", "coin", "]"}], ",", "nearestNumbers"}], 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"angles", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coinPairAngle", "[", 
             RowBox[{"coin", ",", "#"}], "]"}], "&"}], ",", "nearestCoins"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"coinNumber", "[", "coin", "]"}], ",", "nearestNumbers", 
           ",", "angles"}], "}"}]}], ";", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"coinLowerNeighbourNumbersOld", "[", 
       RowBox[{"coin_", ",", "coinFront_", ",", "tolerance_"}], "]"}], " ", ":=",
       " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coinDistances", ",", "nearestCoins", " ", ",", "nearestNumbers"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"only", " ", "used", " ", "when", " ", "we", " ", 
          RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "chain"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coinDistances", " ", "=", "  ", 
          RowBox[{"Association", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", 
               RowBox[{"coinDistance", "[", 
                RowBox[{"coin", ",", "#"}], "]"}]}], "&"}], ",", 
             "coinFront"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"coinDistances", " ", "=", " ", 
          RowBox[{
           RowBox[{"Sort", "[", "coinDistances", "]"}], "-", 
           RowBox[{"Min", "[", "coinDistances", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coinDistances", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"coinDistances", ",", 
            RowBox[{
             RowBox[{"#", "<", "tolerance"}], " ", "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nearestCoins", " ", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "coinDistances", "]"}], ",", 
            RowBox[{"UpTo", "[", "3", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nearestNumbers", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{"coinNumber", ",", "nearestCoins"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "nearestNumbers"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinLowerNeighbourNumbers", "[", 
      RowBox[{"state_", ",", "coin_", ",", "tolerance_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coinDistances", ",", "nearestCoins", " ", ",", "coinFront", ",", 
         "nearestNumbers"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"only", " ", "used", " ", "when", " ", "we", " ", 
         RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "chain"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinFront", " ", "=", " ", 
         RowBox[{"Values", "[", 
          RowBox[{"state", "[", "CoinAssociation", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", "  ", 
         RowBox[{"Association", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"coinDistance", "[", 
               RowBox[{"coin", ",", "#"}], "]"}]}], "&"}], ",", "coinFront"}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{
          RowBox[{"Sort", "[", "coinDistances", "]"}], "-", 
          RowBox[{"Min", "[", "coinDistances", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"coinDistances", ",", 
           RowBox[{
            RowBox[{"#", "<", "tolerance"}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "coinDistances", "]"}], ",", 
           RowBox[{"UpTo", "[", "3", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nearestNumbers", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"coinNumber", ",", "nearestCoins"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "nearestNumbers"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinPairAngle", "[", 
      RowBox[{"coinm_", ",", "coinn_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xym", ",", "xyn", ",", "v", ",", "theta"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xym", "=", " ", 
         RowBox[{"coinXY", "[", "coinm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xyn", "=", " ", 
         RowBox[{"coinXY", "[", "coinn", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", " ", "=", " ", 
         RowBox[{"xyn", " ", "-", " ", "xym"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"ArcTan", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", " ", 
         RowBox[{"theta", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theta", "<", "0"}], ",", 
          RowBox[{"theta", " ", "=", " ", 
           RowBox[{"theta", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", "  ", 
         RowBox[{
          RowBox[{"1", "/", "4"}], "-", " ", "theta"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theta", "<", "0"}], ",", 
          RowBox[{"theta", "=", 
           RowBox[{"theta", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "theta"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"thetac", "[", "angl_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"angl", "-", " ", 
          RowBox[{"1", "/", "2"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"res", "<", "0"}], ",", 
          RowBox[{"res", "=", 
           RowBox[{"res", "+", "1"}]}]}], "]"}], ";", "res"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"5a0690a5-d5d9-44f5-8771-8e2b05800dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"not", " ", "used", " ", "by", " ", "algo"}], ",", " ", 
    RowBox[{
    "but", " ", "useful", " ", "for", " ", "ics", " ", "and", " ", "explains",
      " ", "the", " ", "cone", " ", "geometry"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"toCone", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d_", ",", "h_"}], "}"}], ",", "phi_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"d", ",", "h"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", "h", " ", ")"}], " ", "*", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Sin", "[", " ", 
             RowBox[{"2", " ", "d", " ", "phi"}], "]"}], " ", ",", 
            RowBox[{"Cos", "[", " ", 
             RowBox[{"2", "  ", "d", " ", "phi"}], "]"}]}], "}"}]}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinWithConeTranslations", "[", 
      RowBox[{"nextCoin_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "r", ",", "phi", ",", "cylinderCircumference"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<rFunction\>\"", "]"}], "[", 
          RowBox[{
           RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", " ", 
         RowBox[{"coinR", "[", "nextCoin", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phi", " ", "=", "  ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cylinderCircumference", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
          RowBox[{"coinH", "[", "nextCoin", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"{", "nextCoin", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coinD", "[", "nextCoin", "]"}], "+", 
            RowBox[{"2", " ", "r"}]}], " ", ">", " ", 
           RowBox[{"cylinderCircumference", "/", "2"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"res", ",", 
             RowBox[{"coinTranslateL", "[", 
              RowBox[{"nextCoin", ",", "phi", ",", "cylinderCircumference"}], 
              "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coinD", "[", "nextCoin", "]"}], " ", "-", 
            RowBox[{"2", " ", "r"}]}], "  ", "<", " ", 
           RowBox[{
            RowBox[{"-", "cylinderCircumference"}], "/", "2"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"res", ",", 
             RowBox[{"coinTranslateR", "[", 
              RowBox[{"nextCoin", ",", "phi", ",", "cylinderCircumference"}], 
              "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"iBoundary", "[", 
      RowBox[{"coinFront_", ",", "distance_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"extendRadius", "[", 
         RowBox[{"#", ",", "distance"}], "]"}], "&"}], ",", "coinFront"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"oldstylePlaceNextCoinCone", "[", 
     RowBox[{
     "n_", ",", "coinFront_", ",", "coinRadius_", ",", "highestCoinZ_", ",", 
      "phi_", ",", "cylinderLU_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "ib", ",", "iboundaryMesh", ",", "cyl", ",", "availableRegion", ",", 
        "nextdh", ",", "d", ",", "h", ",", "nextCoin", ",", "x", ",", "y"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ib", " ", "=", " ", 
        RowBox[{"iBoundary", "[", 
         RowBox[{"coinFront", ",", "coinRadius"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"iboundaryMesh", " ", "=", " ", 
        RowBox[{"DiscretizeRegion", "@", 
         RowBox[{"RegionUnion", "[", "ib", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cyl", " ", "=", " ", 
        RowBox[{"coneRegion", "[", 
         RowBox[{"phi", ",", 
          RowBox[{"{", 
           RowBox[{"highestCoinZ", ",", 
            RowBox[{"cylinderLU", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"availableRegion", " ", "=", " ", 
        RowBox[{"RegionDifference", "[", 
         RowBox[{"cyl", ",", "iboundaryMesh"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextdh", "  ", "=", " ", 
        RowBox[{"whichMinConeRegionPoint", "[", 
         RowBox[{"availableRegion", ",", "phi"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"returns", " ", "Point"}], " ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nextCoin", " ", "=", "  ", 
        RowBox[{"nextdh", "/.", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Point", "[", 
            RowBox[{"{", 
             RowBox[{"x_", ",", "y_"}], "}"}], "]"}], " ", "\[Rule]", "  ", 
           RowBox[{"{", 
            RowBox[{"n", ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"x", ",", "y"}], "}"}], ",", "coinRadius"}], "]"}]}], 
            "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"nextCoin", "!=", "2"}], "]"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Can't place next coin with front\\n\>\"", ",", "coinFront"}], 
           "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "nextCoin"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"63ea88af-53a7-423f-8bca-b3bc15d00d81"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.7836691808053913`*^9, 3.7836691981150436`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"290c500d-e234-4dd6-bc8e-7d12becb99a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"moveNumberLeft", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", "left"}], ",", 
     RowBox[{"Missing", "[", "]"}], ",", 
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", " ", "right"}], ",", 
     RowBox[{"n", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
     RowBox[{"left", "[", "n", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"moveNumberRight", "[", "n_", "]"}], " ", ":=", " ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "n", "]"}], "===", "left"}], ",", 
      RowBox[{"n", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Head", "[", "n", "]"}], "===", " ", "right"}], ",", 
      RowBox[{"Missing", "[", "]"}], ",", "True", ",", 
      RowBox[{"right", "[", "n", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addInto", "[", 
     RowBox[{"res_", ",", "n_", ",", "mangle_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", " ", "=", " ", "res"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", 
          RowBox[{"r", "[", "n", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], "=", 
          RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"r", "[", "n", "]"}], ",", "mangle"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "n", "]"}], "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetricAdd", "[", 
    RowBox[{"angleResult_", ",", "n_", ",", "m_", ",", "angle_"}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "newly", " ", "added", " ", "coin", 
       " ", "so", " ", "not", " ", "left", " ", "or", " ", "right", " ", 
       "but", " ", "m", " ", "might", " ", "be"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", "angleResult"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"addInto", "[", 
        RowBox[{"res", ",", "n", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "angle"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"addInto", "[", 
        RowBox[{"res", ",", "m", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "m", "]"}], "===", " ", "right"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"addInto", "[", 
          RowBox[{"res", ",", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"left", "[", "n", "]"}], ",", 
             RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "m", "]"}], "===", " ", "left"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Adding \>\"", ",", " ", "n", " ", ",", " ", 
            "\"\< connected to \>\"", ",", "m"}], "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"addInto", "[", 
          RowBox[{"res", ",", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"right", "[", "n", "]"}], ",", 
             RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.777198758112301*^9, 3.777198761357666*^9}, {
   3.777198825154991*^9, 3.777199195355589*^9}, {3.777199292113744*^9, 
   3.777199355165928*^9}, {3.777199420439361*^9, 3.777199423780373*^9}, {
   3.7771995127873077`*^9, 3.7771995972482815`*^9}, {3.7771996883844447`*^9, 
   3.7771997169732656`*^9}, {3.777199914366419*^9, 3.7771999268520594`*^9}, {
   3.777200114388332*^9, 3.7772004568784266`*^9}, {3.777200554567515*^9, 
   3.7772005730910788`*^9}, {3.7772006082630625`*^9, 3.77720061993501*^9}, 
   3.7772006589255934`*^9, {3.7772006994402103`*^9, 3.7772007258188353`*^9}, {
   3.777200763112069*^9, 3.7772008153653145`*^9}, {3.7772008456925354`*^9, 
   3.7772008639718385`*^9}, {3.7772009668401365`*^9, 
   3.7772009798882785`*^9}, {3.7772010116816607`*^9, 3.7772010119080563`*^9}, 
   3.7772011080083065`*^9, 3.777201220167986*^9, {3.777201260979247*^9, 
   3.777201265545526*^9}, {3.777201309802178*^9, 3.7772014140599713`*^9}, {
   3.777201491046541*^9, 3.777201495061799*^9}, {3.777201540749612*^9, 
   3.777201606005906*^9}, {3.777201637686154*^9, 3.777201866334651*^9}, {
   3.7772019070389266`*^9, 3.7772019284167414`*^9}, {3.7772019959750137`*^9, 
   3.777202422946189*^9}, {3.777202680236458*^9, 3.7772027359552116`*^9}, {
   3.777202781392621*^9, 3.777202843333553*^9}, {3.7772028945656586`*^9, 
   3.7772028964705625`*^9}, {3.777202936315113*^9, 3.777202951761792*^9}, {
   3.7772030822557325`*^9, 3.777203086751713*^9}, {3.777203118483797*^9, 
   3.7772031414852934`*^9}, {3.77720322123335*^9, 3.7772032462274895`*^9}, {
   3.77720333858144*^9, 3.7772034115013685`*^9}, {3.7772034435077457`*^9, 
   3.777203542845574*^9}, {3.7772036132432475`*^9, 3.7772036625036564`*^9}, {
   3.7772037317443852`*^9, 3.7772037347962627`*^9}, {3.7772039049630003`*^9, 
   3.7772039554823236`*^9}, {3.7772041062236333`*^9, 
   3.7772046821250954`*^9}, {3.7772048203393154`*^9, 3.77720485180414*^9}, {
   3.7772049425496025`*^9, 3.7772049692704687`*^9}, {3.777205005536491*^9, 
   3.7772050223285694`*^9}, {3.777205055659367*^9, 3.777205062336505*^9}, 
   3.777205094894067*^9, {3.777205167325325*^9, 3.777205179434198*^9}, {
   3.77720522602855*^9, 3.7772052332624397`*^9}, {3.777205274305686*^9, 
   3.7772053283163376`*^9}, {3.77720536096367*^9, 3.7772053616528635`*^9}, {
   3.7772053960368404`*^9, 3.777205494624268*^9}, 3.777205538333417*^9, {
   3.7772056421646194`*^9, 3.7772056573829093`*^9}, {3.777205837410347*^9, 
   3.777206174034772*^9}, {3.7772062550430655`*^9, 3.7772062581477995`*^9}, {
   3.777206360587723*^9, 3.777206420552726*^9}, {3.7772065485752773`*^9, 
   3.77720655429694*^9}, {3.777206615738614*^9, 3.7772066158353467`*^9}, {
   3.7772066497525806`*^9, 3.7772067025001535`*^9}, {3.777206739603918*^9, 
   3.7772069410258503`*^9}, {3.7772069710276403`*^9, 3.777207767332*^9}, {
   3.7772078022236195`*^9, 3.77720780398413*^9}, {3.77720805555389*^9, 
   3.7772084143918643`*^9}, {3.77720870869031*^9, 3.777208711105912*^9}, {
   3.777208840772634*^9, 3.7772088408813424`*^9}, {3.7772094837413216`*^9, 
   3.777209487756629*^9}, {3.7772181670325403`*^9, 3.7772181721159835`*^9}, {
   3.7772186343496795`*^9, 3.7772187051551533`*^9}, {3.7772187479746017`*^9, 
   3.7772187790425053`*^9}, {3.777218958763965*^9, 3.7772189866831264`*^9}, {
   3.777219019916438*^9, 3.7772190706456904`*^9}, {3.777219101719536*^9, 
   3.7772191082461095`*^9}, {3.7772192323281384`*^9, 
   3.7772192644327784`*^9}, {3.7772192969304137`*^9, 
   3.7772193023269987`*^9}, {3.7772193814369545`*^9, 3.777219452311511*^9}, {
   3.777219730493354*^9, 3.7772197310728383`*^9}, {3.7772202778832617`*^9, 
   3.7772202833715444`*^9}, {3.777261954571349*^9, 3.7772619849795065`*^9}, {
   3.77726234396531*^9, 3.777262357015914*^9}, {3.7772636737680902`*^9, 
   3.7772637188874197`*^9}, {3.7772637547006407`*^9, 
   3.7772638498622403`*^9}, {3.7772640050166073`*^9, 3.777264006528591*^9}, {
   3.777264046961378*^9, 3.77726406495252*^9}, {3.777266869774967*^9, 
   3.7772668750827713`*^9}, {3.7772674487226725`*^9, 
   3.7772674781958494`*^9}, {3.7772675087032313`*^9, 
   3.7772675328137836`*^9}, {3.7772897351531415`*^9, 3.7772897396660748`*^9}, 
   3.7772898181586885`*^9, {3.777289942249778*^9, 3.777289969885913*^9}, {
   3.777290014820979*^9, 3.7772900732068744`*^9}, {3.7772902292519803`*^9, 
   3.7772902499396544`*^9}, {3.777290364493809*^9, 3.7772903662590823`*^9}, {
   3.777290470114333*^9, 3.7772904732589273`*^9}, {3.7772905498770175`*^9, 
   3.777290629285652*^9}, {3.7772907167936187`*^9, 3.7772911185342093`*^9}, {
   3.777291173510193*^9, 3.777291262052396*^9}, {3.7772912927712374`*^9, 
   3.777291312307031*^9}, 3.7772914332934237`*^9, {3.777291489554963*^9, 
   3.777291504998664*^9}, {3.7772917253423758`*^9, 3.7772917945568113`*^9}, {
   3.7772918253095264`*^9, 3.7772918706482735`*^9}, {3.777291936098228*^9, 
   3.7772919397903676`*^9}, {3.7772919857833524`*^9, 
   3.7772921015058737`*^9}, {3.7772926586279416`*^9, 3.777292763197296*^9}, {
   3.7773553227355742`*^9, 3.7773553577983646`*^9}, {3.777355391669306*^9, 
   3.7773554517103634`*^9}, {3.777355571234541*^9, 3.7773555748457613`*^9}, {
   3.7773604116275606`*^9, 3.7773604176601305`*^9}, {3.77736099473905*^9, 
   3.777361012170968*^9}, {3.7773610468423853`*^9, 3.777361198214116*^9}, {
   3.777361229903042*^9, 3.777361266627672*^9}, {3.7773614461043406`*^9, 
   3.7773614487586017`*^9}, {3.777361808750428*^9, 3.777361810195012*^9}, {
   3.777373089843292*^9, 3.7773731342316113`*^9}, {3.7773758349426727`*^9, 
   3.777376075802987*^9}, {3.7773764601565337`*^9, 3.777376461477523*^9}, {
   3.777376595266379*^9, 3.777376613446789*^9}, {3.777376659169614*^9, 
   3.777376664607546*^9}, {3.7773770262295723`*^9, 3.777377047205464*^9}, {
   3.7773773360823183`*^9, 3.7773773362798343`*^9}, {3.7773773781149273`*^9, 
   3.777377676364505*^9}, {3.7773777641210203`*^9, 3.7773777758307004`*^9}, 
   3.7773778591847415`*^9, {3.7773779813874693`*^9, 3.777377988283576*^9}, {
   3.777378504817765*^9, 3.777378568219347*^9}, {3.777379023455084*^9, 
   3.7773790642055244`*^9}, {3.7773792133606143`*^9, 3.777379247247969*^9}, {
   3.777379606068428*^9, 3.77737960883624*^9}, {3.777379726015196*^9, 
   3.777379908495843*^9}, {3.7773800034910054`*^9, 3.7773801196216497`*^9}, 
   3.777380184685319*^9, {3.77738062967465*^9, 3.777380685546166*^9}, {
   3.777380852729165*^9, 3.777380863004466*^9}, {3.7773809399296026`*^9, 
   3.7773809488397126`*^9}, {3.777445422184258*^9, 3.777445473017681*^9}, {
   3.777445694486599*^9, 3.7774456951169133`*^9}, {3.777445781924409*^9, 
   3.7774457989425764`*^9}, 3.7774470615135255`*^9, {3.777447706477621*^9, 
   3.777447713386139*^9}, {3.7774477530240774`*^9, 3.7774478102918944`*^9}, {
   3.777447932396639*^9, 3.7774479366425276`*^9}, {3.777450206044672*^9, 
   3.7774502095054617`*^9}, {3.777450387921694*^9, 3.777450448450479*^9}, {
   3.7774510092430086`*^9, 3.777451015406526*^9}, {3.7774515939389343`*^9, 
   3.777451608210269*^9}, {3.7774516697727413`*^9, 3.7774517008755507`*^9}, {
   3.7774518135885134`*^9, 3.777451817380844*^9}, {3.777452094420721*^9, 
   3.7774521423293085`*^9}, {3.777452716689483*^9, 3.777452928485049*^9}, {
   3.777452962952811*^9, 3.7774529906352043`*^9}, {3.777453071411366*^9, 
   3.777453076228493*^9}, {3.7774537593942633`*^9, 3.7774537782807407`*^9}, 
   3.7774558875250607`*^9, {3.777456230003372*^9, 3.7774562315093374`*^9}, {
   3.777457530821147*^9, 3.7774577264298115`*^9}, {3.7774577615312653`*^9, 
   3.7774578519981885`*^9}, {3.777457908864355*^9, 3.777457925280449*^9}, {
   3.7774579753833838`*^9, 3.7774580718180013`*^9}, {3.7774582368570485`*^9, 
   3.77745830378307*^9}, 3.777458411538827*^9, {3.7774590037090874`*^9, 
   3.777459004764265*^9}, {3.777459434748828*^9, 3.7774594582479715`*^9}, {
   3.777459926456667*^9, 3.7774599268855476`*^9}, {3.777460211036134*^9, 
   3.7774602118629155`*^9}, {3.7774619141674476`*^9, 
   3.7774619477433095`*^9}, {3.7774742259730606`*^9, 
   3.7774743549663916`*^9}, {3.7775238571004114`*^9, 
   3.7775238668204165`*^9}, {3.777549402383898*^9, 3.777549402885852*^9}, {
   3.77755025296043*^9, 3.7775502657977557`*^9}, {3.777550311930078*^9, 
   3.7775503197561817`*^9}, {3.7775505033260098`*^9, 3.777550520286682*^9}, 
   3.7775505641182475`*^9, {3.7775528409757442`*^9, 3.7775528465268965`*^9}, {
   3.7775530317833133`*^9, 3.777553071913044*^9}, {3.777553366675251*^9, 
   3.7775534392965074`*^9}, {3.777553500644627*^9, 3.777553510323704*^9}, {
   3.777553771592589*^9, 3.7775538071653776`*^9}, {3.777553852211567*^9, 
   3.777553931775676*^9}, {3.777693527578799*^9, 3.7776935773985777`*^9}, {
   3.777693637864698*^9, 3.7776936677950706`*^9}, {3.777706584176346*^9, 
   3.777706639490574*^9}, 3.777708242922058*^9, {3.777708311778857*^9, 
   3.7777084545317316`*^9}, {3.7777088809870133`*^9, 
   3.7777090062559624`*^9}, {3.77770909902081*^9, 3.7777091563624206`*^9}, {
   3.777709211441168*^9, 3.777709606554613*^9}, {3.777709746281073*^9, 
   3.777709761469033*^9}, {3.777710003424184*^9, 3.7777100241547575`*^9}, {
   3.777710917617749*^9, 3.777711358711011*^9}, 3.7777115262791395`*^9, {
   3.7777127844551525`*^9, 3.777712829787886*^9}, {3.7777129215720186`*^9, 
   3.7777130051705713`*^9}, {3.7777138674100614`*^9, 3.777714003667265*^9}, {
   3.777714118794379*^9, 3.777714158922139*^9}, {3.777716510090765*^9, 
   3.7777166951354074`*^9}, {3.7777167605684843`*^9, 3.777716827214526*^9}, {
   3.7777168657505364`*^9, 3.777716966348225*^9}, {3.7777170007532215`*^9, 
   3.777717056312934*^9}, {3.777717127499524*^9, 3.7777171730708237`*^9}, {
   3.7777172248903637`*^9, 3.777717267244566*^9}, {3.7777172976612015`*^9, 
   3.7777174029507313`*^9}, {3.777717436719365*^9, 3.777717477102932*^9}, {
   3.7777175133748164`*^9, 3.777717513934308*^9}, {3.7777175509443197`*^9, 
   3.7777176575375357`*^9}, {3.777717715722824*^9, 3.7777177942563577`*^9}, {
   3.777717876941436*^9, 3.777717879787852*^9}, {3.7777180023159633`*^9, 
   3.7777181212744455`*^9}, 3.777718295339547*^9, {3.7777183288143067`*^9, 
   3.777718329830556*^9}, {3.7777184839392023`*^9, 3.777718547432709*^9}, 
   3.777718608362718*^9, {3.777718644621397*^9, 3.7777186862356195`*^9}, {
   3.7777187427792473`*^9, 3.7777187771304426`*^9}, {3.777718812700262*^9, 
   3.777718827101327*^9}, {3.7777189262481594`*^9, 3.777718934205358*^9}, {
   3.7777189730010023`*^9, 3.7777189910777006`*^9}, {3.777719026728071*^9, 
   3.777719398483512*^9}, {3.7779943678287563`*^9, 3.7779944126288*^9}, {
   3.7779944543982167`*^9, 3.7779944753310013`*^9}, {3.7779945276558127`*^9, 
   3.7779945342244215`*^9}, 3.7779947451357064`*^9, 3.7779948023354435`*^9, {
   3.7779951979690704`*^9, 3.7779951983037977`*^9}, {3.7779952290629697`*^9, 
   3.777995249509361*^9}, {3.7779955024746294`*^9, 3.7779955135112123`*^9}, {
   3.7779956726795917`*^9, 3.77799569563489*^9}, {3.7779957408859043`*^9, 
   3.77799574138675*^9}, {3.777995782797874*^9, 3.7779958595517583`*^9}, {
   3.7779961897240086`*^9, 3.7779962643148375`*^9}, {3.7779964279619694`*^9, 
   3.777996574177764*^9}, {3.7779966113400354`*^9, 3.7779966183962173`*^9}, {
   3.7780411596173534`*^9, 3.778041162153574*^9}, {3.7780418132702045`*^9, 
   3.778041868288145*^9}, 3.7780420003023233`*^9, {3.778042042521475*^9, 
   3.7780420503574915`*^9}, {3.778042356291007*^9, 3.7780424119432955`*^9}, {
   3.7780425798809814`*^9, 3.7780426324564095`*^9}, {3.778043067926842*^9, 
   3.7780431151805325`*^9}, {3.7780431523250914`*^9, 
   3.7780433136508484`*^9}, {3.7780434110455637`*^9, 3.778043413814122*^9}, {
   3.778043505637686*^9, 3.778043508353466*^9}, 3.778044086120117*^9, {
   3.7780441333947544`*^9, 3.7780441814742393`*^9}, {3.778047567116767*^9, 
   3.7780476079454417`*^9}, {3.778047656402502*^9, 3.7780476749439273`*^9}, {
   3.7780482392426796`*^9, 3.7780482616161795`*^9}, {3.778048489159915*^9, 
   3.7780484999041443`*^9}, {3.7780779425736966`*^9, 
   3.7780779557008076`*^9}, {3.778077992565337*^9, 3.7780779960393353`*^9}, {
   3.7780782579401736`*^9, 3.778078287746642*^9}, {3.778078355606365*^9, 
   3.778078382167923*^9}, {3.778078425976531*^9, 3.778078475446081*^9}, {
   3.7780785316562014`*^9, 3.7780785481685457`*^9}, {3.778078607450123*^9, 
   3.778078638742775*^9}, {3.7780786942288647`*^9, 3.77807871676748*^9}, {
   3.778079106004037*^9, 3.7780791072644696`*^9}, {3.7780792287760334`*^9, 
   3.7780792682578473`*^9}, {3.7780795092933664`*^9, 
   3.7780795351157064`*^9}, {3.7780798710853767`*^9, 
   3.7780798743964214`*^9}, {3.7780813381016583`*^9, 3.7780813579358487`*^9}, 
   3.7780815249126697`*^9, {3.7780816007184663`*^9, 3.7780816013732486`*^9}, 
   3.7781443124097033`*^9, {3.778144521107155*^9, 3.77814457689913*^9}, 
   3.77814461752282*^9, {3.778144653391524*^9, 3.7781447047975183`*^9}, {
   3.7781464252103558`*^9, 3.7781465418943276`*^9}, {3.7781465823858075`*^9, 
   3.7781465880394316`*^9}, {3.7781466213132114`*^9, 3.778146686222847*^9}, {
   3.77814716908211*^9, 3.778147247263533*^9}, {3.778147286987336*^9, 
   3.7781472962298775`*^9}, {3.7781473622615075`*^9, 
   3.7781473683923516`*^9}, {3.7781502778339453`*^9, 
   3.7781502795137014`*^9}, {3.778150376652686*^9, 3.778150381063978*^9}, 
   3.778151327327828*^9, {3.7781525500269794`*^9, 3.778152625236741*^9}, {
   3.7781528531347113`*^9, 3.778152860547472*^9}, {3.778152990934607*^9, 
   3.7781530267293453`*^9}, {3.77815325132203*^9, 3.778153292446015*^9}, {
   3.7781536227917128`*^9, 3.778153649271813*^9}, 3.778156100545309*^9, {
   3.779266284712841*^9, 3.7792662907991695`*^9}, {3.7792664035276175`*^9, 
   3.7792664144734592`*^9}, 3.7792664820956182`*^9, {3.7801252460391374`*^9, 
   3.780125298322338*^9}, {3.7826412244271955`*^9, 3.782641244506839*^9}, {
   3.7826452502345233`*^9, 3.7826453014106045`*^9}, {3.7826453428258066`*^9, 
   3.782645387387583*^9}, {3.7826454455699153`*^9, 3.782645511003193*^9}, {
   3.7826455481956882`*^9, 3.782645762490694*^9}, {3.7826457939406977`*^9, 
   3.782645915637066*^9}, {3.7826459628719397`*^9, 3.78264598331625*^9}, {
   3.782646028394874*^9, 3.7826460367515163`*^9}, {3.7826461284384203`*^9, 
   3.7826461298506436`*^9}, {3.782646216757451*^9, 3.7826462753557153`*^9}, 
   3.7826464570854177`*^9, {3.7826470674602013`*^9, 3.7826470726284046`*^9}, {
   3.7826476566633234`*^9, 3.7826476599346085`*^9}, {3.7826477140289297`*^9, 
   3.7826477440218325`*^9}, {3.7826479980517535`*^9, 
   3.7826482486542783`*^9}, {3.7826483209977727`*^9, 3.782648335859972*^9}, {
   3.782650250879388*^9, 3.782650264869936*^9}, 3.782652254000444*^9, {
   3.7826522950865097`*^9, 3.782652427132039*^9}, 3.782652576789838*^9, {
   3.782653473455132*^9, 3.782653474214091*^9}, {3.7826535927154207`*^9, 
   3.782653601309453*^9}, 3.7826538322676315`*^9, {3.7826538635806847`*^9, 
   3.7826538649390526`*^9}, 3.7826545343328533`*^9, {3.782654924220892*^9, 
   3.7826551142421937`*^9}, {3.782655162509063*^9, 3.7826551947280493`*^9}, 
   3.7826553642417126`*^9, {3.7826555010879107`*^9, 3.78265550513807*^9}, {
   3.7826556677373157`*^9, 3.782655735120266*^9}, {3.7826557865903854`*^9, 
   3.782655832136692*^9}, 3.782655879769264*^9, {3.7826559616694603`*^9, 
   3.782655996315197*^9}, {3.7826560397710543`*^9, 3.782656054447795*^9}, 
   3.78265639076499*^9, {3.782656471745634*^9, 3.7826564735228806`*^9}, {
   3.7826565404248905`*^9, 3.782656546128627*^9}, {3.7826566228047495`*^9, 
   3.7826567030349736`*^9}, {3.782656770830114*^9, 3.782656773827098*^9}, 
   3.7826568763427653`*^9, 3.7826569733543468`*^9, {3.7826577925565195`*^9, 
   3.782657903237216*^9}, {3.782657954285616*^9, 3.7826579713519554`*^9}, {
   3.782658034548912*^9, 3.782658148947994*^9}, {3.7826582562013617`*^9, 
   3.782658256343979*^9}, {3.7826585151955876`*^9, 3.782658683669541*^9}, {
   3.782658722998616*^9, 3.7826588512724733`*^9}, {3.7826589053348475`*^9, 
   3.782658911907295*^9}, {3.7826589458834143`*^9, 3.7826589790606523`*^9}, {
   3.7826590217633977`*^9, 3.782659030204852*^9}, {3.782659182044652*^9, 
   3.7826592166762495`*^9}, {3.7826592589501038`*^9, 3.7826593076929617`*^9}, 
   3.782659439318256*^9, {3.78265959076301*^9, 3.782659594507036*^9}, {
   3.7826601803054504`*^9, 3.7826602144043093`*^9}, {3.7827489971547327`*^9, 
   3.782749090173984*^9}, {3.782803157143355*^9, 3.7828032272599525`*^9}, {
   3.7828032819926105`*^9, 3.782803299272416*^9}, {3.782803417628023*^9, 
   3.7828037119427466`*^9}, {3.7828039130850544`*^9, 3.782803916356306*^9}, {
   3.782803950503028*^9, 3.7828041916793075`*^9}, {3.7828042261022863`*^9, 
   3.78280428793998*^9}, 3.782804321871279*^9, {3.7828044431171627`*^9, 
   3.782804553426282*^9}, {3.782804850506158*^9, 3.7828048765514956`*^9}, {
   3.7828049867409334`*^9, 3.782805008841852*^9}, {3.78280504560561*^9, 
   3.7828050538704805`*^9}, {3.7828051152783623`*^9, 
   3.7828051162467346`*^9}, {3.7828051521467714`*^9, 
   3.7828051987451987`*^9}, {3.7828111956918707`*^9, 3.7828112036625338`*^9}, 
   3.7828117588987684`*^9, {3.782811805014493*^9, 3.782811827787607*^9}, 
   3.7828120452323656`*^9, {3.782812255892192*^9, 3.782812270746517*^9}, {
   3.7828123382141657`*^9, 3.7828123598164167`*^9}, 3.782812393988033*^9, 
   3.782812477325287*^9, {3.7828125400665665`*^9, 3.782812619081312*^9}, {
   3.782812672590266*^9, 3.782812767377883*^9}, {3.782812903598418*^9, 
   3.7828129043623743`*^9}, {3.782812941082185*^9, 3.7828129423497963`*^9}, 
   3.782813111095786*^9, {3.782813466590537*^9, 3.7828135005154643`*^9}, {
   3.7828136415760145`*^9, 3.7828137752991133`*^9}, {3.7828138059740524`*^9, 
   3.782813808285887*^9}, {3.782813841446911*^9, 3.7828139513780785`*^9}, {
   3.7828140994150276`*^9, 3.7828141222879333`*^9}, {3.7828142031578703`*^9, 
   3.7828142290117593`*^9}, {3.7828142796065574`*^9, 3.782814287263051*^9}, {
   3.7828143930492506`*^9, 3.7828145467115126`*^9}, {3.7828145831500697`*^9, 
   3.7828145889745083`*^9}, {3.7828146211106415`*^9, 
   3.7828146483767543`*^9}, {3.7828147126060147`*^9, 3.782814780323984*^9}, {
   3.7828148117230997`*^9, 3.7828148262452316`*^9}, {3.7828148789064956`*^9, 
   3.7828149601392937`*^9}, 3.782815250420318*^9, {3.782816719615838*^9, 
   3.7828167202650986`*^9}, 3.782820502687225*^9, {3.7828241395326667`*^9, 
   3.7828241561691933`*^9}, {3.782825482221331*^9, 3.78282549347229*^9}, 
   3.782830475836534*^9, {3.7828305475578012`*^9, 3.7828309052775373`*^9}, {
   3.782892521622525*^9, 3.7828925345308247`*^9}, {3.782892583375331*^9, 
   3.782892652914177*^9}, {3.78289269639174*^9, 3.782892710447513*^9}, {
   3.7828927505828485`*^9, 3.7828927939683266`*^9}, {3.7828928275241566`*^9, 
   3.7828928280158405`*^9}, {3.782892861437239*^9, 3.782892906232169*^9}, {
   3.782892943183219*^9, 3.7828929514109497`*^9}, {3.7828929885858107`*^9, 
   3.782893135259907*^9}, 3.7828933675862*^9, {3.782893672589224*^9, 
   3.782893710155964*^9}, {3.782893774844914*^9, 3.7828937905649176`*^9}, {
   3.782893906676653*^9, 3.782893914447729*^9}, {3.782893966949745*^9, 
   3.7828939670624447`*^9}, {3.7828940662903996`*^9, 
   3.7828942169415045`*^9}, {3.782894250295007*^9, 3.782894251603696*^9}, {
   3.782894290403748*^9, 3.782894290606208*^9}, {3.78289441182848*^9, 
   3.7828944140374584`*^9}, {3.782894472660382*^9, 3.7828944933940496`*^9}, {
   3.7828946916252685`*^9, 3.782894761515874*^9}, 3.7828948321907988`*^9, {
   3.782894896309721*^9, 3.7828949415645695`*^9}, {3.78289518278685*^9, 
   3.7828951911247435`*^9}, {3.78289531789001*^9, 3.7828954318949156`*^9}, {
   3.78289548646904*^9, 3.782895486726379*^9}, {3.782895520583413*^9, 
   3.782895614033495*^9}, {3.782895653721721*^9, 3.782895653920192*^9}, {
   3.7828957224465637`*^9, 3.782895722920329*^9}, {3.782895782033208*^9, 
   3.7828959311730566`*^9}, {3.7828959782716846`*^9, 
   3.7828959828324947`*^9}, {3.782896061439496*^9, 3.7828960661439233`*^9}, {
   3.782896484845501*^9, 3.7828965097223034`*^9}, {3.7828977814112225`*^9, 
   3.7828977984906282`*^9}, {3.7828979463442087`*^9, 3.782898101288474*^9}, {
   3.782898141421246*^9, 3.782898151428502*^9}, {3.7828982133590417`*^9, 
   3.7828983146494617`*^9}, {3.7828983451854296`*^9, 3.782898392631812*^9}, {
   3.7828984328842707`*^9, 3.782898535498212*^9}, {3.782898568298558*^9, 
   3.7828985903307266`*^9}, {3.782898660742508*^9, 3.7828988174564667`*^9}, {
   3.7828988601154175`*^9, 3.7828989628491244`*^9}, {3.7828992790398173`*^9, 
   3.7828993016206093`*^9}, {3.7828994369942913`*^9, 3.782899584812992*^9}, {
   3.7829058047829237`*^9, 3.7829059237340527`*^9}, {3.782907538800331*^9, 
   3.7829076443951683`*^9}, {3.782907763419049*^9, 3.7829079405498004`*^9}, {
   3.782908049353963*^9, 3.7829081271208506`*^9}, {3.782908210138513*^9, 
   3.7829082246718893`*^9}, {3.7829082648739862`*^9, 
   3.7829082738010874`*^9}, {3.7829083110124383`*^9, 
   3.7829083114253635`*^9}, {3.782908358683525*^9, 3.782908387294662*^9}, 
   3.7829086136716337`*^9, {3.782908778961769*^9, 3.7829087808650227`*^9}, {
   3.782909932115225*^9, 3.782909935552041*^9}, {3.7829100597258706`*^9, 
   3.7829100620157504`*^9}, 3.7829102216410055`*^9, {3.7829103853634143`*^9, 
   3.782910389486356*^9}, {3.78291049783784*^9, 3.782910503689189*^9}, {
   3.782910654073781*^9, 3.7829107938861017`*^9}, {3.7829108547445545`*^9, 
   3.782910960148917*^9}, {3.7829109902894025`*^9, 3.78291101433012*^9}, {
   3.782911337967696*^9, 3.7829113468848553`*^9}, {3.78291187374927*^9, 
   3.7829118778353777`*^9}, 3.782912201189997*^9, {3.782912453690806*^9, 
   3.7829124689998984`*^9}, {3.782913117742851*^9, 3.782913118780053*^9}, {
   3.7829131713387423`*^9, 3.7829132440382137`*^9}, {3.782913280808482*^9, 
   3.782913371302747*^9}, 3.782913407701459*^9, {3.7829134755770364`*^9, 
   3.7829134801864414`*^9}, {3.7829135148095675`*^9, 3.7829135254810524`*^9}, 
   3.782914245133604*^9, {3.782914507032768*^9, 3.7829145077957344`*^9}, 
   3.7829146719756145`*^9, {3.78291545580511*^9, 3.782915456238947*^9}, {
   3.782915507887892*^9, 3.78291550893509*^9}, {3.782915952042447*^9, 
   3.7829159537159758`*^9}, {3.782915986008263*^9, 3.782916009397791*^9}, {
   3.7829160403701024`*^9, 3.7829160516344013`*^9}, {3.78291623455105*^9, 
   3.782916302478547*^9}, {3.782916392185631*^9, 3.7829164359807014`*^9}, {
   3.7829165366266813`*^9, 3.7829165664551907`*^9}, {3.782918440139101*^9, 
   3.7829184462737083`*^9}, {3.782919693738288*^9, 3.782919699942696*^9}, {
   3.783003840479787*^9, 3.7830038899148765`*^9}, {3.783008200141306*^9, 
   3.7830082034763885`*^9}, {3.783055490418867*^9, 3.7830555001857862`*^9}, {
   3.7830561882025356`*^9, 3.783056188385047*^9}, {3.7830599257849193`*^9, 
   3.783059926630658*^9}, {3.783060681834733*^9, 3.78306070733951*^9}, {
   3.783060937386856*^9, 3.7830609375544114`*^9}, {3.783061120192688*^9, 
   3.7830611203582177`*^9}, {3.7830618221651354`*^9, 3.783061822397519*^9}, {
   3.783061900430731*^9, 3.783061900684016*^9}, {3.7830623936917796`*^9, 
   3.7830623938224287`*^9}, {3.783062449888421*^9, 3.783062450829877*^9}, {
   3.783062578809389*^9, 3.7830625802685213`*^9}, {3.783083239662073*^9, 
   3.7830832944855676`*^9}, {3.7830833501849566`*^9, 
   3.7830833527580767`*^9}, {3.7830834097259903`*^9, 
   3.7830834139111347`*^9}, {3.7830834727102523`*^9, 3.783083513761281*^9}, {
   3.783083572283883*^9, 3.783083572933155*^9}, {3.783083779437415*^9, 
   3.783084048803094*^9}, {3.7830843267320395`*^9, 3.783084337907176*^9}, {
   3.7830844067109747`*^9, 3.7830845440208855`*^9}, {3.783084583360712*^9, 
   3.783084628804316*^9}, {3.783084719517884*^9, 3.7830847597044897`*^9}, {
   3.7830849016032963`*^9, 3.78308490190452*^9}, {3.7830850590824347`*^9, 
   3.78308505953826*^9}, {3.7830852024344387`*^9, 3.7830852048579655`*^9}, {
   3.7830854186125665`*^9, 3.7830855707128754`*^9}, {3.7830856141424*^9, 
   3.783085652288788*^9}, {3.783086117061367*^9, 3.7830861922336407`*^9}, {
   3.7830863128572803`*^9, 3.783086313614266*^9}, 3.783086472757695*^9, {
   3.7830865219302697`*^9, 3.783086528796376*^9}, {3.7830866225889564`*^9, 
   3.7830866335038223`*^9}, {3.783086678911332*^9, 3.7830866861542187`*^9}, {
   3.7830867293120747`*^9, 3.7830867299952526`*^9}, {3.783086798100752*^9, 
   3.783086854148622*^9}, {3.7830872405966988`*^9, 3.7830872460047584`*^9}, {
   3.7830873116981916`*^9, 3.783087331710743*^9}, 3.7830873846711216`*^9, {
   3.783087457092101*^9, 3.783087577497461*^9}, {3.78308763520662*^9, 
   3.7830876653786097`*^9}, {3.7830877270467615`*^9, 3.783087769543395*^9}, {
   3.7830878772307816`*^9, 3.7830878934513316`*^9}, 3.7830880753911805`*^9, {
   3.783089033361082*^9, 3.7830890429454694`*^9}, {3.7830891417713614`*^9, 
   3.783089246318486*^9}, {3.7830893057213097`*^9, 3.7830893871536856`*^9}, {
   3.783090312259946*^9, 3.7830903165877743`*^9}, {3.7830903634834204`*^9, 
   3.7830904331482515`*^9}, {3.7830905049952865`*^9, 3.783090553776052*^9}, {
   3.783090783303627*^9, 3.7830908200278273`*^9}, {3.783094416558322*^9, 
   3.7830945554273133`*^9}, {3.7830946237596955`*^9, 3.78309472706999*^9}, {
   3.7830947777179766`*^9, 3.783094795742816*^9}, {3.7830948314588614`*^9, 
   3.7830948526694627`*^9}, {3.7830948957383537`*^9, 3.783094921561353*^9}, {
   3.78309496355812*^9, 3.783095014039155*^9}, 3.7830951157147636`*^9, {
   3.7830951841578474`*^9, 3.7830951916687756`*^9}, {3.783095232819801*^9, 
   3.783095276017358*^9}, 3.7830953614519205`*^9, {3.783095411724047*^9, 
   3.7830954232362576`*^9}, {3.783095481453676*^9, 3.7830955007024484`*^9}, {
   3.783095616917572*^9, 3.7830957738597097`*^9}, {3.783095815891461*^9, 
   3.7830959415241003`*^9}, {3.783096003783724*^9, 3.7830961324645214`*^9}, 
   3.7830961999183435`*^9, {3.783096423247328*^9, 3.7830964385704217`*^9}, {
   3.7830964969753323`*^9, 3.7830965309851217`*^9}, {3.78309658224465*^9, 
   3.7830965928208027`*^9}, {3.783096676639171*^9, 3.7830967085869813`*^9}, {
   3.783096801477768*^9, 3.783096930992836*^9}, {3.7830972584701357`*^9, 
   3.783097260187579*^9}, {3.783097422549884*^9, 3.7830977329225273`*^9}, {
   3.783098151380085*^9, 3.783098267285675*^9}, {3.7830984835619783`*^9, 
   3.7830984891380463`*^9}, {3.7830989166193333`*^9, 3.783098959860119*^9}, {
   3.7830990497806835`*^9, 3.783099053137717*^9}, {3.783099232175949*^9, 
   3.7830992380403056`*^9}, {3.7830993762137814`*^9, 3.783099401768491*^9}, {
   3.78309949580618*^9, 3.7830995349705925`*^9}, {3.783099577138859*^9, 
   3.783099640513168*^9}, {3.7830997339115753`*^9, 3.783099738027621*^9}, {
   3.783099979840558*^9, 3.7830999813196006`*^9}, {3.783100196572995*^9, 
   3.7831002772289143`*^9}, {3.78310031608012*^9, 3.7831003331115685`*^9}, {
   3.783100406437052*^9, 3.7831004667506266`*^9}, {3.7831006683613205`*^9, 
   3.783100669068287*^9}, {3.783100709622103*^9, 3.7831008184198885`*^9}, {
   3.7831008706294246`*^9, 3.7831009643183756`*^9}, {3.783101107026017*^9, 
   3.7831011079904337`*^9}, 3.7831011493340454`*^9, {3.78310138067008*^9, 
   3.7831013815387607`*^9}, {3.78310154385658*^9, 3.7831016220999947`*^9}, 
   3.7831016846497936`*^9, {3.7831017184115677`*^9, 3.7831017501678*^9}, {
   3.783101925447373*^9, 3.783101997419568*^9}, {3.783102065260459*^9, 
   3.783102251396392*^9}, 3.7831023103737745`*^9, {3.783102352362563*^9, 
   3.783102352732576*^9}, {3.7831521935364447`*^9, 3.7831522977036037`*^9}, {
   3.7831524533490257`*^9, 3.783152554915677*^9}, {3.7831527633756256`*^9, 
   3.783152783657201*^9}, {3.78315287852236*^9, 3.783152914291979*^9}, {
   3.783153008964439*^9, 3.7831530619066544`*^9}, {3.783153094144865*^9, 
   3.7831531119697113`*^9}, {3.783153143184187*^9, 3.7831532158316298`*^9}, {
   3.783153256654709*^9, 3.7831532813880067`*^9}, {3.7831533537588196`*^9, 
   3.783153361317261*^9}, {3.783153462802524*^9, 3.783153504809825*^9}, 
   3.783153555888278*^9, {3.783153596110341*^9, 3.7831537259160023`*^9}, 
   3.7831537572974663`*^9, {3.783153844070965*^9, 3.783153848137968*^9}, {
   3.7831539502914658`*^9, 3.7831539776946125`*^9}, {3.7831540563655653`*^9, 
   3.7831540975175433`*^9}, {3.7831541276838927`*^9, 
   3.7831541823081694`*^9}, {3.783155873746646*^9, 3.7831558760739436`*^9}, 
   3.783155972981032*^9, {3.78315607408528*^9, 3.783156172755717*^9}, {
   3.783156210671802*^9, 3.7831562122010612`*^9}, {3.783156260410429*^9, 
   3.7831562829667506`*^9}, {3.783156324649783*^9, 3.7831563297563725`*^9}, {
   3.7831563717609673`*^9, 3.7831564164719706`*^9}, {3.7831564785711575`*^9, 
   3.78315653287296*^9}, {3.78316137142309*^9, 3.7831613841440153`*^9}, 
   3.7831614284016285`*^9, {3.783161483806345*^9, 3.783161492440277*^9}, {
   3.78316191261397*^9, 3.7831619179676485`*^9}, {3.7831621150901966`*^9, 
   3.783162137798435*^9}, {3.783162563178275*^9, 3.7831625723377237`*^9}, {
   3.783162614721351*^9, 3.783162638385996*^9}, {3.783162737975556*^9, 
   3.783162786382995*^9}, {3.7831628180203886`*^9, 3.7831628318373713`*^9}, {
   3.7831628762884316`*^9, 3.7831629583817716`*^9}, {3.783163030347212*^9, 
   3.7831630310473385`*^9}, {3.7831633269575605`*^9, 3.783163362446636*^9}, {
   3.783163425241579*^9, 3.7831634708295975`*^9}, {3.7831635165412855`*^9, 
   3.7831635173322077`*^9}, {3.7831635736245317`*^9, 3.783163593075486*^9}, {
   3.7831636727353373`*^9, 3.783163696383066*^9}, {3.783163743249696*^9, 
   3.7831637434282165`*^9}, {3.7831637973389325`*^9, 
   3.7831638139275494`*^9}, {3.78316456353679*^9, 3.7831646101540527`*^9}, {
   3.783164693754364*^9, 3.7831647013560553`*^9}, {3.783164850093041*^9, 
   3.783164901776783*^9}, {3.7831650341461377`*^9, 3.7831650386790433`*^9}, {
   3.7831651456844273`*^9, 3.7831651519865694`*^9}, {3.7831655333411627`*^9, 
   3.783165592180727*^9}, {3.783165799413224*^9, 3.78316601122946*^9}, {
   3.7831660493086033`*^9, 3.7831660906848574`*^9}, {3.783166144355212*^9, 
   3.7831661447272177`*^9}, {3.7831661930389485`*^9, 3.78316626607755*^9}, {
   3.783166464667142*^9, 3.7831665449932156`*^9}, {3.7831666357902627`*^9, 
   3.783166821042577*^9}, {3.783166892276012*^9, 3.7831669643920107`*^9}, {
   3.7831671343342905`*^9, 3.7831672637520056`*^9}, {3.783167328493805*^9, 
   3.783167341099077*^9}, {3.7831674572742233`*^9, 3.783167508837221*^9}, {
   3.783167556140683*^9, 3.7831675733665557`*^9}, {3.78316761121828*^9, 
   3.7831676116541095`*^9}, {3.783167644957*^9, 3.7831677926887093`*^9}, {
   3.783167919750758*^9, 3.783168041479012*^9}, {3.7831680971670055`*^9, 
   3.7831681099737372`*^9}, {3.7831682267841835`*^9, 3.783168249584178*^9}, {
   3.783169591787797*^9, 3.7831695984708834`*^9}, {3.7831696835243235`*^9, 
   3.7831697705714087`*^9}, {3.7831698011246576`*^9, 
   3.7831698313149056`*^9}, {3.7831700174339004`*^9, 3.783170030397214*^9}, {
   3.783173445645149*^9, 3.783173472643937*^9}, {3.783173539330471*^9, 
   3.783173619490983*^9}, 3.783237915116966*^9, 3.7832379899277925`*^9, 
   3.783238038887791*^9, 3.7832380730314646`*^9, {3.7832384127683964`*^9, 
   3.783238417587837*^9}, {3.783239982697875*^9, 3.7832400029040813`*^9}, {
   3.7832403214615993`*^9, 3.783240333878853*^9}, {3.783240997003974*^9, 
   3.783241031030908*^9}, {3.7832417957824507`*^9, 3.7832417966471806`*^9}, {
   3.7832541226795473`*^9, 3.783254137292821*^9}, {3.7832541889480515`*^9, 
   3.7832542030704713`*^9}, {3.7832542971853476`*^9, 
   3.7832542978372765`*^9}, {3.78325443487348*^9, 3.7832544353821573`*^9}, {
   3.7832576981180677`*^9, 3.7832577099914303`*^9}, {3.7832578225009384`*^9, 
   3.783257831109132*^9}, {3.783257911992328*^9, 3.7832579128934603`*^9}, {
   3.7833026883372912`*^9, 3.7833029622513695`*^9}, {3.783303730615432*^9, 
   3.7833037878792086`*^9}, {3.783303849545208*^9, 3.783303850653242*^9}, {
   3.783303893891547*^9, 3.7833039144734735`*^9}, {3.7833040296738653`*^9, 
   3.783304036623272*^9}, 3.783304093289716*^9, {3.78330412476649*^9, 
   3.7833041311913023`*^9}, {3.783304205980188*^9, 3.783304310106603*^9}, {
   3.783304352564963*^9, 3.7833043535114293`*^9}, {3.7833043976014557`*^9, 
   3.7833044677417817`*^9}, {3.7833045093674*^9, 3.783304516917202*^9}, {
   3.783304699978898*^9, 3.783304703736843*^9}, 3.7833048092285748`*^9, {
   3.7833048794038043`*^9, 3.7833048868448963`*^9}, {3.783305099632531*^9, 
   3.7833051211130543`*^9}, 3.783305213388153*^9, {3.7833052703008676`*^9, 
   3.7833052731711874`*^9}, {3.783305322923069*^9, 3.7833053233130226`*^9}, {
   3.7833053680303693`*^9, 3.783305368388443*^9}, {3.7833058759622803`*^9, 
   3.7833058859106627`*^9}, {3.783406774054085*^9, 3.7834067999264603`*^9}, {
   3.7834068749797707`*^9, 3.7834068763698645`*^9}, {3.7834192840815907`*^9, 
   3.7834193088298078`*^9}, {3.7834193466445246`*^9, 
   3.7834193761417394`*^9}, {3.783420850058855*^9, 3.78342086067791*^9}, {
   3.783420920175808*^9, 3.7834209340715184`*^9}, {3.7834213918679075`*^9, 
   3.783421435128628*^9}, {3.7834214673210044`*^9, 3.783421515897666*^9}, 
   3.7834216050272765`*^9, {3.783422108388769*^9, 3.7834221195423307`*^9}, 
   3.783424537016801*^9, {3.783425866781705*^9, 3.7834258677644377`*^9}, {
   3.783426036270791*^9, 3.78342613238562*^9}, {3.7834262155352325`*^9, 
   3.783426215966591*^9}, {3.783426263916238*^9, 3.7834262640817957`*^9}, {
   3.783426353723593*^9, 3.7834264285359697`*^9}, {3.7834265518967867`*^9, 
   3.7834265520423927`*^9}, {3.7834280283698735`*^9, 3.78342802847659*^9}, {
   3.783428066152058*^9, 3.783428072600811*^9}, {3.7834282056537085`*^9, 
   3.7834282327014265`*^9}, {3.7836641480069685`*^9, 
   3.7836642220848336`*^9}, {3.783664300460642*^9, 3.7836643010531015`*^9}, 
   3.783666304618492*^9, {3.783666392123995*^9, 3.7836663956465645`*^9}, {
   3.7836667511359825`*^9, 3.783666767626238*^9}, {3.7836669614100237`*^9, 
   3.783666983819486*^9}, {3.7836670367658477`*^9, 3.783667048722896*^9}, {
   3.783667196334739*^9, 3.7836672135975533`*^9}, {3.78366737468898*^9, 
   3.7836673839074097`*^9}, {3.78366743962438*^9, 3.7836674800372458`*^9}, {
   3.7836676560745277`*^9, 3.783667667399234*^9}, {3.783667797383686*^9, 
   3.7836678390176964`*^9}, {3.7836678757264557`*^9, 3.78366790167206*^9}, {
   3.7836679658942556`*^9, 3.783668022572709*^9}, {3.783668109673205*^9, 
   3.7836681129973125`*^9}, {3.783668210932325*^9, 3.7836682139502506`*^9}, {
   3.783668293389781*^9, 3.7836683829195256`*^9}, {3.7836684227120295`*^9, 
   3.7836684381607037`*^9}, {3.7836687162058573`*^9, 3.783668843608276*^9}, {
   3.7836689272873883`*^9, 3.783669020549065*^9}, {3.783669054939206*^9, 
   3.7836691595220146`*^9}, {3.7836693740224457`*^9, 3.7836694065095015`*^9}, 
   3.783669497072275*^9, {3.7836695341969585`*^9, 3.7836698215006495`*^9}, 
   3.7836698516659517`*^9, {3.783669911156884*^9, 3.783669911346377*^9}, {
   3.7836699898912907`*^9, 3.783670096523759*^9}, {3.7836702626094494`*^9, 
   3.783670327808045*^9}, {3.783670519797464*^9, 3.7836705508439555`*^9}, 
   3.7836709495045547`*^9, {3.783670991015684*^9, 3.7836710211003838`*^9}, {
   3.783671330829816*^9, 3.783671492393649*^9}, 3.7836715713473797`*^9, {
   3.783671702030538*^9, 3.7836717450564737`*^9}, {3.7836718022893367`*^9, 
   3.783671855560831*^9}, {3.783671948080329*^9, 3.783671954010504*^9}, {
   3.783672467714637*^9, 3.7836724926765413`*^9}, {3.7836727448059945`*^9, 
   3.7836727606785336`*^9}, {3.7836730297460003`*^9, 
   3.7836730461034107`*^9}, {3.783673263764267*^9, 3.78367328722058*^9}, {
   3.7836733773340445`*^9, 3.7836733798903484`*^9}, {3.7836734138231173`*^9, 
   3.783673417789503*^9}, {3.7836752708047667`*^9, 3.783675288433563*^9}, {
   3.7836765792405233`*^9, 3.7836766687879033`*^9}, {3.78367686269433*^9, 
   3.7836768774219494`*^9}, {3.783677024080982*^9, 3.7836770348935366`*^9}, {
   3.7836770741555066`*^9, 3.7836770897667437`*^9}, 3.783677120706434*^9, {
   3.783677195812484*^9, 3.783677224041402*^9}, {3.7836776512376604`*^9, 
   3.7836776603647566`*^9}, {3.7836880171462245`*^9, 
   3.7836883488983884`*^9}, {3.7836883858964424`*^9, 
   3.7836884561162796`*^9}, {3.7836885085271425`*^9, 3.783688642811578*^9}, {
   3.783688688847434*^9, 3.7836887273999157`*^9}, {3.7836888081049767`*^9, 
   3.783688835435865*^9}, {3.783688998874857*^9, 3.7836890024573097`*^9}, {
   3.783689044901726*^9, 3.783689057718437*^9}, {3.783689092576191*^9, 
   3.7836891703312683`*^9}, {3.7836892348686886`*^9, 3.783689237096696*^9}, {
   3.7836892783942194`*^9, 3.7836893054917297`*^9}, {3.78368970914472*^9, 
   3.7836897484946384`*^9}, {3.783689785545523*^9, 3.783689808119142*^9}, {
   3.7836900404476852`*^9, 3.783690053314455*^9}, {3.783690170214693*^9, 
   3.7836902118922296`*^9}, {3.7836902466921043`*^9, 3.783690289356969*^9}, {
   3.783690330407235*^9, 3.7836904821569858`*^9}, {3.783690516737485*^9, 
   3.783690813402972*^9}, {3.7836908649051623`*^9, 3.78369105084506*^9}, {
   3.7836911046959553`*^9, 3.7836911460569963`*^9}, {3.7836912540460725`*^9, 
   3.78369125661724*^9}, {3.783691330298518*^9, 3.7836915262120895`*^9}, 
   3.783692339369131*^9, {3.7836929889119053`*^9, 3.78369334218369*^9}, {
   3.783693391511915*^9, 3.7836934128508644`*^9}, {3.7836934428665686`*^9, 
   3.7836935139086475`*^9}, {3.7855811698794317`*^9, 3.785581193544176*^9}, {
   3.7855812717600803`*^9, 3.785581323626475*^9}, 3.785583911908019*^9},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[90]:=",ExpressionUUID->"8923fcf7-3a83-4578-b088-d91ab1b058c4"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"coneRegion", "[", 
      RowBox[{"phi_", ",", 
       RowBox[{"{", 
        RowBox[{"h0_", ",", "h1_"}], "}"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d1", ",", "d0"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"DiscretizeRegion", "[", 
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "1"}], "/", "2"}], ",", "h0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "h1"}], "}"}]}], "]"}], "]"}], 
           "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"d1", ",", "d0"}], "}"}], "  ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"DiscretizeRegion", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "h1", ",", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "phi"}], ",", 
                 " ", 
                 RowBox[{
                  RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", "phi"}]}], 
                "}"}]}], "]"}], ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", "h0"}], "]"}]}], "}"}]}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"RegionDifference", "[", 
          RowBox[{"d1", ",", "d0"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.777198758112301*^9, 3.777198761357666*^9}, {
   3.777198825154991*^9, 3.777199195355589*^9}, {3.777199292113744*^9, 
   3.777199355165928*^9}, {3.777199420439361*^9, 3.777199423780373*^9}, {
   3.7771995127873077`*^9, 3.7771995972482815`*^9}, {3.7771996883844447`*^9, 
   3.7771997169732656`*^9}, {3.777199914366419*^9, 3.7771999268520594`*^9}, {
   3.777200114388332*^9, 3.7772004568784266`*^9}, {3.777200554567515*^9, 
   3.7772005730910788`*^9}, {3.7772006082630625`*^9, 3.77720061993501*^9}, 
   3.7772006589255934`*^9, {3.7772006994402103`*^9, 3.7772007258188353`*^9}, {
   3.777200763112069*^9, 3.7772008153653145`*^9}, {3.7772008456925354`*^9, 
   3.7772008639718385`*^9}, {3.7772009668401365`*^9, 
   3.7772009798882785`*^9}, {3.7772010116816607`*^9, 3.7772010119080563`*^9}, 
   3.7772011080083065`*^9, 3.777201220167986*^9, {3.777201260979247*^9, 
   3.777201265545526*^9}, {3.777201309802178*^9, 3.7772014140599713`*^9}, {
   3.777201491046541*^9, 3.777201495061799*^9}, {3.777201540749612*^9, 
   3.777201606005906*^9}, {3.777201637686154*^9, 3.777201866334651*^9}, {
   3.7772019070389266`*^9, 3.7772019284167414`*^9}, {3.7772019959750137`*^9, 
   3.777202422946189*^9}, {3.777202680236458*^9, 3.7772027359552116`*^9}, {
   3.777202781392621*^9, 3.777202843333553*^9}, {3.7772028945656586`*^9, 
   3.7772028964705625`*^9}, {3.777202936315113*^9, 3.777202951761792*^9}, {
   3.7772030822557325`*^9, 3.777203086751713*^9}, {3.777203118483797*^9, 
   3.7772031414852934`*^9}, {3.77720322123335*^9, 3.7772032462274895`*^9}, {
   3.77720333858144*^9, 3.7772034115013685`*^9}, {3.7772034435077457`*^9, 
   3.777203542845574*^9}, {3.7772036132432475`*^9, 3.7772036625036564`*^9}, {
   3.7772037317443852`*^9, 3.7772037347962627`*^9}, {3.7772039049630003`*^9, 
   3.7772039554823236`*^9}, {3.7772041062236333`*^9, 
   3.7772046821250954`*^9}, {3.7772048203393154`*^9, 3.77720485180414*^9}, {
   3.7772049425496025`*^9, 3.7772049692704687`*^9}, {3.777205005536491*^9, 
   3.7772050223285694`*^9}, {3.777205055659367*^9, 3.777205062336505*^9}, 
   3.777205094894067*^9, {3.777205167325325*^9, 3.777205179434198*^9}, {
   3.77720522602855*^9, 3.7772052332624397`*^9}, {3.777205274305686*^9, 
   3.7772053283163376`*^9}, {3.77720536096367*^9, 3.7772053616528635`*^9}, {
   3.7772053960368404`*^9, 3.777205494624268*^9}, 3.777205538333417*^9, {
   3.7772056421646194`*^9, 3.7772056573829093`*^9}, {3.777205837410347*^9, 
   3.777206174034772*^9}, {3.7772062550430655`*^9, 3.7772062581477995`*^9}, {
   3.777206360587723*^9, 3.777206420552726*^9}, {3.7772065485752773`*^9, 
   3.77720655429694*^9}, {3.777206615738614*^9, 3.7772066158353467`*^9}, {
   3.7772066497525806`*^9, 3.7772067025001535`*^9}, {3.777206739603918*^9, 
   3.7772069410258503`*^9}, {3.7772069710276403`*^9, 3.777207767332*^9}, {
   3.7772078022236195`*^9, 3.77720780398413*^9}, {3.77720805555389*^9, 
   3.7772084143918643`*^9}, {3.77720870869031*^9, 3.777208711105912*^9}, {
   3.777208840772634*^9, 3.7772088408813424`*^9}, {3.7772094837413216`*^9, 
   3.777209487756629*^9}, {3.7772181670325403`*^9, 3.7772181721159835`*^9}, {
   3.7772186343496795`*^9, 3.7772187051551533`*^9}, {3.7772187479746017`*^9, 
   3.7772187790425053`*^9}, {3.777218958763965*^9, 3.7772189866831264`*^9}, {
   3.777219019916438*^9, 3.7772190706456904`*^9}, {3.777219101719536*^9, 
   3.7772191082461095`*^9}, {3.7772192323281384`*^9, 
   3.7772192644327784`*^9}, {3.7772192969304137`*^9, 
   3.7772193023269987`*^9}, {3.7772193814369545`*^9, 3.777219452311511*^9}, {
   3.777219730493354*^9, 3.7772197310728383`*^9}, {3.7772202778832617`*^9, 
   3.7772202833715444`*^9}, {3.777261954571349*^9, 3.7772619849795065`*^9}, {
   3.77726234396531*^9, 3.777262357015914*^9}, {3.7772636737680902`*^9, 
   3.7772637188874197`*^9}, {3.7772637547006407`*^9, 
   3.7772638498622403`*^9}, {3.7772640050166073`*^9, 3.777264006528591*^9}, {
   3.777264046961378*^9, 3.77726406495252*^9}, {3.777266869774967*^9, 
   3.7772668750827713`*^9}, {3.7772674487226725`*^9, 
   3.7772674781958494`*^9}, {3.7772675087032313`*^9, 
   3.7772675328137836`*^9}, {3.7772897351531415`*^9, 3.7772897396660748`*^9}, 
   3.7772898181586885`*^9, {3.777289942249778*^9, 3.777289969885913*^9}, {
   3.777290014820979*^9, 3.7772900732068744`*^9}, {3.7772902292519803`*^9, 
   3.7772902499396544`*^9}, {3.777290364493809*^9, 3.7772903662590823`*^9}, {
   3.777290470114333*^9, 3.7772904732589273`*^9}, {3.7772905498770175`*^9, 
   3.777290629285652*^9}, {3.7772907167936187`*^9, 3.7772911185342093`*^9}, {
   3.777291173510193*^9, 3.777291262052396*^9}, {3.7772912927712374`*^9, 
   3.777291312307031*^9}, 3.7772914332934237`*^9, {3.777291489554963*^9, 
   3.777291504998664*^9}, {3.7772917253423758`*^9, 3.7772917945568113`*^9}, {
   3.7772918253095264`*^9, 3.7772918706482735`*^9}, {3.777291936098228*^9, 
   3.7772919397903676`*^9}, {3.7772919857833524`*^9, 
   3.7772921015058737`*^9}, {3.7772926586279416`*^9, 3.777292763197296*^9}, {
   3.7773553227355742`*^9, 3.7773553577983646`*^9}, {3.777355391669306*^9, 
   3.7773554517103634`*^9}, {3.777355571234541*^9, 3.7773555748457613`*^9}, {
   3.7773604116275606`*^9, 3.7773604176601305`*^9}, {3.77736099473905*^9, 
   3.777361012170968*^9}, {3.7773610468423853`*^9, 3.777361198214116*^9}, {
   3.777361229903042*^9, 3.777361266627672*^9}, {3.7773614461043406`*^9, 
   3.7773614487586017`*^9}, {3.777361808750428*^9, 3.777361810195012*^9}, {
   3.777373089843292*^9, 3.7773731342316113`*^9}, {3.7773758349426727`*^9, 
   3.777376075802987*^9}, {3.7773764601565337`*^9, 3.777376461477523*^9}, {
   3.777376595266379*^9, 3.777376613446789*^9}, {3.777376659169614*^9, 
   3.777376664607546*^9}, {3.7773770262295723`*^9, 3.777377047205464*^9}, {
   3.7773773360823183`*^9, 3.7773773362798343`*^9}, {3.7773773781149273`*^9, 
   3.777377676364505*^9}, {3.7773777641210203`*^9, 3.7773777758307004`*^9}, 
   3.7773778591847415`*^9, {3.7773779813874693`*^9, 3.777377988283576*^9}, {
   3.777378504817765*^9, 3.777378568219347*^9}, {3.777379023455084*^9, 
   3.7773790642055244`*^9}, {3.7773792133606143`*^9, 3.777379247247969*^9}, {
   3.777379606068428*^9, 3.77737960883624*^9}, {3.777379726015196*^9, 
   3.777379908495843*^9}, {3.7773800034910054`*^9, 3.7773801196216497`*^9}, 
   3.777380184685319*^9, {3.77738062967465*^9, 3.777380685546166*^9}, {
   3.777380852729165*^9, 3.777380863004466*^9}, {3.7773809399296026`*^9, 
   3.7773809488397126`*^9}, {3.777445422184258*^9, 3.777445473017681*^9}, {
   3.777445694486599*^9, 3.7774456951169133`*^9}, {3.777445781924409*^9, 
   3.7774457989425764`*^9}, 3.7774470615135255`*^9, {3.777447706477621*^9, 
   3.777447713386139*^9}, {3.7774477530240774`*^9, 3.7774478102918944`*^9}, {
   3.777447932396639*^9, 3.7774479366425276`*^9}, {3.777450206044672*^9, 
   3.7774502095054617`*^9}, {3.777450387921694*^9, 3.777450448450479*^9}, {
   3.7774510092430086`*^9, 3.777451015406526*^9}, {3.7774515939389343`*^9, 
   3.777451608210269*^9}, {3.7774516697727413`*^9, 3.7774517008755507`*^9}, {
   3.7774518135885134`*^9, 3.777451817380844*^9}, {3.777452094420721*^9, 
   3.7774521423293085`*^9}, {3.777452716689483*^9, 3.777452928485049*^9}, {
   3.777452962952811*^9, 3.7774529906352043`*^9}, {3.777453071411366*^9, 
   3.777453076228493*^9}, {3.7774537593942633`*^9, 3.7774537782807407`*^9}, 
   3.7774558875250607`*^9, {3.777456230003372*^9, 3.7774562315093374`*^9}, {
   3.777457530821147*^9, 3.7774577264298115`*^9}, {3.7774577615312653`*^9, 
   3.7774578519981885`*^9}, {3.777457908864355*^9, 3.777457925280449*^9}, {
   3.7774579753833838`*^9, 3.7774580718180013`*^9}, {3.7774582368570485`*^9, 
   3.77745830378307*^9}, 3.777458411538827*^9, {3.7774590037090874`*^9, 
   3.777459004764265*^9}, {3.777459434748828*^9, 3.7774594582479715`*^9}, {
   3.777459926456667*^9, 3.7774599268855476`*^9}, {3.777460211036134*^9, 
   3.7774602118629155`*^9}, {3.7774619141674476`*^9, 
   3.7774619477433095`*^9}, {3.7774742259730606`*^9, 
   3.7774743549663916`*^9}, {3.7775238571004114`*^9, 
   3.7775238668204165`*^9}, {3.777549402383898*^9, 3.777549402885852*^9}, {
   3.77755025296043*^9, 3.7775502657977557`*^9}, {3.777550311930078*^9, 
   3.7775503197561817`*^9}, {3.7775505033260098`*^9, 3.777550520286682*^9}, 
   3.7775505641182475`*^9, {3.7775528409757442`*^9, 3.7775528465268965`*^9}, {
   3.7775530317833133`*^9, 3.777553071913044*^9}, {3.777553366675251*^9, 
   3.7775534392965074`*^9}, {3.777553500644627*^9, 3.777553510323704*^9}, {
   3.777553771592589*^9, 3.7775538071653776`*^9}, {3.777553852211567*^9, 
   3.777553931775676*^9}, {3.777693527578799*^9, 3.7776935773985777`*^9}, {
   3.777693637864698*^9, 3.7776936677950706`*^9}, {3.777706584176346*^9, 
   3.777706639490574*^9}, 3.777708242922058*^9, {3.777708311778857*^9, 
   3.7777084545317316`*^9}, {3.7777088809870133`*^9, 
   3.7777090062559624`*^9}, {3.77770909902081*^9, 3.7777091563624206`*^9}, {
   3.777709211441168*^9, 3.777709606554613*^9}, {3.777709746281073*^9, 
   3.777709761469033*^9}, {3.777710003424184*^9, 3.7777100241547575`*^9}, {
   3.777710917617749*^9, 3.777711358711011*^9}, 3.7777115262791395`*^9, {
   3.7777127844551525`*^9, 3.777712829787886*^9}, {3.7777129215720186`*^9, 
   3.7777130051705713`*^9}, {3.7777138674100614`*^9, 3.777714003667265*^9}, {
   3.777714118794379*^9, 3.777714158922139*^9}, {3.777716510090765*^9, 
   3.7777166951354074`*^9}, {3.7777167605684843`*^9, 3.777716827214526*^9}, {
   3.7777168657505364`*^9, 3.777716966348225*^9}, {3.7777170007532215`*^9, 
   3.777717056312934*^9}, {3.777717127499524*^9, 3.7777171730708237`*^9}, {
   3.7777172248903637`*^9, 3.777717267244566*^9}, {3.7777172976612015`*^9, 
   3.7777174029507313`*^9}, {3.777717436719365*^9, 3.777717477102932*^9}, {
   3.7777175133748164`*^9, 3.777717513934308*^9}, {3.7777175509443197`*^9, 
   3.7777176575375357`*^9}, {3.777717715722824*^9, 3.7777177942563577`*^9}, {
   3.777717876941436*^9, 3.777717879787852*^9}, {3.7777180023159633`*^9, 
   3.7777181212744455`*^9}, 3.777718295339547*^9, {3.7777183288143067`*^9, 
   3.777718329830556*^9}, {3.7777184839392023`*^9, 3.777718547432709*^9}, 
   3.777718608362718*^9, {3.777718644621397*^9, 3.7777186862356195`*^9}, {
   3.7777187427792473`*^9, 3.7777187771304426`*^9}, {3.777718812700262*^9, 
   3.777718827101327*^9}, {3.7777189262481594`*^9, 3.777718934205358*^9}, {
   3.7777189730010023`*^9, 3.7777189910777006`*^9}, {3.777719026728071*^9, 
   3.777719398483512*^9}, {3.7779943678287563`*^9, 3.7779944126288*^9}, {
   3.7779944543982167`*^9, 3.7779944753310013`*^9}, {3.7779945276558127`*^9, 
   3.7779945342244215`*^9}, 3.7779947451357064`*^9, 3.7779948023354435`*^9, {
   3.7779951979690704`*^9, 3.7779951983037977`*^9}, {3.7779952290629697`*^9, 
   3.777995249509361*^9}, {3.7779955024746294`*^9, 3.7779955135112123`*^9}, {
   3.7779956726795917`*^9, 3.77799569563489*^9}, {3.7779957408859043`*^9, 
   3.77799574138675*^9}, {3.777995782797874*^9, 3.7779958595517583`*^9}, {
   3.7779961897240086`*^9, 3.7779962643148375`*^9}, {3.7779964279619694`*^9, 
   3.777996574177764*^9}, {3.7779966113400354`*^9, 3.7779966183962173`*^9}, {
   3.7780411596173534`*^9, 3.778041162153574*^9}, {3.7780418132702045`*^9, 
   3.778041868288145*^9}, 3.7780420003023233`*^9, {3.778042042521475*^9, 
   3.7780420503574915`*^9}, {3.778042356291007*^9, 3.7780424119432955`*^9}, {
   3.7780425798809814`*^9, 3.7780426324564095`*^9}, {3.778043067926842*^9, 
   3.7780431151805325`*^9}, {3.7780431523250914`*^9, 
   3.7780433136508484`*^9}, {3.7780434110455637`*^9, 3.778043413814122*^9}, {
   3.778043505637686*^9, 3.778043508353466*^9}, 3.778044086120117*^9, {
   3.7780441333947544`*^9, 3.7780441814742393`*^9}, {3.778047567116767*^9, 
   3.7780476079454417`*^9}, {3.778047656402502*^9, 3.7780476749439273`*^9}, {
   3.7780482392426796`*^9, 3.7780482616161795`*^9}, {3.778048489159915*^9, 
   3.7780484999041443`*^9}, {3.7780779425736966`*^9, 
   3.7780779557008076`*^9}, {3.778077992565337*^9, 3.7780779960393353`*^9}, {
   3.7780782579401736`*^9, 3.778078287746642*^9}, {3.778078355606365*^9, 
   3.778078382167923*^9}, {3.778078425976531*^9, 3.778078475446081*^9}, {
   3.7780785316562014`*^9, 3.7780785481685457`*^9}, {3.778078607450123*^9, 
   3.778078638742775*^9}, {3.7780786942288647`*^9, 3.77807871676748*^9}, {
   3.778079106004037*^9, 3.7780791072644696`*^9}, {3.7780792287760334`*^9, 
   3.7780792682578473`*^9}, {3.7780795092933664`*^9, 
   3.7780795351157064`*^9}, {3.7780798710853767`*^9, 
   3.7780798743964214`*^9}, {3.7780813381016583`*^9, 3.7780813579358487`*^9}, 
   3.7780815249126697`*^9, {3.7780816007184663`*^9, 3.7780816013732486`*^9}, 
   3.7781443124097033`*^9, {3.778144521107155*^9, 3.77814457689913*^9}, 
   3.77814461752282*^9, {3.778144653391524*^9, 3.7781447047975183`*^9}, {
   3.7781464252103558`*^9, 3.7781465418943276`*^9}, {3.7781465823858075`*^9, 
   3.7781465880394316`*^9}, {3.7781466213132114`*^9, 3.778146686222847*^9}, {
   3.77814716908211*^9, 3.778147247263533*^9}, {3.778147286987336*^9, 
   3.7781472962298775`*^9}, {3.7781473622615075`*^9, 
   3.7781473683923516`*^9}, {3.7781502778339453`*^9, 
   3.7781502795137014`*^9}, {3.778150376652686*^9, 3.778150381063978*^9}, 
   3.778151327327828*^9, {3.7781525500269794`*^9, 3.778152625236741*^9}, {
   3.7781528531347113`*^9, 3.778152860547472*^9}, {3.778152990934607*^9, 
   3.7781530267293453`*^9}, {3.77815325132203*^9, 3.778153292446015*^9}, {
   3.7781536227917128`*^9, 3.778153649271813*^9}, 3.778156100545309*^9, {
   3.779266284712841*^9, 3.7792662907991695`*^9}, {3.7792664035276175`*^9, 
   3.7792664144734592`*^9}, 3.7792664820956182`*^9, {3.7801252460391374`*^9, 
   3.780125298322338*^9}, {3.7826412244271955`*^9, 3.782641244506839*^9}, {
   3.7826452502345233`*^9, 3.7826453014106045`*^9}, {3.7826453428258066`*^9, 
   3.782645387387583*^9}, {3.7826454455699153`*^9, 3.782645511003193*^9}, {
   3.7826455481956882`*^9, 3.782645762490694*^9}, {3.7826457939406977`*^9, 
   3.782645915637066*^9}, {3.7826459628719397`*^9, 3.78264598331625*^9}, {
   3.782646028394874*^9, 3.7826460367515163`*^9}, {3.7826461284384203`*^9, 
   3.7826461298506436`*^9}, {3.782646216757451*^9, 3.7826462753557153`*^9}, 
   3.7826464570854177`*^9, {3.7826470674602013`*^9, 3.7826470726284046`*^9}, {
   3.7826476566633234`*^9, 3.7826476599346085`*^9}, {3.7826477140289297`*^9, 
   3.7826477440218325`*^9}, {3.7826479980517535`*^9, 
   3.7826482486542783`*^9}, {3.7826483209977727`*^9, 3.782648335859972*^9}, {
   3.782650250879388*^9, 3.782650264869936*^9}, 3.782652254000444*^9, {
   3.7826522950865097`*^9, 3.782652427132039*^9}, 3.782652576789838*^9, {
   3.782653473455132*^9, 3.782653474214091*^9}, {3.7826535927154207`*^9, 
   3.782653601309453*^9}, 3.7826538322676315`*^9, {3.7826538635806847`*^9, 
   3.7826538649390526`*^9}, 3.7826545343328533`*^9, {3.782654924220892*^9, 
   3.7826551142421937`*^9}, {3.782655162509063*^9, 3.7826551947280493`*^9}, 
   3.7826553642417126`*^9, {3.7826555010879107`*^9, 3.78265550513807*^9}, {
   3.7826556677373157`*^9, 3.782655735120266*^9}, {3.7826557865903854`*^9, 
   3.782655832136692*^9}, 3.782655879769264*^9, {3.7826559616694603`*^9, 
   3.782655996315197*^9}, {3.7826560397710543`*^9, 3.782656054447795*^9}, 
   3.78265639076499*^9, {3.782656471745634*^9, 3.7826564735228806`*^9}, {
   3.7826565404248905`*^9, 3.782656546128627*^9}, {3.7826566228047495`*^9, 
   3.7826567030349736`*^9}, {3.782656770830114*^9, 3.782656773827098*^9}, 
   3.7826568763427653`*^9, 3.7826569733543468`*^9, {3.7826577925565195`*^9, 
   3.782657903237216*^9}, {3.782657954285616*^9, 3.7826579713519554`*^9}, {
   3.782658034548912*^9, 3.782658148947994*^9}, {3.7826582562013617`*^9, 
   3.782658256343979*^9}, {3.7826585151955876`*^9, 3.782658683669541*^9}, {
   3.782658722998616*^9, 3.7826588512724733`*^9}, {3.7826589053348475`*^9, 
   3.782658911907295*^9}, {3.7826589458834143`*^9, 3.7826589790606523`*^9}, {
   3.7826590217633977`*^9, 3.782659030204852*^9}, {3.782659182044652*^9, 
   3.7826592166762495`*^9}, {3.7826592589501038`*^9, 3.7826593076929617`*^9}, 
   3.782659439318256*^9, {3.78265959076301*^9, 3.782659594507036*^9}, {
   3.7826601803054504`*^9, 3.7826602144043093`*^9}, {3.7827489971547327`*^9, 
   3.782749090173984*^9}, {3.782803157143355*^9, 3.7828032272599525`*^9}, {
   3.7828032819926105`*^9, 3.782803299272416*^9}, {3.782803417628023*^9, 
   3.7828037119427466`*^9}, {3.7828039130850544`*^9, 3.782803916356306*^9}, {
   3.782803950503028*^9, 3.7828041916793075`*^9}, {3.7828042261022863`*^9, 
   3.78280428793998*^9}, 3.782804321871279*^9, {3.7828044431171627`*^9, 
   3.782804553426282*^9}, {3.782804850506158*^9, 3.7828048765514956`*^9}, {
   3.7828049867409334`*^9, 3.782805008841852*^9}, {3.78280504560561*^9, 
   3.7828050538704805`*^9}, {3.7828051152783623`*^9, 
   3.7828051162467346`*^9}, {3.7828051521467714`*^9, 
   3.7828051987451987`*^9}, {3.7828111956918707`*^9, 3.7828112036625338`*^9}, 
   3.7828117588987684`*^9, {3.782811805014493*^9, 3.782811827787607*^9}, 
   3.7828120452323656`*^9, {3.782812255892192*^9, 3.782812270746517*^9}, {
   3.7828123382141657`*^9, 3.7828123598164167`*^9}, 3.782812393988033*^9, 
   3.782812477325287*^9, {3.7828125400665665`*^9, 3.782812619081312*^9}, {
   3.782812672590266*^9, 3.782812767377883*^9}, {3.782812903598418*^9, 
   3.7828129043623743`*^9}, {3.782812941082185*^9, 3.7828129423497963`*^9}, 
   3.782813111095786*^9, {3.782813466590537*^9, 3.7828135005154643`*^9}, {
   3.7828136415760145`*^9, 3.7828137752991133`*^9}, {3.7828138059740524`*^9, 
   3.782813808285887*^9}, {3.782813841446911*^9, 3.7828139513780785`*^9}, {
   3.7828140994150276`*^9, 3.7828141222879333`*^9}, {3.7828142031578703`*^9, 
   3.7828142290117593`*^9}, {3.7828142796065574`*^9, 3.782814287263051*^9}, {
   3.7828143930492506`*^9, 3.7828145467115126`*^9}, {3.7828145831500697`*^9, 
   3.7828145889745083`*^9}, {3.7828146211106415`*^9, 
   3.7828146483767543`*^9}, {3.7828147126060147`*^9, 3.782814780323984*^9}, {
   3.7828148117230997`*^9, 3.7828148262452316`*^9}, {3.7828148789064956`*^9, 
   3.7828149601392937`*^9}, 3.782815250420318*^9, {3.782816719615838*^9, 
   3.7828167202650986`*^9}, 3.782820502687225*^9, {3.7828241395326667`*^9, 
   3.7828241561691933`*^9}, {3.782825482221331*^9, 3.78282549347229*^9}, 
   3.782830475836534*^9, {3.7828305475578012`*^9, 3.7828309052775373`*^9}, {
   3.782892521622525*^9, 3.7828925345308247`*^9}, {3.782892583375331*^9, 
   3.782892652914177*^9}, {3.78289269639174*^9, 3.782892710447513*^9}, {
   3.7828927505828485`*^9, 3.7828927939683266`*^9}, {3.7828928275241566`*^9, 
   3.7828928280158405`*^9}, {3.782892861437239*^9, 3.782892906232169*^9}, {
   3.782892943183219*^9, 3.7828929514109497`*^9}, {3.7828929885858107`*^9, 
   3.782893135259907*^9}, 3.7828933675862*^9, {3.782893672589224*^9, 
   3.782893710155964*^9}, {3.782893774844914*^9, 3.7828937905649176`*^9}, {
   3.782893906676653*^9, 3.782893914447729*^9}, {3.782893966949745*^9, 
   3.7828939670624447`*^9}, {3.7828940662903996`*^9, 
   3.7828942169415045`*^9}, {3.782894250295007*^9, 3.782894251603696*^9}, {
   3.782894290403748*^9, 3.782894290606208*^9}, {3.78289441182848*^9, 
   3.7828944140374584`*^9}, {3.782894472660382*^9, 3.7828944933940496`*^9}, {
   3.7828946916252685`*^9, 3.782894761515874*^9}, 3.7828948321907988`*^9, {
   3.782894896309721*^9, 3.7828949415645695`*^9}, {3.78289518278685*^9, 
   3.7828951911247435`*^9}, {3.78289531789001*^9, 3.7828954318949156`*^9}, {
   3.78289548646904*^9, 3.782895486726379*^9}, {3.782895520583413*^9, 
   3.782895614033495*^9}, {3.782895653721721*^9, 3.782895653920192*^9}, {
   3.7828957224465637`*^9, 3.782895722920329*^9}, {3.782895782033208*^9, 
   3.7828959311730566`*^9}, {3.7828959782716846`*^9, 
   3.7828959828324947`*^9}, {3.782896061439496*^9, 3.7828960661439233`*^9}, {
   3.782896484845501*^9, 3.7828965097223034`*^9}, {3.7828977814112225`*^9, 
   3.7828977984906282`*^9}, {3.7828979463442087`*^9, 3.782898101288474*^9}, {
   3.782898141421246*^9, 3.782898151428502*^9}, {3.7828982133590417`*^9, 
   3.7828983146494617`*^9}, {3.7828983451854296`*^9, 3.782898392631812*^9}, {
   3.7828984328842707`*^9, 3.782898535498212*^9}, {3.782898568298558*^9, 
   3.7828985903307266`*^9}, {3.782898660742508*^9, 3.7828988174564667`*^9}, {
   3.7828988601154175`*^9, 3.7828989628491244`*^9}, {3.7828992790398173`*^9, 
   3.7828993016206093`*^9}, {3.7828994369942913`*^9, 3.782899584812992*^9}, {
   3.7829058047829237`*^9, 3.7829059237340527`*^9}, {3.782907538800331*^9, 
   3.7829076443951683`*^9}, {3.782907763419049*^9, 3.7829079405498004`*^9}, {
   3.782908049353963*^9, 3.7829081271208506`*^9}, {3.782908210138513*^9, 
   3.7829082246718893`*^9}, {3.7829082648739862`*^9, 
   3.7829082738010874`*^9}, {3.7829083110124383`*^9, 
   3.7829083114253635`*^9}, {3.782908358683525*^9, 3.782908387294662*^9}, 
   3.7829086136716337`*^9, {3.782908778961769*^9, 3.7829087808650227`*^9}, {
   3.782909932115225*^9, 3.782909935552041*^9}, {3.7829100597258706`*^9, 
   3.7829100620157504`*^9}, 3.7829102216410055`*^9, {3.7829103853634143`*^9, 
   3.782910389486356*^9}, {3.78291049783784*^9, 3.782910503689189*^9}, {
   3.782910654073781*^9, 3.7829107938861017`*^9}, {3.7829108547445545`*^9, 
   3.782910960148917*^9}, {3.7829109902894025`*^9, 3.78291101433012*^9}, {
   3.782911337967696*^9, 3.7829113468848553`*^9}, {3.78291187374927*^9, 
   3.7829118778353777`*^9}, 3.782912201189997*^9, {3.782912453690806*^9, 
   3.7829124689998984`*^9}, {3.782913117742851*^9, 3.782913118780053*^9}, {
   3.7829131713387423`*^9, 3.7829132440382137`*^9}, {3.782913280808482*^9, 
   3.782913371302747*^9}, 3.782913407701459*^9, {3.7829134755770364`*^9, 
   3.7829134801864414`*^9}, {3.7829135148095675`*^9, 3.7829135254810524`*^9}, 
   3.782914245133604*^9, {3.782914507032768*^9, 3.7829145077957344`*^9}, 
   3.7829146719756145`*^9, {3.78291545580511*^9, 3.782915456238947*^9}, {
   3.782915507887892*^9, 3.78291550893509*^9}, {3.782915952042447*^9, 
   3.7829159537159758`*^9}, {3.782915986008263*^9, 3.782916009397791*^9}, {
   3.7829160403701024`*^9, 3.7829160516344013`*^9}, {3.78291623455105*^9, 
   3.782916302478547*^9}, {3.782916392185631*^9, 3.7829164359807014`*^9}, {
   3.7829165366266813`*^9, 3.7829165664551907`*^9}, {3.782918440139101*^9, 
   3.7829184462737083`*^9}, {3.782919693738288*^9, 3.782919699942696*^9}, {
   3.783003840479787*^9, 3.7830038899148765`*^9}, {3.783008200141306*^9, 
   3.7830082034763885`*^9}, {3.783055490418867*^9, 3.7830555001857862`*^9}, {
   3.7830561882025356`*^9, 3.783056188385047*^9}, {3.7830599257849193`*^9, 
   3.783059926630658*^9}, {3.783060681834733*^9, 3.78306070733951*^9}, {
   3.783060937386856*^9, 3.7830609375544114`*^9}, {3.783061120192688*^9, 
   3.7830611203582177`*^9}, {3.7830618221651354`*^9, 3.783061822397519*^9}, {
   3.783061900430731*^9, 3.783061900684016*^9}, {3.7830623936917796`*^9, 
   3.7830623938224287`*^9}, {3.783062449888421*^9, 3.783062450829877*^9}, {
   3.783062578809389*^9, 3.7830625802685213`*^9}, {3.783083239662073*^9, 
   3.7830832944855676`*^9}, {3.7830833501849566`*^9, 
   3.7830833527580767`*^9}, {3.7830834097259903`*^9, 
   3.7830834139111347`*^9}, {3.7830834727102523`*^9, 3.783083513761281*^9}, {
   3.783083572283883*^9, 3.783083572933155*^9}, {3.783083779437415*^9, 
   3.783084048803094*^9}, {3.7830843267320395`*^9, 3.783084337907176*^9}, {
   3.7830844067109747`*^9, 3.7830845440208855`*^9}, {3.783084583360712*^9, 
   3.783084628804316*^9}, {3.783084719517884*^9, 3.7830847597044897`*^9}, {
   3.7830849016032963`*^9, 3.78308490190452*^9}, {3.7830850590824347`*^9, 
   3.78308505953826*^9}, {3.7830852024344387`*^9, 3.7830852048579655`*^9}, {
   3.7830854186125665`*^9, 3.7830855707128754`*^9}, {3.7830856141424*^9, 
   3.783085652288788*^9}, {3.783086117061367*^9, 3.7830861922336407`*^9}, {
   3.7830863128572803`*^9, 3.783086313614266*^9}, 3.783086472757695*^9, {
   3.7830865219302697`*^9, 3.783086528796376*^9}, {3.7830866225889564`*^9, 
   3.7830866335038223`*^9}, {3.783086678911332*^9, 3.7830866861542187`*^9}, {
   3.7830867293120747`*^9, 3.7830867299952526`*^9}, {3.783086798100752*^9, 
   3.783086854148622*^9}, {3.7830872405966988`*^9, 3.7830872460047584`*^9}, {
   3.7830873116981916`*^9, 3.783087331710743*^9}, 3.7830873846711216`*^9, {
   3.783087457092101*^9, 3.783087577497461*^9}, {3.78308763520662*^9, 
   3.7830876653786097`*^9}, {3.7830877270467615`*^9, 3.783087769543395*^9}, {
   3.7830878772307816`*^9, 3.7830878934513316`*^9}, 3.7830880753911805`*^9, {
   3.783089033361082*^9, 3.7830890429454694`*^9}, {3.7830891417713614`*^9, 
   3.783089246318486*^9}, {3.7830893057213097`*^9, 3.7830893871536856`*^9}, {
   3.783090312259946*^9, 3.7830903165877743`*^9}, {3.7830903634834204`*^9, 
   3.7830904331482515`*^9}, {3.7830905049952865`*^9, 3.783090553776052*^9}, {
   3.783090783303627*^9, 3.7830908200278273`*^9}, {3.783094416558322*^9, 
   3.7830945554273133`*^9}, {3.7830946237596955`*^9, 3.78309472706999*^9}, {
   3.7830947777179766`*^9, 3.783094795742816*^9}, {3.7830948314588614`*^9, 
   3.7830948526694627`*^9}, {3.7830948957383537`*^9, 3.783094921561353*^9}, {
   3.78309496355812*^9, 3.783095014039155*^9}, 3.7830951157147636`*^9, {
   3.7830951841578474`*^9, 3.7830951916687756`*^9}, {3.783095232819801*^9, 
   3.783095276017358*^9}, 3.7830953614519205`*^9, {3.783095411724047*^9, 
   3.7830954232362576`*^9}, {3.783095481453676*^9, 3.7830955007024484`*^9}, {
   3.783095616917572*^9, 3.7830957738597097`*^9}, {3.783095815891461*^9, 
   3.7830959415241003`*^9}, {3.783096003783724*^9, 3.7830961324645214`*^9}, 
   3.7830961999183435`*^9, {3.783096423247328*^9, 3.7830964385704217`*^9}, {
   3.7830964969753323`*^9, 3.7830965309851217`*^9}, {3.78309658224465*^9, 
   3.7830965928208027`*^9}, {3.783096676639171*^9, 3.7830967085869813`*^9}, {
   3.783096801477768*^9, 3.783096930992836*^9}, {3.7830972584701357`*^9, 
   3.783097260187579*^9}, {3.783097422549884*^9, 3.7830977329225273`*^9}, {
   3.783098151380085*^9, 3.783098267285675*^9}, {3.7830984835619783`*^9, 
   3.7830984891380463`*^9}, {3.7830989166193333`*^9, 3.783098959860119*^9}, {
   3.7830990497806835`*^9, 3.783099053137717*^9}, {3.783099232175949*^9, 
   3.7830992380403056`*^9}, {3.7830993762137814`*^9, 3.783099401768491*^9}, {
   3.78309949580618*^9, 3.7830995349705925`*^9}, {3.783099577138859*^9, 
   3.783099640513168*^9}, {3.7830997339115753`*^9, 3.783099738027621*^9}, {
   3.783099979840558*^9, 3.7830999813196006`*^9}, {3.783100196572995*^9, 
   3.7831002772289143`*^9}, {3.78310031608012*^9, 3.7831003331115685`*^9}, {
   3.783100406437052*^9, 3.7831004667506266`*^9}, {3.7831006683613205`*^9, 
   3.783100669068287*^9}, {3.783100709622103*^9, 3.7831008184198885`*^9}, {
   3.7831008706294246`*^9, 3.7831009643183756`*^9}, {3.783101107026017*^9, 
   3.7831011079904337`*^9}, 3.7831011493340454`*^9, {3.78310138067008*^9, 
   3.7831013815387607`*^9}, {3.78310154385658*^9, 3.7831016220999947`*^9}, 
   3.7831016846497936`*^9, {3.7831017184115677`*^9, 3.7831017501678*^9}, {
   3.783101925447373*^9, 3.783101997419568*^9}, {3.783102065260459*^9, 
   3.783102251396392*^9}, 3.7831023103737745`*^9, {3.783102352362563*^9, 
   3.783102352732576*^9}, {3.7831521935364447`*^9, 3.7831522977036037`*^9}, {
   3.7831524533490257`*^9, 3.783152554915677*^9}, {3.7831527633756256`*^9, 
   3.783152783657201*^9}, {3.78315287852236*^9, 3.783152914291979*^9}, {
   3.783153008964439*^9, 3.7831530619066544`*^9}, {3.783153094144865*^9, 
   3.7831531119697113`*^9}, {3.783153143184187*^9, 3.7831532158316298`*^9}, {
   3.783153256654709*^9, 3.7831532813880067`*^9}, {3.7831533537588196`*^9, 
   3.783153361317261*^9}, {3.783153462802524*^9, 3.783153504809825*^9}, 
   3.783153555888278*^9, {3.783153596110341*^9, 3.7831537259160023`*^9}, 
   3.7831537572974663`*^9, {3.783153844070965*^9, 3.783153848137968*^9}, {
   3.7831539502914658`*^9, 3.7831539776946125`*^9}, {3.7831540563655653`*^9, 
   3.7831540975175433`*^9}, {3.7831541276838927`*^9, 
   3.7831541823081694`*^9}, {3.783155873746646*^9, 3.7831558760739436`*^9}, 
   3.783155972981032*^9, {3.78315607408528*^9, 3.783156172755717*^9}, {
   3.783156210671802*^9, 3.7831562122010612`*^9}, {3.783156260410429*^9, 
   3.7831562829667506`*^9}, {3.783156324649783*^9, 3.7831563297563725`*^9}, {
   3.7831563717609673`*^9, 3.7831564164719706`*^9}, {3.7831564785711575`*^9, 
   3.78315653287296*^9}, {3.78316137142309*^9, 3.7831613841440153`*^9}, 
   3.7831614284016285`*^9, {3.783161483806345*^9, 3.783161492440277*^9}, {
   3.78316191261397*^9, 3.7831619179676485`*^9}, {3.7831621150901966`*^9, 
   3.783162137798435*^9}, {3.783162563178275*^9, 3.7831625723377237`*^9}, {
   3.783162614721351*^9, 3.783162638385996*^9}, {3.783162737975556*^9, 
   3.783162786382995*^9}, {3.7831628180203886`*^9, 3.7831628318373713`*^9}, {
   3.7831628762884316`*^9, 3.7831629583817716`*^9}, {3.783163030347212*^9, 
   3.7831630310473385`*^9}, {3.7831633269575605`*^9, 3.783163362446636*^9}, {
   3.783163425241579*^9, 3.7831634708295975`*^9}, {3.7831635165412855`*^9, 
   3.7831635173322077`*^9}, {3.7831635736245317`*^9, 3.783163593075486*^9}, {
   3.7831636727353373`*^9, 3.783163696383066*^9}, {3.783163743249696*^9, 
   3.7831637434282165`*^9}, {3.7831637973389325`*^9, 
   3.7831638139275494`*^9}, {3.78316456353679*^9, 3.7831646101540527`*^9}, {
   3.783164693754364*^9, 3.7831647013560553`*^9}, {3.783164850093041*^9, 
   3.783164901776783*^9}, {3.7831650341461377`*^9, 3.7831650386790433`*^9}, {
   3.7831651456844273`*^9, 3.7831651519865694`*^9}, {3.7831655333411627`*^9, 
   3.783165592180727*^9}, {3.783165799413224*^9, 3.78316601122946*^9}, {
   3.7831660493086033`*^9, 3.7831660906848574`*^9}, {3.783166144355212*^9, 
   3.7831661447272177`*^9}, {3.7831661930389485`*^9, 3.78316626607755*^9}, {
   3.783166464667142*^9, 3.7831665449932156`*^9}, {3.7831666357902627`*^9, 
   3.783166821042577*^9}, {3.783166892276012*^9, 3.7831669643920107`*^9}, {
   3.7831671343342905`*^9, 3.7831672637520056`*^9}, {3.783167328493805*^9, 
   3.783167341099077*^9}, {3.7831674572742233`*^9, 3.783167508837221*^9}, {
   3.783167556140683*^9, 3.7831675733665557`*^9}, {3.78316761121828*^9, 
   3.7831676116541095`*^9}, {3.783167644957*^9, 3.7831677926887093`*^9}, {
   3.783167919750758*^9, 3.783168041479012*^9}, {3.7831680971670055`*^9, 
   3.7831681099737372`*^9}, {3.7831682267841835`*^9, 3.783168249584178*^9}, {
   3.783169591787797*^9, 3.7831695984708834`*^9}, {3.7831696835243235`*^9, 
   3.7831697705714087`*^9}, {3.7831698011246576`*^9, 
   3.7831698313149056`*^9}, {3.7831700174339004`*^9, 3.783170030397214*^9}, {
   3.783173445645149*^9, 3.783173472643937*^9}, {3.783173539330471*^9, 
   3.783173619490983*^9}, 3.783237915116966*^9, 3.7832379899277925`*^9, 
   3.783238038887791*^9, {3.7832380730314646`*^9, 3.783238084608799*^9}, {
   3.783238168728973*^9, 3.783238192031124*^9}, {3.7832383731542616`*^9, 
   3.783238374593624*^9}, {3.783238902385934*^9, 3.7832390357292376`*^9}, {
   3.783239312273757*^9, 3.7832393127879176`*^9}, {3.7832394727310033`*^9, 
   3.783239486659909*^9}, {3.7832397340389137`*^9, 3.7832397766542854`*^9}, {
   3.783239825481575*^9, 3.783239854719821*^9}, {3.783241810474144*^9, 
   3.783241854715763*^9}, {3.783254773699931*^9, 3.783254845042369*^9}, {
   3.7832551914029636`*^9, 3.7832551934095993`*^9}, {3.7832578100447187`*^9, 
   3.7832578111393194`*^9}, 3.78325810107343*^9, 3.783304682951459*^9, {
   3.7833053030751724`*^9, 3.7833053075681524`*^9}, {3.7833433928269587`*^9, 
   3.783343419920231*^9}, {3.7833435657773547`*^9, 3.783343573141045*^9}, {
   3.7833441286227045`*^9, 3.7833441599266853`*^9}, {3.783344213302085*^9, 
   3.783344263700887*^9}, {3.783404876382697*^9, 3.7834049144051094`*^9}, {
   3.7834049685592556`*^9, 3.783405036834155*^9}, {3.783405237041499*^9, 
   3.783405246059625*^9}, {3.7834053127894907`*^9, 3.7834053157536116`*^9}, {
   3.7834056357207937`*^9, 3.7834056514248486`*^9}, {3.7834057014151697`*^9, 
   3.7834057419294825`*^9}, {3.7834059951568265`*^9, 3.783406000276182*^9}, {
   3.783429533416204*^9, 3.783429536053154*^9}, 3.7834295879069977`*^9, {
   3.7834296190128226`*^9, 3.7834297315598516`*^9}, {3.7834298922378497`*^9, 
   3.7834298924941273`*^9}, {3.7834299733374257`*^9, 
   3.7834299748164988`*^9}, {3.7834300212821255`*^9, 
   3.7834300214890485`*^9}, {3.7834300819296217`*^9, 3.783430100602194*^9}, {
   3.783430579408439*^9, 3.783430621566786*^9}, {3.7834306569691305`*^9, 
   3.78343069317564*^9}, {3.783430921231218*^9, 3.78343092317933*^9}, {
   3.783431031577341*^9, 3.783431075886281*^9}, {3.783431182976376*^9, 
   3.783431183109054*^9}, {3.7834312215671844`*^9, 3.783431222264367*^9}, {
   3.7834312702201195`*^9, 3.7834312705781355`*^9}, {3.783431301547315*^9, 
   3.7834313021317973`*^9}, {3.7834313691229987`*^9, 3.783431369289562*^9}, {
   3.783431412467098*^9, 3.7834314126186905`*^9}, {3.7834315196026273`*^9, 
   3.783431519821044*^9}, {3.7836642387851934`*^9, 3.7836642924510193`*^9}, {
   3.7836659321871023`*^9, 3.7836659698793125`*^9}, {3.783666331089718*^9, 
   3.7836663533407536`*^9}, {3.783666503974842*^9, 3.783666509788288*^9}, {
   3.783667118016568*^9, 3.7836671535475645`*^9}, {3.7836754581715307`*^9, 
   3.783675483300355*^9}, {3.783676902204651*^9, 3.7836769099509273`*^9}, {
   3.783700026193676*^9, 3.7837000271790667`*^9}, {3.7837001059084263`*^9, 
   3.7837001104044065`*^9}, {3.7837002129515758`*^9, 
   3.7837002247659717`*^9}, {3.7837029436479445`*^9, 3.7837029463418427`*^9}, 
   3.7837031928324566`*^9, {3.783706652034446*^9, 3.7837066689462376`*^9}, {
   3.7837068411572723`*^9, 3.783706842610389*^9}, {3.78375235517667*^9, 
   3.7837523607038827`*^9}, {3.7837979826108923`*^9, 
   3.7837979839483166`*^9}, {3.7838616779158363`*^9, 3.783861679093685*^9}, {
   3.783862092381318*^9, 3.783862092938826*^9}, {3.7838623299367924`*^9, 
   3.7838623562224765`*^9}, {3.7838627056547003`*^9, 
   3.7838627170980935`*^9}, {3.783862824394063*^9, 3.783862824456895*^9}, {
   3.7838629372890577`*^9, 3.7838629374615946`*^9}, {3.7838637305761275`*^9, 
   3.783863733127274*^9}, {3.7855944105138984`*^9, 3.785594411020545*^9}, 
   3.785594810039154*^9, 3.785594937264089*^9, {3.7855951570027437`*^9, 
   3.785595174389265*^9}, {3.7855961853245487`*^9, 3.7855962046139936`*^9}, {
   3.785596257456703*^9, 3.785596283014395*^9}, {3.7855972792883863`*^9, 
   3.785597326302761*^9}, {3.785597622692477*^9, 3.785597633577429*^9}, 
   3.7855978487592187`*^9, {3.78559787876604*^9, 3.785597887055882*^9}, {
   3.7855979464859953`*^9, 3.7855979471123667`*^9}, 3.7855982331477814`*^9, {
   3.78559844141008*^9, 3.7855984708873205`*^9}, {3.785598981344689*^9, 
   3.785599003521411*^9}, {3.7856445645183754`*^9, 3.7856446243443174`*^9}, {
   3.7856512075123367`*^9, 3.785651211566501*^9}, {3.785651972383686*^9, 
   3.785652049296565*^9}, 3.8454252741384163`*^9, {3.8456134758781996`*^9, 
   3.8456134816060486`*^9}, 3.8456176441327543`*^9},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[94]:=",ExpressionUUID->"5b3167ee-900b-4027-a077-40cdfc03cb95"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"edgesWithLR", "[", 
     RowBox[{"n_", ",", "mList_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "newEdges", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "#"}], "}"}], "&"}], ",", "mList"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"rightEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberRight", ",", 
          RowBox[{"Cases", "[", 
           RowBox[{"newEdges", ",", 
            RowBox[{"{", 
             RowBox[{"a_", ",", 
              RowBox[{"left", "[", "b_", "]"}]}], "}"}]}], "]"}], " ", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"leftEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberLeft", ",", 
          RowBox[{"Cases", "[", 
           RowBox[{"newEdges", ",", 
            RowBox[{"{", 
             RowBox[{"a_", ",", 
              RowBox[{"right", "[", "b_", "]"}]}], "}"}]}], "]"}], " ", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"newEdges", ",", "rightEdges", ",", "leftEdges"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"newEdges", ",", 
          RowBox[{"Reverse", "  ", "/@", " ", "newEdges"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"DirectedEdge", " ", "@@@", "newEdges"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DeleteDuplicates", "@", "newEdges"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8459660882322474`*^9, 3.845966113168236*^9}, {
   3.8459713194550047`*^9, 3.8459713253248925`*^9}, 3.8459713786231723`*^9},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[95]:=",ExpressionUUID->"be9277a0-95b7-4e02-a2e3-af046510c2ce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.845437226641659*^9, 3.8454372335621605`*^9}, {
   3.8454372776819153`*^9, 3.845437297750497*^9}, {3.845437337444112*^9, 
   3.8454373845506525`*^9}, 3.8454374978383374`*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"84810bf2-a64d-4f8c-8fdd-1cf91e9d36a5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"chainParastichyCount", "[", 
      RowBox[{"front_", ",", "neighbourAssociations_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pairs", ",", "lookup"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"bareNumber", ",", "front"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"(", " ", 
          RowBox[{"Partition", "[", 
           RowBox[{"pairs", ",", "2", ",", "1"}], "]"}], " ", ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"DirectedEdge", " ", "@@@", "pairs"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Cases", "[", 
          RowBox[{"pairs", ",", 
           RowBox[{"Except", "[", 
            RowBox[{"a_", "\[DirectedEdge]", "a_"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lookup", " ", "=", " ", 
         RowBox[{"KeyMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"bareNumber", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"neighbourAssociations", "[", "DEdgeAngle", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", 
         RowBox[{"(", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lookup", "[", "#", "]"}], "&"}], ",", "pairs"}], "]"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{"#", "<", 
               RowBox[{"1", "/", "4"}]}], ",", "Up", ",", "Down"}], "]"}], 
            "&"}], ",", "pairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "pairs", "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Values", "@", 
         RowBox[{"Counts", "[", "pairs", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845967284599962*^9, 3.8459674475034094`*^9}, {
  3.845967495896744*^9, 3.845967504648801*^9}, {3.8460404578948097`*^9, 
  3.8460404692605324`*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[96]:=",ExpressionUUID->"5615abe2-38df-4d14-a0d1-80e04fc21d15"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotateList", "[", 
     RowBox[{"list_", ",", "element_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pos", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"list", ",", "element"}], "]"}]}], ",", 
         RowBox[{"Return", "[", "list", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pos", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"First", "@", 
          RowBox[{"Position", "[", 
           RowBox[{"list", ",", "element"}], "]"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Drop", "[", 
          RowBox[{"list", ",", 
           RowBox[{"pos", "-", "1"}]}], "]"}], ",", 
         RowBox[{"Take", "[", 
          RowBox[{"list", ",", 
           RowBox[{"pos", "-", "1"}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7834140531073914`*^9, 3.7834140539317136`*^9}, {
  3.7834142739722977`*^9, 3.7834142928824863`*^9}, {3.7834163285072937`*^9, 
  3.7834165998215065`*^9}, {3.7834166399613857`*^9, 3.78341664723638*^9}, {
  3.7834167282237244`*^9, 3.7834168414462476`*^9}, {3.7834171035469646`*^9, 
  3.783417106402382*^9}, {3.846040484006009*^9, 3.846040484396546*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[97]:=",ExpressionUUID->"b01a5813-31ae-44b2-8bca-c9f463e8c4c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "assumes", " ", "each", " ", "node", " ", "sits", " ", "on", " ", "one", 
     " ", "to", " ", "its", " ", "left", " ", "and", " ", "one", " ", "to", 
     " ", "its", " ", "right"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
    "and", " ", "we", " ", "only", " ", "allow", " ", "going", " ", 
     "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"findGraphFront", "[", 
      RowBox[{"firstNumber_", ",", "neighbourAssociations_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastNumber", ",", "nextCoinNumber", ",", "thisFront"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thisFront", " ", "=", " ", 
         RowBox[{"{", "firstNumber", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "<", "50"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lastNumber", "=", "  ", 
            RowBox[{"Last", "[", " ", "thisFront", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextCoinNumber", "=", " ", 
            RowBox[{"nextInChainGraph", "[", 
             RowBox[{"lastNumber", ",", "neighbourAssociations"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MissingQ", "[", "nextCoinNumber", "]"}], ",", 
             RowBox[{"Return", "[", "nextCoinNumber", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"thisFront", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"thisFront", ",", "nextCoinNumber"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"IntegerQ", "[", "nextCoinNumber", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nextCoinNumber", "=", 
               RowBox[{"bareNumber", "[", "nextCoinNumber", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"thisFront", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"thisFront", ",", "nextCoinNumber"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nextCoinNumber", "==", "firstNumber"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "==", "50"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<fGF at 50 for\>\"", ",", "firstNumber"}], "]"}], ";", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "\"\<k50\>\"", "]"}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "thisFront"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextInChainGraph", "[", 
      RowBox[{"lastNumber_", ",", "neighbourAssociations_"}], "]"}], "  ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "allOutwardEdges", ",", "rightEdgesByAngle", ",", "nextEdge", ",", 
         "nextCoinNumber"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allOutwardEdges", "=", 
         RowBox[{"EdgeList", "[", " ", 
          RowBox[{
           RowBox[{"neighbourAssociations", "[", "ContactGraph", "]"}], ",", 
           RowBox[{
            RowBox[{"bareNumber", "[", "lastNumber", " ", "]"}], 
            "\[DirectedEdge]", " ", "_"}]}], "  ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdgesByAngle", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"Association", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", 
               RowBox[{
                RowBox[{"neighbourAssociations", "[", "DEdgeAngle", "]"}], 
                "[", "#", "]"}]}], "&"}], ",", "allOutwardEdges"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rightEdgesByAngle", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"rightEdgesByAngle", ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"1", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rightEdgesByAngle", "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<noRightOutward\>\"", "]"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nextEdge", " ", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Keys", "[", "rightEdgesByAngle", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nextCoinNumber", "  ", "=", " ", 
         RowBox[{"Last", "[", "nextEdge", "]"}]}], ";", "\[IndentingNewLine]",
         "nextCoinNumber"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845959962629813*^9, 3.8459600008631306`*^9}, {
  3.8459600900493946`*^9, 3.8459601976185093`*^9}, {3.845960230176862*^9, 
  3.8459602766472645`*^9}, {3.845960373677277*^9, 3.84596039825334*^9}, {
  3.8459604472225914`*^9, 3.845960475536664*^9}, {3.845960552381359*^9, 
  3.8459606012950425`*^9}, {3.845960670531965*^9, 3.845960726339073*^9}, {
  3.8459615308513613`*^9, 3.8459615352565746`*^9}, {3.845961855170014*^9, 
  3.8459618551750755`*^9}, {3.8459829025944595`*^9, 3.8459829079633613`*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[98]:=",ExpressionUUID->"ab42ed20-266b-4450-8257-d24d04102258"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addCoinsToState", "[", 
     RowBox[{"state_", ",", "nextCoinSet_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "state"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"res", "[", "Coins", "]"}], " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"state", "[", "Coins", "]"}], ",", "nextCoinSet"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       RowBox[{
        RowBox[{"res", "[", "CoinAssociation", "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"state", "[", "CoinAssociation", "]"}], ",", 
          RowBox[{"Association", "@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], "->", "#"}], "&"}], ",", 
             "nextCoinSet"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"c76eea4f-2d81-4606-a338-962eed944458"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"updateNeighbourFunction", "[", 
     RowBox[{"nextCoin_", ",", "nextCoinLowerNeighbours_", ",", "run_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "coinCollection", ",", "newEdges", ",", "nextCoinSet", ",", 
        "para2", ",", "nodeAssociation", ",", "thisChain", ",", 
        "coinNumberPairAngle", ",", "newEdgeAngles", ",", "newRun"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"coinNumber", "[", "nextCoin", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextCoinSet", " ", "=", " ", 
        RowBox[{"coinWithConeTranslations", "[", 
         RowBox[{"nextCoin", ",", "run"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nodeAssociation", " ", "=", 
        RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"coinCollection", "=", " ", 
          RowBox[{"nodeAssociation", "[", "Coins", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coinCollection", " ", "=", " ", 
          RowBox[{"Join", "[", 
           RowBox[{"coinCollection", ",", "nextCoinSet"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "Coins", "]"}], "=", 
          "coinCollection"}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"nodeAssociation", " ", "=", " ", 
        RowBox[{"addCoinsToState", "[", 
         RowBox[{"nodeAssociation", ",", "nextCoinSet"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newRun", " ", "=", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newRun", "[", "\"\<State\>\"", "]"}], "=", " ", 
        "nodeAssociation"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "extra", " ", "copy", " ", "made", " ", "so", " ", "getCoinFromRun", 
          " ", "can", " ", "lookup", " ", "coin"}], ",", " ", 
         RowBox[{"sigh", " ", "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"edgesWithLR", "[", 
         RowBox[{"n", ",", "nextCoinLowerNeighbours"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinNumberPairAngle", "[", 
         RowBox[{"coinm_", ",", "coinn_"}], "]"}], " ", ":=", " ", 
        RowBox[{"coinPairAngle", "[", " ", 
         RowBox[{
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"coinm", ",", "newRun"}], "]"}], ",", 
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"coinn", ",", "newRun"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newEdgeAngles", " ", "=", 
        RowBox[{"Association", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", " ", 
             RowBox[{"coinNumberPairAngle", "[", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
           "newEdges"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "DEdgeAngle", "]"}], "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "DEdgeAngle", "]"}], ",", 
          "newEdgeAngles"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "ContactGraph", "]"}], "=", " ", 
        RowBox[{"EdgeAdd", "[", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "ContactGraph", "]"}], ",", 
          "newEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coinZ", "[", 
           RowBox[{"nextCoin", ",", 
            RowBox[{
             RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
             "]"}]}], "]"}], ">", 
          RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}], "=", " ", 
          RowBox[{"coinZ", "[", 
           RowBox[{"nextCoin", ",", 
            RowBox[{
             RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
             "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"thisChain", " ", "=", " ", 
        RowBox[{"findGraphFront", "[", 
         RowBox[{
          RowBox[{"coinNumber", "[", 
           RowBox[{"First", "[", "nextCoinSet", "]"}], "]"}], ",", 
          "nodeAssociation"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"nodeAssociation", "[", "ChainsByCoinNumber", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"para2", ",", 
          RowBox[{
           RowBox[{"coinNumber", "[", "nextCoin", "]"}], "->", 
           "thisChain"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "ChainsByCoinNumber", "]"}], " ", "=",
         " ", "para2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"nodeAssociation", "[", "Parastichy", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"para2", "[", 
         RowBox[{"coinNumber", "[", "nextCoin", "]"}], "]"}], " ", "=", 
        RowBox[{"chainParastichyCount", "[", 
         RowBox[{"thisChain", ",", "nodeAssociation"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "Parastichy", "]"}], " ", "=", " ", 
        "para2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "nodeAssociation", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"f6641d9c-01c5-4a74-8331-fd6c0316d706"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"chainRegionDistanceFunction", "[", 
      RowBox[{"chainNumbers_", ",", "run_", ",", 
       RowBox[{"dilation_", ":", "1"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"chainAndLRcoins", ",", "disks", ",", "iboundaryMesh"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chainAndLRcoins", "=", " ", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"getCoinAndCopiesByNumber", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "Coins", 
                 "]"}]}], "]"}], "\[IndentingNewLine]", "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"getCoinAndCopiesFromRun", "[", 
                RowBox[{"#", ",", "run"}], "]"}], "\[IndentingNewLine]", 
               "&"}], ",", "chainNumbers"}], "]"}], ",", "1"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"disks", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"Last", ",", "chainAndLRcoins"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskboxes", " ", "=", "  ", 
         RowBox[{"Map", "[", 
          RowBox[{"diskColumn", ",", "disks"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"iboundaryMesh", " ", "=", " ", 
         RowBox[{"DiscretizeRegion", "@", 
          RowBox[{"RegionUnion", "[", "diskboxes", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RegionDistance", "[", "iboundaryMesh", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskColumn", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xymin", ",", "xymax"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xymin", "=", " ", 
         RowBox[{"xy", " ", "-", " ", 
          RowBox[{"{", 
           RowBox[{"r", ",", 
            RowBox[{"3", " ", "r"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xymax", " ", "=", " ", 
         RowBox[{"xy", "+", " ", 
          RowBox[{"{", 
           RowBox[{"r", ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"RegionUnion", "[", 
         RowBox[{
          RowBox[{"Disk", "[", 
           RowBox[{"xy", ",", "r"}], "]"}], ",", 
          RowBox[{"Rectangle", "[", 
           RowBox[{"xymin", ",", "xymax"}], "]"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextCoinRadius", "[", 
      RowBox[{"run_", ",", "chainNumbers_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "h1", ",", "h2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"h1", "=", " ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<rFunction\>\"", "]"}], "[", "h1", "]"}]}], ";", 
        "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextCoinAndContacts", "[", 
      RowBox[{"n_", ",", "chainNumbers_", ",", "r_", ",", "run_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "chainAndLR", ",", "touchingDisksXY", "\[IndentingNewLine]", ",", 
         "chainRDF", ",", "diskChainDistance", ",", 
         "disksNotOverlappingChain", ",", "lowerNeighbours"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"chainAndLR", "=", " ", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{"getCoinAndCopiesByNumber", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "Coins", 
                 "]"}]}], "]"}], "\[IndentingNewLine]", "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"getCoinAndCopiesFromRun", "[", 
                RowBox[{"#", ",", "run"}], "]"}], "\[IndentingNewLine]", 
               "&"}], ",", "chainNumbers"}], "]"}], ",", "1"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"Association", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], "->", 
               RowBox[{"Last", "[", "#", "]"}]}], "&"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{"Transpose", ",", 
               RowBox[{"Subsets", "[", 
                RowBox[{"chainAndLR", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"diskdisktouchingPoint", "[", 
             RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", "touchingDisksXY"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"touchingDisksXY", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MissingQ", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "@", 
             RowBox[{"SortBy", "[", 
              RowBox[{"#", ",", "Last"}], "]"}]}], "&"}], ",", 
           "touchingDisksXY"}], "]"}]}], ";", "  ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "assumes", " ", "lower", " ", "touching", " ", "point", " ", "no", 
          " ", "good"}], " ", "*)"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"touchingDisksXY", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], ">=", " ", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], "<=", " ", 
              RowBox[{"1", "/", "2"}]}]}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "now", " ", "exclude", " ", "the", " ", "ones", " ", "that", " ", 
          "overlap", " ", "with", " ", "the", " ", "chain"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"chainRDF", "=", "  ", 
         RowBox[{"chainRegionDistanceFunction", "[", 
          RowBox[{"chainNumbers", ",", "run"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diskChainDistance", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"chainRDF", ",", "touchingDisksXY"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"disksNotOverlappingChain", " ", "=", " ", 
         RowBox[{"Keys", "@", 
          RowBox[{"Select", "[", 
           RowBox[{"diskChainDistance", ",", 
            RowBox[{
             RowBox[{"#", ">=", "r"}], "&"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{"touchingDisksXY", ",", "disksNotOverlappingChain"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "exclude", " ", "any", " ", "that", " ", "have", " ", "support", " ",
           "on", " ", "the", " ", "wrong", " ", "side"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"cx", "[", "np_", "]"}], " ", ":=", " ", 
           RowBox[{"coinDisk", "@", 
            RowBox[{"getCoinByNumber", "[", 
             RowBox[{"np", ",", 
              RowBox[{
               RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "Coins", 
               "]"}]}], "]"}]}]}], " ", ";"}], "\[IndentingNewLine]", "*)"}], 
        RowBox[{
         RowBox[{"cx", "[", "np_", "]"}], " ", ":=", " ", 
         RowBox[{"coinDisk", "@", 
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"np", ",", "run"}], "]"}]}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"angleLR", "[", "angle_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"angle", "<", 
            RowBox[{"1", "/", "2"}]}], ",", "right", ",", "left"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"bothLLorRR", "  ", "=", " ", 
         RowBox[{"Association", "@@", 
          RowBox[{"KeyValueMap", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "->", " ", 
              RowBox[{"(", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"angleLR", "@", 
                 RowBox[{"coinPairAngle", "[", 
                  RowBox[{
                   RowBox[{"cx", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Disk", "[", 
                    RowBox[{"#2", ",", "1"}], "]"}]}], "]"}]}], "===", 
                "\[IndentingNewLine]", 
                RowBox[{"angleLR", "@", 
                 RowBox[{"coinPairAngle", "[", 
                  RowBox[{
                   RowBox[{"cx", "[", 
                    RowBox[{"#1", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
                   RowBox[{"Disk", "[", 
                    RowBox[{"#2", ",", "1"}], "]"}]}], "]"}]}]}], 
               "\[IndentingNewLine]", ")"}]}], "&"}], ",", 
            "touchingDisksXY"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bothLLorRR", " ", "=", " ", 
         RowBox[{"Keys", "@", " ", 
          RowBox[{"Select", "[", 
           RowBox[{"bothLLorRR", ",", "TrueQ"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"touchingDisksXY", ",", "bothLLorRR"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "touchingDisksXY", "]"}], "==", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<No touching disks\>\"", "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", "  ", "=", " ", 
         RowBox[{"SortBy", "[", 
          RowBox[{"touchingDisksXY", ",", "Last"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lowerNeighbours", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"Keys", "[", "touchingDisksXY", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"touchingDisksXY", " ", "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{"touchingDisksXY", ",", 
           RowBox[{"{", 
            RowBox[{"First", "[", 
             RowBox[{"Keys", "[", "touchingDisksXY", "]"}], "]"}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"<|", " ", 
         RowBox[{
          RowBox[{"\"\<CoinNumber\>\"", "->", " ", "n"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<CoinDisk\>\"", "->", " ", 
           RowBox[{"Disk", "[", 
            RowBox[{
             RowBox[{"touchingDisksXY", "[", "lowerNeighbours", "]"}], ",", 
             "r"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<CoinNeighbours\>\"", "->", " ", "lowerNeighbours"}]}], 
         " ", "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskdisktouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy1", ",", "xy2", ",", "r1", ",", "r2", ",", "interdisk"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xy1", ",", "r1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xy2", ",", "r2"}], "}"}]}], "}"}], "=", " ", 
         RowBox[{"List", "@@@", " ", "pairDisks"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"interdisk", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"xy1", "-", "xy2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"interdisk", " ", ">", " ", 
           RowBox[{"r1", " ", "+", " ", "r2", " ", "+", " ", 
            RowBox[{"2", "r"}]}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sTriangle", " ", "=", 
         RowBox[{"SSSTriangle", "[", 
          RowBox[{
           RowBox[{"r", "+", "r2"}], ",", 
           RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"triangle", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@", "sTriangle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"transform", " ", "=", 
         RowBox[{"Composition", "[", 
          RowBox[{
           RowBox[{"TranslationTransform", "[", "xy1", "]"}], ",", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"triangle", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"xy2", "-", "xy1"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"transform", "[", "triangle", "]"}], ")"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"90", " ", "Degree"}], "]"}], "[", 
              RowBox[{"xy2", "-", "xy1"}], "]"}], ",", "xy1"}], "]"}], ")"}], 
          "[", "rTrianglePT", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"pairDisks", ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Disk", "[", 
             RowBox[{"rTrianglePT", ",", "r"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Disk", "[", 
             RowBox[{"lTrianglePT", ",", "r"}], "]"}]}], "}"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"Yellow", ",", 
            RowBox[{"transform", "[", "sTriangle", "]"}]}], "}"}]}], "}"}], 
        "]"}], "\[IndentingNewLine]", "*)"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"571ebe60-a33d-4390-9c37-d8e843a78d41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"oldstyleNextCoinAndContacts", "[", 
    RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "nextCoinByFront", ",", "phi"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<rFunction\>\"",
          "]"}], "[", 
        RowBox[{
         RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"phi", " ", "=", " ", 
       RowBox[{
        RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"nextCoinByFront", " ", "=", "  ", 
       RowBox[{"oldstylePlaceNextCoinCone", "[", "  ", "\[IndentingNewLine]", 
        RowBox[{"n", ",", "\[IndentingNewLine]", 
         RowBox[{"Values", "[", 
          RowBox[{
           RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CoinAssociation",
            "]"}], "]"}], "\[IndentingNewLine]", ",", "r", 
         "\[IndentingNewLine]", ",", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
          "]"}], "\[IndentingNewLine]", ",", "phi", "\[IndentingNewLine]", 
         ",", " ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
          "\"\<cylinderLU\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"<|", " ", 
       RowBox[{
        RowBox[{"\"\<CoinNumber\>\"", "->", 
         RowBox[{"First", "[", "nextCoinByFront", "]"}]}], ",", 
        RowBox[{"\"\<CoinDisk\>\"", "->", 
         RowBox[{"Last", "[", "nextCoinByFront", "]"}]}], ",", 
        RowBox[{"\"\<CoinNeighbours\>\"", "->", 
         RowBox[{"Missing", "[", "]"}]}]}], "|>"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"61917369-d68f-40c2-a75d-03cd8ed7d530"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addNextCoinCone", "[", 
     RowBox[{"arenaAssociation_", ",", "nodeAssociation_"}], "]"}], " ", ":=",
     " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "r", ",", "nextCoin", ",", "nextCoinSet", ",", "nAres", ",", 
        "para2", ",", "phi", ",", "run", ",", "chainNumbers", ",", "lowest", 
        ",", "oldLowest", ",", "nextCoinLowerNeighbours"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"run", "=", " ", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<State\>\"", "->", "nodeAssociation"}], ",", 
          RowBox[{"\"\<Arena\>\"", "->", " ", "arenaAssociation"}]}], 
         "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"n", " ", "=", "  ", 
          RowBox[{"Max", "[", 
           RowBox[{"Map", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"bareNumber", "[", 
               RowBox[{"First", "[", "#", "]"}], "]"}], "&"}], ",", 
             RowBox[{
              RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "Coins", 
              "]"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", " ", 
        RowBox[{"highestCoinNumber", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chainNumbers", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
          "ChainsByCoinNumber", "]"}], "[", "n", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", " ", "=", 
        RowBox[{"n", "+", " ", "1"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"lowest", "=", " ", 
        RowBox[{"Missing", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "[", "chainNumbers", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"r", "=", " ", 
           RowBox[{"nextCoinRadius", "[", 
            RowBox[{"run", ",", "chainNumbers"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lowest", "  ", "=", " ", 
           RowBox[{"nextCoinAndContacts", "[", 
            RowBox[{"n", ",", "chainNumbers", ",", "r", ",", "run"}], "]"}]}],
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"!", 
          RowBox[{"MissingQ", "[", "lowest", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nextCoin", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lowest", "[", "\"\<CoinNumber\>\"", "]"}], ",", 
             RowBox[{"lowest", "[", "\"\<CoinDisk\>\"", "]"}]}], "}"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"nextCoinLowerNeighbours", " ", "=", " ", 
           RowBox[{"lowest", "[", "\"\<CoinNeighbours\>\"", "]"}]}], ";"}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"oldLowest", " ", "=", 
           RowBox[{"oldstyleNextCoinAndContacts", "[", 
            RowBox[{"n", ",", "run"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MissingQ", "[", "oldLowest", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Can't go oldstyle\>\"", ",", " ", "chainNumbers"}],
               "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"nextCoin", " ", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"oldLowest", "[", "\"\<CoinNumber\>\"", "]"}], ",", 
             RowBox[{"oldLowest", "[", "\"\<CoinDisk\>\"", "]"}]}], "}"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"nextCoinLowerNeighbours", " ", "=", " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"coinLowerNeighbourNumbersOld", "[", 
              RowBox[{"nextCoin", ",", " ", 
               RowBox[{"nodeAssociation", "[", "Coins", "]"}], ",", "0.01"}], 
              "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"coinLowerNeighbourNumbers", "[", " ", 
            RowBox[{"nodeAssociation", ",", "nextCoin", ",", "0.01"}], 
            "]"}]}], ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nAres", " ", "=", " ", 
        RowBox[{"updateNeighbourFunction", "[", 
         RowBox[{"nextCoin", ",", "nextCoinLowerNeighbours", ",", "run"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "nAres"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"e24edc4d-4a7e-4a1b-8be1-291b73f482f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stackFrontFromIC", "[", 
     RowBox[{"icCoins_", ",", "arenaAssociation_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "highestCoinZ", ",", "k", ",", "phi", ",", "parastichyTop", ",", 
        "nodeAssociation"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"highestCoinZ", " ", "=", " ", 
        RowBox[{"Max", "[", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coinZ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"arenaAssociation", "[", "\"\<phi\>\"", "]"}]}], "]"}], 
            "&"}], ",", "icCoins"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nodeAssociation", " ", "=", "  ", 
        RowBox[{"Association", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ContactGraph", "->", 
           RowBox[{"Graph", "[", 
            RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"DEdgeAngle", "->", 
           RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"Parastichy", "\[Rule]", 
           RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"ChainsByCoinNumber", " ", "->", "  ", 
           RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"Coins", "\[Rule]", "icCoins"}], "\[IndentingNewLine]", ",", 
          RowBox[{"CoinAssociation", "\[Rule]", 
           RowBox[{"Association", "@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"First", "[", "#", "]"}], "->", "#"}], "&"}], ",", 
              "icCoins"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
          RowBox[{"HighestCoinZ", "->", " ", "highestCoinZ"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "0"}], ",", 
           RowBox[{"k", "<", " ", 
            RowBox[{"arenaAssociation", "[", "\"\<coinMax\>\"", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tim", ",", "nodeAssociation"}], " ", "}"}], " ", "=", 
             " ", 
             RowBox[{"Timing", "[", " ", "\[IndentingNewLine]", 
              RowBox[{"addNextCoinCone", "[", 
               RowBox[{"arenaAssociation", ",", "nodeAssociation"}], "]"}], 
              " ", "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]",
             "\[IndentingNewLine]", 
            RowBox[{"parastichyTop", " ", "=", " ", 
             RowBox[{"KeyTake", "[", 
              RowBox[{
               RowBox[{"nodeAssociation", "[", "Parastichy", "]"}], ",", 
               RowBox[{"Last", "[", 
                RowBox[{"Keys", "@", 
                 RowBox[{"nodeAssociation", "[", "Parastichy", "]"}]}], 
                "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"highestCoinZ", " ", "=", "  ", 
             RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"highestCoinZ", "+", " ", 
                RowBox[{"2", " ", 
                 RowBox[{
                  RowBox[{"arenaAssociation", "[", "\"\<rFunction\>\"", "]"}],
                   "[", "highestCoinZ", "]"}]}]}], ">", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"arenaAssociation", "[", "\"\<cylinderLU\>\"", "]"}],
                  ")"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ProgressIndicator", "[", 
            RowBox[{"highestCoinZ", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"arenaAssociation", "[", "\"\<cylinderLU\>\"", "]"}],
                  ")"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<h\>\"", "->", "highestCoinZ"}], ",", 
           RowBox[{"\"\<r\>\"", "->", 
            RowBox[{
             RowBox[{"arenaAssociation", "[", "\"\<rFunction\>\"", "]"}], "[",
              "highestCoinZ", "]"}]}], ",", " ", "parastichyTop", ",", 
           "tim"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"run", " ", "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<State\>\"", "->", " ", "nodeAssociation"}], ",", 
          RowBox[{"\"\<Arena\>\"", "->", "arenaAssociation"}]}], "|>"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"run", " ", "=", " ", 
        RowBox[{"makeRunContactGraphXY", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", "run"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeRunContactGraphXY", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"newRun", ",", "g", ",", "graphNodeXY"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"g", "=", " ", 
       RowBox[{
        RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"graphNodeXY", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coinXY", "[", 
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{"#", ",", "run"}], "]"}], "]"}], "&"}], ",", 
         RowBox[{"VertexList", "[", "g", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"newRun", "=", "run"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"newRun", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
        "]"}], " ", "=", " ", 
       RowBox[{"Graph", "[", 
        RowBox[{"g", ",", 
         RowBox[{"VertexCoordinates", "\[Rule]", "graphNodeXY"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "newRun"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->
  True,ExpressionUUID->"f701992d-1388-4d72-b20d-5b59e9c0026b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exampleRisingRun", "[", 
     RowBox[{"s_", ",", "r_", ",", "coinMax_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "arenaAssociation", ",", "cylinderLU", ",", "rFunction", ",", "phi", 
        ",", "cylinderCircumferenceFunction", ",", "d1", ",", "d1T", ",", 
        "d2", ",", "icCoins", ",", "nANew"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rFunction", "[", "h_", "]"}], "  ", ":=", " ", 
        RowBox[{"r", " ", "*", " ", 
         RowBox[{"(", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"1", "/", "10"}]}], ")"}], "  ", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"h", "/", "20"}]}], ")"}]}], " ", "+", " ", 
           RowBox[{"1", "/", "10"}]}], ")"}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"phi", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cylinderCircumferenceFunction", "[", "h_", "]"}], " ", ":=", 
        "  ", "1"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"arenaAssociation", " ", "=", " ", 
        RowBox[{"<|", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<rFunction\>\"", "->", "rFunction"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<phi\>\"", "->", "phi"}], "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<coinMax\>\"", "->", " ", "coinMax"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
          "\"\<cylinderCircumferenceFunction\>\"", "->", 
           "cylinderCircumferenceFunction"}], " ", "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<cylinderLU\>\"", "->", " ", "cylinderLU"}]}], 
         "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d1", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          " ", ",", "r"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"d1T", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          " ", ",", "r"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"d2", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"icCoins", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "101"}], ",", "d1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "102"}], ",", "d1T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "d2"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"stackFrontFromIC", "[", 
        RowBox[{"icCoins", ",", "arenaAssociation"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProfile", " ", ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kmax", "=", "50"}], ";", 
      RowBox[{"r0", "=", "0.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"exampleRisingRun", "[", 
       RowBox[{"0.0", ",", "r0", ",", "kmax"}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8459989894544973`*^9, 3.845999061523218*^9}, 
   3.845999127563054*^9, {3.845999200140022*^9, 3.8459992127029066`*^9}, {
   3.845999251090372*^9, 3.8459992534831996`*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[110]:=",ExpressionUUID->"68c375d9-9111-4839-8ff5-7bcf8c7b73ea"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polygon finding ", "Section",
 CellChangeTimes->{{3.8453786666674557`*^9, 3.8453786666884556`*^9}, {
  3.845455511360236*^9, 
  3.8454555175263925`*^9}},ExpressionUUID->"f23e60c9-e599-4f91-b638-\
47ff7a6eb044"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"edgesAboveNode", "[", 
      RowBox[{"state_", ",", "node_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "aboveNodeAngles", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"KeySelect", "[", 
          RowBox[{
           RowBox[{"state", "[", "DEdgeAngle", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "==", "node"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"edges", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"1", "/", "4"}]}], " ", "||", " ", 
             RowBox[{"#", ">", 
              RowBox[{"3", "/", "4"}]}]}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edges", "]"}], "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"#", "-", "1"}], ",", "#"}], "]"}], "&"}], ",", 
           "edges"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Keys", "@", 
          RowBox[{"Sort", "[", "edges", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"edges", ",", "2", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "edges"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8460394379680586`*^9, {3.846070993712396*^9, 3.846070994571568*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[112]:=",ExpressionUUID->"e3905476-e73b-4b6d-a34f-26be800f5a65"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"bareGraphContacts", "[", "state_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "conts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conts", " ", "=", 
         RowBox[{"GroupBy", "[", 
          RowBox[{
           RowBox[{"EdgeList", "[", 
            RowBox[{"state", "[", "ContactGraph", "]"}], "]"}], ",", 
           RowBox[{"First", "->", "Last"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", 
             RowBox[{"Map", "[", 
              RowBox[{"bareNumber", ",", "#"}], "]"}]}], "&"}], ",", 
           "conts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", 
         RowBox[{"KeySelect", "[", 
          RowBox[{"conts", ",", "IntegerQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "conts"}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"brokenGraphContacts", "[", "state_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "conts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"List", "@@@", " ", 
          RowBox[{"EdgeList", "[", 
           RowBox[{"state", "[", "ContactGraph", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"conts", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}]}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Association", "@@", " ", 
          RowBox[{"Map", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"bareNumber", ",", "#"}], "]"}], "->", " ", "#"}], " ",
              "&"}], ",", "conts"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "conts"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.846039431458249*^9, {3.846070995915002*^9, 3.84607099869563*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[113]:=",ExpressionUUID->"bedd4d38-6543-42ae-9e5a-d744943cd8a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"filterFourthPoint", "[", 
     RowBox[{
     "state_", ",", "node_", ",", "bareA_", ",", "fourthPointList_", ",", 
      "bareB_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"{", 
             RowBox[{"node", ",", "bareA", ",", "#", ",", "bareB"}], "}"}]}], 
           "&"}], ",", "fourthPointList"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "multiple", " ", "fourthpoints", " ", "can", " ", "happen", " ", 
         "when", " ", "poly", " ", "winds", " ", "around", " ", "cylinder"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"res", "=", " ", 
        RowBox[{"First", "[", "fourthPointList", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", "res", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barePolygonsFrom2EdgesRun", "[", 
    RowBox[{"run_", ",", "node_", ",", 
     RowBox[{"{", 
      RowBox[{"edgeA_", ",", "edgeB_"}], "}"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bareA", ",", "bareB", ",", "state"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"state", "=", 
       RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"runContacts", " ", "=", 
       RowBox[{"bareGraphContacts", "[", "state", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Last", "[", "edgeA", "]"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"Last", "[", "edgeB", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bareA", "=", " ", 
       RowBox[{"bareNumber", "[", "a", "]"}]}], ";", 
      RowBox[{"bareB", "=", 
       RowBox[{"bareNumber", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", 
         RowBox[{"runContacts", "[", "bareA", "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"runContacts", "[", "bareA", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", 
         RowBox[{"runContacts", "[", "bareB", "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"runContacts", "[", "bareB", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aContacts", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"runContacts", "[", "bareA", "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bContacts", " ", "=", " ", 
       RowBox[{"Complement", "[", " ", 
        RowBox[{
         RowBox[{"runContacts", "[", "bareB", "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"isTriangle", " ", "=", " ", 
       RowBox[{"MemberQ", "[", " ", 
        RowBox[{"aContacts", ",", "bareB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isTriangle", ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}], "}"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fourthPoint", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{"aContacts", ",", "bContacts"}], "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fourthPoint", "]"}], " ", ">", " ", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rhombuses", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"node", ",", "bareA", ",", "#", ",", "bareB"}], "}"}], 
             "&"}], ",", "fourthPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "rhombuses", "]"}]}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"aContactContacts", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"runContacts", ",", "aContacts"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bContactContacts", " ", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"runContacts", ",", "bContacts"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fifthPoint", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{"aContactContacts", ",", "bContacts"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fifthPoint", "]"}], "==", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fourthPoint", " ", "=", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"bContactContacts", ",", "aContacts"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"node", ",", "bareA", ",", 
             RowBox[{"First", "@", "fourthPoint"}], ",", 
             RowBox[{"First", "@", "fifthPoint"}], ",", "bareB"}], "}"}], 
           "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Missing", "[", "\"\<Hexagon or more\>\"", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.846071000178631*^9, 3.8460710011317663`*^9}, {
  3.8460771498480806`*^9, 3.846077237149496*^9}, {3.84622306877801*^9, 
  3.846223125504236*^9}, {3.846223165751069*^9, 3.84622332097777*^9}, {
  3.8462234163933907`*^9, 3.8462234534774303`*^9}, {3.8462234864197054`*^9, 
  3.8462236172092266`*^9}, {3.8462241539532485`*^9, 3.8462242899402494`*^9}, {
  3.8462275416231213`*^9, 3.8462275420450754`*^9}, {3.846228094050808*^9, 
  3.8462281454340143`*^9}, {3.846228377125045*^9, 3.8462283822958393`*^9}, {
  3.8464858622172937`*^9, 3.846485880914465*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[115]:=",ExpressionUUID->"1e918b21-361c-47de-ab16-bd2d7ad3abc8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"computeCylinderEdgesRun", "[", 
     RowBox[{"run_", ",", "poly_", ",", "breakContacts_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"brokenres", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"brokenres", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"breakContacts", ",", 
          RowBox[{"Partition", "[", 
           RowBox[{"poly", ",", "2", ",", "1", ",", "1"}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"<|", " ", 
         RowBox[{
          RowBox[{"\"\<polygonBare\>\"", "->", " ", "poly"}], ",", 
          RowBox[{"\"\<edges\>\"", "->", " ", "brokenres"}]}], "|>"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"derivedPolysFromRun", "[", 
         RowBox[{"res", ",", "run"}], "]"}]}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"polygonsFrom2EdgesRun", "[", 
     RowBox[{"run_", ",", "poly_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"polys", ",", "brokenres", ",", "state"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"polys", "=", " ", 
        RowBox[{"barePolygonsFrom2Edges", "[", 
         RowBox[{"state", ",", 
          RowBox[{"node", "=", 
           RowBox[{"poly", "[", "\"\<node\>\"", "]"}]}], ",", 
          RowBox[{"poly", "[", "\"\<edgePair\>\"", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", "polys", "]"}], ",", 
         RowBox[{"Return", "[", "polys", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bC", " ", "=", " ", 
        RowBox[{"brokenGraphContacts", "[", "state", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"breakContacts", "[", "ab_", "]"}], " ", ":=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"Keys", "[", "bC", "]"}], ",", "ab"}], "]"}], ",", 
          RowBox[{"bC", "[", "ab", "]"}], ",", "ab"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"polys", "  ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"poly", ",", 
            RowBox[{"computeCylinderEdgesRun", "[", 
             RowBox[{"run", ",", "#", ",", "breakContacts"}], "]"}]}], "]"}], 
          "&"}], " ", "/@", " ", "polys"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"polys", " ", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"polys", ",", 
          RowBox[{
           RowBox[{"TrueQ", "[", "#closed", "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "polys", "]"}], "!=", "1"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"Missing", "[", "\"\<No unique closed poly\>\"", "]"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"polys", "=", " ", 
        RowBox[{"First", "[", "polys", "]"}]}], ";", "\[IndentingNewLine]", 
       "polys"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"barePolygonsFrom2Edges", "[", 
    RowBox[{"state_", ",", "node_", ",", 
     RowBox[{"{", 
      RowBox[{"edgeA_", ",", "edgeB_"}], "}"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"bareA", ",", "bareB"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"runContacts", " ", "=", 
       RowBox[{"bareGraphContacts", "[", "state", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"a", " ", "=", " ", 
       RowBox[{"Last", "[", "edgeA", "]"}]}], ";", 
      RowBox[{"b", "=", 
       RowBox[{"Last", "[", "edgeB", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bareA", "=", " ", 
       RowBox[{"bareNumber", "[", "a", "]"}]}], ";", 
      RowBox[{"bareB", "=", 
       RowBox[{"bareNumber", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", 
         RowBox[{"runContacts", "[", "bareA", "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"runContacts", "[", "bareA", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", 
         RowBox[{"runContacts", "[", "bareB", "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"runContacts", "[", "bareB", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aContacts", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"runContacts", "[", "bareA", "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bContacts", " ", "=", " ", 
       RowBox[{"Complement", "[", " ", 
        RowBox[{
         RowBox[{"runContacts", "[", "bareB", "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"isTriangle", " ", "=", " ", 
       RowBox[{"MemberQ", "[", " ", 
        RowBox[{"aContacts", ",", "bareB"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"isTriangle", ",", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}], "}"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fourthPoint", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{"aContacts", ",", "bContacts"}], "]"}], ",", 
         RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fourthPoint", "]"}], " ", ">", " ", "0"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"rhombuses", " ", "=", " ", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"node", ",", "bareA", ",", "#", ",", "bareB"}], "}"}], 
             "&"}], ",", "fourthPoint"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "rhombuses", "]"}]}]}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"aContactContacts", " ", "=", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"runContacts", ",", "aContacts"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bContactContacts", " ", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"runContacts", ",", "bContacts"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fifthPoint", " ", "=", " ", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Intersection", "[", 
          RowBox[{"aContactContacts", ",", "bContacts"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "fifthPoint", "]"}], "==", "1"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fourthPoint", " ", "=", " ", 
          RowBox[{"Complement", "[", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{"bContactContacts", ",", "aContacts"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"node", ",", "bareA", ",", 
             RowBox[{"First", "@", "fourthPoint"}], ",", 
             RowBox[{"First", "@", "fifthPoint"}], ",", "bareB"}], "}"}], 
           "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Missing", "[", "\"\<Hexagon or more\>\"", "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->
  True,ExpressionUUID->"afdfad16-eaf9-424e-b9ba-241f3bdf0148"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"polygonsFrom2Edges", "[", 
      RowBox[{"state_", ",", "poly_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polys", ",", "brokenres"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "deprecated", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"polys", "=", " ", 
         RowBox[{"barePolygonsFrom2Edges", "[", 
          RowBox[{"state", ",", 
           RowBox[{"node", "=", 
            RowBox[{"poly", "[", "\"\<node\>\"", "]"}]}], ",", 
           RowBox[{"poly", "[", "\"\<edgePair\>\"", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "polys", "]"}], ",", 
          RowBox[{"Return", "[", "polys", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bC", " ", "=", " ", 
         RowBox[{"brokenGraphContacts", "[", "state", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"breakContacts", "[", "ab_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "bC", "]"}], ",", "ab"}], "]"}], ",", 
           RowBox[{"bC", "[", "ab", "]"}], ",", "ab"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"polys", "  ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"poly", ",", 
             RowBox[{"computeCylinderEdges", "[", 
              RowBox[{"state", ",", "#", ",", "breakContacts"}], "]"}]}], 
            "]"}], "&"}], " ", "/@", " ", "polys"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"polys", ",", 
           RowBox[{
            RowBox[{"TrueQ", "[", "#closed", "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "polys", "]"}], "!=", "1"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<No unique closed poly\>\"", "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"First", "[", "polys", "]"}]}], ";", "\[IndentingNewLine]", 
        "polys"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"graphPolygons", " ", "[", "state_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polys", ",", "nodes"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<graphPolygons deprecated use graphPolygonsFromRun\>\"", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"nodes", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"VertexList", "[", 
            RowBox[{"state", "[", "ContactGraph", "]"}], "]"}], ",", 
           "IntegerQ"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"graphPolygonsAboveNode", "[", 
             RowBox[{"state", ",", "#"}], "]"}], "&"}], ",", "nodes"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"polys", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MissingQ", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Association", "@@", "polys"}]}], ";", "\[IndentingNewLine]",
         "\[IndentingNewLine]", "polys"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"graphPolygonsAboveNode", "[", 
      RowBox[{"state_", ",", "node_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"edgePairs", ",", "xyN", ",", "res"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"coinXY", "[", 
          RowBox[{"getCoinByNumber", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"state", "[", "Coins", "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgePairs", " ", "=", 
         RowBox[{"edgesAboveNode", "[", 
          RowBox[{"state", ",", "node"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edgePairs", "]"}], "==", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"<|", " ", 
             RowBox[{
              RowBox[{"\"\<node\>\"", "->", " ", "node"}], ",", 
              RowBox[{"\"\<nodeXY\>\"", "->", 
               RowBox[{"xyN", "[", "node", "]"}]}], ",", 
              RowBox[{"\"\<h\>\"", "->", 
               RowBox[{"Last", "[", 
                RowBox[{"xyN", "[", "node", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<nodeCount\>\"", "->", " ", 
               RowBox[{"{", 
                RowBox[{"node", ",", 
                 RowBox[{"First", "[", "#2", "]"}]}], "}"}]}], ",", 
              RowBox[{"\"\<edgePair\>\"", "->", " ", "#1"}]}], "|>"}], "&"}], 
           ",", "edgePairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Association", "@", 
          RowBox[{"Map", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<nodeCount\>\"", "]"}], "->", " ", "#"}], 
             "&"}], ",", "res"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", "  ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"polygonsFrom2Edges", "[", 
             RowBox[{"state", ",", "#"}], "]"}], "&"}], ",", "res"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Normal", "@", "res"}]}], ";", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"computeCylinderEdges", "[", 
      RowBox[{"state_", ",", "poly_", ",", "breakContacts_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"brokenres", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"brokenres", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"breakContacts", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"poly", ",", "2", ",", "1", ",", "1"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"\"\<polygonBare\>\"", "->", " ", "poly"}], ",", 
           RowBox[{"\"\<edges\>\"", "->", " ", "brokenres"}]}], "|>"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"derivedPolys", "[", 
          RowBox[{"res", ",", "state"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  " ", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"derivedPolys", "[", 
      RowBox[{"poly_", ",", "state_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "linePairs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"coinXY", "[", 
          RowBox[{"getCoinByNumber", "[", 
           RowBox[{"n", ",", " ", 
            RowBox[{"state", "[", "Coins", "]"}]}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", "poly"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linePairs", " ", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", 
            RowBox[{"res", "[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"xyN", ",", 
             RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vector", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", ",", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "-", 
                RowBox[{"First", "[", "#", "]"}]}], ")"}], "&"}], ",", 
             "linePairs"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polygon", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", " ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"Accumulate", "@", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"vector", ",", 
                 RowBox[{"-", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"area", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "polygon", "]"}], ",", "polygon", ",", 
           RowBox[{"Area", "[", "polygon", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"closed", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"First", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", "vector"}], "]"}], "]"}]}], " ", "<", 
            "  ", "0.5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<line\>\"", "->", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", 
              ",", 
              RowBox[{"Line", "[", "linePairs", "]"}]}], "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<vector\>\"", "->", "vector"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<zeroPolygon\>\"", "->", "polygon"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<area\>\"", "->", "area"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<closed\>\"", "->", "closed"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"9098af10-d6e5-4946-bcd6-0bfacc11931d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"graphPolygonsAboveNodeFromRun", "[", 
      RowBox[{"run_", ",", "node_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"edgePairs", ",", "xyN", ",", "res", ",", "state"}], "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"coinXY", "[", 
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{"n", ",", " ", "run"}], "]"}], "]"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", " ", 
         RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgePairs", " ", "=", 
         RowBox[{"edgesAboveNode", "[", 
          RowBox[{"state", ",", "node"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edgePairs", "]"}], "==", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"<|", " ", 
             RowBox[{
              RowBox[{"\"\<node\>\"", "->", " ", "node"}], ",", 
              RowBox[{"\"\<nodeXY\>\"", "->", 
               RowBox[{"xyN", "[", "node", "]"}]}], ",", 
              RowBox[{"\"\<h\>\"", "->", 
               RowBox[{"Last", "[", 
                RowBox[{"xyN", "[", "node", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<nodeCount\>\"", "->", " ", 
               RowBox[{"{", 
                RowBox[{"node", ",", 
                 RowBox[{"First", "[", "#2", "]"}]}], "}"}]}], ",", 
              RowBox[{"\"\<edgePair\>\"", "->", " ", "#1"}]}], "|>"}], "&"}], 
           ",", "edgePairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Association", "@", 
          RowBox[{"Map", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<nodeCount\>\"", "]"}], "->", " ", "#"}], 
             "&"}], ",", "res"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", "  ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"polygonsFrom2EdgesRun", "[", 
             RowBox[{"run", ",", "#"}], "]"}], "&"}], ",", "res"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Normal", "@", "res"}]}], ";", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graphPolygonsFromRun", " ", "[", "run_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polys", ",", "nodes"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodes", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"VertexList", "[", 
            RowBox[{
             RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
             "]"}], "]"}], ",", "IntegerQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"graphPolygonsAboveNodeFromRun", "[", 
             RowBox[{"run", ",", "#"}], "]"}], "&"}], ",", "nodes"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"polys", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MissingQ", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Association", "@@", "polys"}]}], ";", "\[IndentingNewLine]",
         "polys"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"derivedPolysFromRun", "[", 
      RowBox[{"poly_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "linePairs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"coinXY", "[", 
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"n", ",", " ", "run"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", "poly"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linePairs", " ", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", 
            RowBox[{"res", "[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"xyN", ",", 
             RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vector", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", ",", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "-", 
                RowBox[{"First", "[", "#", "]"}]}], ")"}], "&"}], ",", 
             "linePairs"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polygon", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", " ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"Accumulate", "@", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"vector", ",", 
                 RowBox[{"-", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"area", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "polygon", "]"}], ",", "polygon", ",", 
           RowBox[{"Area", "[", "polygon", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"closed", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"First", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", "vector"}], "]"}], "]"}]}], " ", "<", 
            "  ", "0.5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<line\>\"", "->", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", 
              ",", 
              RowBox[{"Line", "[", "linePairs", "]"}]}], "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<vector\>\"", "->", "vector"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<zeroPolygon\>\"", "->", "polygon"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<area\>\"", "->", "area"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<closed\>\"", "->", "closed"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.846039364074238*^9, {3.8460710062106466`*^9, 3.8460710178269386`*^9}, {
   3.8460779474951057`*^9, 3.846077966768895*^9}, {3.8460780228033624`*^9, 
   3.8460780372800713`*^9}, {3.8460811304826803`*^9, 
   3.8460811844769945`*^9}, {3.846085514174466*^9, 3.8460855626490183`*^9}, {
   3.8460856113986616`*^9, 3.8460856824127817`*^9}, {3.8460858175646887`*^9, 
   3.8460858868838186`*^9}, {3.846085928854543*^9, 3.846086026454589*^9}, {
   3.846086118218397*^9, 3.8460861460207796`*^9}, {3.846086327558793*^9, 
   3.846086370916082*^9}, {3.846086417064284*^9, 3.846086452168335*^9}, {
   3.8460865019746027`*^9, 3.8460865136324463`*^9}, {3.8460865789611483`*^9, 
   3.8460865830509653`*^9}, {3.846086619667646*^9, 3.84608679280722*^9}, {
   3.8460869757881265`*^9, 3.8460870336041718`*^9}, {3.846087096467902*^9, 
   3.846087096811631*^9}, {3.8460872388761225`*^9, 3.8460873408777094`*^9}, {
   3.846087853638746*^9, 3.846087907955181*^9}, {3.84608798555529*^9, 
   3.8460879958280425`*^9}, {3.8460881942257605`*^9, 
   3.8460882343286066`*^9}, {3.846088278290189*^9, 3.846088385483927*^9}, {
   3.8460884155244102`*^9, 3.8460884169212947`*^9}, {3.8460884707002306`*^9, 
   3.8460885237139053`*^9}, {3.8460885733348722`*^9, 
   3.8460885741316023`*^9}, {3.846088634631323*^9, 3.8460887011381125`*^9}, {
   3.846088732539647*^9, 3.84608878352986*^9}, {3.8460888258295045`*^9, 
   3.8460889208923254`*^9}, 3.8460891082116027`*^9, {3.8460893440497003`*^9, 
   3.846089391212572*^9}, {3.8460894484964256`*^9, 3.846089450558502*^9}, {
   3.8460895043049765`*^9, 3.8460895242464*^9}, {3.8460895952925234`*^9, 
   3.846089834515482*^9}, {3.846089867728051*^9, 3.8460899185374594`*^9}, {
   3.846089954563159*^9, 3.84608998458965*^9}, {3.846090040134672*^9, 
   3.846090041386861*^9}, {3.846090325152096*^9, 3.846090364040694*^9}, {
   3.8460904582150183`*^9, 3.8460904697632837`*^9}, {3.846090569986625*^9, 
   3.846090573470671*^9}, {3.8460908276999197`*^9, 3.8460909930958195`*^9}, {
   3.8460910378694363`*^9, 3.8460911969049363`*^9}, {3.8460912439226933`*^9, 
   3.8460914316745586`*^9}, {3.846091485833419*^9, 3.8460915614842167`*^9}, {
   3.8460915948781514`*^9, 3.8460916340873966`*^9}, {3.8460916915707417`*^9, 
   3.846091694080989*^9}, {3.8460917628413987`*^9, 3.8460917648231916`*^9}, {
   3.8460918646449757`*^9, 3.84609187367647*^9}, {3.8460921439457254`*^9, 
   3.8460921501157756`*^9}, 3.846092491595927*^9, {3.8460925784496956`*^9, 
   3.8460926041146245`*^9}, {3.8460928112326636`*^9, 
   3.8460928136063094`*^9}, {3.8460929525466557`*^9, 3.846093008116851*^9}, {
   3.846180541671257*^9, 3.8461805581534977`*^9}, {3.84618203861445*^9, 
   3.8461820807538724`*^9}, {3.8461821251834803`*^9, 
   3.8461821318381653`*^9}, {3.846218726662593*^9, 3.846218727474856*^9}, 
   3.8462247154086514`*^9, {3.846224894929779*^9, 3.8462251218064528`*^9}, 
   3.846225162000116*^9, {3.846225248443615*^9, 3.846225249521511*^9}, {
   3.8462253588842945`*^9, 3.8462254288430133`*^9}, {3.8462254738253727`*^9, 
   3.8462255481043653`*^9}, {3.8462256236778755`*^9, 
   3.8462257319171104`*^9}, {3.846226064973773*^9, 3.8462261206652718`*^9}, {
   3.846226503115736*^9, 3.846226722497224*^9}, {3.846226859927313*^9, 
   3.846226861380066*^9}, {3.8462269116938305`*^9, 3.846226934030941*^9}, 
   3.846226975428667*^9, {3.846227050000003*^9, 3.8462270591285486`*^9}, {
   3.8462271208734274`*^9, 3.846227124606849*^9}, {3.8462271659608774`*^9, 
   3.8462271808991647`*^9}, {3.846227217287897*^9, 3.846227228129036*^9}, 
   3.846227533796788*^9, {3.846227694359744*^9, 3.8462277207104273`*^9}, {
   3.8462280222732277`*^9, 3.846228025944458*^9}, {3.8462285691352787`*^9, 
   3.846228633981532*^9}, {3.846228671932893*^9, 3.8462287241102448`*^9}, {
   3.8462287731859694`*^9, 3.8462287763414707`*^9}, 3.8462291394412127`*^9, {
   3.846229505720285*^9, 3.846229508125989*^9}, {3.8462295574301167`*^9, 
   3.8462295581174946`*^9}, {3.846229591910795*^9, 3.8462296585750685`*^9}, {
   3.846229724707071*^9, 3.846229754455261*^9}, 3.8462297958023524`*^9, {
   3.8462305734999533`*^9, 3.8462306119019384`*^9}, {3.8464850845239563`*^9, 
   3.8464852498370647`*^9}, {3.8464853609343796`*^9, 3.846485504112321*^9}, {
   3.846485567219529*^9, 3.8464855783387537`*^9}, {3.846485637505988*^9, 
   3.8464856378809447`*^9}, {3.84648574556264*^9, 3.8464857570246944`*^9}, {
   3.846486177267046*^9, 3.8464862096855803`*^9}, {3.8464862508058696`*^9, 
   3.846486275565835*^9}},
 CellLabel->
  "3/19/22 17:20:30 (Local) \
In[125]:=",ExpressionUUID->"4b271e5a-53e7-47b7-a0eb-7c17b370aa30"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.846091697433435*^9},ExpressionUUID->"98492b1e-5b9a-4b99-a091-\
10f8ec283f8b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Pruning
\
\>", "Section",
 CellChangeTimes->{{3.8460707621520834`*^9, 
  3.846070775811489*^9}},ExpressionUUID->"d0565a12-5574-4552-b037-\
4effbe774747"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pruneNodeAssociation", "[", 
      RowBox[{"nodeAssociation_", ",", "pruneNumbers_"}], "]"}], "  ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", " ", "bare"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", "nodeAssociation"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "Parastichy", "]"}], "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "Parastichy", "]"}], ",", "pruneNumbers"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "Coins", "]"}], " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"res", "[", "Coins", "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"pruneNumbers", ",", 
              RowBox[{"bareCoinNumber", "[", "#", "]"}]}], "]"}], " ", 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "CoinAssociation", "]"}], " ", "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "CoinAssociation", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], "=", "  ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"withLRNumbers", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"pruneNumbers", ",", 
           RowBox[{"left", "/@", "pruneNumbers"}], ",", 
           RowBox[{"right", " ", "/@", " ", "pruneNumbers"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "ContactGraph", "]"}], " ", "=", " ", 
         RowBox[{"Subgraph", "[", 
          RowBox[{
           RowBox[{"res", "[", "ContactGraph", "]"}], ",", "withLRNumbers", 
           ",", 
           RowBox[{"AnnotationRules", "\[Rule]", "Inherited"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pruneRun", "[", 
      RowBox[{"run_", ",", "pruneNumbers_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "prunedRun", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prunedRun", " ", "=", " ", "run"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prunedRun", "[", "\"\<State\>\"", "]"}], " ", "=", " ", 
         RowBox[{"pruneNodeAssociation", "[", 
          RowBox[{
           RowBox[{"prunedRun", "[", "\"\<State\>\"", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "prunedRun"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pruneRunByFunction", "[", 
      RowBox[{"run_", ",", "pruneFunction_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pruneNumbers", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pruneNumbers", " ", "=", "  ", 
         RowBox[{"Map", "[", 
          RowBox[{"bareCoinNumber", " ", ",", " ", 
           RowBox[{"Keys", "[", 
            RowBox[{
             RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
             "CoinAssociation", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pruneRun", "[", 
         RowBox[{"run", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"pruneNumbers", ",", 
            RowBox[{
             RowBox[{"pruneFunction", "[", "#", "]"}], "&"}]}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "3/19/22 18:19:06 (Local) \
In[63]:=",ExpressionUUID->"a9ab3c21-00a3-46ec-8866-89bcc4d3930a"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718.5, 831.},
WindowMargins->{{Automatic, -5.25}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"85328bca-52b9-43f5-838a-66c5a2e20559"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 292, 5, 74, "Section",ExpressionUUID->"e55015fc-a79b-4df9-961d-01036e6cf397"],
Cell[875, 29, 362, 11, 83, "Input",ExpressionUUID->"ff2e94a6-5c48-4dce-90d5-bda2729443a1",
 InitializationCell->True],
Cell[1240, 42, 33641, 860, 4465, "Input",ExpressionUUID->"5a0690a5-d5d9-44f5-8771-8e2b05800dcb",
 InitializationCell->True],
Cell[34884, 904, 7324, 179, 1182, "Input",ExpressionUUID->"63ea88af-53a7-423f-8bca-b3bc15d00d81",
 InitializationCell->True],
Cell[42211, 1085, 198, 3, 52, "Input",ExpressionUUID->"290c500d-e234-4dd6-bc8e-7d12becb99a3"],
Cell[42412, 1090, 41971, 630, 671, "Input",ExpressionUUID->"8923fcf7-3a83-4578-b088-d91ab1b058c4",
 InitializationCell->True],
Cell[84386, 1722, 37118, 531, 272, "Input",ExpressionUUID->"5b3167ee-900b-4027-a077-40cdfc03cb95",
 InitializationCell->True],
Cell[121507, 2255, 2289, 54, 315, "Input",ExpressionUUID->"be9277a0-95b7-4e02-a2e3-af046510c2ce",
 InitializationCell->True],
Cell[123799, 2311, 305, 5, 31, "Input",ExpressionUUID->"84810bf2-a64d-4f8c-8fdd-1cf91e9d36a5"],
Cell[124107, 2318, 2864, 71, 419, "Input",ExpressionUUID->"5615abe2-38df-4d14-a0d1-80e04fc21d15",
 InitializationCell->True],
Cell[126974, 2391, 1623, 40, 168, "Input",ExpressionUUID->"b01a5813-31ae-44b2-8bca-c9f463e8c4c1",
 InitializationCell->True],
Cell[128600, 2433, 6292, 143, 922, "Input",ExpressionUUID->"ab42ed20-266b-4450-8257-d24d04102258",
 InitializationCell->True],
Cell[134895, 2578, 1323, 34, 217, "Input",ExpressionUUID->"c76eea4f-2d81-4606-a338-962eed944458",
 InitializationCell->True],
Cell[136221, 2614, 6645, 147, 1222, "Input",ExpressionUUID->"f6641d9c-01c5-4a74-8331-fd6c0316d706",
 InitializationCell->True],
Cell[142869, 2763, 16648, 395, 1999, "Input",ExpressionUUID->"571ebe60-a33d-4390-9c37-d8e843a78d41",
 InitializationCell->True],
Cell[159520, 3160, 2163, 50, 405, "Input",ExpressionUUID->"61917369-d68f-40c2-a75d-03cd8ed7d530",
 InitializationCell->True],
Cell[161686, 3212, 5249, 116, 929, "Input",ExpressionUUID->"e24edc4d-4a7e-4a1b-8be1-291b73f482f1",
 InitializationCell->True],
Cell[166938, 3330, 6758, 153, 1013, "Input",ExpressionUUID->"f701992d-1388-4d72-b20d-5b59e9c0026b",
 InitializationCell->True],
Cell[173699, 3485, 4805, 116, 692, "Input",ExpressionUUID->"68c375d9-9111-4839-8ff5-7bcf8c7b73ea",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[178541, 3606, 216, 4, 74, "Section",ExpressionUUID->"f23e60c9-e599-4f91-b638-47ff7a6eb044"],
Cell[178760, 3612, 2277, 58, 272, "Input",ExpressionUUID->"e3905476-e73b-4b6d-a34f-26be800f5a65",
 InitializationCell->True],
Cell[181040, 3672, 2701, 67, 419, "Input",ExpressionUUID->"bedd4d38-6543-42ae-9e5a-d744943cd8a0",
 InitializationCell->True],
Cell[183744, 3741, 7227, 169, 963, "Input",ExpressionUUID->"1e918b21-361c-47de-ab16-bd2d7ad3abc8",
 InitializationCell->True],
Cell[190974, 3912, 9014, 217, 1286, "Input",ExpressionUUID->"afdfad16-eaf9-424e-b9ba-241f3bdf0148",
 InitializationCell->True],
Cell[199991, 4131, 12359, 298, 1535, "Input",ExpressionUUID->"9098af10-d6e5-4946-bcd6-0bfacc11931d",
 InitializationCell->True],
Cell[212353, 4431, 13148, 272, 1091, "Input",ExpressionUUID->"4b271e5a-53e7-47b7-a0eb-7c17b370aa30",
 InitializationCell->True],
Cell[225504, 4705, 128, 3, 31, "Input",ExpressionUUID->"98492b1e-5b9a-4b99-a091-10f8ec283f8b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225669, 4713, 163, 6, 116, "Section",ExpressionUUID->"d0565a12-5574-4552-b037-4effbe774747"],
Cell[225835, 4721, 4254, 103, 671, "Input",ExpressionUUID->"a9ab3c21-00a3-46ec-8866-89bcc4d3930a",
 InitializationCell->True]
}, Open  ]]
}
]
*)

