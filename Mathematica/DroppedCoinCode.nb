(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    242740,       5231]
NotebookOptionsPosition[    237641,       5134]
NotebookOutlinePosition[    238106,       5152]
CellTagsIndexPosition[    238063,       5149]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Dropped coin model ", "Section",
 CellChangeTimes->{{3.7771818580920444`*^9, 3.7771818869468756`*^9}, {
   3.777444976808712*^9, 3.777444980622511*^9}, {3.77815133774113*^9, 
   3.7781513433467703`*^9}, 
   3.845844314817604*^9},ExpressionUUID->"e55015fc-a79b-4df9-961d-\
01036e6cf397"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[75]:=",ExpressionUUID->"ff2e94a6-5c48-4dce-90d5-bda2729443a1"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"coinD", ",", "coinZ"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinNumber", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", "n"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareCoinNumber", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"bareNumber", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"isPrincipal", "[", "coin_", "]"}], " ", ":=", " ", 
     RowBox[{"IntegerQ", "[", 
      RowBox[{"coinNumber", "[", "coin", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"isBare", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"IntegerQ", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", "n_", "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"left", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareNumber", "[", 
      RowBox[{"right", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"highestCoinNumber", "[", "run_", "]"}], " ", ":=", "  ", 
     RowBox[{"Max", "[", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{"bareNumber", ",", 
        RowBox[{"Keys", "@", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CoinAssociation", 
          "]"}]}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getCoinFromRun", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coinSet", ",", "coinCollection", ",", "\[IndentingNewLine]", 
         "coinAssociation", ",", "coin", ",", "cylinderCircumference"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinAssociation", " ", "=", " ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CoinAssociation", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coin", "=", " ", 
         RowBox[{"coinAssociation", "[", 
          RowBox[{"bareNumber", "[", "n", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "coin", "]"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<gCFR Can't find coin \>\"", ",", " ", "n", ",", 
             RowBox[{"bareNumber", "[", "n", "]"}], ",", "coin", ",", 
             "coinAssociation"}], "]"}], ";", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], 
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cylinderCircumference", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
          RowBox[{"coinH", "[", "coin", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "n", "]"}], "==", " ", "left"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coin", "  ", "=", " ", 
           RowBox[{"coinTranslateL", "[", 
            RowBox[{"coin", ",", 
             RowBox[{
              RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
              "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "n", "]"}], "==", " ", "right"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"coin", "  ", "=", " ", 
           RowBox[{"coinTranslateR", "[", 
            RowBox[{"coin", ",", 
             RowBox[{
              RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
              "]"}], ",", "cylinderCircumference"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "coin", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getCoinFromChain", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", 
     RowBox[{"getCoinFromChain", "[", 
      RowBox[{"n", ",", "run", ",", "\"\<tag\>\""}], "]"}]}], " ", ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getCoinFromChain", "[", 
      RowBox[{"n_", ",", "run_", ",", "tag_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"getCoinFromLookup", "[", 
      RowBox[{"run", ",", 
       RowBox[{
        RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "CurrentChainDisks", 
        "]"}], ",", "n", ",", "tag"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"getCoinFromChain", "[", 
       RowBox[{"n_", ",", "run_", ",", "tag_"}], "]"}], " ", ":=", "  ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "coin", "}"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coin", "=", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
            "CurrentChainDisks", "]"}], "[", 
           RowBox[{"bareNumber", "[", "n", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "coin", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
                 "MostRecentCoin", "]"}], ">", " ", "19"}], " ", "&&", " ", 
               RowBox[{"!", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{
                  RowBox[{"{", "\"\<xy\>\"", "}"}], ",", "tag"}], "]"}]}]}], 
              ",", 
              RowBox[{"Print", "[", 
               RowBox[{
               "tag", ",", " ", "\"\< searching in CoinAssociation for \>\"", 
                ",", "n", " ", ",", "\"\< at \>\"", ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
                 "MostRecentCoin", "]"}]}], "]"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", 
             RowBox[{"getCoinFromRun", "[", 
              RowBox[{"n", ",", "run"}], "]"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "n", "]"}], "==", " ", "left"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coin", " ", "=", " ", 
            RowBox[{"coinTranslateLeft", "[", 
             RowBox[{"run", ",", "coin"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "n", "]"}], "==", "right"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"coin", " ", "=", " ", 
            RowBox[{"coinTranslateRight", "[", 
             RowBox[{"run", ",", "coin"}], "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "coin"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateLeft", "[", 
      RowBox[{"run_", ",", "coin_"}], "]"}], " ", ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"coinTranslateL", "[", 
      RowBox[{"coin", ",", 
       RowBox[{
        RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", "]"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
         "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
        RowBox[{"coinH", "[", "coin", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateRight", "[", 
      RowBox[{"run_", ",", "coin_"}], "]"}], " ", ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"coinTranslateR", "[", 
      RowBox[{"coin", ",", 
       RowBox[{
        RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", "]"}],
        ",", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
         "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
        RowBox[{"coinH", "[", "coin", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateL", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", " ", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"xy", "-", 
          RowBox[{"{", 
           RowBox[{"cylinderCircumference", ",", "0"}], "}"}]}], ",", "r"}], 
        "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"2", "phi"}], "]"}], "[", "xy", "]"}], ",", "r"}], "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateR", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"xy", "+", 
          RowBox[{"{", 
           RowBox[{"cylinderCircumference", ",", "0"}], "}"}]}], ",", "r"}], 
        "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{
            RowBox[{"-", "2"}], "phi"}], "]"}], "[", "xy", "]"}], ",", "r"}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateL", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"left", "[", "n", "]"}], ",", 
       RowBox[{"coinTranslateL", "[", 
        RowBox[{"coin", ",", "phi", ",", "cylinderCircumference"}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTranslateR", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_", ",", 
       "cylinderCircumference_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"right", "[", "n", "]"}], ",", 
       RowBox[{"coinTranslateR", "[", 
        RowBox[{"coin", ",", "phi", ",", "cylinderCircumference"}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8570242779213753`*^9, {3.8570244373894253`*^9, 3.8570244378185997`*^9}, {
   3.857024546147752*^9, 3.8570245649107885`*^9}, 3.8571559652795467`*^9, {
   3.8571563510107164`*^9, 3.8571563527548447`*^9}, {3.857204260851201*^9, 
   3.8572042959232364`*^9}, {3.8572043904398966`*^9, 
   3.8572044725862856`*^9}, {3.857204570637913*^9, 3.857204726404628*^9}, {
   3.85720475858053*^9, 3.8572048089762683`*^9}, {3.8572054433408813`*^9, 
   3.85720547542472*^9}, {3.857205580894614*^9, 3.8572055813155646`*^9}, {
   3.857205648616786*^9, 3.857205702974378*^9}, {3.8572061965827456`*^9, 
   3.857206249042426*^9}, {3.8572067459467177`*^9, 3.857206793520833*^9}, {
   3.8572080083560486`*^9, 3.85720803927551*^9}, {3.857260960053832*^9, 
   3.8572609806924424`*^9}, {3.857261588741517*^9, 3.857261597866849*^9}, {
   3.857478611633952*^9, 3.857478614134404*^9}, 3.8577053855891933`*^9, {
   3.8577056895042257`*^9, 3.85770571268808*^9}, {3.8577057562616816`*^9, 
   3.8577057862004023`*^9}},ExpressionUUID->"5a0690a5-d5d9-44f5-8771-\
8e2b05800dcb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getCoinFromLookup", "[", 
    RowBox[{"run_", ",", "lookup_", ",", "n_", ",", "tag_"}], "]"}], " ", ":=",
    " ", "\[IndentingNewLine]", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "coin", "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coin", "=", " ", 
       RowBox[{"lookup", "[", 
        RowBox[{"bareNumber", "[", "n", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", "coin", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
              "MostRecentCoin", "]"}], ">", " ", "19"}], " ", "&&", " ", 
            RowBox[{"!", 
             RowBox[{"MemberQ", "[", 
              RowBox[{
               RowBox[{"{", "\"\<xy\>\"", "}"}], ",", "tag"}], "]"}]}]}], ",", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "tag", ",", " ", "\"\< searching in run for \>\"", ",", "n", " ",
               ",", "\"\< at \>\"", ",", 
              RowBox[{
               RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
               "MostRecentCoin", "]"}]}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"n", ",", "run"}], "]"}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "n", "]"}], "==", " ", "left"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"coin", " ", "=", " ", 
         RowBox[{"coinTranslateLeft", "[", 
          RowBox[{"run", ",", "coin"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "n", "]"}], "==", "right"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"coin", " ", "=", " ", 
         RowBox[{"coinTranslateRight", "[", 
          RowBox[{"run", ",", "coin"}], "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "coin"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8577053877908487`*^9, 3.857705520542511*^9}, {
  3.8577055634928665`*^9, 3.8577055638549767`*^9}, {3.8577057375285473`*^9, 
  3.8577057431495104`*^9}, {3.8577059158407135`*^9, 
  3.8577059869305787`*^9}},ExpressionUUID->"8bc1d667-742b-4cbc-84af-\
9ee1892c828e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"coinH", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"xy", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinH", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinH", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinD", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", 
     RowBox[{"xy", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinD", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinD", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinR", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", "r"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinR", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"coinR", "[", "coin", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinXY", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", 
        RowBox[{"Disk", "[", 
         RowBox[{"xy_", ",", "r_"}], "]"}]}], "}"}], "]"}], " ", ":=", " ", 
     "xy"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinXY", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{"xy_", ",", "r_"}], "]"}], "]"}], " ", ":=", " ", "xy"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinZ", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "phi_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"xy", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"xy", ".", "xy"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinZ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"coinZ", "[", 
      RowBox[{"coin", ",", "phi"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTheta", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}], ",", "r_"}], "]"}], ",", "phi_"}],
       "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"phi", "\[Equal]", "0"}], ",", 
       RowBox[{"2", "\[Pi]", " ", 
        RowBox[{"coinD", "[", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", "r"}], "]"}], "]"}]}], ",", 
       RowBox[{"ArcTan", "[", 
        RowBox[{"x", ",", "y"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinTheta", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "phi_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"coinTheta", "[", 
      RowBox[{"coin", ",", "phi"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDisk", "[", 
      RowBox[{"{", 
       RowBox[{"n_", ",", "coin_Disk"}], "}"}], "]"}], " ", ":=", " ", 
     "coin"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extendRadius", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy_", ",", "r_"}], "]"}], ",", "inhibition_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Disk", "[", 
      RowBox[{"xy", ",", 
       RowBox[{"r", "+", "inhibition"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"extendRadius", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n_", ",", "coin_Disk"}], "}"}], ",", "inhibition_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"extendRadius", "[", 
      RowBox[{"coin", ",", "inhibition"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinsOverZ", "[", 
      RowBox[{"coinFront_", ",", "z_", ",", "phi_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"coinFront", "[", 
      RowBox[{"[", " ", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"coinZ", "[", 
               RowBox[{"#", ",", "phi"}], "]"}], ">", "z"}], " ", "&"}], ",", 
            "coinFront"}], "]"}], ",", "True"}], "]"}]}], " ", "]"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDistance", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy1_", ",", "r1_"}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"xy2_", ",", "r2_"}], "]"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "v", "}"}], ",", 
       RowBox[{
        RowBox[{"v", "=", 
         RowBox[{"xy1", "-", "xy2"}]}], ";", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"v", ".", "v"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinDistance", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1_", ",", "coin1_Disk"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n2_", ",", "coin2_Disk"}], "}"}]}], "]"}], " ", ":=", 
     RowBox[{"coinDistance", "[", 
      RowBox[{"coin1", ",", "coin2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nearestCoinPair", "[", 
      RowBox[{"coin_", ",", "coinFront_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"coinDistances", ",", "nearestCoins"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coinDistance", "[", 
             RowBox[{"coin", ",", "#"}], "]"}], "&"}], ",", "coinFront"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"coinFront", "[", 
            RowBox[{"[", " ", 
             RowBox[{"Ordering", "[", "coinDistances", "]"}], " ", "]"}], 
            "]"}], ",", "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "nearestCoins"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinLowerPair", "[", 
      RowBox[{"coin_", ",", "coinFront_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nearestCoins", " ", ",", 
         RowBox[{"res", ".", "nearestNumbers"}], ",", "angles"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"nearestCoinPair", "[", 
          RowBox[{"coin", ",", "coinFront"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"isPrincipal", "[", "coin", "]"}]}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"nearestCoins", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"nearestCoins", ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"coinDistance", "[", 
                RowBox[{"#", ",", "coin"}], "]"}], "<", " ", 
               RowBox[{"2.1", " ", 
                RowBox[{"coinR", "[", "#", "]"}]}]}], " ", "&"}]}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nearestNumbers", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"coinNumber", ",", "nearestCoins"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"coinNumber", "[", "coin", "]"}], ",", "nearestNumbers"}], 
          "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"angles", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"coinPairAngle", "[", 
             RowBox[{"coin", ",", "#"}], "]"}], "&"}], ",", "nearestCoins"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"coinNumber", "[", "coin", "]"}], ",", "nearestNumbers", 
           ",", "angles"}], "}"}]}], ";", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinLowerNeighbourNumbers", "[", 
      RowBox[{"state_", ",", "coin_", ",", "tolerance_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coinDistances", ",", "nearestCoins", " ", ",", "coinFront", ",", 
         "nearestNumbers"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"only", " ", "used", " ", "when", " ", "we", " ", 
         RowBox[{"don", "'"}], "t", " ", "have", " ", "a", " ", "chain"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinFront", " ", "=", " ", 
         RowBox[{"Values", "[", 
          RowBox[{"state", "[", "CoinAssociation", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", "  ", 
         RowBox[{"Association", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"coinDistance", "[", 
               RowBox[{"coin", ",", "#"}], "]"}]}], "&"}], ",", "coinFront"}],
            "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{
          RowBox[{"Sort", "[", "coinDistances", "]"}], "-", 
          RowBox[{"Min", "[", "coinDistances", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coinDistances", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"coinDistances", ",", 
           RowBox[{
            RowBox[{"#", "<", "tolerance"}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nearestCoins", " ", "=", " ", 
         RowBox[{"Take", "[", 
          RowBox[{
           RowBox[{"Keys", "[", "coinDistances", "]"}], ",", 
           RowBox[{"UpTo", "[", "3", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nearestNumbers", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"coinNumber", ",", "nearestCoins"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "nearestNumbers"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinPairAngle", "[", 
      RowBox[{"coinm_", ",", "coinn_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xym", ",", "xyn", ",", "v", ",", "theta"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xym", "=", " ", 
         RowBox[{"coinXY", "[", "coinm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xyn", "=", " ", 
         RowBox[{"coinXY", "[", "coinn", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"v", " ", "=", " ", 
         RowBox[{"xyn", " ", "-", " ", "xym"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"ArcTan", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", " ", 
         RowBox[{"theta", "/", 
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theta", "<", "0"}], ",", 
          RowBox[{"theta", " ", "=", " ", 
           RowBox[{"theta", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"theta", " ", "=", "  ", 
         RowBox[{
          RowBox[{"1", "/", "4"}], "-", " ", "theta"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"theta", "<", "0"}], ",", 
          RowBox[{"theta", "=", 
           RowBox[{"theta", "+", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]",
         "theta"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"thetac", "[", "angl_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", 
       RowBox[{
        RowBox[{"res", "=", 
         RowBox[{"angl", "-", " ", 
          RowBox[{"1", "/", "2"}]}]}], ";", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"res", "<", "0"}], ",", 
          RowBox[{"res", "=", 
           RowBox[{"res", "+", "1"}]}]}], "]"}], ";", "res"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8570242779213753`*^9, {3.8570244373894253`*^9, 3.8570244378185997`*^9}, {
   3.857024546147752*^9, 3.8570245649107885`*^9}, 3.8571559652795467`*^9, {
   3.8571563510107164`*^9, 3.8571563527548447`*^9}, {3.857204260851201*^9, 
   3.8572042959232364`*^9}, {3.8572043904398966`*^9, 
   3.8572044725862856`*^9}, {3.857204570637913*^9, 3.857204726404628*^9}, {
   3.85720475858053*^9, 3.8572048089762683`*^9}, {3.8572054433408813`*^9, 
   3.85720547542472*^9}, {3.857205580894614*^9, 3.8572055813155646`*^9}, {
   3.857205648616786*^9, 3.857205702974378*^9}, {3.8572061965827456`*^9, 
   3.857206249042426*^9}, {3.8572067459467177`*^9, 3.857206793520833*^9}, {
   3.8572080083560486`*^9, 3.85720803927551*^9}, {3.857260960053832*^9, 
   3.8572609806924424`*^9}, {3.857261588741517*^9, 3.857261597866849*^9}, {
   3.857478611633952*^9, 3.857478614134404*^9}, 
   3.8577053855891933`*^9},ExpressionUUID->"6e590626-7255-4638-b969-\
ef4c07bf8951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"not", " ", "used", " ", "by", " ", "algo"}], ",", " ", 
    RowBox[{
    "but", " ", "useful", " ", "for", " ", "ics", " ", "and", " ", "explains",
      " ", "the", " ", "cone", " ", "geometry"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"toCone", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d_", ",", "h_"}], "}"}], ",", "phi_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"d", ",", "h"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", "h", " ", ")"}], " ", "*", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"Sin", "[", " ", 
             RowBox[{"2", " ", "d", " ", "phi"}], "]"}], " ", ",", 
            RowBox[{"Cos", "[", " ", 
             RowBox[{"2", "  ", "d", " ", "phi"}], "]"}]}], "}"}]}]}], 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"coinWithConeTranslations", "[", 
      RowBox[{"nextCoin_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "r", ",", "phi", ",", "cylinderCircumference"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<rFunction\>\"", "]"}], "[", 
          RowBox[{
           RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", "=", " ", 
         RowBox[{"coinR", "[", "nextCoin", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"phi", " ", "=", "  ", 
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cylinderCircumference", " ", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<cylinderCircumferenceFunction\>\"", "]"}], "[", 
          RowBox[{"coinH", "[", "nextCoin", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"{", "nextCoin", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coinD", "[", "nextCoin", "]"}], "+", 
            RowBox[{"2", " ", "r"}]}], " ", ">", " ", 
           RowBox[{"cylinderCircumference", "/", "2"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"res", ",", 
             RowBox[{"coinTranslateL", "[", 
              RowBox[{"nextCoin", ",", "phi", ",", "cylinderCircumference"}], 
              "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"coinD", "[", "nextCoin", "]"}], " ", "-", 
            RowBox[{"2", " ", "r"}]}], "  ", "<", " ", 
           RowBox[{
            RowBox[{"-", "cylinderCircumference"}], "/", "2"}]}], ",", 
          "\[IndentingNewLine]", " ", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"res", ",", 
             RowBox[{"coinTranslateR", "[", 
              RowBox[{"nextCoin", ",", "phi", ",", "cylinderCircumference"}], 
              "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.857155901054227*^9},
 CellLabel->
  "In[117]:=",ExpressionUUID->"63ea88af-53a7-423f-8bca-b3bc15d00d81"],

Cell[CellGroupData[{

Cell["Unchained adding", "Subsection",ExpressionUUID->"a4f08e8c-f847-404b-ad6f-f3f3b12919f2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"oldstylePlaceNextCoinCone", "[", 
    RowBox[{
    "n_", ",", "coinFront_", ",", "coinRadius_", ",", "highestCoinZ_", ",", 
     "phi_", ",", "cylinderLU_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ib", ",", "iboundaryMesh", ",", "cyl", ",", "availableRegion", ",", 
       "nextdh", ",", "d", ",", "h", ",", "nextCoin", ",", "x", ",", "y"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ib", " ", "=", " ", 
       RowBox[{"iBoundary", "[", 
        RowBox[{"coinFront", ",", "coinRadius"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iboundaryMesh", " ", "=", " ", 
       RowBox[{"DiscretizeRegion", "@", 
        RowBox[{"RegionUnion", "[", "ib", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cyl", " ", "=", " ", 
       RowBox[{"coneRegion", "[", 
        RowBox[{"phi", ",", 
         RowBox[{"{", 
          RowBox[{"highestCoinZ", ",", 
           RowBox[{"cylinderLU", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"availableRegion", " ", "=", " ", 
       RowBox[{"RegionDifference", "[", 
        RowBox[{"cyl", ",", "iboundaryMesh"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextdh", "  ", "=", " ", 
       RowBox[{"whichMinConeRegionPoint", "[", 
        RowBox[{"availableRegion", ",", "phi"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"returns", " ", "Point"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"nextCoin", " ", "=", "  ", 
       RowBox[{"nextdh", "/.", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "]"}], " ", "\[Rule]", "  ", 
          RowBox[{"{", 
           RowBox[{"n", ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"x", ",", "y"}], "}"}], ",", "coinRadius"}], "]"}]}], 
           "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"nextCoin", "!=", "2"}], "]"}], ",", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Can't place next coin with front\\n\>\"", ",", "coinFront"}], 
          "]"}], ";", 
         RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "nextCoin"}]}], " ", "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"iBoundary", "[", 
     RowBox[{"coinFront_", ",", "distance_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"extendRadius", "[", 
        RowBox[{"#", ",", "distance"}], "]"}], "&"}], ",", "coinFront"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"coneRegion", "[", 
     RowBox[{"phi_", ",", 
      RowBox[{"{", 
       RowBox[{"h0_", ",", "h1_"}], "}"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d1", ",", "d0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", 
          RowBox[{"DiscretizeRegion", "[", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", "h0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "2"}], ",", "h1"}], "}"}]}], "]"}], "]"}], 
          "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"d1", ",", "d0"}], "}"}], "  ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"DiscretizeRegion", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "h1", ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], " ", "-", " ", "phi"}], ",", 
                " ", 
                RowBox[{
                 RowBox[{"\[Pi]", "/", "2"}], " ", "+", " ", "phi"}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"Disk", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", "h0"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"RegionDifference", "[", 
         RowBox[{"d1", ",", "d0"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"whichMinConeRegionPoint", "[", 
     RowBox[{"region_", ",", "phi_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"pts", ",", "hpts", ",", "x"}], 
       RowBox[{"(*", 
        RowBox[{"y", ",", "xy"}], "*)"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pts", " ", "=", " ", 
        RowBox[{"MeshPrimitives", "[", 
         RowBox[{"region", ",", "0"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"phi", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"hpts", " ", "=", " ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "y", "}"}], ",", 
            RowBox[{"pts", " ", "/.", " ", 
             RowBox[{
              RowBox[{"Point", "[", 
               RowBox[{"{", 
                RowBox[{"x_", ",", "y_"}], "}"}], "]"}], " ", "\[Rule]", " ", 
              "y"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"hpts", "=", "  ", 
          RowBox[{"Block", "[", 
           RowBox[{
            RowBox[{"{", "xy", "}"}], ",", 
            RowBox[{"pts", " ", "/.", 
             RowBox[{
              RowBox[{"Point", "[", "xy_", "]"}], " ", "\[Rule]", " ", 
              RowBox[{"xy", ".", "xy"}]}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"pts", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"Ordering", "[", "hpts", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"unchainedNextCoinAndContacts", "[", 
     RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "nextCoinByFront", ",", "phi"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
          "\"\<rFunction\>\"", "]"}], "[", 
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"phi", " ", "=", " ", 
        RowBox[{
         RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"nextCoinByFront", " ", "=", "  ", 
        RowBox[{"oldstylePlaceNextCoinCone", "[", "  ", "\[IndentingNewLine]", 
         RowBox[{"n", ",", "\[IndentingNewLine]", 
          RowBox[{"Values", "[", 
           RowBox[{
            RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
            "CoinAssociation", "]"}], "]"}], "\[IndentingNewLine]", ",", "r", 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
           "]"}], "\[IndentingNewLine]", ",", "phi", "\[IndentingNewLine]", 
          ",", " ", 
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
           "\"\<cylinderLU\>\"", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"<|", " ", 
        RowBox[{
         RowBox[{"\"\<CoinNumber\>\"", "->", 
          RowBox[{"First", "[", "nextCoinByFront", "]"}]}], ",", 
         RowBox[{"\"\<CoinDisk\>\"", "->", 
          RowBox[{"Last", "[", "nextCoinByFront", "]"}]}], ",", 
         RowBox[{"\"\<CoinNeighbours\>\"", "->", 
          RowBox[{"Missing", "[", "]"}]}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"unchainedNextState", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "oldLowest", ",", "nextCoin", ",", "nextCoinLowerNeighbours", ",", 
       "nAres"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"oldLowest", " ", "=", 
       RowBox[{"unchainedNextCoinAndContacts", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"highestCoinNumber", "[", "run", "]"}], "+", " ", "1"}], 
         ",", "run"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", "oldLowest", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Can't go oldstyle\>\"", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"nextCoin", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"oldLowest", "[", "\"\<CoinNumber\>\"", "]"}], ",", 
         RowBox[{"oldLowest", "[", "\"\<CoinDisk\>\"", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextCoinLowerNeighbours", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"coinLowerNeighbourNumbers", "[", " ", 
        RowBox[{
         RowBox[{"run", "[", "\"\<State\>\"", "]"}], ",", "nextCoin", ",", 
         "0.01"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nAres", " ", "=", " ", 
       RowBox[{"updateNeighbourFunction", "[", 
        RowBox[{"nextCoin", ",", "nextCoinLowerNeighbours", ",", "run"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "nAres", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8571559041702127`*^9, {3.85715594626145*^9, 3.857155976460081*^9}, {
   3.857188634480054*^9, 3.857188660668495*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"430a849a-06d4-4447-b77f-8452d15a272c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General", "Subsection",ExpressionUUID->"40d374d9-ea14-49ac-bbf8-505bd03fda55"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.7836691808053913`*^9, 3.7836691981150436`*^9}},
 CellLabel->
  "In[127]:=",ExpressionUUID->"290c500d-e234-4dd6-bc8e-7d12becb99a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"moveNumberLeft", "[", "n_", "]"}], " ", ":=", " ", 
   RowBox[{"Which", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", "left"}], ",", 
     RowBox[{"Missing", "[", "]"}], ",", 
     RowBox[{
      RowBox[{"Head", "[", "n", "]"}], "===", " ", "right"}], ",", 
     RowBox[{"n", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "True", ",", 
     RowBox[{"left", "[", "n", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"moveNumberRight", "[", "n_", "]"}], " ", ":=", " ", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Head", "[", "n", "]"}], "===", "left"}], ",", 
      RowBox[{"n", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Head", "[", "n", "]"}], "===", " ", "right"}], ",", 
      RowBox[{"Missing", "[", "]"}], ",", "True", ",", 
      RowBox[{"right", "[", "n", "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addInto", "[", 
     RowBox[{"res_", ",", "n_", ",", "mangle_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", " ", "=", " ", "res"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", 
          RowBox[{"r", "[", "n", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], "=", 
          RowBox[{"{", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"r", "[", "n", "]"}], ",", "mangle"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"r", "[", "n", "]"}], "=", 
        RowBox[{"SortBy", "[", 
         RowBox[{
          RowBox[{"r", "[", "n", "]"}], ",", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "r"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"symmetricAdd", "[", 
    RowBox[{"angleResult_", ",", "n_", ",", "m_", ",", "angle_"}], "]"}], " ",
    ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "n", " ", "is", " ", "the", " ", "newly", " ", "added", " ", "coin", 
       " ", "so", " ", "not", " ", "left", " ", "or", " ", "right", " ", 
       "but", " ", "m", " ", "might", " ", "be"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", "angleResult"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"addInto", "[", 
        RowBox[{"res", ",", "n", ",", 
         RowBox[{"{", 
          RowBox[{"m", ",", "angle"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"addInto", "[", 
        RowBox[{"res", ",", "m", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "m", "]"}], "===", " ", "right"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"addInto", "[", 
          RowBox[{"res", ",", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"left", "[", "n", "]"}], ",", 
             RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "m", "]"}], "===", " ", "left"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Adding \>\"", ",", " ", "n", " ", ",", " ", 
            "\"\< connected to \>\"", ",", "m"}], "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"addInto", "[", 
          RowBox[{"res", ",", 
           RowBox[{"m", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"right", "[", "n", "]"}], ",", 
             RowBox[{"thetac", "[", "angle", "]"}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.777198758112301*^9, 3.777198761357666*^9}, {
   3.777198825154991*^9, 3.777199195355589*^9}, {3.777199292113744*^9, 
   3.777199355165928*^9}, {3.777199420439361*^9, 3.777199423780373*^9}, {
   3.7771995127873077`*^9, 3.7771995972482815`*^9}, {3.7771996883844447`*^9, 
   3.7771997169732656`*^9}, {3.777199914366419*^9, 3.7771999268520594`*^9}, {
   3.777200114388332*^9, 3.7772004568784266`*^9}, {3.777200554567515*^9, 
   3.7772005730910788`*^9}, {3.7772006082630625`*^9, 3.77720061993501*^9}, 
   3.7772006589255934`*^9, {3.7772006994402103`*^9, 3.7772007258188353`*^9}, {
   3.777200763112069*^9, 3.7772008153653145`*^9}, {3.7772008456925354`*^9, 
   3.7772008639718385`*^9}, {3.7772009668401365`*^9, 
   3.7772009798882785`*^9}, {3.7772010116816607`*^9, 3.7772010119080563`*^9}, 
   3.7772011080083065`*^9, 3.777201220167986*^9, {3.777201260979247*^9, 
   3.777201265545526*^9}, {3.777201309802178*^9, 3.7772014140599713`*^9}, {
   3.777201491046541*^9, 3.777201495061799*^9}, {3.777201540749612*^9, 
   3.777201606005906*^9}, {3.777201637686154*^9, 3.777201866334651*^9}, {
   3.7772019070389266`*^9, 3.7772019284167414`*^9}, {3.7772019959750137`*^9, 
   3.777202422946189*^9}, {3.777202680236458*^9, 3.7772027359552116`*^9}, {
   3.777202781392621*^9, 3.777202843333553*^9}, {3.7772028945656586`*^9, 
   3.7772028964705625`*^9}, {3.777202936315113*^9, 3.777202951761792*^9}, {
   3.7772030822557325`*^9, 3.777203086751713*^9}, {3.777203118483797*^9, 
   3.7772031414852934`*^9}, {3.77720322123335*^9, 3.7772032462274895`*^9}, {
   3.77720333858144*^9, 3.7772034115013685`*^9}, {3.7772034435077457`*^9, 
   3.777203542845574*^9}, {3.7772036132432475`*^9, 3.7772036625036564`*^9}, {
   3.7772037317443852`*^9, 3.7772037347962627`*^9}, {3.7772039049630003`*^9, 
   3.7772039554823236`*^9}, {3.7772041062236333`*^9, 
   3.7772046821250954`*^9}, {3.7772048203393154`*^9, 3.77720485180414*^9}, {
   3.7772049425496025`*^9, 3.7772049692704687`*^9}, {3.777205005536491*^9, 
   3.7772050223285694`*^9}, {3.777205055659367*^9, 3.777205062336505*^9}, 
   3.777205094894067*^9, {3.777205167325325*^9, 3.777205179434198*^9}, {
   3.77720522602855*^9, 3.7772052332624397`*^9}, {3.777205274305686*^9, 
   3.7772053283163376`*^9}, {3.77720536096367*^9, 3.7772053616528635`*^9}, {
   3.7772053960368404`*^9, 3.777205494624268*^9}, 3.777205538333417*^9, {
   3.7772056421646194`*^9, 3.7772056573829093`*^9}, {3.777205837410347*^9, 
   3.777206174034772*^9}, {3.7772062550430655`*^9, 3.7772062581477995`*^9}, {
   3.777206360587723*^9, 3.777206420552726*^9}, {3.7772065485752773`*^9, 
   3.77720655429694*^9}, {3.777206615738614*^9, 3.7772066158353467`*^9}, {
   3.7772066497525806`*^9, 3.7772067025001535`*^9}, {3.777206739603918*^9, 
   3.7772069410258503`*^9}, {3.7772069710276403`*^9, 3.777207767332*^9}, {
   3.7772078022236195`*^9, 3.77720780398413*^9}, {3.77720805555389*^9, 
   3.7772084143918643`*^9}, {3.77720870869031*^9, 3.777208711105912*^9}, {
   3.777208840772634*^9, 3.7772088408813424`*^9}, {3.7772094837413216`*^9, 
   3.777209487756629*^9}, {3.7772181670325403`*^9, 3.7772181721159835`*^9}, {
   3.7772186343496795`*^9, 3.7772187051551533`*^9}, {3.7772187479746017`*^9, 
   3.7772187790425053`*^9}, {3.777218958763965*^9, 3.7772189866831264`*^9}, {
   3.777219019916438*^9, 3.7772190706456904`*^9}, {3.777219101719536*^9, 
   3.7772191082461095`*^9}, {3.7772192323281384`*^9, 
   3.7772192644327784`*^9}, {3.7772192969304137`*^9, 
   3.7772193023269987`*^9}, {3.7772193814369545`*^9, 3.777219452311511*^9}, {
   3.777219730493354*^9, 3.7772197310728383`*^9}, {3.7772202778832617`*^9, 
   3.7772202833715444`*^9}, {3.777261954571349*^9, 3.7772619849795065`*^9}, {
   3.77726234396531*^9, 3.777262357015914*^9}, {3.7772636737680902`*^9, 
   3.7772637188874197`*^9}, {3.7772637547006407`*^9, 
   3.7772638498622403`*^9}, {3.7772640050166073`*^9, 3.777264006528591*^9}, {
   3.777264046961378*^9, 3.77726406495252*^9}, {3.777266869774967*^9, 
   3.7772668750827713`*^9}, {3.7772674487226725`*^9, 
   3.7772674781958494`*^9}, {3.7772675087032313`*^9, 
   3.7772675328137836`*^9}, {3.7772897351531415`*^9, 3.7772897396660748`*^9}, 
   3.7772898181586885`*^9, {3.777289942249778*^9, 3.777289969885913*^9}, {
   3.777290014820979*^9, 3.7772900732068744`*^9}, {3.7772902292519803`*^9, 
   3.7772902499396544`*^9}, {3.777290364493809*^9, 3.7772903662590823`*^9}, {
   3.777290470114333*^9, 3.7772904732589273`*^9}, {3.7772905498770175`*^9, 
   3.777290629285652*^9}, {3.7772907167936187`*^9, 3.7772911185342093`*^9}, {
   3.777291173510193*^9, 3.777291262052396*^9}, {3.7772912927712374`*^9, 
   3.777291312307031*^9}, 3.7772914332934237`*^9, {3.777291489554963*^9, 
   3.777291504998664*^9}, {3.7772917253423758`*^9, 3.7772917945568113`*^9}, {
   3.7772918253095264`*^9, 3.7772918706482735`*^9}, {3.777291936098228*^9, 
   3.7772919397903676`*^9}, {3.7772919857833524`*^9, 
   3.7772921015058737`*^9}, {3.7772926586279416`*^9, 3.777292763197296*^9}, {
   3.7773553227355742`*^9, 3.7773553577983646`*^9}, {3.777355391669306*^9, 
   3.7773554517103634`*^9}, {3.777355571234541*^9, 3.7773555748457613`*^9}, {
   3.7773604116275606`*^9, 3.7773604176601305`*^9}, {3.77736099473905*^9, 
   3.777361012170968*^9}, {3.7773610468423853`*^9, 3.777361198214116*^9}, {
   3.777361229903042*^9, 3.777361266627672*^9}, {3.7773614461043406`*^9, 
   3.7773614487586017`*^9}, {3.777361808750428*^9, 3.777361810195012*^9}, {
   3.777373089843292*^9, 3.7773731342316113`*^9}, {3.7773758349426727`*^9, 
   3.777376075802987*^9}, {3.7773764601565337`*^9, 3.777376461477523*^9}, {
   3.777376595266379*^9, 3.777376613446789*^9}, {3.777376659169614*^9, 
   3.777376664607546*^9}, {3.7773770262295723`*^9, 3.777377047205464*^9}, {
   3.7773773360823183`*^9, 3.7773773362798343`*^9}, {3.7773773781149273`*^9, 
   3.777377676364505*^9}, {3.7773777641210203`*^9, 3.7773777758307004`*^9}, 
   3.7773778591847415`*^9, {3.7773779813874693`*^9, 3.777377988283576*^9}, {
   3.777378504817765*^9, 3.777378568219347*^9}, {3.777379023455084*^9, 
   3.7773790642055244`*^9}, {3.7773792133606143`*^9, 3.777379247247969*^9}, {
   3.777379606068428*^9, 3.77737960883624*^9}, {3.777379726015196*^9, 
   3.777379908495843*^9}, {3.7773800034910054`*^9, 3.7773801196216497`*^9}, 
   3.777380184685319*^9, {3.77738062967465*^9, 3.777380685546166*^9}, {
   3.777380852729165*^9, 3.777380863004466*^9}, {3.7773809399296026`*^9, 
   3.7773809488397126`*^9}, {3.777445422184258*^9, 3.777445473017681*^9}, {
   3.777445694486599*^9, 3.7774456951169133`*^9}, {3.777445781924409*^9, 
   3.7774457989425764`*^9}, 3.7774470615135255`*^9, {3.777447706477621*^9, 
   3.777447713386139*^9}, {3.7774477530240774`*^9, 3.7774478102918944`*^9}, {
   3.777447932396639*^9, 3.7774479366425276`*^9}, {3.777450206044672*^9, 
   3.7774502095054617`*^9}, {3.777450387921694*^9, 3.777450448450479*^9}, {
   3.7774510092430086`*^9, 3.777451015406526*^9}, {3.7774515939389343`*^9, 
   3.777451608210269*^9}, {3.7774516697727413`*^9, 3.7774517008755507`*^9}, {
   3.7774518135885134`*^9, 3.777451817380844*^9}, {3.777452094420721*^9, 
   3.7774521423293085`*^9}, {3.777452716689483*^9, 3.777452928485049*^9}, {
   3.777452962952811*^9, 3.7774529906352043`*^9}, {3.777453071411366*^9, 
   3.777453076228493*^9}, {3.7774537593942633`*^9, 3.7774537782807407`*^9}, 
   3.7774558875250607`*^9, {3.777456230003372*^9, 3.7774562315093374`*^9}, {
   3.777457530821147*^9, 3.7774577264298115`*^9}, {3.7774577615312653`*^9, 
   3.7774578519981885`*^9}, {3.777457908864355*^9, 3.777457925280449*^9}, {
   3.7774579753833838`*^9, 3.7774580718180013`*^9}, {3.7774582368570485`*^9, 
   3.77745830378307*^9}, 3.777458411538827*^9, {3.7774590037090874`*^9, 
   3.777459004764265*^9}, {3.777459434748828*^9, 3.7774594582479715`*^9}, {
   3.777459926456667*^9, 3.7774599268855476`*^9}, {3.777460211036134*^9, 
   3.7774602118629155`*^9}, {3.7774619141674476`*^9, 
   3.7774619477433095`*^9}, {3.7774742259730606`*^9, 
   3.7774743549663916`*^9}, {3.7775238571004114`*^9, 
   3.7775238668204165`*^9}, {3.777549402383898*^9, 3.777549402885852*^9}, {
   3.77755025296043*^9, 3.7775502657977557`*^9}, {3.777550311930078*^9, 
   3.7775503197561817`*^9}, {3.7775505033260098`*^9, 3.777550520286682*^9}, 
   3.7775505641182475`*^9, {3.7775528409757442`*^9, 3.7775528465268965`*^9}, {
   3.7775530317833133`*^9, 3.777553071913044*^9}, {3.777553366675251*^9, 
   3.7775534392965074`*^9}, {3.777553500644627*^9, 3.777553510323704*^9}, {
   3.777553771592589*^9, 3.7775538071653776`*^9}, {3.777553852211567*^9, 
   3.777553931775676*^9}, {3.777693527578799*^9, 3.7776935773985777`*^9}, {
   3.777693637864698*^9, 3.7776936677950706`*^9}, {3.777706584176346*^9, 
   3.777706639490574*^9}, 3.777708242922058*^9, {3.777708311778857*^9, 
   3.7777084545317316`*^9}, {3.7777088809870133`*^9, 
   3.7777090062559624`*^9}, {3.77770909902081*^9, 3.7777091563624206`*^9}, {
   3.777709211441168*^9, 3.777709606554613*^9}, {3.777709746281073*^9, 
   3.777709761469033*^9}, {3.777710003424184*^9, 3.7777100241547575`*^9}, {
   3.777710917617749*^9, 3.777711358711011*^9}, 3.7777115262791395`*^9, {
   3.7777127844551525`*^9, 3.777712829787886*^9}, {3.7777129215720186`*^9, 
   3.7777130051705713`*^9}, {3.7777138674100614`*^9, 3.777714003667265*^9}, {
   3.777714118794379*^9, 3.777714158922139*^9}, {3.777716510090765*^9, 
   3.7777166951354074`*^9}, {3.7777167605684843`*^9, 3.777716827214526*^9}, {
   3.7777168657505364`*^9, 3.777716966348225*^9}, {3.7777170007532215`*^9, 
   3.777717056312934*^9}, {3.777717127499524*^9, 3.7777171730708237`*^9}, {
   3.7777172248903637`*^9, 3.777717267244566*^9}, {3.7777172976612015`*^9, 
   3.7777174029507313`*^9}, {3.777717436719365*^9, 3.777717477102932*^9}, {
   3.7777175133748164`*^9, 3.777717513934308*^9}, {3.7777175509443197`*^9, 
   3.7777176575375357`*^9}, {3.777717715722824*^9, 3.7777177942563577`*^9}, {
   3.777717876941436*^9, 3.777717879787852*^9}, {3.7777180023159633`*^9, 
   3.7777181212744455`*^9}, 3.777718295339547*^9, {3.7777183288143067`*^9, 
   3.777718329830556*^9}, {3.7777184839392023`*^9, 3.777718547432709*^9}, 
   3.777718608362718*^9, {3.777718644621397*^9, 3.7777186862356195`*^9}, {
   3.7777187427792473`*^9, 3.7777187771304426`*^9}, {3.777718812700262*^9, 
   3.777718827101327*^9}, {3.7777189262481594`*^9, 3.777718934205358*^9}, {
   3.7777189730010023`*^9, 3.7777189910777006`*^9}, {3.777719026728071*^9, 
   3.777719398483512*^9}, {3.7779943678287563`*^9, 3.7779944126288*^9}, {
   3.7779944543982167`*^9, 3.7779944753310013`*^9}, {3.7779945276558127`*^9, 
   3.7779945342244215`*^9}, 3.7779947451357064`*^9, 3.7779948023354435`*^9, {
   3.7779951979690704`*^9, 3.7779951983037977`*^9}, {3.7779952290629697`*^9, 
   3.777995249509361*^9}, {3.7779955024746294`*^9, 3.7779955135112123`*^9}, {
   3.7779956726795917`*^9, 3.77799569563489*^9}, {3.7779957408859043`*^9, 
   3.77799574138675*^9}, {3.777995782797874*^9, 3.7779958595517583`*^9}, {
   3.7779961897240086`*^9, 3.7779962643148375`*^9}, {3.7779964279619694`*^9, 
   3.777996574177764*^9}, {3.7779966113400354`*^9, 3.7779966183962173`*^9}, {
   3.7780411596173534`*^9, 3.778041162153574*^9}, {3.7780418132702045`*^9, 
   3.778041868288145*^9}, 3.7780420003023233`*^9, {3.778042042521475*^9, 
   3.7780420503574915`*^9}, {3.778042356291007*^9, 3.7780424119432955`*^9}, {
   3.7780425798809814`*^9, 3.7780426324564095`*^9}, {3.778043067926842*^9, 
   3.7780431151805325`*^9}, {3.7780431523250914`*^9, 
   3.7780433136508484`*^9}, {3.7780434110455637`*^9, 3.778043413814122*^9}, {
   3.778043505637686*^9, 3.778043508353466*^9}, 3.778044086120117*^9, {
   3.7780441333947544`*^9, 3.7780441814742393`*^9}, {3.778047567116767*^9, 
   3.7780476079454417`*^9}, {3.778047656402502*^9, 3.7780476749439273`*^9}, {
   3.7780482392426796`*^9, 3.7780482616161795`*^9}, {3.778048489159915*^9, 
   3.7780484999041443`*^9}, {3.7780779425736966`*^9, 
   3.7780779557008076`*^9}, {3.778077992565337*^9, 3.7780779960393353`*^9}, {
   3.7780782579401736`*^9, 3.778078287746642*^9}, {3.778078355606365*^9, 
   3.778078382167923*^9}, {3.778078425976531*^9, 3.778078475446081*^9}, {
   3.7780785316562014`*^9, 3.7780785481685457`*^9}, {3.778078607450123*^9, 
   3.778078638742775*^9}, {3.7780786942288647`*^9, 3.77807871676748*^9}, {
   3.778079106004037*^9, 3.7780791072644696`*^9}, {3.7780792287760334`*^9, 
   3.7780792682578473`*^9}, {3.7780795092933664`*^9, 
   3.7780795351157064`*^9}, {3.7780798710853767`*^9, 
   3.7780798743964214`*^9}, {3.7780813381016583`*^9, 3.7780813579358487`*^9}, 
   3.7780815249126697`*^9, {3.7780816007184663`*^9, 3.7780816013732486`*^9}, 
   3.7781443124097033`*^9, {3.778144521107155*^9, 3.77814457689913*^9}, 
   3.77814461752282*^9, {3.778144653391524*^9, 3.7781447047975183`*^9}, {
   3.7781464252103558`*^9, 3.7781465418943276`*^9}, {3.7781465823858075`*^9, 
   3.7781465880394316`*^9}, {3.7781466213132114`*^9, 3.778146686222847*^9}, {
   3.77814716908211*^9, 3.778147247263533*^9}, {3.778147286987336*^9, 
   3.7781472962298775`*^9}, {3.7781473622615075`*^9, 
   3.7781473683923516`*^9}, {3.7781502778339453`*^9, 
   3.7781502795137014`*^9}, {3.778150376652686*^9, 3.778150381063978*^9}, 
   3.778151327327828*^9, {3.7781525500269794`*^9, 3.778152625236741*^9}, {
   3.7781528531347113`*^9, 3.778152860547472*^9}, {3.778152990934607*^9, 
   3.7781530267293453`*^9}, {3.77815325132203*^9, 3.778153292446015*^9}, {
   3.7781536227917128`*^9, 3.778153649271813*^9}, 3.778156100545309*^9, {
   3.779266284712841*^9, 3.7792662907991695`*^9}, {3.7792664035276175`*^9, 
   3.7792664144734592`*^9}, 3.7792664820956182`*^9, {3.7801252460391374`*^9, 
   3.780125298322338*^9}, {3.7826412244271955`*^9, 3.782641244506839*^9}, {
   3.7826452502345233`*^9, 3.7826453014106045`*^9}, {3.7826453428258066`*^9, 
   3.782645387387583*^9}, {3.7826454455699153`*^9, 3.782645511003193*^9}, {
   3.7826455481956882`*^9, 3.782645762490694*^9}, {3.7826457939406977`*^9, 
   3.782645915637066*^9}, {3.7826459628719397`*^9, 3.78264598331625*^9}, {
   3.782646028394874*^9, 3.7826460367515163`*^9}, {3.7826461284384203`*^9, 
   3.7826461298506436`*^9}, {3.782646216757451*^9, 3.7826462753557153`*^9}, 
   3.7826464570854177`*^9, {3.7826470674602013`*^9, 3.7826470726284046`*^9}, {
   3.7826476566633234`*^9, 3.7826476599346085`*^9}, {3.7826477140289297`*^9, 
   3.7826477440218325`*^9}, {3.7826479980517535`*^9, 
   3.7826482486542783`*^9}, {3.7826483209977727`*^9, 3.782648335859972*^9}, {
   3.782650250879388*^9, 3.782650264869936*^9}, 3.782652254000444*^9, {
   3.7826522950865097`*^9, 3.782652427132039*^9}, 3.782652576789838*^9, {
   3.782653473455132*^9, 3.782653474214091*^9}, {3.7826535927154207`*^9, 
   3.782653601309453*^9}, 3.7826538322676315`*^9, {3.7826538635806847`*^9, 
   3.7826538649390526`*^9}, 3.7826545343328533`*^9, {3.782654924220892*^9, 
   3.7826551142421937`*^9}, {3.782655162509063*^9, 3.7826551947280493`*^9}, 
   3.7826553642417126`*^9, {3.7826555010879107`*^9, 3.78265550513807*^9}, {
   3.7826556677373157`*^9, 3.782655735120266*^9}, {3.7826557865903854`*^9, 
   3.782655832136692*^9}, 3.782655879769264*^9, {3.7826559616694603`*^9, 
   3.782655996315197*^9}, {3.7826560397710543`*^9, 3.782656054447795*^9}, 
   3.78265639076499*^9, {3.782656471745634*^9, 3.7826564735228806`*^9}, {
   3.7826565404248905`*^9, 3.782656546128627*^9}, {3.7826566228047495`*^9, 
   3.7826567030349736`*^9}, {3.782656770830114*^9, 3.782656773827098*^9}, 
   3.7826568763427653`*^9, 3.7826569733543468`*^9, {3.7826577925565195`*^9, 
   3.782657903237216*^9}, {3.782657954285616*^9, 3.7826579713519554`*^9}, {
   3.782658034548912*^9, 3.782658148947994*^9}, {3.7826582562013617`*^9, 
   3.782658256343979*^9}, {3.7826585151955876`*^9, 3.782658683669541*^9}, {
   3.782658722998616*^9, 3.7826588512724733`*^9}, {3.7826589053348475`*^9, 
   3.782658911907295*^9}, {3.7826589458834143`*^9, 3.7826589790606523`*^9}, {
   3.7826590217633977`*^9, 3.782659030204852*^9}, {3.782659182044652*^9, 
   3.7826592166762495`*^9}, {3.7826592589501038`*^9, 3.7826593076929617`*^9}, 
   3.782659439318256*^9, {3.78265959076301*^9, 3.782659594507036*^9}, {
   3.7826601803054504`*^9, 3.7826602144043093`*^9}, {3.7827489971547327`*^9, 
   3.782749090173984*^9}, {3.782803157143355*^9, 3.7828032272599525`*^9}, {
   3.7828032819926105`*^9, 3.782803299272416*^9}, {3.782803417628023*^9, 
   3.7828037119427466`*^9}, {3.7828039130850544`*^9, 3.782803916356306*^9}, {
   3.782803950503028*^9, 3.7828041916793075`*^9}, {3.7828042261022863`*^9, 
   3.78280428793998*^9}, 3.782804321871279*^9, {3.7828044431171627`*^9, 
   3.782804553426282*^9}, {3.782804850506158*^9, 3.7828048765514956`*^9}, {
   3.7828049867409334`*^9, 3.782805008841852*^9}, {3.78280504560561*^9, 
   3.7828050538704805`*^9}, {3.7828051152783623`*^9, 
   3.7828051162467346`*^9}, {3.7828051521467714`*^9, 
   3.7828051987451987`*^9}, {3.7828111956918707`*^9, 3.7828112036625338`*^9}, 
   3.7828117588987684`*^9, {3.782811805014493*^9, 3.782811827787607*^9}, 
   3.7828120452323656`*^9, {3.782812255892192*^9, 3.782812270746517*^9}, {
   3.7828123382141657`*^9, 3.7828123598164167`*^9}, 3.782812393988033*^9, 
   3.782812477325287*^9, {3.7828125400665665`*^9, 3.782812619081312*^9}, {
   3.782812672590266*^9, 3.782812767377883*^9}, {3.782812903598418*^9, 
   3.7828129043623743`*^9}, {3.782812941082185*^9, 3.7828129423497963`*^9}, 
   3.782813111095786*^9, {3.782813466590537*^9, 3.7828135005154643`*^9}, {
   3.7828136415760145`*^9, 3.7828137752991133`*^9}, {3.7828138059740524`*^9, 
   3.782813808285887*^9}, {3.782813841446911*^9, 3.7828139513780785`*^9}, {
   3.7828140994150276`*^9, 3.7828141222879333`*^9}, {3.7828142031578703`*^9, 
   3.7828142290117593`*^9}, {3.7828142796065574`*^9, 3.782814287263051*^9}, {
   3.7828143930492506`*^9, 3.7828145467115126`*^9}, {3.7828145831500697`*^9, 
   3.7828145889745083`*^9}, {3.7828146211106415`*^9, 
   3.7828146483767543`*^9}, {3.7828147126060147`*^9, 3.782814780323984*^9}, {
   3.7828148117230997`*^9, 3.7828148262452316`*^9}, {3.7828148789064956`*^9, 
   3.7828149601392937`*^9}, 3.782815250420318*^9, {3.782816719615838*^9, 
   3.7828167202650986`*^9}, 3.782820502687225*^9, {3.7828241395326667`*^9, 
   3.7828241561691933`*^9}, {3.782825482221331*^9, 3.78282549347229*^9}, 
   3.782830475836534*^9, {3.7828305475578012`*^9, 3.7828309052775373`*^9}, {
   3.782892521622525*^9, 3.7828925345308247`*^9}, {3.782892583375331*^9, 
   3.782892652914177*^9}, {3.78289269639174*^9, 3.782892710447513*^9}, {
   3.7828927505828485`*^9, 3.7828927939683266`*^9}, {3.7828928275241566`*^9, 
   3.7828928280158405`*^9}, {3.782892861437239*^9, 3.782892906232169*^9}, {
   3.782892943183219*^9, 3.7828929514109497`*^9}, {3.7828929885858107`*^9, 
   3.782893135259907*^9}, 3.7828933675862*^9, {3.782893672589224*^9, 
   3.782893710155964*^9}, {3.782893774844914*^9, 3.7828937905649176`*^9}, {
   3.782893906676653*^9, 3.782893914447729*^9}, {3.782893966949745*^9, 
   3.7828939670624447`*^9}, {3.7828940662903996`*^9, 
   3.7828942169415045`*^9}, {3.782894250295007*^9, 3.782894251603696*^9}, {
   3.782894290403748*^9, 3.782894290606208*^9}, {3.78289441182848*^9, 
   3.7828944140374584`*^9}, {3.782894472660382*^9, 3.7828944933940496`*^9}, {
   3.7828946916252685`*^9, 3.782894761515874*^9}, 3.7828948321907988`*^9, {
   3.782894896309721*^9, 3.7828949415645695`*^9}, {3.78289518278685*^9, 
   3.7828951911247435`*^9}, {3.78289531789001*^9, 3.7828954318949156`*^9}, {
   3.78289548646904*^9, 3.782895486726379*^9}, {3.782895520583413*^9, 
   3.782895614033495*^9}, {3.782895653721721*^9, 3.782895653920192*^9}, {
   3.7828957224465637`*^9, 3.782895722920329*^9}, {3.782895782033208*^9, 
   3.7828959311730566`*^9}, {3.7828959782716846`*^9, 
   3.7828959828324947`*^9}, {3.782896061439496*^9, 3.7828960661439233`*^9}, {
   3.782896484845501*^9, 3.7828965097223034`*^9}, {3.7828977814112225`*^9, 
   3.7828977984906282`*^9}, {3.7828979463442087`*^9, 3.782898101288474*^9}, {
   3.782898141421246*^9, 3.782898151428502*^9}, {3.7828982133590417`*^9, 
   3.7828983146494617`*^9}, {3.7828983451854296`*^9, 3.782898392631812*^9}, {
   3.7828984328842707`*^9, 3.782898535498212*^9}, {3.782898568298558*^9, 
   3.7828985903307266`*^9}, {3.782898660742508*^9, 3.7828988174564667`*^9}, {
   3.7828988601154175`*^9, 3.7828989628491244`*^9}, {3.7828992790398173`*^9, 
   3.7828993016206093`*^9}, {3.7828994369942913`*^9, 3.782899584812992*^9}, {
   3.7829058047829237`*^9, 3.7829059237340527`*^9}, {3.782907538800331*^9, 
   3.7829076443951683`*^9}, {3.782907763419049*^9, 3.7829079405498004`*^9}, {
   3.782908049353963*^9, 3.7829081271208506`*^9}, {3.782908210138513*^9, 
   3.7829082246718893`*^9}, {3.7829082648739862`*^9, 
   3.7829082738010874`*^9}, {3.7829083110124383`*^9, 
   3.7829083114253635`*^9}, {3.782908358683525*^9, 3.782908387294662*^9}, 
   3.7829086136716337`*^9, {3.782908778961769*^9, 3.7829087808650227`*^9}, {
   3.782909932115225*^9, 3.782909935552041*^9}, {3.7829100597258706`*^9, 
   3.7829100620157504`*^9}, 3.7829102216410055`*^9, {3.7829103853634143`*^9, 
   3.782910389486356*^9}, {3.78291049783784*^9, 3.782910503689189*^9}, {
   3.782910654073781*^9, 3.7829107938861017`*^9}, {3.7829108547445545`*^9, 
   3.782910960148917*^9}, {3.7829109902894025`*^9, 3.78291101433012*^9}, {
   3.782911337967696*^9, 3.7829113468848553`*^9}, {3.78291187374927*^9, 
   3.7829118778353777`*^9}, 3.782912201189997*^9, {3.782912453690806*^9, 
   3.7829124689998984`*^9}, {3.782913117742851*^9, 3.782913118780053*^9}, {
   3.7829131713387423`*^9, 3.7829132440382137`*^9}, {3.782913280808482*^9, 
   3.782913371302747*^9}, 3.782913407701459*^9, {3.7829134755770364`*^9, 
   3.7829134801864414`*^9}, {3.7829135148095675`*^9, 3.7829135254810524`*^9}, 
   3.782914245133604*^9, {3.782914507032768*^9, 3.7829145077957344`*^9}, 
   3.7829146719756145`*^9, {3.78291545580511*^9, 3.782915456238947*^9}, {
   3.782915507887892*^9, 3.78291550893509*^9}, {3.782915952042447*^9, 
   3.7829159537159758`*^9}, {3.782915986008263*^9, 3.782916009397791*^9}, {
   3.7829160403701024`*^9, 3.7829160516344013`*^9}, {3.78291623455105*^9, 
   3.782916302478547*^9}, {3.782916392185631*^9, 3.7829164359807014`*^9}, {
   3.7829165366266813`*^9, 3.7829165664551907`*^9}, {3.782918440139101*^9, 
   3.7829184462737083`*^9}, {3.782919693738288*^9, 3.782919699942696*^9}, {
   3.783003840479787*^9, 3.7830038899148765`*^9}, {3.783008200141306*^9, 
   3.7830082034763885`*^9}, {3.783055490418867*^9, 3.7830555001857862`*^9}, {
   3.7830561882025356`*^9, 3.783056188385047*^9}, {3.7830599257849193`*^9, 
   3.783059926630658*^9}, {3.783060681834733*^9, 3.78306070733951*^9}, {
   3.783060937386856*^9, 3.7830609375544114`*^9}, {3.783061120192688*^9, 
   3.7830611203582177`*^9}, {3.7830618221651354`*^9, 3.783061822397519*^9}, {
   3.783061900430731*^9, 3.783061900684016*^9}, {3.7830623936917796`*^9, 
   3.7830623938224287`*^9}, {3.783062449888421*^9, 3.783062450829877*^9}, {
   3.783062578809389*^9, 3.7830625802685213`*^9}, {3.783083239662073*^9, 
   3.7830832944855676`*^9}, {3.7830833501849566`*^9, 
   3.7830833527580767`*^9}, {3.7830834097259903`*^9, 
   3.7830834139111347`*^9}, {3.7830834727102523`*^9, 3.783083513761281*^9}, {
   3.783083572283883*^9, 3.783083572933155*^9}, {3.783083779437415*^9, 
   3.783084048803094*^9}, {3.7830843267320395`*^9, 3.783084337907176*^9}, {
   3.7830844067109747`*^9, 3.7830845440208855`*^9}, {3.783084583360712*^9, 
   3.783084628804316*^9}, {3.783084719517884*^9, 3.7830847597044897`*^9}, {
   3.7830849016032963`*^9, 3.78308490190452*^9}, {3.7830850590824347`*^9, 
   3.78308505953826*^9}, {3.7830852024344387`*^9, 3.7830852048579655`*^9}, {
   3.7830854186125665`*^9, 3.7830855707128754`*^9}, {3.7830856141424*^9, 
   3.783085652288788*^9}, {3.783086117061367*^9, 3.7830861922336407`*^9}, {
   3.7830863128572803`*^9, 3.783086313614266*^9}, 3.783086472757695*^9, {
   3.7830865219302697`*^9, 3.783086528796376*^9}, {3.7830866225889564`*^9, 
   3.7830866335038223`*^9}, {3.783086678911332*^9, 3.7830866861542187`*^9}, {
   3.7830867293120747`*^9, 3.7830867299952526`*^9}, {3.783086798100752*^9, 
   3.783086854148622*^9}, {3.7830872405966988`*^9, 3.7830872460047584`*^9}, {
   3.7830873116981916`*^9, 3.783087331710743*^9}, 3.7830873846711216`*^9, {
   3.783087457092101*^9, 3.783087577497461*^9}, {3.78308763520662*^9, 
   3.7830876653786097`*^9}, {3.7830877270467615`*^9, 3.783087769543395*^9}, {
   3.7830878772307816`*^9, 3.7830878934513316`*^9}, 3.7830880753911805`*^9, {
   3.783089033361082*^9, 3.7830890429454694`*^9}, {3.7830891417713614`*^9, 
   3.783089246318486*^9}, {3.7830893057213097`*^9, 3.7830893871536856`*^9}, {
   3.783090312259946*^9, 3.7830903165877743`*^9}, {3.7830903634834204`*^9, 
   3.7830904331482515`*^9}, {3.7830905049952865`*^9, 3.783090553776052*^9}, {
   3.783090783303627*^9, 3.7830908200278273`*^9}, {3.783094416558322*^9, 
   3.7830945554273133`*^9}, {3.7830946237596955`*^9, 3.78309472706999*^9}, {
   3.7830947777179766`*^9, 3.783094795742816*^9}, {3.7830948314588614`*^9, 
   3.7830948526694627`*^9}, {3.7830948957383537`*^9, 3.783094921561353*^9}, {
   3.78309496355812*^9, 3.783095014039155*^9}, 3.7830951157147636`*^9, {
   3.7830951841578474`*^9, 3.7830951916687756`*^9}, {3.783095232819801*^9, 
   3.783095276017358*^9}, 3.7830953614519205`*^9, {3.783095411724047*^9, 
   3.7830954232362576`*^9}, {3.783095481453676*^9, 3.7830955007024484`*^9}, {
   3.783095616917572*^9, 3.7830957738597097`*^9}, {3.783095815891461*^9, 
   3.7830959415241003`*^9}, {3.783096003783724*^9, 3.7830961324645214`*^9}, 
   3.7830961999183435`*^9, {3.783096423247328*^9, 3.7830964385704217`*^9}, {
   3.7830964969753323`*^9, 3.7830965309851217`*^9}, {3.78309658224465*^9, 
   3.7830965928208027`*^9}, {3.783096676639171*^9, 3.7830967085869813`*^9}, {
   3.783096801477768*^9, 3.783096930992836*^9}, {3.7830972584701357`*^9, 
   3.783097260187579*^9}, {3.783097422549884*^9, 3.7830977329225273`*^9}, {
   3.783098151380085*^9, 3.783098267285675*^9}, {3.7830984835619783`*^9, 
   3.7830984891380463`*^9}, {3.7830989166193333`*^9, 3.783098959860119*^9}, {
   3.7830990497806835`*^9, 3.783099053137717*^9}, {3.783099232175949*^9, 
   3.7830992380403056`*^9}, {3.7830993762137814`*^9, 3.783099401768491*^9}, {
   3.78309949580618*^9, 3.7830995349705925`*^9}, {3.783099577138859*^9, 
   3.783099640513168*^9}, {3.7830997339115753`*^9, 3.783099738027621*^9}, {
   3.783099979840558*^9, 3.7830999813196006`*^9}, {3.783100196572995*^9, 
   3.7831002772289143`*^9}, {3.78310031608012*^9, 3.7831003331115685`*^9}, {
   3.783100406437052*^9, 3.7831004667506266`*^9}, {3.7831006683613205`*^9, 
   3.783100669068287*^9}, {3.783100709622103*^9, 3.7831008184198885`*^9}, {
   3.7831008706294246`*^9, 3.7831009643183756`*^9}, {3.783101107026017*^9, 
   3.7831011079904337`*^9}, 3.7831011493340454`*^9, {3.78310138067008*^9, 
   3.7831013815387607`*^9}, {3.78310154385658*^9, 3.7831016220999947`*^9}, 
   3.7831016846497936`*^9, {3.7831017184115677`*^9, 3.7831017501678*^9}, {
   3.783101925447373*^9, 3.783101997419568*^9}, {3.783102065260459*^9, 
   3.783102251396392*^9}, 3.7831023103737745`*^9, {3.783102352362563*^9, 
   3.783102352732576*^9}, {3.7831521935364447`*^9, 3.7831522977036037`*^9}, {
   3.7831524533490257`*^9, 3.783152554915677*^9}, {3.7831527633756256`*^9, 
   3.783152783657201*^9}, {3.78315287852236*^9, 3.783152914291979*^9}, {
   3.783153008964439*^9, 3.7831530619066544`*^9}, {3.783153094144865*^9, 
   3.7831531119697113`*^9}, {3.783153143184187*^9, 3.7831532158316298`*^9}, {
   3.783153256654709*^9, 3.7831532813880067`*^9}, {3.7831533537588196`*^9, 
   3.783153361317261*^9}, {3.783153462802524*^9, 3.783153504809825*^9}, 
   3.783153555888278*^9, {3.783153596110341*^9, 3.7831537259160023`*^9}, 
   3.7831537572974663`*^9, {3.783153844070965*^9, 3.783153848137968*^9}, {
   3.7831539502914658`*^9, 3.7831539776946125`*^9}, {3.7831540563655653`*^9, 
   3.7831540975175433`*^9}, {3.7831541276838927`*^9, 
   3.7831541823081694`*^9}, {3.783155873746646*^9, 3.7831558760739436`*^9}, 
   3.783155972981032*^9, {3.78315607408528*^9, 3.783156172755717*^9}, {
   3.783156210671802*^9, 3.7831562122010612`*^9}, {3.783156260410429*^9, 
   3.7831562829667506`*^9}, {3.783156324649783*^9, 3.7831563297563725`*^9}, {
   3.7831563717609673`*^9, 3.7831564164719706`*^9}, {3.7831564785711575`*^9, 
   3.78315653287296*^9}, {3.78316137142309*^9, 3.7831613841440153`*^9}, 
   3.7831614284016285`*^9, {3.783161483806345*^9, 3.783161492440277*^9}, {
   3.78316191261397*^9, 3.7831619179676485`*^9}, {3.7831621150901966`*^9, 
   3.783162137798435*^9}, {3.783162563178275*^9, 3.7831625723377237`*^9}, {
   3.783162614721351*^9, 3.783162638385996*^9}, {3.783162737975556*^9, 
   3.783162786382995*^9}, {3.7831628180203886`*^9, 3.7831628318373713`*^9}, {
   3.7831628762884316`*^9, 3.7831629583817716`*^9}, {3.783163030347212*^9, 
   3.7831630310473385`*^9}, {3.7831633269575605`*^9, 3.783163362446636*^9}, {
   3.783163425241579*^9, 3.7831634708295975`*^9}, {3.7831635165412855`*^9, 
   3.7831635173322077`*^9}, {3.7831635736245317`*^9, 3.783163593075486*^9}, {
   3.7831636727353373`*^9, 3.783163696383066*^9}, {3.783163743249696*^9, 
   3.7831637434282165`*^9}, {3.7831637973389325`*^9, 
   3.7831638139275494`*^9}, {3.78316456353679*^9, 3.7831646101540527`*^9}, {
   3.783164693754364*^9, 3.7831647013560553`*^9}, {3.783164850093041*^9, 
   3.783164901776783*^9}, {3.7831650341461377`*^9, 3.7831650386790433`*^9}, {
   3.7831651456844273`*^9, 3.7831651519865694`*^9}, {3.7831655333411627`*^9, 
   3.783165592180727*^9}, {3.783165799413224*^9, 3.78316601122946*^9}, {
   3.7831660493086033`*^9, 3.7831660906848574`*^9}, {3.783166144355212*^9, 
   3.7831661447272177`*^9}, {3.7831661930389485`*^9, 3.78316626607755*^9}, {
   3.783166464667142*^9, 3.7831665449932156`*^9}, {3.7831666357902627`*^9, 
   3.783166821042577*^9}, {3.783166892276012*^9, 3.7831669643920107`*^9}, {
   3.7831671343342905`*^9, 3.7831672637520056`*^9}, {3.783167328493805*^9, 
   3.783167341099077*^9}, {3.7831674572742233`*^9, 3.783167508837221*^9}, {
   3.783167556140683*^9, 3.7831675733665557`*^9}, {3.78316761121828*^9, 
   3.7831676116541095`*^9}, {3.783167644957*^9, 3.7831677926887093`*^9}, {
   3.783167919750758*^9, 3.783168041479012*^9}, {3.7831680971670055`*^9, 
   3.7831681099737372`*^9}, {3.7831682267841835`*^9, 3.783168249584178*^9}, {
   3.783169591787797*^9, 3.7831695984708834`*^9}, {3.7831696835243235`*^9, 
   3.7831697705714087`*^9}, {3.7831698011246576`*^9, 
   3.7831698313149056`*^9}, {3.7831700174339004`*^9, 3.783170030397214*^9}, {
   3.783173445645149*^9, 3.783173472643937*^9}, {3.783173539330471*^9, 
   3.783173619490983*^9}, 3.783237915116966*^9, 3.7832379899277925`*^9, 
   3.783238038887791*^9, 3.7832380730314646`*^9, {3.7832384127683964`*^9, 
   3.783238417587837*^9}, {3.783239982697875*^9, 3.7832400029040813`*^9}, {
   3.7832403214615993`*^9, 3.783240333878853*^9}, {3.783240997003974*^9, 
   3.783241031030908*^9}, {3.7832417957824507`*^9, 3.7832417966471806`*^9}, {
   3.7832541226795473`*^9, 3.783254137292821*^9}, {3.7832541889480515`*^9, 
   3.7832542030704713`*^9}, {3.7832542971853476`*^9, 
   3.7832542978372765`*^9}, {3.78325443487348*^9, 3.7832544353821573`*^9}, {
   3.7832576981180677`*^9, 3.7832577099914303`*^9}, {3.7832578225009384`*^9, 
   3.783257831109132*^9}, {3.783257911992328*^9, 3.7832579128934603`*^9}, {
   3.7833026883372912`*^9, 3.7833029622513695`*^9}, {3.783303730615432*^9, 
   3.7833037878792086`*^9}, {3.783303849545208*^9, 3.783303850653242*^9}, {
   3.783303893891547*^9, 3.7833039144734735`*^9}, {3.7833040296738653`*^9, 
   3.783304036623272*^9}, 3.783304093289716*^9, {3.78330412476649*^9, 
   3.7833041311913023`*^9}, {3.783304205980188*^9, 3.783304310106603*^9}, {
   3.783304352564963*^9, 3.7833043535114293`*^9}, {3.7833043976014557`*^9, 
   3.7833044677417817`*^9}, {3.7833045093674*^9, 3.783304516917202*^9}, {
   3.783304699978898*^9, 3.783304703736843*^9}, 3.7833048092285748`*^9, {
   3.7833048794038043`*^9, 3.7833048868448963`*^9}, {3.783305099632531*^9, 
   3.7833051211130543`*^9}, 3.783305213388153*^9, {3.7833052703008676`*^9, 
   3.7833052731711874`*^9}, {3.783305322923069*^9, 3.7833053233130226`*^9}, {
   3.7833053680303693`*^9, 3.783305368388443*^9}, {3.7833058759622803`*^9, 
   3.7833058859106627`*^9}, {3.783406774054085*^9, 3.7834067999264603`*^9}, {
   3.7834068749797707`*^9, 3.7834068763698645`*^9}, {3.7834192840815907`*^9, 
   3.7834193088298078`*^9}, {3.7834193466445246`*^9, 
   3.7834193761417394`*^9}, {3.783420850058855*^9, 3.78342086067791*^9}, {
   3.783420920175808*^9, 3.7834209340715184`*^9}, {3.7834213918679075`*^9, 
   3.783421435128628*^9}, {3.7834214673210044`*^9, 3.783421515897666*^9}, 
   3.7834216050272765`*^9, {3.783422108388769*^9, 3.7834221195423307`*^9}, 
   3.783424537016801*^9, {3.783425866781705*^9, 3.7834258677644377`*^9}, {
   3.783426036270791*^9, 3.78342613238562*^9}, {3.7834262155352325`*^9, 
   3.783426215966591*^9}, {3.783426263916238*^9, 3.7834262640817957`*^9}, {
   3.783426353723593*^9, 3.7834264285359697`*^9}, {3.7834265518967867`*^9, 
   3.7834265520423927`*^9}, {3.7834280283698735`*^9, 3.78342802847659*^9}, {
   3.783428066152058*^9, 3.783428072600811*^9}, {3.7834282056537085`*^9, 
   3.7834282327014265`*^9}, {3.7836641480069685`*^9, 
   3.7836642220848336`*^9}, {3.783664300460642*^9, 3.7836643010531015`*^9}, 
   3.783666304618492*^9, {3.783666392123995*^9, 3.7836663956465645`*^9}, {
   3.7836667511359825`*^9, 3.783666767626238*^9}, {3.7836669614100237`*^9, 
   3.783666983819486*^9}, {3.7836670367658477`*^9, 3.783667048722896*^9}, {
   3.783667196334739*^9, 3.7836672135975533`*^9}, {3.78366737468898*^9, 
   3.7836673839074097`*^9}, {3.78366743962438*^9, 3.7836674800372458`*^9}, {
   3.7836676560745277`*^9, 3.783667667399234*^9}, {3.783667797383686*^9, 
   3.7836678390176964`*^9}, {3.7836678757264557`*^9, 3.78366790167206*^9}, {
   3.7836679658942556`*^9, 3.783668022572709*^9}, {3.783668109673205*^9, 
   3.7836681129973125`*^9}, {3.783668210932325*^9, 3.7836682139502506`*^9}, {
   3.783668293389781*^9, 3.7836683829195256`*^9}, {3.7836684227120295`*^9, 
   3.7836684381607037`*^9}, {3.7836687162058573`*^9, 3.783668843608276*^9}, {
   3.7836689272873883`*^9, 3.783669020549065*^9}, {3.783669054939206*^9, 
   3.7836691595220146`*^9}, {3.7836693740224457`*^9, 3.7836694065095015`*^9}, 
   3.783669497072275*^9, {3.7836695341969585`*^9, 3.7836698215006495`*^9}, 
   3.7836698516659517`*^9, {3.783669911156884*^9, 3.783669911346377*^9}, {
   3.7836699898912907`*^9, 3.783670096523759*^9}, {3.7836702626094494`*^9, 
   3.783670327808045*^9}, {3.783670519797464*^9, 3.7836705508439555`*^9}, 
   3.7836709495045547`*^9, {3.783670991015684*^9, 3.7836710211003838`*^9}, {
   3.783671330829816*^9, 3.783671492393649*^9}, 3.7836715713473797`*^9, {
   3.783671702030538*^9, 3.7836717450564737`*^9}, {3.7836718022893367`*^9, 
   3.783671855560831*^9}, {3.783671948080329*^9, 3.783671954010504*^9}, {
   3.783672467714637*^9, 3.7836724926765413`*^9}, {3.7836727448059945`*^9, 
   3.7836727606785336`*^9}, {3.7836730297460003`*^9, 
   3.7836730461034107`*^9}, {3.783673263764267*^9, 3.78367328722058*^9}, {
   3.7836733773340445`*^9, 3.7836733798903484`*^9}, {3.7836734138231173`*^9, 
   3.783673417789503*^9}, {3.7836752708047667`*^9, 3.783675288433563*^9}, {
   3.7836765792405233`*^9, 3.7836766687879033`*^9}, {3.78367686269433*^9, 
   3.7836768774219494`*^9}, {3.783677024080982*^9, 3.7836770348935366`*^9}, {
   3.7836770741555066`*^9, 3.7836770897667437`*^9}, 3.783677120706434*^9, {
   3.783677195812484*^9, 3.783677224041402*^9}, {3.7836776512376604`*^9, 
   3.7836776603647566`*^9}, {3.7836880171462245`*^9, 
   3.7836883488983884`*^9}, {3.7836883858964424`*^9, 
   3.7836884561162796`*^9}, {3.7836885085271425`*^9, 3.783688642811578*^9}, {
   3.783688688847434*^9, 3.7836887273999157`*^9}, {3.7836888081049767`*^9, 
   3.783688835435865*^9}, {3.783688998874857*^9, 3.7836890024573097`*^9}, {
   3.783689044901726*^9, 3.783689057718437*^9}, {3.783689092576191*^9, 
   3.7836891703312683`*^9}, {3.7836892348686886`*^9, 3.783689237096696*^9}, {
   3.7836892783942194`*^9, 3.7836893054917297`*^9}, {3.78368970914472*^9, 
   3.7836897484946384`*^9}, {3.783689785545523*^9, 3.783689808119142*^9}, {
   3.7836900404476852`*^9, 3.783690053314455*^9}, {3.783690170214693*^9, 
   3.7836902118922296`*^9}, {3.7836902466921043`*^9, 3.783690289356969*^9}, {
   3.783690330407235*^9, 3.7836904821569858`*^9}, {3.783690516737485*^9, 
   3.783690813402972*^9}, {3.7836908649051623`*^9, 3.78369105084506*^9}, {
   3.7836911046959553`*^9, 3.7836911460569963`*^9}, {3.7836912540460725`*^9, 
   3.78369125661724*^9}, {3.783691330298518*^9, 3.7836915262120895`*^9}, 
   3.783692339369131*^9, {3.7836929889119053`*^9, 3.78369334218369*^9}, {
   3.783693391511915*^9, 3.7836934128508644`*^9}, {3.7836934428665686`*^9, 
   3.7836935139086475`*^9}, {3.7855811698794317`*^9, 3.785581193544176*^9}, {
   3.7855812717600803`*^9, 3.785581323626475*^9}, 3.785583911908019*^9},
 CellLabel->
  "In[125]:=",ExpressionUUID->"8923fcf7-3a83-4578-b088-d91ab1b058c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"edgesWithLR", "[", 
     RowBox[{"n_", ",", "mList_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "newEdges", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"n", ",", "#"}], "}"}], "&"}], ",", "mList"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"rightEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberRight", ",", 
          RowBox[{"Cases", "[", 
           RowBox[{"newEdges", ",", 
            RowBox[{"{", 
             RowBox[{"a_", ",", 
              RowBox[{"left", "[", "b_", "]"}]}], "}"}]}], "]"}], " ", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"leftEdges", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberLeft", ",", 
          RowBox[{"Cases", "[", 
           RowBox[{"newEdges", ",", 
            RowBox[{"{", 
             RowBox[{"a_", ",", 
              RowBox[{"right", "[", "b_", "]"}]}], "}"}]}], "]"}], " ", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"newEdges", ",", "rightEdges", ",", "leftEdges"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"Join", "[", 
         RowBox[{"newEdges", ",", 
          RowBox[{"Reverse", "  ", "/@", " ", "newEdges"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"DirectedEdge", " ", "@@@", "newEdges"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"DeleteDuplicates", "@", "newEdges"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8459660882322474`*^9, 3.845966113168236*^9}, {
   3.8459713194550047`*^9, 3.8459713253248925`*^9}, 3.8459713786231723`*^9},
 CellLabel->
  "In[129]:=",ExpressionUUID->"be9277a0-95b7-4e02-a2e3-af046510c2ce"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.845437226641659*^9, 3.8454372335621605`*^9}, {
   3.8454372776819153`*^9, 3.845437297750497*^9}, {3.845437337444112*^9, 
   3.8454373845506525`*^9}, 3.8454374978383374`*^9},
 CellLabel->
  "In[134]:=",ExpressionUUID->"84810bf2-a64d-4f8c-8fdd-1cf91e9d36a5"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"chainParastichyCount", "[", 
      RowBox[{"front_", ",", "neighbourAssociations_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pairs", ",", "lookup"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"bareNumber", ",", "front"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"(", " ", 
          RowBox[{"Partition", "[", 
           RowBox[{"pairs", ",", "2", ",", "1"}], "]"}], " ", ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"DirectedEdge", " ", "@@@", "pairs"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Cases", "[", 
          RowBox[{"pairs", ",", 
           RowBox[{"Except", "[", 
            RowBox[{"a_", "\[DirectedEdge]", "a_"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lookup", " ", "=", " ", 
         RowBox[{"KeyMap", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"bareNumber", ",", "#"}], "]"}], "&"}], ",", 
           RowBox[{"neighbourAssociations", "[", "DEdgeAngle", "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", 
         RowBox[{"(", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"lookup", "[", "#", "]"}], "&"}], ",", "pairs"}], "]"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pairs", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", " ", "[", 
             RowBox[{
              RowBox[{"#", "<", 
               RowBox[{"1", "/", "4"}]}], ",", "Up", ",", "Down"}], "]"}], 
            "&"}], ",", "pairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "pairs", "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Values", "@", 
         RowBox[{"Counts", "[", "pairs", "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845967284599962*^9, 3.8459674475034094`*^9}, {
  3.845967495896744*^9, 3.845967504648801*^9}, {3.8460404578948097`*^9, 
  3.8460404692605324`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"5615abe2-38df-4d14-a0d1-80e04fc21d15"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "assumes", " ", "each", " ", "node", " ", "sits", " ", "on", " ", "one", 
     " ", "to", " ", "its", " ", "left", " ", "and", " ", "one", " ", "to", 
     " ", "its", " ", "right"}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
    "and", " ", "we", " ", "only", " ", "allow", " ", "going", " ", 
     "right"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"findGraphFront", "[", 
      RowBox[{"firstNumber_", ",", "neighbourAssociations_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lastNumber", ",", "nextCoinNumber", ",", "thisFront"}], 
        "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"thisFront", " ", "=", " ", 
         RowBox[{"{", "firstNumber", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "0"}], ",", 
          RowBox[{"k", "<", "50"}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"lastNumber", "=", "  ", 
            RowBox[{"Last", "[", " ", "thisFront", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"nextCoinNumber", "=", " ", 
            RowBox[{"nextInChainGraph", "[", 
             RowBox[{"lastNumber", ",", "neighbourAssociations"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"MissingQ", "[", "nextCoinNumber", "]"}], ",", 
             RowBox[{"Return", "[", "nextCoinNumber", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"thisFront", " ", "=", " ", 
            RowBox[{"Append", "[", 
             RowBox[{"thisFront", ",", "nextCoinNumber"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"IntegerQ", "[", "nextCoinNumber", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"nextCoinNumber", "=", 
               RowBox[{"bareNumber", "[", "nextCoinNumber", "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"thisFront", " ", "=", " ", 
               RowBox[{"Append", "[", 
                RowBox[{"thisFront", ",", "nextCoinNumber"}], "]"}]}], 
              ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"nextCoinNumber", "==", "firstNumber"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"k", "==", "50"}], ",", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<fGF at 50 for\>\"", ",", "firstNumber"}], "]"}], ";", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "\"\<k50\>\"", "]"}], "]"}]}]}], "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "thisFront"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextInChainGraph", "[", 
      RowBox[{"lastNumber_", ",", "neighbourAssociations_"}], "]"}], "  ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "allOutwardEdges", ",", "rightEdgesByAngle", ",", "nextEdge", ",", 
         "nextCoinNumber"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allOutwardEdges", "=", 
         RowBox[{"EdgeList", "[", " ", 
          RowBox[{
           RowBox[{"neighbourAssociations", "[", "ContactGraph", "]"}], ",", 
           RowBox[{
            RowBox[{"bareNumber", "[", "lastNumber", " ", "]"}], 
            "\[DirectedEdge]", " ", "_"}]}], "  ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rightEdgesByAngle", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"Association", "@@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "->", 
               RowBox[{
                RowBox[{"neighbourAssociations", "[", "DEdgeAngle", "]"}], 
                "[", "#", "]"}]}], "&"}], ",", "allOutwardEdges"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rightEdgesByAngle", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"rightEdgesByAngle", ",", 
           RowBox[{
            RowBox[{"#", "<", 
             RowBox[{"1", "/", "2"}]}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "rightEdgesByAngle", "]"}], "\[Equal]", 
           "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<noRightOutward\>\"", "]"}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"nextEdge", " ", "=", 
         RowBox[{"First", "@", 
          RowBox[{"Keys", "[", "rightEdgesByAngle", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"nextCoinNumber", "  ", "=", " ", 
         RowBox[{"Last", "[", "nextEdge", "]"}]}], ";", "\[IndentingNewLine]",
         "nextCoinNumber"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.845959962629813*^9, 3.8459600008631306`*^9}, {
  3.8459600900493946`*^9, 3.8459601976185093`*^9}, {3.845960230176862*^9, 
  3.8459602766472645`*^9}, {3.845960373677277*^9, 3.84596039825334*^9}, {
  3.8459604472225914`*^9, 3.845960475536664*^9}, {3.845960552381359*^9, 
  3.8459606012950425`*^9}, {3.845960670531965*^9, 3.845960726339073*^9}, {
  3.8459615308513613`*^9, 3.8459615352565746`*^9}, {3.845961855170014*^9, 
  3.8459618551750755`*^9}, {3.8459829025944595`*^9, 3.8459829079633613`*^9}},
 CellLabel->
  "In[131]:=",ExpressionUUID->"ab42ed20-266b-4450-8257-d24d04102258"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addCoinsToState", "[", 
     RowBox[{"state_", ",", "nextCoinSet_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", "state"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "CoinAssociation", "]"}], " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"state", "[", "CoinAssociation", "]"}], ",", 
          RowBox[{"Association", "@", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", "#", "]"}], "->", "#"}], "&"}], ",", 
             "nextCoinSet"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "MostRecentCoin", "]"}], " ", "=", "  ", 
        RowBox[{"Max", "@", 
         RowBox[{"Map", "[", 
          RowBox[{"bareCoinNumber", ",", "nextCoinSet"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856947755382576*^9, 3.856947821001051*^9}, 
   3.856947861074744*^9},
 CellLabel->
  "In[133]:=",ExpressionUUID->"c76eea4f-2d81-4606-a338-962eed944458"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"updateNeighbourFunction", "[", 
     RowBox[{"nextCoin_", ",", "nextCoinLowerNeighbours_", ",", "run_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "coinCollection", ",", "newEdges", ",", "nextCoinSet", ",", 
        "para2", ",", "nodeAssociation", ",", "thisChain", ",", 
        "coinNumberPairAngle", ",", "newEdgeAngles", ",", "newRun"}], "}"}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", " ", "=", " ", 
        RowBox[{"coinNumber", "[", "nextCoin", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nextCoinSet", " ", "=", " ", 
        RowBox[{"coinWithConeTranslations", "[", 
         RowBox[{"nextCoin", ",", "run"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Adding \>\"", ",", "n", ",", " ", "\"\< \>\"", ",", 
           "nextCoinLowerNeighbours"}], "]"}], ";"}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "*)"}], 
       RowBox[{"nodeAssociation", " ", "=", 
        RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nodeAssociation", " ", "=", " ", 
        RowBox[{"addCoinsToState", "[", 
         RowBox[{"nodeAssociation", ",", "nextCoinSet"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], " ", "=", 
        " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], ",", 
          RowBox[{
           RowBox[{"First", "[", "nextCoin", "]"}], "->", "nextCoin"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newRun", " ", "=", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"newRun", "[", "\"\<State\>\"", "]"}], "=", " ", 
        "nodeAssociation"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"newEdges", " ", "=", " ", 
        RowBox[{"edgesWithLR", "[", 
         RowBox[{"n", ",", "nextCoinLowerNeighbours"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coinNumberPairAngle", "[", 
         RowBox[{"coinm_", ",", "coinn_"}], "]"}], " ", ":=", " ", 
        RowBox[{"coinPairAngle", "[", " ", 
         RowBox[{
          RowBox[{"getCoinFromChain", "[", 
           RowBox[{"coinm", ",", "newRun", ",", "\"\<cpa\>\""}], "]"}], ",", 
          RowBox[{"getCoinFromChain", "[", 
           RowBox[{"coinn", ",", "newRun", ",", "\"\<cpa\>\""}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"newEdgeAngles", " ", "=", 
        RowBox[{"Association", "@@", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "->", " ", 
             RowBox[{"coinNumberPairAngle", "[", " ", 
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "&"}], ",", 
           "newEdges"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "DEdgeAngle", "]"}], "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "DEdgeAngle", "]"}], ",", 
          "newEdgeAngles"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "ContactGraph", "]"}], "=", " ", 
        RowBox[{"EdgeAdd", "[", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "ContactGraph", "]"}], ",", 
          "newEdges"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coinZ", "[", 
           RowBox[{"nextCoin", ",", 
            RowBox[{
             RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
             "]"}]}], "]"}], ">", 
          RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}], "=", " ", 
          RowBox[{"coinZ", "[", 
           RowBox[{"nextCoin", ",", 
            RowBox[{
             RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<phi\>\"", 
             "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"thisChain", " ", "=", " ", 
        RowBox[{"findGraphFront", "[", 
         RowBox[{
          RowBox[{"coinNumber", "[", 
           RowBox[{"First", "[", "nextCoinSet", "]"}], "]"}], ",", 
          "nodeAssociation"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"nodeAssociation", "[", "ChainsByCoinNumber", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"para2", ",", 
          RowBox[{
           RowBox[{"coinNumber", "[", "nextCoin", "]"}], "->", 
           "thisChain"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "ChainsByCoinNumber", "]"}], " ", "=",
         " ", "para2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", "thisChain", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], " ", 
          "=", " ", 
          RowBox[{"Association", "[", "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"bareChain", " ", "=", " ", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"bareNumber", "/@", "thisChain"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MissingQ", "[", "thisChain", "]"}]}], "&&", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], "]"}],
            "==", "0"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], "=", 
           " ", 
           RowBox[{"KeyTake", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nodeAssociation", "[", "CoinAssociation", "]"}], ",", 
             "bareChain"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"!", 
           RowBox[{"MissingQ", "[", "thisChain", "]"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], "]"}],
            ">", "0"}]}], " ", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"drop", " ", "=", " ", 
           RowBox[{"Complement", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Keys", "[", 
              RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], 
              "]"}], ",", "\[IndentingNewLine]", "bareChain"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], " ", 
           "=", " ", 
           RowBox[{"KeyDrop", "[", "  ", 
            RowBox[{
             RowBox[{"nodeAssociation", "[", "CurrentChainDisks", "]"}], ",", 
             "drop"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"para2", " ", "=", " ", 
        RowBox[{"nodeAssociation", "[", "Parastichy", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"para2", "[", 
         RowBox[{"coinNumber", "[", "nextCoin", "]"}], "]"}], " ", "=", 
        RowBox[{"chainParastichyCount", "[", 
         RowBox[{"thisChain", ",", "nodeAssociation"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodeAssociation", "[", "Parastichy", "]"}], " ", "=", " ", 
        "para2"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "nodeAssociation", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8569476946458654`*^9, {3.8569783963344917`*^9, 3.856978428421009*^9}, 
   3.8571904084640713`*^9, {3.8572020947882094`*^9, 3.8572021164611206`*^9}, 
   3.8572021692796144`*^9, {3.8572022772916565`*^9, 3.8572023062531633`*^9}, {
   3.8572023874599113`*^9, 3.8572025176531863`*^9}, {3.8572025533155913`*^9, 
   3.8572025838012486`*^9}, {3.857202662348343*^9, 3.857202680149577*^9}, {
   3.8572027524493756`*^9, 3.8572028645956116`*^9}, {3.857202904158513*^9, 
   3.857202919584724*^9}, {3.8572030039365396`*^9, 3.85720300592914*^9}, {
   3.8572030655171156`*^9, 3.857203135682062*^9}, {3.857203166560198*^9, 
   3.857203374930234*^9}, {3.8572034067121515`*^9, 3.8572034090864954`*^9}, 
   3.857203496728602*^9, {3.8572035315010633`*^9, 3.857203537415497*^9}, {
   3.8572035731034355`*^9, 3.8572035815993133`*^9}, {3.8572036416224685`*^9, 
   3.8572036444046345`*^9}, {3.8572036764010663`*^9, 
   3.8572038300225525`*^9}, {3.857203919018691*^9, 3.857203927882498*^9}, {
   3.857203966560653*^9, 3.857204054979351*^9}, {3.857204181350184*^9, 
   3.8572041858655806`*^9}, {3.857205788118972*^9, 3.857205789019232*^9}, {
   3.8572068020503387`*^9, 3.8572068031519136`*^9}, {3.8572069019875903`*^9, 
   3.857206902440379*^9}, {3.8572074648446283`*^9, 3.8572075082901735`*^9}, {
   3.85747225835172*^9, 3.857472435298279*^9}, {3.857472483194206*^9, 
   3.8574724905016575`*^9}, {3.8574725235174203`*^9, 3.857472558535039*^9}, 
   3.857473755329666*^9, {3.8574788551113253`*^9, 3.857478874908419*^9}, {
   3.8574789086805077`*^9, 3.8574789269506516`*^9}, {3.857479185008768*^9, 
   3.8574792036376085`*^9}, 
   3.857634249642333*^9},ExpressionUUID->"f6641d9c-01c5-4a74-8331-\
fd6c0316d706"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nextCoinRadius", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "h1", ",", "h2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h1", "=", " ", 
       RowBox[{
        RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "HighestCoinZ", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"r", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<rFunction\>\"",
          "]"}], "[", "h1", "]"}]}], ";", "\[IndentingNewLine]", "r"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.857023211647301*^9, 3.8570232145781937`*^9}, {
  3.857190632128996*^9, 3.857190660996131*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"e0a0ad5c-b6b7-449f-aa53-4799160440dc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run implementation", "Subsection",
 CellChangeTimes->{{3.8571906746572547`*^9, 
  3.8571906821071024`*^9}},ExpressionUUID->"def335d8-3501-4c7b-bdbd-\
53f5b6469018"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "function", " ", "called", " ", "by", " ", "Chapter", " ", "8", " ", 
    "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"stackFrontFromIC", "[", 
      RowBox[{"icCoins_", ",", "arenaAssociation_"}], "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"arena", ",", "icRun"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"arena", " ", "=", " ", "arenaAssociation"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", 
           RowBox[{"arena", "[", "\"\<ArenaType\>\"", "]"}], "]"}], ",", 
          RowBox[{"arena", " ", "=", " ", 
           RowBox[{"Append", "[", 
            RowBox[{"arena", ",", 
             RowBox[{"\"\<ArenaType\>\"", "->", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"MissingQ", "[", 
                  RowBox[{"arena", "[", "\"\<phi\>\"", "]"}], "]"}], " ", "||",
                  " ", 
                 RowBox[{
                  RowBox[{"arena", "[", "\"\<phi\>\"", "]"}], "==", "0"}]}], 
                ",", "\"\<Cylinder\>\"", ",", "\"\<Cone\>\""}], "]"}]}]}], 
            "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"icRun", " ", "=", " ", 
         RowBox[{"initializeRunFromIC", "[", 
          RowBox[{"icCoins", ",", "arena"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"executeStacking", "[", "icRun", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"initializeRunFromIC", "[", 
      RowBox[{"icCoins_", ",", "arenaAssociation_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"run", ",", "highestCoinZ", ",", "nodeAssociation"}], "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"highestCoinZ", " ", "=", " ", 
         RowBox[{"Max", "[", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coinZ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"arenaAssociation", "[", "\"\<phi\>\"", "]"}]}], "]"}],
              "&"}], ",", "icCoins"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"nodeAssociation", " ", "=", "  ", 
         RowBox[{"Association", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ContactGraph", "->", 
            RowBox[{"Graph", "[", 
             RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"DEdgeAngle", "->", 
            RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"Parastichy", "\[Rule]", 
            RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"ChainsByCoinNumber", " ", "->", "  ", 
            RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"InitialCoins", "\[Rule]", 
            RowBox[{"(*", "icCoins", "*)"}], " ", 
            RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"CoinAssociation", "\[Rule]", 
            RowBox[{"Association", "@", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"First", "[", "#", "]"}], "->", "#"}], "&"}], ",", 
               "icCoins"}], "]"}]}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"CurrentChainDisks", " ", "\[Rule]", 
            RowBox[{"Association", "[", "]"}]}], "\[IndentingNewLine]", ",", 
           RowBox[{"MostRecentCoin", " ", "->", " ", 
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "icCoins", "]"}], "]"}]}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"HighestCoinZ", "->", " ", "highestCoinZ"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"run", " ", "=", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<State\>\"", "->", " ", "nodeAssociation"}], ",", 
           RowBox[{"\"\<Arena\>\"", "->", "arenaAssociation"}]}], "|>"}]}], 
        ";", "\[IndentingNewLine]", "run"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"restartRun", "[", 
      RowBox[{"run_", ",", "extraCoinCount_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "arena"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"pruneRunToLastChain", "[", "run", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"arena", " ", "=", " ", 
         RowBox[{"res", "[", "\"\<Arena\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"arena", "[", "\"\<coinMax\>\"", "]"}], "=", 
         "extraCoinCount"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"arena", "[", "\"\<cylinderLU\>\"", "]"}], "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"arena", "[", "\"\<cylinderLU\>\"", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
           "100"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<Arena\>\"", "]"}], "=", "arena"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"executeStacking", "[", "res", "]"}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8569474108981676`*^9, 3.8569474450311346`*^9}, 
   3.85694791651422*^9, {3.856948280429024*^9, 3.856948280514798*^9}, {
   3.8569767039944243`*^9, 3.8569767086391644`*^9}, 3.8571269418101587`*^9, {
   3.857201899955621*^9, 3.8572019325120153`*^9}, 3.857202203996524*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"a2972f55-e319-40a1-877f-dd1884a8fe19"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"executeStacking", "[", "icRun_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "run", ",", "highestCoinZ", ",", "k", ",", "phi", ",", 
        "parastichyTop"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"run", " ", "=", "icRun"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "0"}], ",", 
           RowBox[{"k", "<", "500"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"tim", ",", "run"}], " ", "}"}], " ", "=", " ", 
             RowBox[{"Timing", "[", " ", 
              RowBox[{"addNextCoinCone", "[", "run", "]"}], " ", "]"}]}], ";",
             "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"stoppingIndicator", "[", "run", "]"}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"monitorIndicator", "[", 
          RowBox[{"run", ",", "tim"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"run", " ", "=", " ", 
        RowBox[{"makeRunContactGraphXY", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", "run"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stoppingIndicator", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "highestCoinZ", ",", "arenaAssociation", ",", "nodeAssociation", ",", 
        "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nodeAssociation", "=", 
        RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"arenaAssociation", "=", 
        RowBox[{"run", "[", "\"\<Arena\>\"", "]"}]}], ";", 
       RowBox[{"highestCoinZ", " ", "=", "  ", 
        RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"highestCoinZ", "+", " ", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"arenaAssociation", "[", "\"\<rFunction\>\"", "]"}], 
              "[", "highestCoinZ", "]"}]}]}], ">", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"arenaAssociation", "[", "\"\<cylinderLU\>\"", "]"}], 
             ")"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ",", "True", ",", "False"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"res", " ", "||", " ", 
         RowBox[{
          RowBox[{"nodeAssociation", "[", "MostRecentCoin", "]"}], ">=", 
          RowBox[{
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", "\"\<coinMax\>\"",
            "]"}]}]}]}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitorIndicator", "[", 
    RowBox[{"run_", ",", "tim_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "parastichyTop", ",", "highestCoinZ", ",", "\[IndentingNewLine]", 
       "arenaAssociation", ",", "nodeAssociation"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nodeAssociation", "=", 
       RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arenaAssociation", "=", 
       RowBox[{"run", "[", "\"\<Arena\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"parastichyTop", " ", "=", " ", 
       RowBox[{"KeyTake", "[", 
        RowBox[{
         RowBox[{"nodeAssociation", "[", "Parastichy", "]"}], ",", 
         RowBox[{"Last", "[", 
          RowBox[{"Keys", "@", 
           RowBox[{"nodeAssociation", "[", "Parastichy", "]"}]}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"highestCoinZ", " ", "=", "  ", 
       RowBox[{"nodeAssociation", "[", "HighestCoinZ", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ProgressIndicator", "[", "\[IndentingNewLine]", 
         RowBox[{"highestCoinZ", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"arenaAssociation", "[", "\"\<cylinderLU\>\"", "]"}], 
              ")"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<coin\>\"", "->", " ", 
         RowBox[{"nodeAssociation", "[", "MostRecentCoin", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<h\>\"", "->", "highestCoinZ"}], ",", 
        RowBox[{"\"\<r\>\"", "->", 
         RowBox[{
          RowBox[{"arenaAssociation", "[", "\"\<rFunction\>\"", "]"}], "[", 
          "highestCoinZ", "]"}]}], ",", " ", "parastichyTop", ",", "tim"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856887506536969*^9, 3.856887541817913*^9}, {
   3.856887792021962*^9, 3.8568878554674377`*^9}, {3.8568879443839784`*^9, 
   3.85688801862976*^9}, {3.856888560643253*^9, 3.856888592323385*^9}, {
   3.856888666134199*^9, 3.856888684903555*^9}, {3.8568887522209406`*^9, 
   3.8568888107594013`*^9}, 3.8568888546125712`*^9, {3.8568889513815117`*^9, 
   3.8568889687788897`*^9}, {3.8568890554621677`*^9, 
   3.8568890556339846`*^9}, {3.8568891066678057`*^9, 3.85688911783703*^9}, {
   3.8568891935063195`*^9, 3.8568891976771398`*^9}, {3.8568892415666924`*^9, 
   3.856889249596019*^9}, {3.856889287014114*^9, 3.8568893062712393`*^9}, 
   3.85689394550881*^9, 3.856894654504861*^9, {3.856894709095279*^9, 
   3.856894787465933*^9}, 3.8568951890394945`*^9, {3.856947995146341*^9, 
   3.856947997463334*^9}, {3.856948028846595*^9, 3.8569480386391983`*^9}, {
   3.8569481078353224`*^9, 3.8569481729260697`*^9}, 3.8569482872361927`*^9, {
   3.8569483242829742`*^9, 3.8569483251614285`*^9}, {3.8569540120107813`*^9, 
   3.8569540398591995`*^9}, {3.8569556349384813`*^9, 
   3.8569556810001965`*^9}, {3.856956752772873*^9, 3.856956779051503*^9}, {
   3.8569775087302523`*^9, 3.856977552073371*^9}, 3.8569775823294034`*^9, {
   3.856977954007395*^9, 3.856977959111758*^9}, {3.857023223112054*^9, 
   3.8570232234931746`*^9}, {3.8570238528558865`*^9, 3.8570238747449346`*^9}, 
   3.8570265056020393`*^9, {3.8571253260774393`*^9, 3.857125334020835*^9}, {
   3.857125365145632*^9, 3.8571253786908712`*^9}, {3.85718833974711*^9, 
   3.857188343272195*^9}, {3.8571887449518805`*^9, 3.8571888004798346`*^9}, 
   3.8571906997566276`*^9},
 CellLabel->
  "In[139]:=",ExpressionUUID->"f701992d-1388-4d72-b20d-5b59e9c0026b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["General", "Subsection",
 CellChangeTimes->{{3.857190701394922*^9, 
  3.8571907066178927`*^9}},ExpressionUUID->"655e9006-4dc7-4128-9ede-\
b95ba9b867d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"currentChain", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "chainNumbers"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", " ", 
        RowBox[{"highestCoinNumber", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chainNumbers", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
          "ChainsByCoinNumber", "]"}], "[", "n", "]"}]}], ";", 
       "\[IndentingNewLine]", "chainNumbers"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"addNextCoinCone", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"chainNumbers", ",", "state", ",", "res"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainNumbers", "=", 
        RowBox[{"currentChain", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", "chainNumbers", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Doing unchained at \>\"", ",", 
            RowBox[{"highestCoinNumber", "[", "run", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", " ", "=", " ", 
           RowBox[{"unchainedNextState", "[", "run", "]"}]}]}], 
         "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
         RowBox[{"state", " ", "=", " ", 
          RowBox[{"chainedNextState", "[", "run", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<State\>\"", "->", " ", "state"}], ",", 
          RowBox[{"\"\<Arena\>\"", "->", 
           RowBox[{"run", "[", "\"\<Arena\>\"", "]"}]}]}], "|>"}]}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainedNextState", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lowest", ",", "nextCoin", ",", "nextCoinLowerNeighbours", ",", 
       "nAres"}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lowest", " ", "=", " ", 
       RowBox[{"nextCoinAndContacts", "[", "run", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MissingQ", "[", "lowest", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<chain cannot be added to after coin \>\"", ",", " ", 
           RowBox[{"highestCoinNumber", "[", "run", "]"}]}], " ", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nextCoin", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lowest", "[", "\"\<CoinNumber\>\"", "]"}], ",", 
         RowBox[{"lowest", "[", "\"\<CoinDisk\>\"", "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nextCoinLowerNeighbours", " ", "=", " ", 
       RowBox[{"lowest", "[", "\"\<CoinNeighbours\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nAres", " ", "=", " ", 
       RowBox[{"updateNeighbourFunction", "[", 
        RowBox[{"nextCoin", ",", "nextCoinLowerNeighbours", ",", "run"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "nAres"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->
  True,ExpressionUUID->"26e81a0a-5e5b-44af-ab9f-0e666b48fded"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nextCoinAndContacts", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"r", ",", "diskPairNumbers", ",", "lowestPair"}], "}"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"r", "=", " ", 
        RowBox[{"nextCoinRadius", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"diskPairNumbers", " ", "=", 
        RowBox[{"nextCoinOptions", "[", 
         RowBox[{"run", ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"lowestPair", " ", "=", " ", 
          RowBox[{"First", "@", 
           RowBox[{"SortBy", "[", 
            RowBox[{"diskPairNumbers", ",", 
             RowBox[{
              RowBox[{"Last", "[", "#Point", "]"}], "&"}]}], "]"}]}]}], ";"}],
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"newdiskPairNumbers", " ", "=", 
        RowBox[{"newnextCoinOptions", "[", 
         RowBox[{"run", ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newlowestPair", " ", "=", "  ", 
        RowBox[{"First", "@", 
         RowBox[{"SortBy", "[", 
          RowBox[{"newdiskPairNumbers", ",", 
           RowBox[{
            RowBox[{"Last", "[", "#Point", "]"}], "&"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"<|", " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<CoinNumber\>\"", "->", " ", 
          RowBox[{
           RowBox[{"highestCoinNumber", "[", "run", "]"}], "+", " ", "1"}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"\"\<CoinDisk\>\"", "->", " ", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"newlowestPair", "[", "\"\<Point\>\"", "]"}], ",", "r"}], 
           "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"\"\<CoinNeighbours\>\"", "->", 
          RowBox[{"newlowestPair", "[", "\"\<Pair\>\"", "]"}]}]}], " ", 
        "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->
  True,ExpressionUUID->"60132781-44f9-4b27-86e2-33a7b41bfbd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nextCoinOptions", "[", 
    RowBox[{"run_", ",", "r_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chainNumbers", ",", "localDisks", ",", "diskPairNumbers", ",", "yMax", 
       ",", "extendedDisk", ",", "pointInDisks", ",", "\[IndentingNewLine]", 
       "chainAndLeftNumbers", ",", "localAndLeftDisks"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chainNumbers", "=", 
       RowBox[{"currentChain", "[", "run", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"localDisks", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"Last", "@", 
             RowBox[{"getCoinFromChain", "[", 
              RowBox[{"#", ",", "run", ",", "\"\<localdisks\>\""}], "]"}]}]}],
            "&"}], ",", "chainNumbers"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"chainAndLeftNumbers", " ", "=", "chainNumbers"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chainAndLeftNumbers", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"chainNumbers", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"left", "[", 
              RowBox[{"bareNumber", "[", "#", "]"}], "]"}], "&"}], ",", 
            "chainNumbers"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chainAndLeftRightNumbers", " ", "=", " ", 
       RowBox[{"DeleteDuplicates", "[", 
        RowBox[{"Join", "[", 
         RowBox[{"chainNumbers", ",", "\[IndentingNewLine]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"left", "[", 
              RowBox[{"bareNumber", "[", "#", "]"}], "]"}], "&"}], ",", 
            "chainNumbers"}], "]"}], ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"right", "[", 
              RowBox[{"bareNumber", "[", "#", "]"}], "]"}], "&"}], ",", 
            "chainNumbers"}], "]"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<chain:\>\"", " ", ",", "chainNumbers"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<chainAndLeft:\>\"", ",", " ", "chainAndLeftNumbers"}], 
         "]"}], ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"localAndLeftDisks", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"Last", "@", 
             RowBox[{"getCoinFromChain", "[", 
              RowBox[{"#", ",", "run", ",", "\"\<localeftdisks\>\""}], 
              "]"}]}]}], "&"}], ",", "chainAndLeftNumbers"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"yMax", "=", " ", 
       RowBox[{"Max", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "2"}], "]"}], "]"}], "&"}], ",", 
          "localDisks"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yMax", " ", "=", " ", 
       RowBox[{"yMax", " ", "-", " ", "r"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"heuristic", " ", "-", " ", 
         RowBox[{
         "to", " ", "exclude", " ", "intersections", " ", "below", " ", "the",
           " ", "chain"}]}], ",", " ", 
        RowBox[{
        "but", " ", "misses", " ", "holes", " ", "when", " ", "r", " ", 
         "varying", " ", "fast", " ", "if", " ", "too", " ", "strict"}]}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"yMax", " ", "=", " ", 
       RowBox[{"-", "\[Infinity]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"allDistinctSortedPairs", "[", "chainAndLeftNumbers", "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"Map", "[", 
             RowBox[{"localAndLeftDisks", ",", "#"}], "]"}]}], "&"}], ",", 
          "diskPairNumbers"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"diskdiskUpperTouchingPoint", "[", 
           RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", "diskPairNumbers"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"DeleteMissing", "[", "diskPairNumbers", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"diskPairNumbers", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Last", "[", "#", "]"}], ">=", "yMax"}], "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Pair\>\"", "->", "#1"}], ",", 
            RowBox[{"\"\<Point\>\"", "->", "#2"}]}], "|>"}], "&"}], ",", 
         "diskPairNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"calcShift", ",", "diskPairNumbers"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", "=", 
       RowBox[{"computeExclusions", "[", 
        RowBox[{
        "diskPairNumbers", ",", "chainAndLeftRightNumbers", ",", "run", ",", 
         "r"}], "]"}]}], " ", ";", " ", "\[IndentingNewLine]", 
      RowBox[{"dp", "=", "diskPairNumbers"}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"diskPairNumbers", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"TrueQ", "[", "#Excluded", "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "diskPairNumbers"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856887900214071*^9, 3.856887900462079*^9}, {
   3.856890216099166*^9, 3.8568903847837963`*^9}, {3.856890467948381*^9, 
   3.856890515204425*^9}, {3.8568907012896347`*^9, 3.856890712430599*^9}, {
   3.856890749328204*^9, 3.8568908031488347`*^9}, {3.8568908549603148`*^9, 
   3.856890901341498*^9}, {3.8568909379506965`*^9, 3.856890989683014*^9}, {
   3.856891062043993*^9, 3.856891074315077*^9}, {3.856891140125272*^9, 
   3.856891185511138*^9}, 3.8568912227111597`*^9, {3.856891332273427*^9, 
   3.8568913411416883`*^9}, {3.8568913804673758`*^9, 
   3.8568913824605856`*^9}, {3.8568914408211517`*^9, 
   3.8568914695550256`*^9}, {3.8568914995827484`*^9, 
   3.8568915905138493`*^9}, {3.8568916487483807`*^9, 
   3.8568917226336193`*^9}, {3.8568917625811806`*^9, 3.856891800451206*^9}, {
   3.8568918534463673`*^9, 3.856891991445899*^9}, {3.8568920998058147`*^9, 
   3.856892130458727*^9}, {3.8568921628103914`*^9, 3.8568922930632143`*^9}, {
   3.856892340319947*^9, 3.856892561701888*^9}, {3.8568926714806795`*^9, 
   3.8568926914526167`*^9}, {3.8568927560159674`*^9, 
   3.8568928160902033`*^9}, {3.8568928502356777`*^9, 3.856892851669343*^9}, {
   3.8568929610609903`*^9, 3.856892963303528*^9}, {3.8568930146939163`*^9, 
   3.856893040153465*^9}, {3.856893072460146*^9, 3.8568930826247663`*^9}, {
   3.856893119063678*^9, 3.856893207970866*^9}, {3.8568932624707003`*^9, 
   3.856893263954732*^9}, {3.8568935003039093`*^9, 3.8568935116301937`*^9}, {
   3.8568935791334763`*^9, 3.856893589657753*^9}, {3.856893651557782*^9, 
   3.8568936698765383`*^9}, 3.8568937029912443`*^9, {3.856893782739919*^9, 
   3.856893813425339*^9}, {3.8568940330302444`*^9, 3.856894170623567*^9}, {
   3.8568942013231792`*^9, 3.856894342129407*^9}, {3.856894538801078*^9, 
   3.856894542551335*^9}, 3.8568951026211014`*^9, {3.8569495240122833`*^9, 
   3.8569495346550617`*^9}, {3.856953965759916*^9, 3.8569539866553535`*^9}, {
   3.856976138819652*^9, 3.856976271844668*^9}, {3.856976327892764*^9, 
   3.8569763496616244`*^9}, {3.8569765580341077`*^9, 3.856976571069826*^9}, {
   3.8569766229716873`*^9, 3.856976650319167*^9}, 3.8569768286966395`*^9, {
   3.8569769114115314`*^9, 3.856976922596374*^9}, {3.8569771042881165`*^9, 
   3.856977137888245*^9}, 3.856977326095533*^9, {3.856977851891387*^9, 
   3.8569778597437735`*^9}, {3.8570102371865835`*^9, 
   3.8570103272247105`*^9}, {3.85701036730394*^9, 3.857010386586419*^9}, {
   3.857010479454553*^9, 3.857010488877842*^9}, {3.85701057777584*^9, 
   3.8570106038819313`*^9}, {3.8570125224054956`*^9, 3.8570125342715836`*^9}, 
   3.857012579317604*^9, {3.8570126390261383`*^9, 3.8570126782148705`*^9}, {
   3.857012818433789*^9, 3.8570128267908897`*^9}, {3.857012875117757*^9, 
   3.857012901989237*^9}, {3.8570130700994606`*^9, 3.8570130726108913`*^9}, 
   3.8570137009241333`*^9, {3.857013786849537*^9, 3.8570137870576878`*^9}, 
   3.857013858328081*^9, {3.857013974170878*^9, 3.857013995988784*^9}, {
   3.8570196175430436`*^9, 3.8570196243561726`*^9}, {3.857020329973744*^9, 
   3.8570203949926786`*^9}, {3.8570205003836246`*^9, 3.857020502104081*^9}, {
   3.857020592719337*^9, 3.85702061386926*^9}, {3.857020791831822*^9, 
   3.857020813844076*^9}, {3.8570211748401737`*^9, 3.857021181262464*^9}, {
   3.857021590076315*^9, 3.8570216003178005`*^9}, {3.857021694720386*^9, 
   3.8570217867515125`*^9}, {3.857022980993922*^9, 3.8570230046059775`*^9}, {
   3.8570230468029647`*^9, 3.857023050512473*^9}, {3.857023230016488*^9, 
   3.857023230250808*^9}, 3.8570232888331985`*^9, {3.8570237772923837`*^9, 
   3.857023813376418*^9}, {3.8570240700427656`*^9, 3.857024096418992*^9}, {
   3.8570241460502067`*^9, 3.857024146934859*^9}, {3.8570257703884525`*^9, 
   3.8570257779509106`*^9}, 3.857026492062175*^9, {3.8570365948055754`*^9, 
   3.8570366642378488`*^9}, {3.8570367491274385`*^9, 3.857036757675004*^9}, {
   3.8570368488383636`*^9, 3.8570368556486864`*^9}, {3.8570369870539703`*^9, 
   3.8570369939303837`*^9}, {3.857037474719449*^9, 3.8570375537120275`*^9}, 
   3.8570376548894143`*^9, {3.8570376938420525`*^9, 3.8570376977788754`*^9}, {
   3.8570377750515394`*^9, 3.857037809018758*^9}, {3.8570379409118643`*^9, 
   3.85703796611367*^9}, {3.857038897370883*^9, 3.8570389234587526`*^9}, 
   3.857062921923441*^9, {3.857063597862331*^9, 3.8570638272066746`*^9}, 
   3.8570639409368877`*^9, {3.857063980378826*^9, 3.857064183790632*^9}, {
   3.8570643334967985`*^9, 3.8570643750750113`*^9}, {3.857064443551404*^9, 
   3.8570644663257895`*^9}, {3.857064527053348*^9, 3.8570645607185946`*^9}, {
   3.8570648001993427`*^9, 3.8570648053036985`*^9}, 3.8570649785370283`*^9, {
   3.857065060735474*^9, 3.85706506925828*^9}, {3.8570652524718285`*^9, 
   3.857065327896551*^9}, {3.857065398312546*^9, 3.8570653991673803`*^9}, {
   3.8570654485359664`*^9, 3.857065449582594*^9}, {3.85706553005721*^9, 
   3.8570655504020796`*^9}, {3.857065585049105*^9, 3.8570656324855824`*^9}, 
   3.857066266988491*^9, {3.8571248925092497`*^9, 3.8571249003631773`*^9}, 
   3.8571254715525675`*^9, {3.8571882489096727`*^9, 3.8571883065951347`*^9}, 
   3.857188356802001*^9, 3.8571889043290815`*^9, 3.857188967820746*^9, 
   3.857190083067108*^9, {3.8571907296584935`*^9, 3.857190730771329*^9}, {
   3.857205853006606*^9, 3.8572058553304567`*^9}, {3.8572069403697305`*^9, 
   3.85720696182862*^9}, {3.85747148843478*^9, 3.857471606749007*^9}, 
   3.857472715296717*^9},
 CellLabel->
  "In[147]:=",ExpressionUUID->"589bf961-4832-4f0b-b6b1-b30244e43547"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"currentChainLR", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "chainNumbers", ",", "rightCoin", ",", "rightmostPair", ",", "res"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainNumbers", "=", 
        RowBox[{"currentChain", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "chainNumbers", "]"}], "!=", 
          RowBox[{"First", "[", "chainNumbers", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<chain unlooped\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chainNumbers", "=", 
        RowBox[{"Drop", "[", 
         RowBox[{"chainNumbers", ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightCoin", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"chainNumbers", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"isBare", "[", "#", "]"}]}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "rightCoin", "]"}], "!=", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<multiple rights\>\"", "]"}], ";", 
          RowBox[{"Abort", "[", "]"}]}], "\[IndentingNewLine]", ",", 
         RowBox[{"rightCoin", "=", 
          RowBox[{"First", "[", "rightCoin", "]"}]}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"rightCoin", "=", 
        RowBox[{"bareNumber", "@", "rightCoin"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightCoin", "=", 
        RowBox[{"FirstPosition", "[", 
         RowBox[{"chainNumbers", ",", "rightCoin", ",", 
          RowBox[{"Missing", "[", "]"}], ",", "1"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"chainNumbers", "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{"chainNumbers", ",", 
          RowBox[{"rightCoin", "-", "1"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rightmostPair", " ", "=", " ", 
        RowBox[{"Take", "[", " ", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"chainNumbers", ",", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"-", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"rightmostPair", " ", "=", " ", 
        RowBox[{"left", "/@", " ", "rightmostPair"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{"rightmostPair", ",", "chainNumbers"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chainPairNumbersWithinRadius", "[", 
    RowBox[{"run_", ",", "disks_", ",", "chainNumbers_", ",", "r_"}], "]"}], 
   " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}], "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"nearPairsAfterI", "[", 
         RowBox[{
         "run", ",", "disks", ",", "\[IndentingNewLine]", "chainNumbers", ",",
           "r", ",", "i"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "chainNumbers", "]"}], "-", "1"}]}], 
         "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nearPairsAfterI", "[", 
    RowBox[{
    "run_", ",", "disks_", ",", "chainNumbers_", ",", "r_", ",", "i_"}], 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "xRightValue", ",", "xLeftValue", ",", "xRightN", ",", 
       "xLeftN", ",", "thisX", ",", "res"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"xRightValue", "[", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_"}], "}"}], ",", "rad_"}], "]"}], "]"}], ":=",
        " ", 
       RowBox[{"x", "+", "rad"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xLeftValue", "[", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_"}], "}"}], ",", "rad_"}], "]"}], "]"}], ":=",
        " ", 
       RowBox[{"x", "-", "rad"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xRightN", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"xRightValue", "[", 
        RowBox[{"disks", "[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xLeftN", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"xLeftValue", "[", 
        RowBox[{"disks", "[", "n", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thisX", " ", "=", " ", 
       RowBox[{"xRightN", "[", 
        RowBox[{
        "chainNumbers", "\[LeftDoubleBracket]", "i", 
         "\[RightDoubleBracket]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", 
         RowBox[{"i", "+", "1"}]}], ",", 
        RowBox[{"j", "<=", " ", 
         RowBox[{"Length", "[", "chainNumbers", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"xLeftN", "@", 
            RowBox[{
            "chainNumbers", "\[LeftDoubleBracket]", "j", 
             "\[RightDoubleBracket]"}]}], "  ", "<=", "  ", "thisX"}], " ", 
          ",", " ", 
          RowBox[{"res", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"res", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
               "chainNumbers", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "chainNumbers", "\[LeftDoubleBracket]", "j", 
                "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.857653663008686*^9, 3.8576536643741293`*^9}, {
  3.857653751987884*^9, 3.85765376797027*^9}, {3.857653836409258*^9, 
  3.857653837332728*^9}, {3.8576539124959984`*^9, 3.8576539135967073`*^9}, {
  3.857653951348278*^9, 3.857653990627203*^9}, {3.857706446600272*^9, 
  3.8577064643955746`*^9}},ExpressionUUID->"b81136a3-b726-4e6d-b369-\
571eb16c5b64"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"newnextCoinOptions", "[", 
    RowBox[{"run_", ",", "r_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "chainNumbers", ",", "localDisks", ",", "diskPairNumbers", ",", "yMax", 
       ",", "extendedDisk", ",", "pointInDisks", ",", "\[IndentingNewLine]", 
       "chainAndLeftNumbers", ",", "chainAndLeftRightNumbers", ",", 
       "localAndLeftDisks"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chainDebug", " ", "=", " ", "22"}], ";", 
      RowBox[{"debug", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "MostRecentCoin", 
         "]"}], "==", "chainDebug"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"chainNumbers", "=", " ", 
       RowBox[{"currentChain", "[", "run", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chainNumbersLR", " ", "=", " ", 
       RowBox[{"currentChainLR", "[", "run", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currentDisks", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"Last", "@", 
             RowBox[{"getCoinFromChain", "[", 
              RowBox[{"#", ",", "run", ",", "\"\<nnco1\>\""}], "]"}]}]}], 
           "&"}], ",", "\[IndentingNewLine]", "chainNumbersLR"}], "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"extendedDisks", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"extendRadius", "[", 
           RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", "currentDisks"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"chainPairsToTry", " ", "=", " ", 
       RowBox[{"chainPairNumbersWithinRadius", "[", 
        RowBox[{
        "run", ",", "extendedDisks", ",", "chainNumbersLR", ",", "r"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairsToTry", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"currentDisks", ",", "#"}], "]"}]}], "&"}], ",", 
          "chainPairsToTry"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"localDisks", " ", "=", " ", 
       RowBox[{"Association", "@", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", 
            RowBox[{"Last", "@", 
             RowBox[{"getCoinFromChain", "[", 
              RowBox[{"#", ",", "run", ",", "\"\<nnco\>\""}], "]"}]}]}], 
           "&"}], ",", "chainNumbers"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"chainAndLeftRightNumbers", " ", "=", " ", 
       RowBox[{"DeleteMissing", "@", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Join", "[", 
          RowBox[{"chainNumbers", ",", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{"moveNumberLeft", ",", "chainNumbers"}], "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"moveNumberRight", ",", "chainNumbers"}], "]"}]}], "]"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"debug", ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<chainlr:\>\"", ",", " ", "chainAndLeftRightNumbers"}], 
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", "diskPairsToTry"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"diskdiskUpperTouchingPoint", "[", 
           RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", "diskPairNumbers"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"DeleteMissing", "[", "diskPairNumbers", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<Pair\>\"", "->", "#1"}], ",", 
            RowBox[{"\"\<Point\>\"", "->", "#2"}]}], "|>"}], "&"}], ",", 
         "diskPairNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"calcShift", ",", "diskPairNumbers"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", "=", 
       RowBox[{"computeExclusions", "[", 
        RowBox[{
        "diskPairNumbers", ",", "chainAndLeftRightNumbers", ",", "run", ",", 
         "r"}], "]"}]}], " ", ";", "\[IndentingNewLine]", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{"\"\<InOtherDisk\>\"", "->", " ", 
              RowBox[{"checkPointInChain", "[", 
               RowBox[{"#", ",", "extendedDisks"}], "]"}]}], "|>"}]}], "]"}], 
          "&"}], ",", "diskPairNumbers"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"dp", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"diskPairNumbers", ",", 
             RowBox[{
              RowBox[{"#Excluded", "=!=", " ", 
               RowBox[{"!", 
                RowBox[{"MissingQ", "[", "#InOtherDisk", "]"}]}]}], "&"}]}], 
            "]"}]}], "]"}], "!=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<exclusion mismarch\>\"", ",", "dp"}], "]"}]}], 
       RowBox[{"(*", 
        RowBox[{";", 
         RowBox[{"Abort", "[", "]"}]}], "*)"}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"diskPairNumbers", ",", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"TrueQ", "[", "#Excluded", "]"}]}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "diskPairNumbers"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", "chainlr"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.857653601705651*^9, 3.857653627592825*^9}, {
   3.8576537782510204`*^9, 3.8576537785715923`*^9}, {3.8576538617668*^9, 
   3.8576538624580345`*^9}, 3.8576539277004447`*^9, {3.8576541998421307`*^9, 
   3.8576542030685425`*^9}, {3.85765488718082*^9, 3.8576548970439725`*^9}, {
   3.8576549644689193`*^9, 3.857654964701475*^9}, {3.8576552724324856`*^9, 
   3.857655285997566*^9}, {3.857655329413275*^9, 3.857655467160723*^9}, {
   3.85765560416772*^9, 3.857655658886216*^9}, {3.85765718809828*^9, 
   3.857657344040267*^9}, {3.85765740500774*^9, 3.857657429147964*^9}, 
   3.8577048176887937`*^9, {3.8577062361408916`*^9, 3.857706254266382*^9}, {
   3.85770641508875*^9, 3.8577064284105077`*^9}, {3.857708714273306*^9, 
   3.8577087203776245`*^9}, {3.857708782775215*^9, 
   3.857708784045714*^9}},ExpressionUUID->"fe5123f8-2d48-4c27-b2df-\
d4baaaea44f2"],

Cell[BoxData["chainlr"], "Output",
 CellChangeTimes->{3.8576573492241936`*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"6ededf73-81db-460f-916a-df4fea634e35"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkPointInChain", "[", 
    RowBox[{"diskPair_", ",", "extendedDisks_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"insideDisk", ",", "tooFarRight"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "requires", " ", "disks", " ", "to", " ", "be", " ", "in", " ", "x"}], 
       "-", "order"}], "  ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "also", " ", "requires", " ", "fixed", " ", "circumference", " ", "and",
        " ", "will", " ", "break", " ", "otherwise"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"insideDisk", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{"xy_", ",", "r_"}], "]"}], ",", "point_"}], "]"}], " ", ":=",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"point", "-", "xy"}], ")"}], ".", 
         RowBox[{"(", 
          RowBox[{"point", "-", "xy"}], ")"}]}], " ", "<=", " ", 
        RowBox[{"r", "^", "2"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"insideRightDisk", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{"xy_", ",", "r_"}], "]"}], ",", "point_"}], "]"}], " ", ":=",
        " ", 
       RowBox[{"insideDisk", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"xy", "+", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ",", "r"}], "]"}], ",", 
         "point"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tooFarRight", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{"xy_", ",", "r_"}], "]"}], ",", "point_"}], "]"}], " ", ":=",
        " ", 
       RowBox[{
        RowBox[{
         RowBox[{"xy", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", 
         RowBox[{"point", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], " ", ">", " ", "r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tooFarRightRight", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{"xy_", ",", "r_"}], "]"}], ",", "point_"}], "]"}], " ", ":=", 
       RowBox[{"tooFarRight", "[", 
        RowBox[{
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"xy", "+", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}], ",", "r"}], "]"}], ",", 
         "point"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"inDisk", "=", 
       RowBox[{"Missing", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"diskPair", "[", "\"\<Pair\>\"", "]"}], "==", 
           RowBox[{"{", 
            RowBox[{"84", ",", 
             RowBox[{"right", "[", "87", "]"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
             RowBox[{"diskPair", "[", "\"\<Pair\>\"", "]"}], ",", 
             "\"\<:\>\""}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<\>\"", ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"<|", 
                 RowBox[{
                  RowBox[{"\"\<indisk\>\"", "->", " ", 
                   RowBox[{"insideDisk", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<inrightdisk\>\"", "->", 
                   RowBox[{"insideRightDisk", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], 
                    "]"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{"\"\<toofarright\>\"", "->", " ", 
                   RowBox[{"tooFarRight", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", ",", 
                  RowBox[{"\"\<toofarrightright\>\"", "->", " ", 
                   RowBox[{"tooFarRightRight", "[", 
                    RowBox[{"#", ",", " ", 
                    RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], 
                    "]"}]}]}], "|>"}], "&"}], ",", "extendedDisks"}], "]"}]}],
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Keys", "[", "extendedDisks", "]"}], "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{
           RowBox[{"Keys", "[", "extendedDisks", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", " ", 
            RowBox[{
             RowBox[{"diskPair", "[", "\"\<Pair\>\"", "]"}], ",", "n"}], 
            "]"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"insideDisk", "[", 
            RowBox[{
             RowBox[{"extendedDisks", "[", "n", "]"}], ",", " ", 
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], ",", 
           RowBox[{"Return", "[", "n", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tooFarRight", "[", 
            RowBox[{
             RowBox[{"extendedDisks", "[", "n", "]"}], ",", 
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", " ", 
         RowBox[{"Length", "[", 
          RowBox[{"Keys", "[", "extendedDisks", "]"}], "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "=", 
          RowBox[{
           RowBox[{"Keys", "[", "extendedDisks", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", " ", 
            RowBox[{
             RowBox[{"diskPair", "[", "\"\<Pair\>\"", "]"}], ",", 
             RowBox[{"moveNumberRight", "[", "n", "]"}]}], "]"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"insideRightDisk", "[", 
            RowBox[{
             RowBox[{"extendedDisks", "[", "n", "]"}], ",", " ", 
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"moveNumberRight", "[", "n", "]"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"tooFarRightRight", "[", 
            RowBox[{
             RowBox[{"extendedDisks", "[", "n", "]"}], ",", 
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], ",", 
           RowBox[{"Return", "[", 
            RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "\"\<cPIC Got to end of right chain\>\"", "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "@", 
       RowBox[{"Map", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"tooFarRight", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], "&"}], 
         ",", "extendedDisks"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"tooFarRightRight", "[", 
           RowBox[{"#", ",", " ", 
            RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}]}], "]"}], "&"}], 
         ",", "extendedDisks"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Abort", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "inChain", "]"}], ";"}]}], "\[IndentingNewLine]",
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856887900214071*^9, 3.856887900462079*^9}, {
   3.856890216099166*^9, 3.8568903847837963`*^9}, {3.856890467948381*^9, 
   3.856890515204425*^9}, {3.8568907012896347`*^9, 3.856890712430599*^9}, {
   3.856890749328204*^9, 3.8568908031488347`*^9}, {3.8568908549603148`*^9, 
   3.856890901341498*^9}, {3.8568909379506965`*^9, 3.856890989683014*^9}, {
   3.856891062043993*^9, 3.856891074315077*^9}, {3.856891140125272*^9, 
   3.856891185511138*^9}, 3.8568912227111597`*^9, {3.856891332273427*^9, 
   3.8568913411416883`*^9}, {3.8568913804673758`*^9, 
   3.8568913824605856`*^9}, {3.8568914408211517`*^9, 
   3.8568914695550256`*^9}, {3.8568914995827484`*^9, 
   3.8568915905138493`*^9}, {3.8568916487483807`*^9, 
   3.8568917226336193`*^9}, {3.8568917625811806`*^9, 3.856891800451206*^9}, {
   3.8568918534463673`*^9, 3.856891991445899*^9}, {3.8568920998058147`*^9, 
   3.856892130458727*^9}, {3.8568921628103914`*^9, 3.8568922930632143`*^9}, {
   3.856892340319947*^9, 3.856892561701888*^9}, {3.8568926714806795`*^9, 
   3.8568926914526167`*^9}, {3.8568927560159674`*^9, 
   3.8568928160902033`*^9}, {3.8568928502356777`*^9, 3.856892851669343*^9}, {
   3.8568929610609903`*^9, 3.856892963303528*^9}, {3.8568930146939163`*^9, 
   3.856893040153465*^9}, {3.856893072460146*^9, 3.8568930826247663`*^9}, {
   3.856893119063678*^9, 3.856893207970866*^9}, {3.8568932624707003`*^9, 
   3.856893263954732*^9}, {3.8568935003039093`*^9, 3.8568935116301937`*^9}, {
   3.8568935791334763`*^9, 3.856893589657753*^9}, {3.856893651557782*^9, 
   3.8568936698765383`*^9}, 3.8568937029912443`*^9, {3.856893782739919*^9, 
   3.856893813425339*^9}, {3.8568940330302444`*^9, 3.856894170623567*^9}, {
   3.8568942013231792`*^9, 3.856894342129407*^9}, {3.856894538801078*^9, 
   3.856894542551335*^9}, 3.8568951026211014`*^9, {3.8569495240122833`*^9, 
   3.8569495346550617`*^9}, {3.856953965759916*^9, 3.8569539866553535`*^9}, {
   3.856976138819652*^9, 3.856976271844668*^9}, {3.856976327892764*^9, 
   3.8569763496616244`*^9}, {3.8569765580341077`*^9, 3.856976571069826*^9}, {
   3.8569766229716873`*^9, 3.856976650319167*^9}, 3.8569768286966395`*^9, {
   3.8569769114115314`*^9, 3.856976922596374*^9}, {3.8569771042881165`*^9, 
   3.856977137888245*^9}, 3.856977326095533*^9, {3.856977851891387*^9, 
   3.8569778597437735`*^9}, {3.8570102371865835`*^9, 
   3.8570103272247105`*^9}, {3.85701036730394*^9, 3.857010386586419*^9}, {
   3.857010479454553*^9, 3.857010488877842*^9}, {3.85701057777584*^9, 
   3.8570106038819313`*^9}, {3.8570125224054956`*^9, 3.8570125342715836`*^9}, 
   3.857012579317604*^9, {3.8570126390261383`*^9, 3.8570126782148705`*^9}, {
   3.857012818433789*^9, 3.8570128267908897`*^9}, {3.857012875117757*^9, 
   3.857012901989237*^9}, {3.8570130700994606`*^9, 3.8570130726108913`*^9}, 
   3.8570137009241333`*^9, {3.857013786849537*^9, 3.8570137870576878`*^9}, 
   3.857013858328081*^9, {3.857013974170878*^9, 3.857013995988784*^9}, {
   3.8570196175430436`*^9, 3.8570196243561726`*^9}, {3.857020329973744*^9, 
   3.8570203949926786`*^9}, {3.8570205003836246`*^9, 3.857020502104081*^9}, {
   3.857020592719337*^9, 3.85702061386926*^9}, {3.857020791831822*^9, 
   3.857020813844076*^9}, {3.8570211748401737`*^9, 3.857021181262464*^9}, {
   3.857021590076315*^9, 3.8570216003178005`*^9}, {3.857021694720386*^9, 
   3.8570217867515125`*^9}, {3.857022980993922*^9, 3.8570230046059775`*^9}, {
   3.8570230468029647`*^9, 3.857023050512473*^9}, {3.857023230016488*^9, 
   3.857023230250808*^9}, 3.8570232888331985`*^9, {3.8570237772923837`*^9, 
   3.857023813376418*^9}, {3.8570240700427656`*^9, 3.857024096418992*^9}, {
   3.8570241460502067`*^9, 3.857024146934859*^9}, {3.8570257703884525`*^9, 
   3.8570257779509106`*^9}, 3.857026492062175*^9, {3.8570365948055754`*^9, 
   3.8570366642378488`*^9}, {3.8570367491274385`*^9, 3.857036757675004*^9}, {
   3.8570368488383636`*^9, 3.8570368556486864`*^9}, {3.8570369870539703`*^9, 
   3.8570369939303837`*^9}, {3.857037474719449*^9, 3.8570375537120275`*^9}, 
   3.8570376548894143`*^9, {3.8570376938420525`*^9, 3.8570376977788754`*^9}, {
   3.8570377750515394`*^9, 3.857037809018758*^9}, {3.8570379409118643`*^9, 
   3.85703796611367*^9}, {3.857038897370883*^9, 3.8570389234587526`*^9}, 
   3.857062921923441*^9, {3.857063597862331*^9, 3.8570638272066746`*^9}, 
   3.8570639409368877`*^9, {3.857063980378826*^9, 3.857064183790632*^9}, {
   3.8570643334967985`*^9, 3.8570643750750113`*^9}, {3.857064443551404*^9, 
   3.8570644663257895`*^9}, {3.857064527053348*^9, 3.8570645607185946`*^9}, {
   3.8570648001993427`*^9, 3.8570648053036985`*^9}, 3.8570649785370283`*^9, {
   3.857065060735474*^9, 3.85706506925828*^9}, {3.8570652524718285`*^9, 
   3.857065327896551*^9}, {3.857065398312546*^9, 3.8570653991673803`*^9}, {
   3.8570654485359664`*^9, 3.857065449582594*^9}, {3.85706553005721*^9, 
   3.8570655504020796`*^9}, {3.857065585049105*^9, 3.8570656324855824`*^9}, 
   3.857066266988491*^9, {3.8571248925092497`*^9, 3.8571249003631773`*^9}, 
   3.8571254715525675`*^9, {3.8571882489096727`*^9, 3.8571883065951347`*^9}, 
   3.857188356802001*^9, 3.8571889043290815`*^9, 3.857188967820746*^9, 
   3.8572058151508884`*^9, {3.8572071173806534`*^9, 3.8572071229139876`*^9}, {
   3.8572613203833323`*^9, 3.8572613855494833`*^9}, {3.85726154559735*^9, 
   3.857261570338207*^9}, {3.8572616380140324`*^9, 3.8572616580918226`*^9}, 
   3.857261694666503*^9, {3.8576540535535946`*^9, 3.8576540688487186`*^9}, {
   3.8576541037093763`*^9, 3.8576541064391785`*^9}, {3.85765416271716*^9, 
   3.857654162934303*^9}, {3.857654215038186*^9, 3.8576542599913883`*^9}, 
   3.857654317320162*^9, {3.8576543505718346`*^9, 3.85765441224198*^9}, {
   3.857654501821556*^9, 3.8576545263025227`*^9}, 3.8576546254857426`*^9, {
   3.857654970239828*^9, 3.857654979225335*^9}, {3.857655047130412*^9, 
   3.8576550698832664`*^9}, {3.8576555007921824`*^9, 
   3.8576555993866005`*^9}, {3.8576556322890463`*^9, 3.8576556482482595`*^9}, 
   3.857655759130001*^9, {3.857655869878439*^9, 3.8576560505845585`*^9}, {
   3.857656083737153*^9, 3.857656092680202*^9}, {3.8576561228551598`*^9, 
   3.8576562218157377`*^9}, {3.8576563884677167`*^9, 
   3.8576565076603513`*^9}, {3.8576565401951094`*^9, 3.85765669647392*^9}, {
   3.85765675444562*^9, 3.857656881768649*^9}, {3.857656953238577*^9, 
   3.857656955491726*^9}, {3.8576570124188995`*^9, 3.857657072695755*^9}, {
   3.8576571124152203`*^9, 3.857657113126542*^9}, {3.8576571553753123`*^9, 
   3.857657159668399*^9}, 3.8576575910321703`*^9, {3.8576576725947995`*^9, 
   3.857657732903737*^9}, {3.8576577811536837`*^9, 3.857657825236592*^9}, {
   3.8576578946633196`*^9, 3.8576579385907626`*^9}, {3.8576579821616435`*^9, 
   3.8576580522924223`*^9}, 3.8576582383685265`*^9, {3.8576582706757617`*^9, 
   3.8576582845562067`*^9}, 3.8576583417776957`*^9, {3.85765843520325*^9, 
   3.8576586471780033`*^9}, 3.8577044114667797`*^9, {3.8577044520737095`*^9, 
   3.8577045246202884`*^9}, {3.857704588097886*^9, 3.857704611438363*^9}, {
   3.8577046473333306`*^9, 3.8577046492898808`*^9}, {3.857704903310422*^9, 
   3.8577049501420918`*^9}, {3.8577049929608994`*^9, 3.857705018717105*^9}, {
   3.8577051192884903`*^9, 3.8577051395741663`*^9}, {3.8577052351702757`*^9, 
   3.857705237615288*^9}, 3.8577077444995184`*^9, {3.8577078268300977`*^9, 
   3.857707853961943*^9}, {3.857707900144396*^9, 3.8577079060734634`*^9}, {
   3.8577080006637506`*^9, 3.8577080539992485`*^9}, {3.8577081414905643`*^9, 
   3.8577081474699235`*^9}, {3.8577081845821567`*^9, 3.857708270803174*^9}, {
   3.8577083304377375`*^9, 3.8577083315092244`*^9}, {3.857708370367674*^9, 
   3.857708371259427*^9}, {3.857708440089549*^9, 3.857708440464835*^9}, {
   3.8577085546712017`*^9, 3.8577085632498617`*^9}, {3.8577086150081177`*^9, 
   3.85770867381768*^9}, {3.8577087456973543`*^9, 3.8577087459608793`*^9}, {
   3.8577088960416927`*^9, 3.857708896293337*^9}, {3.8577089447342787`*^9, 
   3.857708947603001*^9}, 
   3.857708996322124*^9},ExpressionUUID->"973eaff8-774d-451f-98a9-\
776dc7437548"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"computeExclusions", "[", 
    RowBox[{
    "diskPairNumbersA_", ",", "exclusionDiskNumbers_", ",", "run_", ",", 
     "r_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"diskPairNumbers", "=", "diskPairNumbersA"}], ",", 
       "extendedDisk", ",", "pointInDisks"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"<|", "\[IndentingNewLine]", 
             RowBox[{"\"\<RestOfChain\>\"", "->", 
              RowBox[{"Complement", "[", 
               RowBox[{"exclusionDiskNumbers", ",", "#Pair"}], "]"}]}], 
             "|>"}]}], "]"}], "&"}], ",", "diskPairNumbers"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"extendedDisk", "[", "number_", "]"}], " ", ":=", " ", 
       RowBox[{"extendRadius", "[", 
        RowBox[{
         RowBox[{"getCoinFromChain", "[", 
          RowBox[{"number", ",", "run", ",", "\"\<er\>\""}], "]"}], ",", 
         "r"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pointInDisks", "[", 
        RowBox[{"point_", ",", "diskNumbers_"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"res", "=", 
           RowBox[{"Association", "@", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "->", 
                RowBox[{"RegionMember", "[", 
                 RowBox[{
                  RowBox[{"extendedDisk", "[", "#", "]"}], ",", "point"}], 
                 "]"}]}], "&"}], ",", "diskNumbers"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"res", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"res", ",", "TrueQ"}], "]"}]}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", 
            RowBox[{"\"\<ExcludedBy\>\"", "->", 
             RowBox[{"pointInDisks", "[", 
              RowBox[{"#Point", ",", "#RestOfChain"}], "]"}]}]}], "]"}], 
          "&"}], ",", "\[IndentingNewLine]", "diskPairNumbers"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"diskPairNumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Append", "[", 
           RowBox[{"#", ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<Excluded\>\"", "->", 
             RowBox[{"Or", "@@", 
              RowBox[{"Values", "[", "#ExcludedBy", "]"}]}]}]}], "]"}], "&"}],
          ",", "diskPairNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "diskPairNumbers"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856887900214071*^9, 3.856887900462079*^9}, {
   3.856890216099166*^9, 3.8568903847837963`*^9}, {3.856890467948381*^9, 
   3.856890515204425*^9}, {3.8568907012896347`*^9, 3.856890712430599*^9}, {
   3.856890749328204*^9, 3.8568908031488347`*^9}, {3.8568908549603148`*^9, 
   3.856890901341498*^9}, {3.8568909379506965`*^9, 3.856890989683014*^9}, {
   3.856891062043993*^9, 3.856891074315077*^9}, {3.856891140125272*^9, 
   3.856891185511138*^9}, 3.8568912227111597`*^9, {3.856891332273427*^9, 
   3.8568913411416883`*^9}, {3.8568913804673758`*^9, 
   3.8568913824605856`*^9}, {3.8568914408211517`*^9, 
   3.8568914695550256`*^9}, {3.8568914995827484`*^9, 
   3.8568915905138493`*^9}, {3.8568916487483807`*^9, 
   3.8568917226336193`*^9}, {3.8568917625811806`*^9, 3.856891800451206*^9}, {
   3.8568918534463673`*^9, 3.856891991445899*^9}, {3.8568920998058147`*^9, 
   3.856892130458727*^9}, {3.8568921628103914`*^9, 3.8568922930632143`*^9}, {
   3.856892340319947*^9, 3.856892561701888*^9}, {3.8568926714806795`*^9, 
   3.8568926914526167`*^9}, {3.8568927560159674`*^9, 
   3.8568928160902033`*^9}, {3.8568928502356777`*^9, 3.856892851669343*^9}, {
   3.8568929610609903`*^9, 3.856892963303528*^9}, {3.8568930146939163`*^9, 
   3.856893040153465*^9}, {3.856893072460146*^9, 3.8568930826247663`*^9}, {
   3.856893119063678*^9, 3.856893207970866*^9}, {3.8568932624707003`*^9, 
   3.856893263954732*^9}, {3.8568935003039093`*^9, 3.8568935116301937`*^9}, {
   3.8568935791334763`*^9, 3.856893589657753*^9}, {3.856893651557782*^9, 
   3.8568936698765383`*^9}, 3.8568937029912443`*^9, {3.856893782739919*^9, 
   3.856893813425339*^9}, {3.8568940330302444`*^9, 3.856894170623567*^9}, {
   3.8568942013231792`*^9, 3.856894342129407*^9}, {3.856894538801078*^9, 
   3.856894542551335*^9}, 3.8568951026211014`*^9, {3.8569495240122833`*^9, 
   3.8569495346550617`*^9}, {3.856953965759916*^9, 3.8569539866553535`*^9}, {
   3.856976138819652*^9, 3.856976271844668*^9}, {3.856976327892764*^9, 
   3.8569763496616244`*^9}, {3.8569765580341077`*^9, 3.856976571069826*^9}, {
   3.8569766229716873`*^9, 3.856976650319167*^9}, 3.8569768286966395`*^9, {
   3.8569769114115314`*^9, 3.856976922596374*^9}, {3.8569771042881165`*^9, 
   3.856977137888245*^9}, 3.856977326095533*^9, {3.856977851891387*^9, 
   3.8569778597437735`*^9}, {3.8570102371865835`*^9, 
   3.8570103272247105`*^9}, {3.85701036730394*^9, 3.857010386586419*^9}, {
   3.857010479454553*^9, 3.857010488877842*^9}, {3.85701057777584*^9, 
   3.8570106038819313`*^9}, {3.8570125224054956`*^9, 3.8570125342715836`*^9}, 
   3.857012579317604*^9, {3.8570126390261383`*^9, 3.8570126782148705`*^9}, {
   3.857012818433789*^9, 3.8570128267908897`*^9}, {3.857012875117757*^9, 
   3.857012901989237*^9}, {3.8570130700994606`*^9, 3.8570130726108913`*^9}, 
   3.8570137009241333`*^9, {3.857013786849537*^9, 3.8570137870576878`*^9}, 
   3.857013858328081*^9, {3.857013974170878*^9, 3.857013995988784*^9}, {
   3.8570196175430436`*^9, 3.8570196243561726`*^9}, {3.857020329973744*^9, 
   3.8570203949926786`*^9}, {3.8570205003836246`*^9, 3.857020502104081*^9}, {
   3.857020592719337*^9, 3.85702061386926*^9}, {3.857020791831822*^9, 
   3.857020813844076*^9}, {3.8570211748401737`*^9, 3.857021181262464*^9}, {
   3.857021590076315*^9, 3.8570216003178005`*^9}, {3.857021694720386*^9, 
   3.8570217867515125`*^9}, {3.857022980993922*^9, 3.8570230046059775`*^9}, {
   3.8570230468029647`*^9, 3.857023050512473*^9}, {3.857023230016488*^9, 
   3.857023230250808*^9}, 3.8570232888331985`*^9, {3.8570237772923837`*^9, 
   3.857023813376418*^9}, {3.8570240700427656`*^9, 3.857024096418992*^9}, {
   3.8570241460502067`*^9, 3.857024146934859*^9}, {3.8570257703884525`*^9, 
   3.8570257779509106`*^9}, 3.857026492062175*^9, {3.8570365948055754`*^9, 
   3.8570366642378488`*^9}, {3.8570367491274385`*^9, 3.857036757675004*^9}, {
   3.8570368488383636`*^9, 3.8570368556486864`*^9}, {3.8570369870539703`*^9, 
   3.8570369939303837`*^9}, {3.857037474719449*^9, 3.8570375537120275`*^9}, 
   3.8570376548894143`*^9, {3.8570376938420525`*^9, 3.8570376977788754`*^9}, {
   3.8570377750515394`*^9, 3.857037809018758*^9}, {3.8570379409118643`*^9, 
   3.85703796611367*^9}, {3.857038897370883*^9, 3.8570389234587526`*^9}, 
   3.857062921923441*^9, {3.857063597862331*^9, 3.8570638272066746`*^9}, 
   3.8570639409368877`*^9, {3.857063980378826*^9, 3.857064183790632*^9}, {
   3.8570643334967985`*^9, 3.8570643750750113`*^9}, {3.857064443551404*^9, 
   3.8570644663257895`*^9}, {3.857064527053348*^9, 3.8570645607185946`*^9}, {
   3.8570648001993427`*^9, 3.8570648053036985`*^9}, 3.8570649785370283`*^9, {
   3.857065060735474*^9, 3.85706506925828*^9}, {3.8570652524718285`*^9, 
   3.857065327896551*^9}, {3.857065398312546*^9, 3.8570653991673803`*^9}, {
   3.8570654485359664`*^9, 3.857065449582594*^9}, {3.85706553005721*^9, 
   3.8570655504020796`*^9}, {3.857065585049105*^9, 3.8570656324855824`*^9}, 
   3.857066266988491*^9, {3.8571248925092497`*^9, 3.8571249003631773`*^9}, 
   3.8571254715525675`*^9, {3.8571882489096727`*^9, 3.8571883065951347`*^9}, 
   3.857188356802001*^9, 3.8571889043290815`*^9, 3.857188967820746*^9, 
   3.8572058151508884`*^9, {3.8572071173806534`*^9, 3.8572071229139876`*^9}, {
   3.8572613203833323`*^9, 3.8572613855494833`*^9}, {3.85726154559735*^9, 
   3.857261570338207*^9}, {3.8572616380140324`*^9, 3.8572616580918226`*^9}, 
   3.857261694666503*^9, {3.8576540535535946`*^9, 3.8576540688487186`*^9}, {
   3.8576541037093763`*^9, 3.8576541064391785`*^9}, {3.85765416271716*^9, 
   3.857654162934303*^9}, {3.857654215038186*^9, 3.8576542599913883`*^9}, 
   3.857654317320162*^9, {3.8576543505718346`*^9, 3.85765441224198*^9}, {
   3.857654501821556*^9, 3.8576545263025227`*^9}, 3.8576546254857426`*^9, {
   3.857654970239828*^9, 3.857654979225335*^9}, {3.857655047130412*^9, 
   3.8576550698832664`*^9}},ExpressionUUID->"dfa72b13-0774-487e-a956-\
1f30c064b7d2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"calcShift", "[", "diskPair_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", "=", "diskPair"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<Shift\>\"", "->", "\"\<None\>\""}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}], "]"}], "<", 
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", "\"\<Point\>\"", "]"}], "=", 
            RowBox[{
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}], "+", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<Shift\>\"", "]"}], " ", "=", " ", 
            "\"\<Right\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<Pair\>\"", "]"}], "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"moveNumberRight", ",", 
              RowBox[{"res", "[", "\"\<Pair\>\"", "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"First", "[", 
            RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}], "]"}], ">", " ", 
           RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", "\"\<Point\>\"", "]"}], "=", 
            RowBox[{
             RowBox[{"diskPair", "[", "\"\<Point\>\"", "]"}], "-", 
             RowBox[{"{", 
              RowBox[{"1", ",", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<Shift\>\"", "]"}], " ", "=", " ", 
            "\"\<Left\>\""}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<Pair\>\"", "]"}], " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"moveNumberLeft", ",", 
              RowBox[{"res", "[", "\"\<Pair\>\"", "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"allDistinctSortedPairs", "[", "list_", "]"}], " ", ":=", " ", 
     RowBox[{"DeleteDuplicates", "@", 
      RowBox[{"(", 
       RowBox[{"Sort", "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Tuples", "[", 
           RowBox[{"list", ",", "2"}], "]"}], ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"SameQ", "@@", "#"}]}], "&"}]}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856887900214071*^9, 3.856887900462079*^9}, {
   3.856890216099166*^9, 3.8568903847837963`*^9}, {3.856890467948381*^9, 
   3.856890515204425*^9}, {3.8568907012896347`*^9, 3.856890712430599*^9}, {
   3.856890749328204*^9, 3.8568908031488347`*^9}, {3.8568908549603148`*^9, 
   3.856890901341498*^9}, {3.8568909379506965`*^9, 3.856890989683014*^9}, {
   3.856891062043993*^9, 3.856891074315077*^9}, {3.856891140125272*^9, 
   3.856891185511138*^9}, 3.8568912227111597`*^9, {3.856891332273427*^9, 
   3.8568913411416883`*^9}, {3.8568913804673758`*^9, 
   3.8568913824605856`*^9}, {3.8568914408211517`*^9, 
   3.8568914695550256`*^9}, {3.8568914995827484`*^9, 
   3.8568915905138493`*^9}, {3.8568916487483807`*^9, 
   3.8568917226336193`*^9}, {3.8568917625811806`*^9, 3.856891800451206*^9}, {
   3.8568918534463673`*^9, 3.856891991445899*^9}, {3.8568920998058147`*^9, 
   3.856892130458727*^9}, {3.8568921628103914`*^9, 3.8568922930632143`*^9}, {
   3.856892340319947*^9, 3.856892561701888*^9}, {3.8568926714806795`*^9, 
   3.8568926914526167`*^9}, {3.8568927560159674`*^9, 
   3.8568928160902033`*^9}, {3.8568928502356777`*^9, 3.856892851669343*^9}, {
   3.8568929610609903`*^9, 3.856892963303528*^9}, {3.8568930146939163`*^9, 
   3.856893040153465*^9}, {3.856893072460146*^9, 3.8568930826247663`*^9}, {
   3.856893119063678*^9, 3.856893207970866*^9}, {3.8568932624707003`*^9, 
   3.856893263954732*^9}, {3.8568935003039093`*^9, 3.8568935116301937`*^9}, {
   3.8568935791334763`*^9, 3.856893589657753*^9}, {3.856893651557782*^9, 
   3.8568936698765383`*^9}, 3.8568937029912443`*^9, {3.856893782739919*^9, 
   3.856893813425339*^9}, {3.8568940330302444`*^9, 3.856894170623567*^9}, {
   3.8568942013231792`*^9, 3.856894342129407*^9}, {3.856894538801078*^9, 
   3.856894542551335*^9}, 3.8568951026211014`*^9, {3.8569495240122833`*^9, 
   3.8569495346550617`*^9}, {3.856953965759916*^9, 3.8569539866553535`*^9}, {
   3.856976138819652*^9, 3.856976271844668*^9}, {3.856976327892764*^9, 
   3.8569763496616244`*^9}, {3.8569765580341077`*^9, 3.856976571069826*^9}, {
   3.8569766229716873`*^9, 3.856976650319167*^9}, 3.8569768286966395`*^9, {
   3.8569769114115314`*^9, 3.856976922596374*^9}, {3.8569771042881165`*^9, 
   3.856977137888245*^9}, 3.856977326095533*^9, {3.856977851891387*^9, 
   3.8569778597437735`*^9}, {3.8570102371865835`*^9, 
   3.8570103272247105`*^9}, {3.85701036730394*^9, 3.857010386586419*^9}, {
   3.857010479454553*^9, 3.857010488877842*^9}, {3.85701057777584*^9, 
   3.8570106038819313`*^9}, {3.8570125224054956`*^9, 3.8570125342715836`*^9}, 
   3.857012579317604*^9, {3.8570126390261383`*^9, 3.8570126782148705`*^9}, {
   3.857012818433789*^9, 3.8570128267908897`*^9}, {3.857012875117757*^9, 
   3.857012901989237*^9}, {3.8570130700994606`*^9, 3.8570130726108913`*^9}, 
   3.8570137009241333`*^9, {3.857013786849537*^9, 3.8570137870576878`*^9}, 
   3.857013858328081*^9, {3.857013974170878*^9, 3.857013995988784*^9}, {
   3.8570196175430436`*^9, 3.8570196243561726`*^9}, {3.857020329973744*^9, 
   3.8570203949926786`*^9}, {3.8570205003836246`*^9, 3.857020502104081*^9}, {
   3.857020592719337*^9, 3.85702061386926*^9}, {3.857020791831822*^9, 
   3.857020813844076*^9}, {3.8570211748401737`*^9, 3.857021181262464*^9}, {
   3.857021590076315*^9, 3.8570216003178005`*^9}, {3.857021694720386*^9, 
   3.8570217867515125`*^9}, {3.857022980993922*^9, 3.8570230046059775`*^9}, {
   3.8570230468029647`*^9, 3.857023050512473*^9}, {3.857023230016488*^9, 
   3.857023230250808*^9}, 3.8570232888331985`*^9, {3.8570237772923837`*^9, 
   3.857023813376418*^9}, {3.8570240700427656`*^9, 3.857024096418992*^9}, {
   3.8570241460502067`*^9, 3.857024146934859*^9}, {3.8570257703884525`*^9, 
   3.8570257779509106`*^9}, 3.857026492062175*^9, {3.8570365948055754`*^9, 
   3.8570366642378488`*^9}, {3.8570367491274385`*^9, 3.857036757675004*^9}, {
   3.8570368488383636`*^9, 3.8570368556486864`*^9}, {3.8570369870539703`*^9, 
   3.8570369939303837`*^9}, {3.857037474719449*^9, 3.8570375537120275`*^9}, 
   3.8570376548894143`*^9, {3.8570376938420525`*^9, 3.8570376977788754`*^9}, {
   3.8570377750515394`*^9, 3.857037809018758*^9}, {3.8570379409118643`*^9, 
   3.85703796611367*^9}, {3.857038897370883*^9, 3.8570389234587526`*^9}, 
   3.857062921923441*^9, {3.857063597862331*^9, 3.8570638272066746`*^9}, 
   3.8570639409368877`*^9, {3.857063980378826*^9, 3.857064183790632*^9}, {
   3.8570643334967985`*^9, 3.8570643750750113`*^9}, {3.857064443551404*^9, 
   3.8570644663257895`*^9}, {3.857064527053348*^9, 3.8570645607185946`*^9}, {
   3.8570648001993427`*^9, 3.8570648053036985`*^9}, 3.8570649785370283`*^9, {
   3.857065060735474*^9, 3.85706506925828*^9}, {3.8570652524718285`*^9, 
   3.857065327896551*^9}, {3.857065398312546*^9, 3.8570653991673803`*^9}, {
   3.8570654485359664`*^9, 3.857065449582594*^9}, {3.85706553005721*^9, 
   3.8570655504020796`*^9}, {3.857065585049105*^9, 3.8570656324855824`*^9}, 
   3.857066266988491*^9, {3.8571248925092497`*^9, 3.8571249003631773`*^9}, 
   3.8571254715525675`*^9, {3.8571882489096727`*^9, 3.8571883065951347`*^9}, 
   3.8571900448817167`*^9, {3.8572615279679856`*^9, 3.8572615286558294`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"1eddaded-9ec0-4f93-84b2-3e6e5fa75bf1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"for", " ", "some", " ", "ics"}], ",", " ", 
    RowBox[{
     RowBox[{"couldn", "'"}], "t", " ", "guarantee", " ", "the", " ", "lower",
      " ", "one", " ", "is", " ", "discardable"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "but", " ", "should", " ", "be", " ", "provided", " ", "pattern", " ", 
     "is", " ", "a", " ", "dropped", " ", "coin", " ", "one"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskdiskUpperTouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "lrPoints", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lrPoints", "=", " ", 
         RowBox[{"diskdisktouchingPoint", "[", 
          RowBox[{"pairDisks", ",", "r"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "lrPoints", "]"}], ",", 
          RowBox[{"Return", "[", "lrPoints", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Last", "[", 
         RowBox[{"SortBy", "[", 
          RowBox[{"lrPoints", ",", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskdisktouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy1", ",", "xy2", ",", "r1", ",", "r2", ",", "interdisk"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xy1", ",", "r1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xy2", ",", "r2"}], "}"}]}], "}"}], "=", " ", 
         RowBox[{"List", "@@@", " ", "pairDisks"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"interdisk", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"xy1", "-", "xy2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"interdisk", " ", ">", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1", "+", "r"}], ")"}], " ", "+", 
            RowBox[{"(", " ", 
             RowBox[{"r2", " ", "+", " ", "r"}], ")"}]}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Off", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sTriangle", " ", "=", 
         RowBox[{"SSSTriangle", "[", 
          RowBox[{
           RowBox[{"r", "+", "r2"}], ",", 
           RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"On", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sTriangle", "]"}], "===", "SSSTriangle"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"triangle", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@", "sTriangle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"transform", " ", "=", 
         RowBox[{"Composition", "[", 
          RowBox[{
           RowBox[{"TranslationTransform", "[", "xy1", "]"}], ",", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"triangle", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"xy2", "-", "xy1"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"transform", "[", "triangle", "]"}], ")"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"90", " ", "Degree"}], "]"}], "[", 
              RowBox[{"xy2", "-", "xy1"}], "]"}], ",", "xy1"}], "]"}], ")"}], 
          "[", "rTrianglePT", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}]}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Graphics", "[", 
        RowBox[{"{", 
         RowBox[{"pairDisks", ",", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Disk", "[", 
             RowBox[{"rTrianglePT", ",", "r"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"Disk", "[", 
             RowBox[{"lTrianglePT", ",", "r"}], "]"}]}], "}"}], " ", ",", 
          RowBox[{"{", 
           RowBox[{"Yellow", ",", 
            RowBox[{"transform", "[", "sTriangle", "]"}]}], "}"}]}], "}"}], 
        "]"}], "\[IndentingNewLine]", "*)"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856890650008703*^9, 3.85689067286756*^9}, {
   3.8568920185899725`*^9, 3.8568920625893984`*^9}, {3.8571152866804256`*^9, 
   3.8571153034394283`*^9}, {3.8571171134824324`*^9, 
   3.8571171413767424`*^9}, {3.8571171853168*^9, 3.8571172283028445`*^9}, 
   3.8571269932151995`*^9, {3.857127151449848*^9, 3.857127168930334*^9}, {
   3.8571273299195204`*^9, 3.8571273327408686`*^9}, {3.8571273879771347`*^9, 
   3.8571274361429415`*^9}, {3.8571274968993864`*^9, 
   3.8571275846370783`*^9}, {3.8571277374939375`*^9, 3.857127777817645*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"7072b596-be8b-42d1-8c96-5c9ad092c91a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"makeRunContactGraphXY", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newRun", ",", "g", ",", "graphNodeXY"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"g", "=", " ", 
        RowBox[{
         RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"graphNodeXY", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"coinXY", "[", 
            RowBox[{"getCoinFromChain", "[", 
             RowBox[{"#", ",", "run", ",", "\"\<xy\>\""}], "]"}], "]"}], 
           "&"}], ",", 
          RowBox[{"VertexList", "[", "g", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newRun", "=", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"newRun", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
         "]"}], " ", "=", " ", 
        RowBox[{"Graph", "[", 
         RowBox[{"g", ",", 
          RowBox[{"VertexCoordinates", "\[Rule]", "graphNodeXY"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", "newRun"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8571562495352945`*^9, 3.8571885791847878`*^9, 3.857205817557516*^9, {
   3.8572071298945804`*^9, 3.8572071351817293`*^9}},
 CellLabel->
  "In[154]:=",ExpressionUUID->"b29e5a56-f9b2-4d17-88e0-af255feea230"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exampleRisingRun", "[", 
     RowBox[{"s_", ",", "r_", ",", "coinMax_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "arenaAssociation", ",", "cylinderLU", ",", "rFunction", ",", "phi", 
        ",", "cylinderCircumferenceFunction", ",", "d1", ",", "d1T", ",", 
        "d2", ",", "icCoins", ",", "nANew"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", "20"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rFunction", "[", "h_", "]"}], "  ", ":=", " ", 
        RowBox[{"r", " ", "*", " ", 
         RowBox[{"(", "  ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"1", "/", "10"}]}], ")"}], "  ", "*", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"h", "/", "20"}]}], ")"}]}], " ", "+", " ", 
           RowBox[{"1", "/", "10"}]}], ")"}]}]}], " ", ";", 
       "\[IndentingNewLine]", 
       RowBox[{"phi", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cylinderCircumferenceFunction", "[", "h_", "]"}], " ", ":=", 
        "  ", "1"}], ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"arenaAssociation", " ", "=", " ", 
        RowBox[{"<|", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<rFunction\>\"", "->", "rFunction"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<phi\>\"", "->", "phi"}], "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<coinMax\>\"", "->", " ", "coinMax"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
          "\"\<cylinderCircumferenceFunction\>\"", "->", 
           "cylinderCircumferenceFunction"}], " ", "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<cylinderLU\>\"", "->", " ", "cylinderLU"}]}], 
         "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"d1", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}], ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          " ", ",", "r"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"d1T", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          " ", ",", "r"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"d2", " ", "=", " ", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"toCone", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "phi"}], "]"}], 
          ",", "r"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"icCoins", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "101"}], ",", "d1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "102"}], ",", "d1T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "d2"}], "}"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"stackFrontFromIC", "[", 
        RowBox[{"icCoins", ",", "arenaAssociation"}], "]"}]}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeProfile", " ", ":=", " ", 
    RowBox[{"(", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"kmax", "=", "50"}], ";", 
      RowBox[{"r0", "=", "0.2"}], ";", "\[IndentingNewLine]", 
      RowBox[{"exampleRisingRun", "[", 
       RowBox[{"0.0", ",", "r0", ",", "kmax"}], "]"}], ";"}], 
     "\[IndentingNewLine]", ")"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8459989894544973`*^9, 3.845999061523218*^9}, 
   3.845999127563054*^9, {3.845999200140022*^9, 3.8459992127029066`*^9}, {
   3.845999251090372*^9, 3.8459992534831996`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"68c375d9-9111-4839-8ff5-7bcf8c7b73ea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Polygon finding ", "Section",
 CellChangeTimes->{{3.8453786666674557`*^9, 3.8453786666884556`*^9}, {
  3.845455511360236*^9, 
  3.8454555175263925`*^9}},ExpressionUUID->"f23e60c9-e599-4f91-b638-\
47ff7a6eb044"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "is", " ", "called", " ", "_after", "_", " ", "the", " ", 
    "run", " ", "has", " ", "completed"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"graphPolygonsFromRun", " ", "[", "run_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polys", ",", "nodes"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nodes", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"VertexList", "[", 
            RowBox[{
             RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", "ContactGraph", 
             "]"}], "]"}], ",", "IntegerQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"graphPolygonsAboveNodeFromRun", "[", 
             RowBox[{"run", ",", "#"}], "]"}], "&"}], ",", "nodes"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"polys", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"MissingQ", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Association", "@@", "polys"}]}], ";", "\[IndentingNewLine]",
         "polys"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"graphPolygonsAboveNodeFromRun", "[", 
      RowBox[{"run_", ",", "node_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"edgePairs", ",", "xyN", ",", "res", ",", "state"}], "}"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"(", 
          RowBox[{"coinXY", "[", 
           RowBox[{"getCoinFromRun", "[", 
            RowBox[{"n", ",", " ", "run"}], "]"}], "]"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", " ", 
         RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"edgePairs", " ", "=", 
         RowBox[{"edgesAboveNode", "[", 
          RowBox[{"state", ",", "node"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edgePairs", "]"}], "==", "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"<|", " ", 
             RowBox[{
              RowBox[{"\"\<node\>\"", "->", " ", "node"}], ",", 
              RowBox[{"\"\<nodeXY\>\"", "->", 
               RowBox[{"xyN", "[", "node", "]"}]}], ",", 
              RowBox[{"\"\<h\>\"", "->", 
               RowBox[{"Last", "[", 
                RowBox[{"xyN", "[", "node", "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"\"\<nodeCount\>\"", "->", " ", 
               RowBox[{"{", 
                RowBox[{"node", ",", 
                 RowBox[{"First", "[", "#2", "]"}]}], "}"}]}], ",", 
              RowBox[{"\"\<edgePair\>\"", "->", " ", "#1"}]}], "|>"}], "&"}], 
           ",", "edgePairs"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Association", "@", 
          RowBox[{"Map", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", "\"\<nodeCount\>\"", "]"}], "->", " ", "#"}], 
             "&"}], ",", "res"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", "  ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"polygonsFrom2EdgesRun", "[", 
             RowBox[{"run", ",", "#"}], "]"}], "&"}], ",", "res"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Normal", "@", "res"}]}], ";", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"edgesAboveNode", "[", 
      RowBox[{"state_", ",", "node_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "aboveNodeAngles", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"KeySelect", "[", 
          RowBox[{
           RowBox[{"state", "[", "DEdgeAngle", "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "#", "]"}], "==", "node"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"edges", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "<", 
              RowBox[{"1", "/", "4"}]}], " ", "||", " ", 
             RowBox[{"#", ">", 
              RowBox[{"3", "/", "4"}]}]}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "edges", "]"}], "<", "2"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", ">", 
               RowBox[{"1", "/", "2"}]}], ",", 
              RowBox[{"#", "-", "1"}], ",", "#"}], "]"}], "&"}], ",", 
           "edges"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Keys", "@", 
          RowBox[{"Sort", "[", "edges", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"edges", " ", "=", " ", 
         RowBox[{"Partition", "[", 
          RowBox[{"edges", ",", "2", ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "edges"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"polygonsFrom2EdgesRun", "[", 
      RowBox[{"run_", ",", "poly_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"polys", ",", "brokenres", ",", "state"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"run", "[", "\"\<State\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"barePolygonsFrom2Edges", "[", 
          RowBox[{"state", ",", 
           RowBox[{"node", "=", 
            RowBox[{"poly", "[", "\"\<node\>\"", "]"}]}], ",", 
           RowBox[{"poly", "[", "\"\<edgePair\>\"", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "polys", "]"}], ",", 
          RowBox[{"Return", "[", "polys", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bC", " ", "=", " ", 
         RowBox[{"brokenGraphContacts", "[", "state", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"breakContacts", "[", "ab_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Keys", "[", "bC", "]"}], ",", "ab"}], "]"}], ",", 
           RowBox[{"bC", "[", "ab", "]"}], ",", "ab"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"polys", "  ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Append", "[", 
            RowBox[{"poly", ",", 
             RowBox[{"computeCylinderEdgesRun", "[", 
              RowBox[{"run", ",", "#", ",", "breakContacts"}], "]"}]}], "]"}],
            "&"}], " ", "/@", " ", "polys"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polys", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"polys", ",", 
           RowBox[{
            RowBox[{"TrueQ", "[", "#closed", "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "polys", "]"}], "!=", "1"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "\"\<No unique closed poly\>\"", "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"polys", "=", " ", 
         RowBox[{"First", "[", "polys", "]"}]}], ";", "\[IndentingNewLine]", 
        "polys"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"barePolygonsFrom2Edges", "[", 
      RowBox[{"state_", ",", "node_", ",", 
       RowBox[{"{", 
        RowBox[{"edgeA_", ",", "edgeB_"}], "}"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bareA", ",", "bareB"}], "}"}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"runContacts", " ", "=", 
         RowBox[{"bareGraphContacts", "[", "state", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"a", " ", "=", " ", 
         RowBox[{"Last", "[", "edgeA", "]"}]}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"Last", "[", "edgeB", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bareA", "=", " ", 
         RowBox[{"bareNumber", "[", "a", "]"}]}], ";", 
        RowBox[{"bareB", "=", 
         RowBox[{"bareNumber", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", 
           RowBox[{"runContacts", "[", "bareA", "]"}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"runContacts", "[", "bareA", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", 
           RowBox[{"runContacts", "[", "bareB", "]"}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"runContacts", "[", "bareB", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"aContacts", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"runContacts", "[", "bareA", "]"}], ",", 
           RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"bContacts", " ", "=", " ", 
         RowBox[{"Complement", "[", " ", 
          RowBox[{
           RowBox[{"runContacts", "[", "bareB", "]"}], ",", 
           RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"isTriangle", " ", "=", " ", 
         RowBox[{"MemberQ", "[", " ", 
          RowBox[{"aContacts", ",", "bareB"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"isTriangle", ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}], "}"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"fourthPoint", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"aContacts", ",", "bContacts"}], "]"}], ",", 
           RowBox[{"{", "node", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "fourthPoint", "]"}], " ", ">", " ", "0"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rhombuses", " ", "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"node", ",", "bareA", ",", "#", ",", "bareB"}], "}"}],
                "&"}], ",", "fourthPoint"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Return", "[", "rhombuses", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"aContactContacts", " ", "=", " ", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"runContacts", ",", "aContacts"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"bContactContacts", " ", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Map", "[", 
           RowBox[{"runContacts", ",", "bContacts"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"fifthPoint", " ", "=", " ", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Intersection", "[", 
            RowBox[{"aContactContacts", ",", "bContacts"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "fifthPoint", "]"}], "==", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"fourthPoint", " ", "=", " ", 
            RowBox[{"Complement", "[", 
             RowBox[{
              RowBox[{"Intersection", "[", 
               RowBox[{"bContactContacts", ",", "aContacts"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"node", ",", "bareA", ",", "bareB"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"Return", "[", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"node", ",", "bareA", ",", 
               RowBox[{"First", "@", "fourthPoint"}], ",", 
               RowBox[{"First", "@", "fifthPoint"}], ",", "bareB"}], "}"}], 
             "}"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Missing", "[", "\"\<Hexagon or more\>\"", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bareGraphContacts", "[", "state_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "conts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conts", " ", "=", 
         RowBox[{"GroupBy", "[", 
          RowBox[{
           RowBox[{"EdgeList", "[", 
            RowBox[{"state", "[", "ContactGraph", "]"}], "]"}], ",", 
           RowBox[{"First", "->", "Last"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteDuplicates", "@", 
             RowBox[{"Map", "[", 
              RowBox[{"bareNumber", ",", "#"}], "]"}]}], "&"}], ",", 
           "conts"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", 
         RowBox[{"KeySelect", "[", 
          RowBox[{"conts", ",", "IntegerQ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "conts"}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"brokenGraphContacts", "[", "state_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "conts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"List", "@@@", " ", 
          RowBox[{"EdgeList", "[", 
           RowBox[{"state", "[", "ContactGraph", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"conts", ",", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}]}], "&"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"conts", " ", "=", " ", 
         RowBox[{"Association", "@@", " ", 
          RowBox[{"Map", "[", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"bareNumber", ",", "#"}], "]"}], "->", " ", "#"}], " ",
              "&"}], ",", "conts"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "conts"}]}], " ", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"computeCylinderEdgesRun", "[", 
      RowBox[{"run_", ",", "poly_", ",", "breakContacts_"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"brokenres", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"brokenres", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{"breakContacts", ",", 
           RowBox[{"Partition", "[", 
            RowBox[{"poly", ",", "2", ",", "1", ",", "1"}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"<|", " ", 
          RowBox[{
           RowBox[{"\"\<polygonBare\>\"", "->", " ", "poly"}], ",", 
           RowBox[{"\"\<edges\>\"", "->", " ", "brokenres"}]}], "|>"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"derivedPolysFromRun", "[", 
          RowBox[{"res", ",", "run"}], "]"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"derivedPolysFromRun", "[", 
      RowBox[{"poly_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "linePairs"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"xyN", "[", "n_", "]"}], "  ", ":=", " ", 
         RowBox[{"coinXY", "[", 
          RowBox[{"getCoinFromRun", "[", 
           RowBox[{"n", ",", " ", "run"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", "poly"}], ";", "\[IndentingNewLine]", 
        RowBox[{"linePairs", " ", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", 
            RowBox[{"res", "[", "\"\<edges\>\"", "]"}], "]"}], ",", 
           RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
           RowBox[{"Map", "[", 
            RowBox[{"xyN", ",", 
             RowBox[{"res", "[", "\"\<edges\>\"", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"vector", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", ",", 
           RowBox[{"Map", "[", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Last", "[", "#", "]"}], "-", 
                RowBox[{"First", "[", "#", "]"}]}], ")"}], "&"}], ",", 
             "linePairs"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"polygon", "=", "  ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", " ", 
           RowBox[{"Polygon", "[", 
            RowBox[{"Accumulate", "@", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Drop", "[", 
                RowBox[{"vector", ",", 
                 RowBox[{"-", "1"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"area", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "polygon", "]"}], ",", "polygon", ",", 
           RowBox[{"Area", "[", "polygon", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"closed", " ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"MissingQ", "[", "vector", "]"}], ",", "vector", ",", 
           RowBox[{
            RowBox[{"Abs", "@", 
             RowBox[{"First", "[", 
              RowBox[{"Apply", "[", 
               RowBox[{"Plus", ",", "vector"}], "]"}], "]"}]}], " ", "<", 
            "  ", "0.5"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<line\>\"", "->", " ", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MissingQ", "[", "linePairs", "]"}], ",", "linePairs", 
              ",", 
              RowBox[{"Line", "[", "linePairs", "]"}]}], "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<vector\>\"", "->", "vector"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<zeroPolygon\>\"", "->", "polygon"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<area\>\"", "->", "area"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", 
           RowBox[{"\"\<closed\>\"", "->", "closed"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[157]:=",ExpressionUUID->"3e5576af-6ab6-43f4-be67-95b66123e558"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Pruning
\
\>", "Section",
 CellChangeTimes->{{3.8460707621520834`*^9, 
  3.846070775811489*^9}},ExpressionUUID->"d0565a12-5574-4552-b037-\
4effbe774747"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"pruneNodeAssociation", "[", 
      RowBox[{"nodeAssociation_", ",", "pruneNumbers_"}], "]"}], "  ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", " ", "bare"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", "nodeAssociation"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "Parastichy", "]"}], "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "Parastichy", "]"}], ",", "pruneNumbers"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "Parastichy", "]"}], "=", " ", 
         RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "DEdgeAngle", "]"}], "=", " ", 
         RowBox[{"KeySelect", "[", 
          RowBox[{
           RowBox[{"res", "[", "DEdgeAngle", "]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"pruneNumbers", ",", 
              RowBox[{"First", "[", "#", "]"}]}], "]"}], "&"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "InitialCoins", "]"}], "=", " ", 
         RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "CoinAssociation", "]"}], " ", "=", " ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "CoinAssociation", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], "=", "  ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], "=", "  ", 
         RowBox[{"KeyTake", "[", 
          RowBox[{
           RowBox[{"res", "[", "ChainsByCoinNumber", "]"}], ",", 
           RowBox[{"Last", "@", 
            RowBox[{"Keys", "@", 
             RowBox[{"res", "[", "ChainsByCoinNumber", "]"}]}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"withLRNumbers", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"pruneNumbers", ",", 
           RowBox[{"left", "/@", "pruneNumbers"}], ",", 
           RowBox[{"right", " ", "/@", " ", "pruneNumbers"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "ContactGraph", "]"}], " ", "=", " ", 
         RowBox[{"Subgraph", "[", 
          RowBox[{
           RowBox[{"res", "[", "ContactGraph", "]"}], ",", "withLRNumbers", 
           ",", 
           RowBox[{"AnnotationRules", "\[Rule]", "Inherited"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pruneRun", "[", 
      RowBox[{"run_", ",", "pruneNumbers_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "prunedRun", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"prunedRun", " ", "=", " ", "run"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prunedRun", "[", "\"\<State\>\"", "]"}], " ", "=", " ", 
         RowBox[{"pruneNodeAssociation", "[", 
          RowBox[{
           RowBox[{"prunedRun", "[", "\"\<State\>\"", "]"}], ",", 
           "pruneNumbers"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "prunedRun"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pruneRunByFunction", "[", 
      RowBox[{"run_", ",", "pruneFunction_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pruneNumbers", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pruneNumbers", " ", "=", "  ", 
         RowBox[{"Map", "[", 
          RowBox[{"bareCoinNumber", " ", ",", " ", 
           RowBox[{"Keys", "[", 
            RowBox[{
             RowBox[{"run", "[", "\"\<State\>\"", "]"}], "[", 
             "CoinAssociation", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pruneRun", "[", 
         RowBox[{"run", ",", 
          RowBox[{"Select", "[", 
           RowBox[{"pruneNumbers", ",", 
            RowBox[{
             RowBox[{"pruneFunction", "[", "#", "]"}], "&"}]}], "]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pruneRunToLastChain", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "chainNumbers", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"chainNumbers", "=", 
        RowBox[{"currentChain", "[", "run", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"pruneRun", "[", 
        RowBox[{"run", ",", "chainNumbers"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[166]:=",ExpressionUUID->"a9ab3c21-00a3-46ec-8866-89bcc4d3930a"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{949., 479.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"85328bca-52b9-43f5-838a-66c5a2e20559"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 292, 5, 74, "Section",ExpressionUUID->"e55015fc-a79b-4df9-961d-01036e6cf397"],
Cell[875, 29, 332, 9, 70, "Input",ExpressionUUID->"ff2e94a6-5c48-4dce-90d5-bda2729443a1",
 InitializationCell->True],
Cell[1210, 40, 12919, 320, 1439, "Input",ExpressionUUID->"5a0690a5-d5d9-44f5-8771-8e2b05800dcb",
 InitializationCell->True],
Cell[14132, 362, 2760, 68, 405, "Input",ExpressionUUID->"8bc1d667-742b-4cbc-84af-9ee1892c828e",
 InitializationCell->True],
Cell[16895, 432, 14734, 383, 1568, "Input",ExpressionUUID->"6e590626-7255-4638-b969-ef4c07bf8951",
 InitializationCell->True],
Cell[31632, 817, 4297, 104, 573, "Input",ExpressionUUID->"63ea88af-53a7-423f-8bca-b3bc15d00d81",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[35954, 925, 93, 0, 59, "Subsection",ExpressionUUID->"a4f08e8c-f847-404b-ad6f-f3f3b12919f2"],
Cell[36050, 927, 10966, 273, 1310, "Input",ExpressionUUID->"430a849a-06d4-4447-b77f-8452d15a272c",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[47053, 1205, 84, 0, 59, "Subsection",ExpressionUUID->"40d374d9-ea14-49ac-bbf8-505bd03fda55"],
Cell[47140, 1207, 198, 3, 52, "Input",ExpressionUUID->"290c500d-e234-4dd6-bc8e-7d12becb99a3"],
Cell[47341, 1212, 41945, 629, 616, "Input",ExpressionUUID->"8923fcf7-3a83-4578-b088-d91ab1b058c4",
 InitializationCell->True],
Cell[89289, 1843, 2263, 53, 260, "Input",ExpressionUUID->"be9277a0-95b7-4e02-a2e3-af046510c2ce",
 InitializationCell->True],
Cell[91555, 1898, 305, 5, 31, "Input",ExpressionUUID->"84810bf2-a64d-4f8c-8fdd-1cf91e9d36a5"],
Cell[91863, 1905, 2838, 70, 364, "Input",ExpressionUUID->"5615abe2-38df-4d14-a0d1-80e04fc21d15",
 InitializationCell->True],
Cell[94704, 1977, 6266, 142, 804, "Input",ExpressionUUID->"ab42ed20-266b-4450-8257-d24d04102258",
 InitializationCell->True],
Cell[100973, 2121, 1412, 35, 217, "Input",ExpressionUUID->"c76eea4f-2d81-4606-a338-962eed944458",
 InitializationCell->True],
Cell[102388, 2158, 10605, 225, 1348, "Input",ExpressionUUID->"f6641d9c-01c5-4a74-8331-fd6c0316d706",
 InitializationCell->True],
Cell[112996, 2385, 921, 23, 133, "Input",ExpressionUUID->"e0a0ad5c-b6b7-449f-aa53-4799160440dc",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[113954, 2413, 170, 3, 59, "Subsection",ExpressionUUID->"def335d8-3501-4c7b-bdbd-53f5b6469018"],
Cell[114127, 2418, 6303, 139, 867, "Input",ExpressionUUID->"a2972f55-e319-40a1-877f-dd1884a8fe19",
 InitializationCell->True],
Cell[120433, 2559, 7301, 159, 907, "Input",ExpressionUUID->"f701992d-1388-4d72-b20d-5b59e9c0026b",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[127771, 2723, 157, 3, 59, "Subsection",ExpressionUUID->"655e9006-4dc7-4128-9ede-b95ba9b867d7"],
Cell[127931, 2728, 4063, 95, 783, "Input",ExpressionUUID->"26e81a0a-5e5b-44af-ab9f-0e666b48fded",
 InitializationCell->True],
Cell[131997, 2825, 2308, 53, 405, "Input",ExpressionUUID->"60132781-44f9-4b27-86e2-33a7b41bfbd5",
 InitializationCell->True],
Cell[134308, 2880, 12240, 233, 887, "Input",ExpressionUUID->"589bf961-4832-4f0b-b6b1-b30244e43547",
 InitializationCell->True],
Cell[146551, 3115, 7193, 181, 890, "Input",ExpressionUUID->"b81136a3-b726-4e6d-b369-571eb16c5b64",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[153769, 3300, 7626, 170, 887, "Input",ExpressionUUID->"fe5123f8-2d48-4c27-b2df-d4baaaea44f2",
 InitializationCell->True],
Cell[161398, 3472, 161, 3, 35, "Output",ExpressionUUID->"6ededf73-81db-460f-916a-df4fea634e35"]
}, Open  ]],
Cell[161574, 3478, 17006, 327, 847, "Input",ExpressionUUID->"973eaff8-774d-451f-98a9-776dc7437548",
 InitializationCell->True],
Cell[178583, 3807, 9148, 159, 427, "Input",ExpressionUUID->"dfa72b13-0774-487e-a956-1f30c064b7d2",
 InitializationCell->True],
Cell[187734, 3968, 8417, 149, 406, "Input",ExpressionUUID->"1eddaded-9ec0-4f93-84b2-3e6e5fa75bf1",
 InitializationCell->True],
Cell[196154, 4119, 6657, 160, 678, "Input",ExpressionUUID->"7072b596-be8b-42d1-8c96-5c9ad092c91a",
 InitializationCell->True],
Cell[202814, 4281, 1590, 40, 196, "Input",ExpressionUUID->"b29e5a56-f9b2-4d17-88e0-af255feea230",
 InitializationCell->True],
Cell[204407, 4323, 4778, 115, 656, "Input",ExpressionUUID->"68c375d9-9111-4839-8ff5-7bcf8c7b73ea",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[209234, 4444, 216, 4, 73, "Section",ExpressionUUID->"f23e60c9-e599-4f91-b638-47ff7a6eb044"],
Cell[209453, 4450, 22532, 538, 2748, "Input",ExpressionUUID->"3e5576af-6ab6-43f4-be67-95b66123e558",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[232022, 4993, 163, 6, 115, "Section",ExpressionUUID->"d0565a12-5574-4552-b037-4effbe774747"],
Cell[232188, 5001, 5437, 130, 740, "Input",ExpressionUUID->"a9ab3c21-00a3-46ec-8866-89bcc4d3930a",
 InitializationCell->True]
}, Open  ]]
}
]
*)

