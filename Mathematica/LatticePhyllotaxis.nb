(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    415381,      10244]
NotebookOptionsPosition[    395963,       9871]
NotebookOutlinePosition[    398946,       9955]
CellTagsIndexPosition[    398534,       9936]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetOptions", "[", 
  RowBox[{
   RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
   RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855708557192008*^9, 3.855708558082427*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"0c63ea52-7fb0-493b-bb7d-4edd448cd6cb"],

Cell[CellGroupData[{

Cell["Euclidean highest common factor", "Chapter",
 CellChangeTimes->{{3.8556828100796533`*^9, 
  3.855682816184741*^9}},ExpressionUUID->"6e622f36-b0ac-4664-8d98-\
e8bdd1e37010"],

Cell[CellGroupData[{

Cell["Winding number", "Section",
 CellTags->"c:1",ExpressionUUID->"dafb00cf-9865-4e0d-8243-84db3f549a19"],

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"euclideanQCoefficients", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "q", ",", "i"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ";", "\n", "\t", 
        RowBox[{
         RowBox[{"r", "[", 
          RowBox[{"-", "1"}], "]"}], "=", "n"}], ";", " ", "\n", "\t", 
        RowBox[{
         RowBox[{"r", "[", "0", "]"}], " ", "=", " ", "m"}], ";", "\n", "\t", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "i", "]"}], " ", ">", " ", "0"}], "  ", ",", " ",
           "\n", "\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"q", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"i", "-", "1"}], "]"}], "/", 
              RowBox[{"r", "[", "i", "]"}]}], "]"}]}], ";", "\n", "\t\t", 
           RowBox[{
            RowBox[{"r", "[", 
             RowBox[{"i", "+", "1"}], "]"}], " ", "=", " ", 
            RowBox[{
             RowBox[{"r", "[", 
              RowBox[{"i", "-", "1"}], "]"}], " ", "-", " ", 
             RowBox[{
              RowBox[{"q", "[", "i", "]"}], "*", 
              RowBox[{"r", "[", "i", "]"}]}]}]}], ";", "\n", "\t\t", 
           RowBox[{"i", "++"}], ";"}]}], "\n", "\t", "]"}], ";", "\n", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"q", "[", "j", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "0", ",", 
            RowBox[{"i", "-", "1"}]}], "}"}]}], "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"euclideanQCoefficients", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", ":=", " ", 
      RowBox[{"{", "}"}]}], ";", " ", "\n", 
     RowBox[{
      RowBox[{"euclideanQCoefficients", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", ":=", " ", 
      RowBox[{"{", "0", "}"}]}], ";"}], " ", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8550899594083595`*^9, 3.8550899759779177`*^9}, {
   3.855090083355332*^9, 3.8550901727139726`*^9}, {3.855090320743924*^9, 
   3.855090330268848*^9}, {3.8550904347313476`*^9, 3.8550904351843677`*^9}, {
   3.8550905680342784`*^9, 3.855090601825388*^9}, {3.8550906434706*^9, 
   3.855090894216764*^9}, {3.8550909364618983`*^9, 3.8550909843989897`*^9}, {
   3.855091046762987*^9, 3.8550910519314036`*^9}, {3.855091099856184*^9, 
   3.8550911580490932`*^9}, {3.855091401872802*^9, 3.855091431168048*^9}, {
   3.855091588834622*^9, 3.8550915929785647`*^9}, {3.855091689834828*^9, 
   3.8550917064220295`*^9}, {3.855091747347949*^9, 3.855091860718851*^9}, {
   3.8550919349348173`*^9, 3.8550919608980474`*^9}, {3.8550920380854287`*^9, 
   3.855092048153428*^9}, {3.855092254314417*^9, 3.855092303543399*^9}, {
   3.8550923526540833`*^9, 3.8550923580149946`*^9}, {3.8550923891101456`*^9, 
   3.8550924554219165`*^9}, {3.855092593453182*^9, 3.855092740734395*^9}, {
   3.855092771841914*^9, 3.855092872914487*^9}, {3.855092919962076*^9, 
   3.855093053825495*^9}, {3.855093196308894*^9, 3.855093267365672*^9}, {
   3.8550933175084*^9, 3.8550933721273727`*^9}, {3.855093421915478*^9, 
   3.8550934515749474`*^9}, {3.855093554659423*^9, 3.855093568766191*^9}, {
   3.855095325701079*^9, 3.8550953628248177`*^9}, {3.8550955747235107`*^9, 
   3.855095584239109*^9}, {3.855158465646411*^9, 3.8551585398493433`*^9}, {
   3.8551585832281494`*^9, 3.855158608185342*^9}, {3.855158662716675*^9, 
   3.855158667481183*^9}, {3.855158698941802*^9, 3.855158813327651*^9}, {
   3.855158940540723*^9, 3.8551589450496535`*^9}, {3.855158993715618*^9, 
   3.855158995387066*^9}, {3.8551590431978855`*^9, 3.8551591001208096`*^9}, {
   3.8551591351330037`*^9, 3.8551592266439524`*^9}, {3.855159302000229*^9, 
   3.855159384720044*^9}, {3.855159448955248*^9, 3.8551594525012836`*^9}, {
   3.8551594827799463`*^9, 3.8551595490549936`*^9}, 3.8551597329018307`*^9, {
   3.8551601200634537`*^9, 3.8551601267545595`*^9}, {3.8551601605810976`*^9, 
   3.8551602171747503`*^9}, {3.855160265426713*^9, 3.855160350157117*^9}, 
   3.855160381030554*^9, {3.8551609762077227`*^9, 3.8551609883767357`*^9}, {
   3.85516101842398*^9, 3.8551610324992685`*^9}, {3.855169625341195*^9, 
   3.8551696410352087`*^9}, 3.8551696976869116`*^9, {3.8552119638678904`*^9, 
   3.855212028934022*^9}, 3.855212072224595*^9, {3.8552121203291597`*^9, 
   3.8552121566063848`*^9}, {3.855213159140607*^9, 3.855213365552743*^9}, {
   3.855213417322071*^9, 3.855213446224846*^9}, {3.855213515564699*^9, 
   3.8552137566848507`*^9}, {3.855213806118827*^9, 3.8552138267311125`*^9}, 
   3.855256920633424*^9, 3.8552999671428156`*^9, 3.8553000237439823`*^9, {
   3.855300363826341*^9, 3.855300420315815*^9}, {3.855300616932152*^9, 
   3.8553006265248413`*^9}, {3.8553021057350645`*^9, 3.8553021150161085`*^9}, 
   3.8553023076726847`*^9, 3.85530263193653*^9, {3.8553027148082314`*^9, 
   3.8553027340310016`*^9}, {3.855302893493291*^9, 3.8553028961957765`*^9}, {
   3.855302946442678*^9, 3.85530296679068*^9}, {3.85530321187998*^9, 
   3.8553032177775545`*^9}, 3.8553032979547806`*^9, 3.8553034616914635`*^9, {
   3.8553040266263194`*^9, 3.8553040386703777`*^9}, {3.855305279211133*^9, 
   3.855305291201293*^9}, 3.855305434172698*^9, 3.85533845025774*^9, {
   3.855356370620609*^9, 3.85535638015679*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"d65299de-a7b4-4028-bfad-df211f871af8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"need", " ", "one", " ", "of", " ", "m", " ", "and", " ", "n"}],
       " ", ">", " ", "0"}], ";", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"creates", " ", "a", " ", "matrix", " ", "with", " ", 
        RowBox[{"(", GridBox[{
           {"m", "u"},
           {"n", "v"}
          }], ")"}], "  ", "and"}], " ", "|", " ", 
       RowBox[{
        RowBox[{"m", " ", "v"}], " ", "-", "  ", "nu"}], " ", "|"}], "=", 
      "1"}]}], ",", " ", 
    RowBox[{
     RowBox[{"no", " ", "assumption", " ", "that", " ", "m"}], "<", "n"}]}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8550899594083595`*^9, 3.8550899759779177`*^9}, {
   3.855090083355332*^9, 3.8550901727139726`*^9}, {3.855090320743924*^9, 
   3.855090330268848*^9}, {3.8550904347313476`*^9, 3.8550904351843677`*^9}, {
   3.8550905680342784`*^9, 3.855090601825388*^9}, {3.8550906434706*^9, 
   3.855090894216764*^9}, {3.8550909364618983`*^9, 3.8550909843989897`*^9}, {
   3.855091046762987*^9, 3.8550910519314036`*^9}, {3.855091099856184*^9, 
   3.8550911580490932`*^9}, {3.855091401872802*^9, 3.855091431168048*^9}, {
   3.855091588834622*^9, 3.8550915929785647`*^9}, {3.855091689834828*^9, 
   3.8550917064220295`*^9}, {3.855091747347949*^9, 3.855091860718851*^9}, {
   3.8550919349348173`*^9, 3.8550919608980474`*^9}, {3.8550920380854287`*^9, 
   3.855092048153428*^9}, {3.855092254314417*^9, 3.855092303543399*^9}, {
   3.8550923526540833`*^9, 3.8550923580149946`*^9}, {3.8550923891101456`*^9, 
   3.8550924554219165`*^9}, {3.855092593453182*^9, 3.855092740734395*^9}, {
   3.855092771841914*^9, 3.855092872914487*^9}, {3.855092919962076*^9, 
   3.855093053825495*^9}, {3.855093196308894*^9, 3.855093267365672*^9}, {
   3.8550933175084*^9, 3.8550933721273727`*^9}, {3.855093421915478*^9, 
   3.8550934515749474`*^9}, {3.855093554659423*^9, 3.855093568766191*^9}, {
   3.855095325701079*^9, 3.8550953628248177`*^9}, {3.8550955747235107`*^9, 
   3.855095584239109*^9}, {3.855158465646411*^9, 3.8551585398493433`*^9}, {
   3.8551585832281494`*^9, 3.855158608185342*^9}, {3.855158662716675*^9, 
   3.855158667481183*^9}, {3.855158698941802*^9, 3.855158813327651*^9}, {
   3.855158940540723*^9, 3.8551589450496535`*^9}, {3.855158993715618*^9, 
   3.855158995387066*^9}, {3.8551590431978855`*^9, 3.8551591001208096`*^9}, {
   3.8551591351330037`*^9, 3.8551592266439524`*^9}, {3.855159302000229*^9, 
   3.855159384720044*^9}, {3.855159448955248*^9, 3.8551594525012836`*^9}, {
   3.8551594827799463`*^9, 3.8551595490549936`*^9}, 3.8551597329018307`*^9, {
   3.8551601200634537`*^9, 3.8551601267545595`*^9}, {3.8551601605810976`*^9, 
   3.8551602171747503`*^9}, {3.855160265426713*^9, 3.855160350157117*^9}, 
   3.855160381030554*^9, {3.8551609762077227`*^9, 3.8551609883767357`*^9}, {
   3.85516101842398*^9, 3.8551610324992685`*^9}, {3.855169625341195*^9, 
   3.8551696410352087`*^9}, 3.8551696976869116`*^9, {3.8552119638678904`*^9, 
   3.855212028934022*^9}, 3.855212072224595*^9, {3.8552121203291597`*^9, 
   3.8552121566063848`*^9}, {3.855213159140607*^9, 3.855213365552743*^9}, {
   3.855213417322071*^9, 3.855213446224846*^9}, {3.855213515564699*^9, 
   3.8552137566848507`*^9}, {3.855213806118827*^9, 3.8552138267311125`*^9}, 
   3.855256920633424*^9, 3.8552999671428156`*^9, 3.8553000237439823`*^9, {
   3.855300363826341*^9, 3.855300420315815*^9}, {3.855300616932152*^9, 
   3.8553006265248413`*^9}, {3.8553021057350645`*^9, 3.8553021150161085`*^9}, 
   3.8553023076726847`*^9, 3.85530263193653*^9, {3.8553027148082314`*^9, 
   3.8553027340310016`*^9}, {3.855302893493291*^9, 3.8553028961957765`*^9}, {
   3.855302946442678*^9, 3.85530296679068*^9}, {3.85530321187998*^9, 
   3.8553032177775545`*^9}, 3.8553032979547806`*^9, 3.8553034616914635`*^9, {
   3.8553040266263194`*^9, 3.8553040386703777`*^9}, {3.855305279211133*^9, 
   3.855305308344753*^9}, {3.8553059703581767`*^9, 3.8553059911834917`*^9}, 
   3.855306036977373*^9, {3.8553060919480877`*^9, 3.855306094653239*^9}, {
   3.8553061672475157`*^9, 3.855306177685176*^9}, 3.8553070262340503`*^9, {
   3.8553070767275705`*^9, 3.855307083462491*^9}, {3.8553072783611293`*^9, 
   3.855307313058523*^9}, {3.8553073506864767`*^9, 3.855307367223693*^9}, 
   3.8553081940068645`*^9, {3.8553082277187176`*^9, 3.8553082327969823`*^9}, {
   3.8553082671869593`*^9, 3.8553083073010635`*^9}, {3.8553084122706604`*^9, 
   3.8553084536301994`*^9}, 3.855308486434149*^9, {3.8553562957326107`*^9, 
   3.855356310945068*^9}, {3.855356381421789*^9, 3.8553563856655617`*^9}, 
   3.8553564261929274`*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"b3379e87-4e63-4a79-8911-97a1ca53c1a6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eMatrix", " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"1", "1"},
        {"0", "1"}
       }], ")"}]}], ";", 
    RowBox[{"sMatrix", "=", 
     RowBox[{"(", GridBox[{
        {"0", "1"},
        {"1", "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanMatrixProduct", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"q", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"q", " ", "=", " ", 
          RowBox[{"euclideanQCoefficients", "[", "mn", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", " ", 
          RowBox[{"(", 
           RowBox[{"Map", "[", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"MatrixPower", "[", 
                RowBox[{"eMatrix", ",", "#"}], "]"}], ".", " ", "sMatrix"}], 
              " ", "&"}], ",", "q"}], "]"}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "res", "]"}], ">", "0"}], ",", 
            RowBox[{"Dot", "@@", "res"}], ",", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"res", " ", "=", " ", 
          RowBox[{"sMatrix", " ", ".", " ", "res"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", " ", 
      RowBox[{"NumericQ", "[", 
       RowBox[{"First", "[", "mn", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanMatrixProduct", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"0", 
         RowBox[{"-", "1"}]},
        {"1", "0"}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanMatrixProduct", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         RowBox[{"-", "1"}]}
       }], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"euclideanDelta", "[", "mn_", "]"}], "  ", ":=", " ", 
    RowBox[{"Det", "@", 
     RowBox[{"euclideanMatrixProduct", "[", "mn", "]"}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"euclideanMatrixProductNew", "[", "mn_", "]"}], " ", ":=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"sMatrix", ".", " ", 
         RowBox[{"euclideanMatrixProduct", "[", "mn", "]"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"euclideanMatrixProductNew", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], "]"}]}], " ", "=", " ", 
       RowBox[{"(", GridBox[{
          {"0", 
           RowBox[{"-", "1"}]},
          {"1", "0"}
         }], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"euclideanMatrixProductNew", "[", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
      RowBox[{"(", GridBox[{
         {"1", "0"},
         {"0", 
          RowBox[{"-", "1"}]}
        }], ")"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8550899594083595`*^9, 3.8550899759779177`*^9}, {
   3.855090083355332*^9, 3.8550901727139726`*^9}, {3.855090320743924*^9, 
   3.855090330268848*^9}, {3.8550904347313476`*^9, 3.8550904351843677`*^9}, {
   3.8550905680342784`*^9, 3.855090601825388*^9}, {3.8550906434706*^9, 
   3.855090894216764*^9}, {3.8550909364618983`*^9, 3.8550909843989897`*^9}, {
   3.855091046762987*^9, 3.8550910519314036`*^9}, {3.855091099856184*^9, 
   3.8550911580490932`*^9}, {3.855091401872802*^9, 3.855091431168048*^9}, {
   3.855091588834622*^9, 3.8550915929785647`*^9}, {3.855091689834828*^9, 
   3.8550917064220295`*^9}, {3.855091747347949*^9, 3.855091860718851*^9}, {
   3.8550919349348173`*^9, 3.8550919608980474`*^9}, {3.8550920380854287`*^9, 
   3.855092048153428*^9}, {3.855092254314417*^9, 3.855092303543399*^9}, {
   3.8550923526540833`*^9, 3.8550923580149946`*^9}, {3.8550923891101456`*^9, 
   3.8550924554219165`*^9}, {3.855092593453182*^9, 3.855092740734395*^9}, {
   3.855092771841914*^9, 3.855092872914487*^9}, {3.855092919962076*^9, 
   3.855093053825495*^9}, {3.855093196308894*^9, 3.855093267365672*^9}, {
   3.8550933175084*^9, 3.8550933721273727`*^9}, {3.855093421915478*^9, 
   3.8550934515749474`*^9}, {3.855093554659423*^9, 3.855093568766191*^9}, {
   3.855095325701079*^9, 3.8550953628248177`*^9}, {3.8550955747235107`*^9, 
   3.855095584239109*^9}, {3.855158465646411*^9, 3.8551585398493433`*^9}, {
   3.8551585832281494`*^9, 3.855158608185342*^9}, {3.855158662716675*^9, 
   3.855158667481183*^9}, {3.855158698941802*^9, 3.855158813327651*^9}, {
   3.855158940540723*^9, 3.8551589450496535`*^9}, {3.855158993715618*^9, 
   3.855158995387066*^9}, {3.8551590431978855`*^9, 3.8551591001208096`*^9}, {
   3.8551591351330037`*^9, 3.8551592266439524`*^9}, {3.855159302000229*^9, 
   3.855159384720044*^9}, {3.855159448955248*^9, 3.8551594525012836`*^9}, {
   3.8551594827799463`*^9, 3.8551595490549936`*^9}, 3.8551597329018307`*^9, {
   3.8551601200634537`*^9, 3.8551601267545595`*^9}, {3.8551601605810976`*^9, 
   3.8551602171747503`*^9}, {3.855160265426713*^9, 3.855160350157117*^9}, 
   3.855160381030554*^9, {3.8551609762077227`*^9, 3.8551609883767357`*^9}, {
   3.85516101842398*^9, 3.8551610324992685`*^9}, {3.855169625341195*^9, 
   3.8551696410352087`*^9}, 3.8551696976869116`*^9, {3.8552119638678904`*^9, 
   3.855212028934022*^9}, 3.855212072224595*^9, {3.8552121203291597`*^9, 
   3.8552121566063848`*^9}, {3.855213159140607*^9, 3.855213365552743*^9}, {
   3.855213417322071*^9, 3.855213446224846*^9}, {3.855213515564699*^9, 
   3.8552137566848507`*^9}, {3.855213806118827*^9, 3.8552138267311125`*^9}, 
   3.855256920633424*^9, 3.8552999671428156`*^9, 3.8553000237439823`*^9, {
   3.855300363826341*^9, 3.855300420315815*^9}, {3.855300616932152*^9, 
   3.8553006265248413`*^9}, {3.8553021057350645`*^9, 3.8553021150161085`*^9}, 
   3.8553023076726847`*^9, 3.85530263193653*^9, {3.8553027148082314`*^9, 
   3.8553027340310016`*^9}, {3.855302893493291*^9, 3.8553028961957765`*^9}, {
   3.855302946442678*^9, 3.85530296679068*^9}, {3.85530321187998*^9, 
   3.8553032177775545`*^9}, 3.8553032979547806`*^9, 3.8553034616914635`*^9, {
   3.8553040266263194`*^9, 3.8553040386703777`*^9}, {3.855305279211133*^9, 
   3.855305291201293*^9}, {3.8553054405714426`*^9, 3.855305444548381*^9}, 
   3.855307929486965*^9, 3.8553079657260504`*^9, {3.8553562614193015`*^9, 
   3.855356271585587*^9}, {3.8553564316710443`*^9, 3.8553564540833387`*^9}, 
   3.855847950826933*^9},
 CellLabel->
  "In[1541]:=",ExpressionUUID->"a5cdef2c-f8c2-4138-91c2-7451c12c4570"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"requires", " ", "m"}], " ", "&"}], " ", "n"}], " ", ">=", " ", 
    "0"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"euclideanHighestCommonFactor", "[", "mn_", "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", "  ", 
         RowBox[{
          RowBox[{"Inverse", "[", 
           RowBox[{"euclideanMatrixProduct", "[", "mn", "]"}], "]"}], "  ", 
          ".", "  ", "mn"}]}], " ", ";", "  ", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"res", "[", 
            RowBox[{"[", "2", "]"}], "]"}], " ", "!=", "0"}], " ", ",", " ", 
          RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"First", "[", "res", "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanWindingNumberPair", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n", ",", "u", ",", "v"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "u"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "v"}], "}"}]}], "}"}], "=", " ", 
         RowBox[{"euclideanMatrixProduct", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"euclideanWindingNumberPairNew", "[", "mn_", "]"}], " ", ":=", 
      " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"m", ",", "n", ",", "u", ",", "v"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"m", ",", "u"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"n", ",", "v"}], "}"}]}], "}"}], "=", " ", 
          RowBox[{"euclideanMatrixProductNew", "[", "mn", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanFareyInterval", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanFareyInterval", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanFareyInterval", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"euclideanFareyInterval", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v", ",", "delta", ",", "interval"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"delta", " ", "=", " ", 
         RowBox[{"euclideanDelta", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"interval", " ", "=", "  ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u", "/", "m"}], ",", 
           RowBox[{"v", "/", "n"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"delta", " ", "<", "0"}], ",", " ", 
          RowBox[{"interval", "=", 
           RowBox[{"Reverse", "@", "interval"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "interval"}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8550899594083595`*^9, 3.8550899759779177`*^9}, {
   3.855090083355332*^9, 3.8550901727139726`*^9}, {3.855090320743924*^9, 
   3.855090330268848*^9}, {3.8550904347313476`*^9, 3.8550904351843677`*^9}, {
   3.8550905680342784`*^9, 3.855090601825388*^9}, {3.8550906434706*^9, 
   3.855090894216764*^9}, {3.8550909364618983`*^9, 3.8550909843989897`*^9}, {
   3.855091046762987*^9, 3.8550910519314036`*^9}, {3.855091099856184*^9, 
   3.8550911580490932`*^9}, {3.855091401872802*^9, 3.855091431168048*^9}, {
   3.855091588834622*^9, 3.8550915929785647`*^9}, {3.855091689834828*^9, 
   3.8550917064220295`*^9}, {3.855091747347949*^9, 3.855091860718851*^9}, {
   3.8550919349348173`*^9, 3.8550919608980474`*^9}, {3.8550920380854287`*^9, 
   3.855092048153428*^9}, {3.855092254314417*^9, 3.855092303543399*^9}, {
   3.8550923526540833`*^9, 3.8550923580149946`*^9}, {3.8550923891101456`*^9, 
   3.8550924554219165`*^9}, {3.855092593453182*^9, 3.855092740734395*^9}, {
   3.855092771841914*^9, 3.855092872914487*^9}, {3.855092919962076*^9, 
   3.855093053825495*^9}, {3.855093196308894*^9, 3.855093267365672*^9}, {
   3.8550933175084*^9, 3.8550933721273727`*^9}, {3.855093421915478*^9, 
   3.8550934515749474`*^9}, {3.855093554659423*^9, 3.855093568766191*^9}, {
   3.855095325701079*^9, 3.8550953628248177`*^9}, {3.8550955747235107`*^9, 
   3.855095584239109*^9}, {3.855158465646411*^9, 3.8551585398493433`*^9}, {
   3.8551585832281494`*^9, 3.855158608185342*^9}, {3.855158662716675*^9, 
   3.855158667481183*^9}, {3.855158698941802*^9, 3.855158813327651*^9}, {
   3.855158940540723*^9, 3.8551589450496535`*^9}, {3.855158993715618*^9, 
   3.855158995387066*^9}, {3.8551590431978855`*^9, 3.8551591001208096`*^9}, {
   3.8551591351330037`*^9, 3.8551592266439524`*^9}, {3.855159302000229*^9, 
   3.855159384720044*^9}, {3.855159448955248*^9, 3.8551594525012836`*^9}, {
   3.8551594827799463`*^9, 3.8551595490549936`*^9}, 3.8551597329018307`*^9, {
   3.8551601200634537`*^9, 3.8551601267545595`*^9}, {3.8551601605810976`*^9, 
   3.8551602171747503`*^9}, {3.855160265426713*^9, 3.855160365649686*^9}, {
   3.8553052274213314`*^9, 3.855305260088523*^9}, 3.8556440967862053`*^9, 
   3.8556825456390867`*^9, 
   3.855847881377151*^9},ExpressionUUID->"7036ebfe-030a-49e0-b87d-\
b224cd9134b9"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mobius maps", "Chapter",
 CellChangeTimes->{{3.8556828534358544`*^9, 
  3.8556828613407707`*^9}},ExpressionUUID->"de368bc0-235c-41d2-9a9d-\
306682b7b46a"],

Cell[CellGroupData[{

Cell["gmn map", "Subsection",
 CellChangeTimes->{{3.855682972160249*^9, 
  3.8556829780429325`*^9}},ExpressionUUID->"568cea66-98e0-4905-8ae7-\
07ed56da9aef"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"basisChangeMatrix", "[", "mn_", "]"}], " ", ":=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {"1", "0"},
        {"0", 
         RowBox[{"-", "1"}]}
       }], ")"}], " ", ".", 
     RowBox[{"Transpose", "[", " ", 
      RowBox[{"euclideanMatrixProductNew", "[", "mn", "]"}], "]"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisInverseChangeMatrix", "[", "mn_", "]"}], " ", ":=", " ", 
   RowBox[{"Inverse", "[", 
    RowBox[{"basisChangeMatrix", "[", "mn", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"n", ",", "m", ",", "v", ",", "u"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"basisChangeMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"n", ",", "m"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"(", GridBox[{
      {"n", 
       RowBox[{"-", "v"}]},
      {"m", 
       RowBox[{"-", "u"}]}
     }], ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matrixToMoebius", "[", "matrix_", "]"}], " ", ":=", " ", 
   RowBox[{"Function", "[", 
    RowBox[{"z", ",", " ", 
     RowBox[{"Divide", "@@", 
      RowBox[{"(", 
       RowBox[{"matrix", " ", ".", " ", 
        RowBox[{"{", 
         RowBox[{"z", ",", "1"}], "}"}]}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "gmn", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"reIm", "[", "x___", "]"}], " ", ":=", " ", 
   RowBox[{"ComplexExpand", "[", 
    RowBox[{"ReIm", "[", "x", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conjugate", "[", "x___", "]"}], " ", ":=", " ", 
    RowBox[{"ComplexExpand", "[", 
     RowBox[{"Conjugate", "[", "x", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"gmn", ",", "m", ",", "n", ",", "z", ",", "u", ",", "v"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gmn", "[", "mn_", "]"}], "[", "z", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"matrixToMoebius", "[", 
    RowBox[{"basisInverseChangeMatrix", "[", "mn", "]"}], "]"}], "[", "z", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gmn", "[", "mn_", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"reIm", "@", 
    RowBox[{
     RowBox[{"matrixToMoebius", "[", 
      RowBox[{"basisInverseChangeMatrix", "[", "mn", "]"}], "]"}], "[", 
     RowBox[{"d", "+", " ", 
      RowBox[{"I", " ", "h"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"gmn", "[", "mn_", "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"d_", ",", 
       RowBox[{"DirectedInfinity", "[", "_", "]"}]}], "}"}], "]"}], " ", ":=",
     " ", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Divide", "@@", " ", 
        RowBox[{"basisInverseChangeMatrix", "[", "mn", "]"}]}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], ",", "0"}], "}"}]}], ";", 
   RowBox[{
    RowBox[{
     RowBox[{"gmn", "[", 
      RowBox[{"{", 
       RowBox[{"n", ",", "m"}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"DirectedInfinity", "[", "_", "]"}]}], "}"}], "]"}], " ", ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"u", "/", "m"}], ",", "0"}], "}"}]}]}], " ", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gmnInDHalfNew", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "[", "dh_", "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"gmn", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "[", "dh", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gmnInDHalfNew", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], "]"}], "[", "dh_", "]"}], " ", ":=", 
   " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}]}], "}"}], " ", "*", " ", 
    RowBox[{
     RowBox[{"gmn", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "]"}], "[", "dh", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gmnInDHalfNew", "[", "mn_", "]"}], "[", "dh_", "]"}], " ", ":=", 
   " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", 
       RowBox[{
        RowBox[{"gmn", "[", "mn", "]"}], "[", "dh", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"euclideanDelta", "[", "mn", "]"}], "<", "0"}], ",", " ", 
        RowBox[{"res", "=", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "1"}]}], "}"}], " ", "*", " ", "res"}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855169303930827*^9, 3.8551694147820296`*^9}, {
   3.8551695047168493`*^9, 3.855169525970995*^9}, {3.855169609905811*^9, 
   3.8551696104892707`*^9}, {3.8551696789994946`*^9, 3.855169738691918*^9}, {
   3.855169771037916*^9, 3.8551697731255555`*^9}, {3.855169834557398*^9, 
   3.8551698465699577`*^9}, {3.85516988286786*^9, 3.855170010719825*^9}, {
   3.855170170570446*^9, 3.8551701819608536`*^9}, {3.855170339389206*^9, 
   3.8551703761117716`*^9}, {3.855210050076187*^9, 3.855210054278208*^9}, 
   3.8552102535075593`*^9, {3.8552103669377313`*^9, 3.8552103943450675`*^9}, {
   3.855210486670768*^9, 3.8552105121325707`*^9}, {3.855257022249633*^9, 
   3.8552570325097947`*^9}, {3.8552571988355513`*^9, 3.85525726439155*^9}, {
   3.8552579049992037`*^9, 3.855257939194954*^9}, {3.8552579712859488`*^9, 
   3.8552580004327164`*^9}, {3.855267470430182*^9, 3.8552674710394073`*^9}, {
   3.855267507384616*^9, 3.8552676167723455`*^9}, {3.8552681836272593`*^9, 
   3.855268256332899*^9}, {3.8552682956518025`*^9, 3.8552683249686112`*^9}, {
   3.855268377221817*^9, 3.8552683925929575`*^9}, {3.855268533532687*^9, 
   3.855268697626459*^9}, {3.855268729854045*^9, 3.8552688646621895`*^9}, {
   3.8552689131107607`*^9, 3.8552690221703196`*^9}, 3.8552690862700624`*^9, {
   3.855284605320052*^9, 3.8552846701983056`*^9}, {3.8552849999575415`*^9, 
   3.8552850652957025`*^9}, {3.8552852422765303`*^9, 
   3.8552853122432175`*^9}, {3.8552853907825108`*^9, 
   3.8552853960157104`*^9}, {3.85528548080171*^9, 3.855285500032851*^9}, 
   3.855285535944915*^9, {3.8552856311149487`*^9, 3.8552857148896537`*^9}, {
   3.8552857628220882`*^9, 3.8552858149832973`*^9}, {3.855286620359476*^9, 
   3.855286630082608*^9}, 3.8552866725908995`*^9, {3.8552989437461495`*^9, 
   3.8552989908587317`*^9}, {3.8553008997519045`*^9, 
   3.8553009115756073`*^9}, {3.8553009439048424`*^9, 3.855300944460219*^9}, {
   3.8553011179958878`*^9, 3.855301118132721*^9}, {3.8553011552116156`*^9, 
   3.8553011554438906`*^9}, {3.8553011888341193`*^9, 
   3.8553011890193405`*^9}, {3.8553013836893067`*^9, 
   3.8553013839552937`*^9}, {3.855303353226388*^9, 3.855303357022874*^9}, {
   3.8553037240177064`*^9, 3.8553037316868014`*^9}, {3.8553041399648886`*^9, 
   3.855304140480094*^9}, {3.8553067080835824`*^9, 3.8553067093333178`*^9}, {
   3.8553067631616163`*^9, 3.8553067640520315`*^9}, {3.8553086186045465`*^9, 
   3.8553087553841085`*^9}, {3.8553088408119545`*^9, 3.855308841241037*^9}, {
   3.855308930492298*^9, 3.8553089308559833`*^9}, {3.8553089684952755`*^9, 
   3.8553089689532714`*^9}, {3.8553107567344313`*^9, 
   3.8553107574459543`*^9}, {3.8553108177304745`*^9, 3.85531081791673*^9}, {
   3.855310927531148*^9, 3.8553109955844493`*^9}, {3.8553112547514596`*^9, 
   3.8553112650700455`*^9}, {3.855311303084302*^9, 3.855311384475004*^9}, {
   3.855311483173472*^9, 3.8553114843861265`*^9}, {3.8553115664426413`*^9, 
   3.855311568997903*^9}, {3.8553116182397423`*^9, 3.855311684121542*^9}, {
   3.8553117279143195`*^9, 3.855311728098197*^9}, 3.8553173525732417`*^9, {
   3.855317395315879*^9, 3.855317432362951*^9}, {3.855317469258072*^9, 
   3.8553174719417*^9}, {3.855317655656708*^9, 3.8553176629509916`*^9}, 
   3.855317776943341*^9, {3.8553178498789787`*^9, 3.855317856639346*^9}, {
   3.8553179375859623`*^9, 3.855318015258377*^9}, 3.855318112928958*^9, {
   3.855320388436124*^9, 3.855320399732512*^9}, {3.8553700637270427`*^9, 
   3.8553701153656197`*^9}, {3.855382195385887*^9, 3.855382238020749*^9}, 
   3.855533706959055*^9, 3.8555337432253327`*^9, {3.8555339081024694`*^9, 
   3.85553391367931*^9}, {3.855554544417221*^9, 3.855554578534535*^9}, 
   3.8556828938664346`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"1e9fad43-8743-42b5-a24f-c278f9aa1ebb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Mapped points", "Subsection",
 CellChangeTimes->{{3.855682895933633*^9, 
  3.855682906985134*^9}},ExpressionUUID->"f94db409-52ef-4b5f-a556-\
b11eb1fc13ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"euclideanMobiusTransformation", "[", "mn_", "]"}], "[", "dh_", 
    "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"gmnInDHalfNew", "[", "mn", "]"}], "[", "dh", "]"}]}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"euclideanMobiusTransformation", "[", "mn_", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"DirectedInfinity", "[", "1", "]"}]}], "}"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gmnInDHalfNew", "[", "mn", "]"}], "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", "h"}], "}"}], "]"}], ",", 
       RowBox[{"h", "->", "\[Infinity]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"euclidean01Points", " ", "=", " ", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<ZeroRise\>\"", "->", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"DirectedInfinity", "[", "1", "]"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<RightTriplePoint\>\"", "->", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", ",", " ", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"\"\<LeftTriplePoint\>\"", "->", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], " ", ",", " ", 
         RowBox[{
          RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"\"\<UpperTouchingCircle\>\"", "->", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"1", "/", "2"}], " ", ",", " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"\"\<LowerTouchingCircle\>\"", "->", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], " ", ",", " ", 
         RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
      ",", 
      RowBox[{"\"\<Orthogonal\>\"", "  ", "->", "  ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"\"\<TouchingCircle\>\"", "  ", "->", "  ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"\"\<Zero\>\"", "  ", "->", "  ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"\"\<Interior\>\"", "->", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1.5"}], "}"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "8"}], ",", "1.5"}], "}"}], "*)"}], 
     "\[IndentingNewLine]", "|>"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonRegionPoints", "[", "mn_", "]"}], " ", ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Off", "[", 
        RowBox[{
         RowBox[{"Infinity", "::", "indet"}], ",", 
         RowBox[{"Divide", "::", "infy"}]}], "]"}], ";", 
       RowBox[{"res", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"euclideanMobiusTransformation", "[", "mn", "]"}], ",", 
          "euclidean01Points"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"On", "[", 
        RowBox[{
         RowBox[{"Infinity", "::", "indet"}], ",", 
         RowBox[{"Divide", "::", "infy"}]}], "]"}], ";", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vanItersonLabelPoint", "[", "mn_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"vanItersonRegionPoints", "[", "mn", "]"}], "[", 
   "\"\<Interior\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vanItersonTriplePointLeft", "[", "mn_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"vanItersonRegionPoints", "[", "mn", "]"}], "[", 
   "\"\<LeftTriplePoint\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonTriplePointRight", "[", "mn_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"vanItersonRegionPoints", "[", "mn", "]"}], "[", 
    "\"\<RightTriplePoint\>\"", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"viiLabelPoint", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"5", "/", "2"}], ")"}]}]}], "}"}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855169303930827*^9, 3.8551694147820296`*^9}, {
   3.8551695047168493`*^9, 3.855169525970995*^9}, {3.855169609905811*^9, 
   3.8551696104892707`*^9}, {3.8551696789994946`*^9, 3.855169738691918*^9}, {
   3.855169771037916*^9, 3.8551697731255555`*^9}, {3.855169834557398*^9, 
   3.8551698465699577`*^9}, {3.85516988286786*^9, 3.855170010719825*^9}, {
   3.855170170570446*^9, 3.8551701819608536`*^9}, {3.855170339389206*^9, 
   3.8551703761117716`*^9}, {3.855210050076187*^9, 3.855210054278208*^9}, 
   3.8552102535075593`*^9, {3.8552103669377313`*^9, 3.8552103943450675`*^9}, {
   3.855210486670768*^9, 3.8552105121325707`*^9}, {3.855257022249633*^9, 
   3.8552570325097947`*^9}, {3.8552571988355513`*^9, 3.85525726439155*^9}, {
   3.8552579049992037`*^9, 3.855257939194954*^9}, {3.8552579712859488`*^9, 
   3.8552580004327164`*^9}, {3.855267470430182*^9, 3.8552674710394073`*^9}, {
   3.855267507384616*^9, 3.8552676167723455`*^9}, {3.8552681836272593`*^9, 
   3.855268256332899*^9}, {3.8552682956518025`*^9, 3.8552683249686112`*^9}, {
   3.855268377221817*^9, 3.8552683925929575`*^9}, {3.855268533532687*^9, 
   3.855268697626459*^9}, {3.855268729854045*^9, 3.8552688646621895`*^9}, {
   3.8552689131107607`*^9, 3.8552690221703196`*^9}, 3.8552690862700624`*^9, {
   3.855284605320052*^9, 3.8552846701983056`*^9}, {3.8552849999575415`*^9, 
   3.8552850652957025`*^9}, {3.8552852422765303`*^9, 
   3.8552853122432175`*^9}, {3.8552853907825108`*^9, 
   3.8552853960157104`*^9}, {3.85528548080171*^9, 3.855285500032851*^9}, 
   3.855285535944915*^9, {3.8552856311149487`*^9, 3.8552857148896537`*^9}, {
   3.8552857628220882`*^9, 3.8552858149832973`*^9}, {3.855286620359476*^9, 
   3.855286630082608*^9}, 3.8552866725908995`*^9, {3.8552989437461495`*^9, 
   3.8552989908587317`*^9}, {3.8553008997519045`*^9, 
   3.8553009115756073`*^9}, {3.8553009439048424`*^9, 3.855300944460219*^9}, {
   3.8553011179958878`*^9, 3.855301118132721*^9}, {3.8553011552116156`*^9, 
   3.8553011554438906`*^9}, {3.8553011888341193`*^9, 
   3.8553011890193405`*^9}, {3.8553013836893067`*^9, 
   3.8553013839552937`*^9}, {3.855303353226388*^9, 3.855303357022874*^9}, {
   3.8553037240177064`*^9, 3.8553037316868014`*^9}, {3.8553041399648886`*^9, 
   3.855304140480094*^9}, {3.8553067080835824`*^9, 3.8553067093333178`*^9}, {
   3.8553067631616163`*^9, 3.8553067640520315`*^9}, {3.8553086186045465`*^9, 
   3.8553087553841085`*^9}, {3.8553088408119545`*^9, 3.855308841241037*^9}, {
   3.855308930492298*^9, 3.8553089308559833`*^9}, {3.8553089684952755`*^9, 
   3.8553089689532714`*^9}, {3.8553107567344313`*^9, 
   3.8553107574459543`*^9}, {3.8553108177304745`*^9, 3.85531081791673*^9}, {
   3.855310927531148*^9, 3.8553109955844493`*^9}, {3.8553112547514596`*^9, 
   3.8553112650700455`*^9}, {3.855311303084302*^9, 3.855311384475004*^9}, {
   3.855311483173472*^9, 3.8553114843861265`*^9}, {3.8553115664426413`*^9, 
   3.855311568997903*^9}, {3.8553116182397423`*^9, 3.855311684121542*^9}, {
   3.8553117279143195`*^9, 3.855311728098197*^9}, 3.8553173525732417`*^9, {
   3.855317395315879*^9, 3.855317432362951*^9}, {3.855317469258072*^9, 
   3.8553174719417*^9}, {3.855317655656708*^9, 3.8553176629509916`*^9}, 
   3.855317776943341*^9, {3.8553178498789787`*^9, 3.855317856639346*^9}, {
   3.8553179375859623`*^9, 3.855318015258377*^9}, 3.855318112928958*^9, {
   3.855320388436124*^9, 3.855320399732512*^9}, {3.8553700637270427`*^9, 
   3.8553701153656197`*^9}, {3.855382195385887*^9, 3.855382238020749*^9}, 
   3.855533706959055*^9, 3.8555337432253327`*^9, {3.8555339081024694`*^9, 
   3.85553391367931*^9}, {3.855554544417221*^9, 3.855554578534535*^9}, 
   3.8556828938664346`*^9, {3.8556977149630384`*^9, 3.8556977812826457`*^9}, 
   3.8557078143034697`*^9, {3.8557079074444885`*^9, 3.8557079687435102`*^9}, {
   3.8557080128868446`*^9, 3.855708027667549*^9}, {3.855708117444818*^9, 
   3.8557081208160543`*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"5b70e54d-e622-4347-b9ad-75bc348cc649"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mapped lines", "Subsection",
 CellChangeTimes->{{3.8556829153627996`*^9, 
  3.8556829231784105`*^9}},ExpressionUUID->"9018438c-054d-4bf6-9f53-\
331d4b15410a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"viiPrimaryBoundingBox", "[", "mn_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"upperTP", ",", "lowerTP", ",", "m", ",", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", " ", "mn"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"upperTP", " ", "=", " ", 
         RowBox[{"viiTriplePoint", "[", 
          RowBox[{"viiUpperPair", "[", 
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lowerTP", " ", "=", " ", 
         RowBox[{"viiTriplePoint", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"lowerTP", ",", "upperTP"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimaryBoundingBox", "[", "mn_", "]"}], 
     " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"euclideanMobiusTransformation", "[", "mn", "]"}], "/@", " ", 
        RowBox[{"KeyTake", "[", 
         RowBox[{"euclidean01Points", ",", 
          RowBox[{"{", 
           RowBox[{
           "\"\<LeftTriplePoint\>\"", ",", "\"\<RightTriplePoint\>\""}], 
           "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimary", "[", "mn_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pointData", ",", "circleData", ",", "centre"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pointData", " ", "=", " ", 
         RowBox[{
         "vanItersonTouchingCirclePrimaryBoundingBox", "[", "mn", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"circleData", "=", " ", 
         RowBox[{"vanItersonTouchingCircle", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"centre", " ", "=", " ", 
         RowBox[{"circleData", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointData", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "-", "centre"}], " ", "&"}], ",", "pointData"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointData", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"ArcTan", ",", "#"}], "]"}], "&"}], ",", "pointData"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pointData", " ", "=", " ", 
         RowBox[{"Sort", "@", 
          RowBox[{"N", "@", 
           RowBox[{"Values", "@", "pointData"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"circleData", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"circleData", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "pointData"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimary", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{
           RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", 
             RowBox[{"Sqrt", "[", "3", "]"}]}], ")"}]}]}], "}"}]}], "}"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vanItersonTouchingCirclePrimary", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], "]"}], ":=", " ", 
    RowBox[{"vanItersonTouchingCirclePrimary", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimary", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", "\[IndentingNewLine]", " ", 
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Pi]", "/", "3"}], ",", 
          RowBox[{"2", 
           RowBox[{"\[Pi]", "/", "3"}]}]}], "}"}]}], "]"}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCircle", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "m", ",", "n", ",", "u", ",", "v", ",", "dbar"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", " ", "mn"}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"Sort", "[", "mn", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "\[Equal]", "1"}], " ", "&&", " ", 
           RowBox[{"n", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"InfiniteLine", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "}"}], "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"n", "^", "2"}], "-", 
             RowBox[{"m", "^", "2"}]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dbar", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"n", " ", "v"}], " ", "-", " ", 
            RowBox[{"m", " ", "u"}]}], " ", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "-", 
            RowBox[{"m", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"dbar", ",", " ", "0"}], "}"}], ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCircleNonPrimary", "[", "mn_", "]"}], " ", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "upperTP", ",", "lowerTP", ",", "m", ",", "n", ",", "circle"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lowerTP", ",", "upperTP"}], "}"}], " ", "=", " ", 
         RowBox[{"Values", "@", 
          RowBox[{
          "vanItersonTouchingCirclePrimaryBoundingBox", "[", "mn", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"remainderSegments", "[", 
         RowBox[{
          RowBox[{"vanItersonTouchingCircle", "[", "mn", "]"}], ",", 
          "upperTP", ",", "lowerTP"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "split", "  ", "half", " ", "circle", "  ", "at", " ", "points", " ", 
     "p1", " ", "and", " ", "p2"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"subSegment", "[", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{"xy_", ",", "r_", ",", "angles___"}], "]"}], ",", "p1_", ",", 
       "p2_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"angle1", ",", "angle2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"angle1", ",", "angle2"}], "}"}], " ", "=", " ", 
         RowBox[{"Sort", "@", 
          RowBox[{"N", "[", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ArcTan", " ", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "xy"}], ")"}]}], ",", 
             RowBox[{"ArcTan", " ", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"p2", "-", "xy"}], ")"}]}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", 
         RowBox[{"xy", ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"angle1", ",", "angle2"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"remainderSegments", "[", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{"xy_", ",", "r_", ",", "angles___"}], "]"}], ",", "p1_", ",", 
       "p2_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"angle1", ",", "angle2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"angle1", ",", "angle2"}], "}"}], " ", "=", " ", 
         RowBox[{"Sort", "@", 
          RowBox[{"N", "[", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"ArcTan", " ", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"p1", "-", "xy"}], ")"}]}], ",", 
             RowBox[{"ArcTan", " ", "@@", " ", 
              RowBox[{"(", 
               RowBox[{"p2", "-", "xy"}], ")"}]}]}], "}"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Circle", "[", 
           RowBox[{"xy", ",", "r", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "angle1"}], "}"}]}], "]"}], ",", 
          RowBox[{"Circle", "[", 
           RowBox[{"xy", ",", "r", ",", 
            RowBox[{"{", 
             RowBox[{"angle2", ",", "\[Pi]"}], "}"}]}], "]"}]}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"subSegment", "[", 
      RowBox[{
       RowBox[{"InfiniteLine", "[", "_", "]"}], ",", "p1_", ",", "p2_"}], 
      "]"}], " ", ":=", " ", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"by", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCircleNonPrimary", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"\[Pi]", "/", "3"}]}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCircleNonPrimary", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", " ", 
               RowBox[{"\[Sqrt]", "3"}]}], ")"}]}]}], "}"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{"HalfLine", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Sqrt]", "3"}], ")"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "2"}], "}"}]}], "}"}], "]"}]}], 
      "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"1.2", " ", "=", " ", "\[Infinity]"}], " ", "*)"}], " ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCircleNonPrimary", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], " ", "=", 
     RowBox[{"{", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
         RowBox[{"1", "/", "3"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Pi]", "/", "3"}], ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
       " ", 
       RowBox[{"Circle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "/", "3"}], ",", "0"}], "}"}], ",", 
         RowBox[{"1", "/", "3"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"5", 
            RowBox[{"\[Pi]", "/", "6"}]}], ",", "\[Pi]"}], "}"}]}], "]"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiPrimaryIsEverNonOpposed", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], " ", "=", " ", 
         RowBox[{"Sort", "[", "mn", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", " ", "<", " ", 
         RowBox[{"n", " ", "-", " ", "m"}]}]}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimaryOpposed", "[", "mn_", "]"}], " ",
      ":=", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"vanItersonTouchingCirclePrimary", "[", "mn", "]"}], " ", "/;", 
      " ", 
      RowBox[{"viiPrimaryIsEverNonOpposed", "[", "mn", "]"}]}]}], " ", ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimaryOpposed", "[", "mn_", "]"}], 
     "  ", ":=", " ", 
     RowBox[{"circleBranch", "[", 
      RowBox[{"mn", ",", "\"\<Opposed\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonTouchingCirclePrimaryNonOpposed", "[", "mn_", "]"}], 
     "  ", ":=", " ", 
     RowBox[{"circleBranch", "[", 
      RowBox[{"mn", ",", "\"\<NonOpposed\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"viiPrimaryOpposed", "[", "mn_", "]"}], "  ", ":=", " ", 
      RowBox[{"getCircleBranch", "[", 
       RowBox[{"mn", ",", "\"\<Opposed\>\""}], "]"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"viiPrimaryNonOpposed", "[", "mn_", "]"}], "  ", ":=", " ", 
      RowBox[{"getCircleBranch", "[", 
       RowBox[{"mn", ",", "\"\<NonOpposed\>\""}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"circleBranch", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], ",", "scalingFunction_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mn", ",", "angle", ",", "upperpt", ",", "lowerpt", ",", "res", ",", 
         "centre", ",", "r", ",", "theta12", ",", "branch"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mn", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"branch", " ", "=", " ", 
         RowBox[{"vanItersonTouchingCirclePrimary", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"viiPrimaryIsEverNonOpposed", "[", "mn", "]"}]}], ",", 
          "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"scalingFunction", "==", "\"\<Opposed\>\""}], ",", " ", 
            RowBox[{"Return", "[", "branch", "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"Nothing", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angle", " ", "=", " ", 
         RowBox[{"circleAngleAtLine", "[", 
          RowBox[{"branch", ",", 
           RowBox[{"viiOrthostichyD", "[", "mn", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"upperpt", " ", "=", "  ", 
         RowBox[{"vanItersonTriplePointRight", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lowerpt", " ", "=", " ", 
         RowBox[{"vanItersonTriplePointLeft", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"centre", ",", "r", ",", "theta12"}], "}"}], " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "branch"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"scalingFunction", "==", "\"\<NonOpposed\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Circle", "[", 
            RowBox[{"centre", ",", "r", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xyToArg", "[", 
                 RowBox[{"branch", ",", "upperpt"}], "]"}], ",", "angle"}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Circle", "[", 
            RowBox[{"centre", ",", "r", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xyToArg", "[", 
                 RowBox[{"branch", ",", "lowerpt"}], "]"}], ",", "angle"}], 
               "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiOrthostichyD", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"u", ",", "v", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
        RowBox[{"euclideanWindingNumberPair", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"v", "/", "n"}]}], ";", "\[IndentingNewLine]", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"res", ">", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{"res", " ", "=", " ", 
          RowBox[{"1", "-", "res"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "res"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xyToArg", "[", 
      RowBox[{
       RowBox[{"Circle", "[", 
        RowBox[{"centre_", ",", "r_", ",", "theta_"}], "]"}], ",", "xy_"}], 
      " ", "]"}], ":=", " ", 
     RowBox[{"ArcTan", " ", "@@", " ", 
      RowBox[{"(", " ", 
       RowBox[{"xy", " ", "-", " ", "centre"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"circleAngleAtLine", "[", 
      RowBox[{"circle_", ",", "d_"}], "]"}], " ", ":=", " ", 
     RowBox[{"xyToArg", "[", 
      RowBox[{"circle", ",", " ", 
       RowBox[{"linecircleIntersectionDH", "[", 
        RowBox[{"d", ",", "circle"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linecircleIntersectionDH", "[", 
      RowBox[{"d_", ",", "circle_"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{"d", ",", 
       RowBox[{"linecircleIntersection", "[", 
        RowBox[{"d", ",", "circle"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"linecircleIntersection", "[", 
      RowBox[{"lineD_", ",", 
       RowBox[{"Circle", "[", 
        RowBox[{"centre_", ",", "r_", ",", "theta_"}], "]"}]}], "]"}], " ", ":=",
      " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"r", "^", "2"}], " ", "-", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lineD", "-", 
          RowBox[{"centre", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonSquareLattice", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"HalfLine", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"HalfLine", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonSquareLattice", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], "}"}], 
        "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], "}"}], 
        "]"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"vanItersonSquareLattice", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n", ",", "u", ",", "v", ",", "um", ",", "vn"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", " ", "mn"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"um", ",", "vn"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u", "/", "m"}], ",", 
           RowBox[{"v", "/", "n"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"um", "+", "vn"}], ")"}], "/", "2"}], ",", " ", "0"}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"vn", "-", "um"}], "]"}], "/", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vanItersonSquareLatticeRegion", "[", "mn_", "]"}], " ", ":=", 
    " ", 
    RowBox[{
     RowBox[{"vanItersonSquareLattice", "[", "mn", "]"}], "/.", " ", 
     RowBox[{"Circle", "->", "Disk"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vanItersonTouchingRegion", "[", "mn_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"vanItersonTouchingCircle", "[", "mn", "]"}], " ", "/.", " ", 
     RowBox[{"Circle", "->", "Disk"}]}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8555333115698223`*^9, 3.855533530958736*^9}, 
   3.8555336953177676`*^9, 3.855533728593272*^9, 3.855533807744364*^9, {
   3.8555339187549953`*^9, 3.8555339225830364`*^9}, {3.855533970641518*^9, 
   3.8555339941447773`*^9}, {3.85553404435563*^9, 3.855534230394991*^9}, {
   3.855534288479534*^9, 3.8555342939326077`*^9}, {3.855534692650647*^9, 
   3.8555347282706347`*^9}, {3.8555347741907673`*^9, 3.855534780342754*^9}, {
   3.8555348227932796`*^9, 3.8555348241044445`*^9}, {3.855534894149061*^9, 
   3.855535169514002*^9}, {3.8555353310993104`*^9, 3.855535429761984*^9}, {
   3.8555357204041557`*^9, 3.8555357837811017`*^9}, {3.8555358277059383`*^9, 
   3.8555358522074003`*^9}, {3.8555359455481453`*^9, 3.855535953946597*^9}, {
   3.855536012231922*^9, 3.8555360529883003`*^9}, {3.855536092845914*^9, 
   3.855536097855298*^9}, {3.8555361913180304`*^9, 3.8555362272238812`*^9}, {
   3.8555364182794733`*^9, 3.8555364305890827`*^9}, {3.8555364734348617`*^9, 
   3.8555364753573008`*^9}, {3.8555366265321836`*^9, 
   3.8555366445718317`*^9}, {3.8555367749281087`*^9, 
   3.8555367975336556`*^9}, {3.855536875080449*^9, 3.855536883503791*^9}, {
   3.8555369152641478`*^9, 3.85553693841665*^9}, 3.855536975081807*^9, {
   3.8555370117650833`*^9, 3.8555371145850277`*^9}, {3.8555371565030704`*^9, 
   3.85553720482619*^9}, {3.8555538387558184`*^9, 3.85555390297546*^9}, 
   3.855553959680527*^9, {3.855554022170492*^9, 3.8555540542458677`*^9}, {
   3.8555541051102715`*^9, 3.8555541916777754`*^9}, {3.8555543205318537`*^9, 
   3.855554339855812*^9}, {3.8555546174579372`*^9, 3.855554718501359*^9}, {
   3.8555725957221713`*^9, 3.8555725990495176`*^9}, {3.855573477982793*^9, 
   3.8555734810758142`*^9}, {3.8555735475003767`*^9, 3.855573548093936*^9}, {
   3.8555758498046355`*^9, 3.8555758508044415`*^9}, {3.855575966787492*^9, 
   3.8555759709657693`*^9}, {3.855581028305601*^9, 3.8555810293363047`*^9}, {
   3.855581066242447*^9, 3.8555810884014125`*^9}, {3.8557003711714544`*^9, 
   3.8557003812871866`*^9}, {3.855702300001058*^9, 3.855702303248357*^9}, {
   3.855721883173523*^9, 3.85572193098024*^9}, 3.8557219674753494`*^9, {
   3.8557271278163357`*^9, 3.8557271382649784`*^9}, {3.85572723475414*^9, 
   3.855727359980834*^9}, {3.855727436649648*^9, 3.8557274669233847`*^9}, {
   3.855727885943629*^9, 3.855727916877756*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"2a6f8a99-dda3-4048-9102-1b1225ad8242"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mapped regions", "Subsection",
 CellChangeTimes->{{3.855682947963882*^9, 
  3.8556829562424974`*^9}},ExpressionUUID->"d3c5b46f-d312-4a31-b1ca-\
48111f6dce9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", 
    RowBox[{"vanItersonPolygon", ",", "vanItersonRegion"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonPolygon", "[", "mn_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"vanItersonPolygon", "[", 
      RowBox[{"mn", ",", " ", "\"\<Plus\>\""}], "]"}], ",", 
     RowBox[{"vanItersonPolygon", "[", 
      RowBox[{"mn", ",", " ", "\"\<Minus\>\""}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonPolygon", "[", 
     RowBox[{"mn_", ",", "sign_"}], "]"}], " ", ":=", " ", 
    RowBox[{"viiPolygon", "[", 
     RowBox[{"mn", ",", "\"\<Ordered\>\"", ",", "sign"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonPolygon", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", " ", "sign_"}], "]"}], "  ", ":=", 
   " ", 
   RowBox[{"regionToPolygon", "@", 
    RowBox[{"DiscretizeRegion", "@", 
     RowBox[{"vanItersonRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "sign"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonPolygon", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", " ", "sign_"}], "]"}], "  ", ":=", 
   " ", 
   RowBox[{"regionToPolygon", "@", 
    RowBox[{"DiscretizeRegion", "@", 
     RowBox[{"vanItersonRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "sign"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonPolygon", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", " ", "sign_"}], "]"}], "  ", ":=", 
   " ", 
   RowBox[{"regionToPolygon", "@", 
    RowBox[{"DiscretizeRegion", "@", 
     RowBox[{"vanItersonRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "sign"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonPolygon", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", " ", "sign_"}], "]"}], "  ", ":=", 
   " ", 
   RowBox[{"regionToPolygon", "@", 
    RowBox[{"DiscretizeRegion", "@", 
     RowBox[{"vanItersonRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "sign"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonPolygon", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", " ", "sign_"}], "]"}], "  ", ":=",
     " ", 
    RowBox[{"regionToPolygon", "@", 
     RowBox[{"DiscretizeRegion", "@", 
      RowBox[{"vanItersonRegion", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], ",", "sign"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vihmax", "=", "1.2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", " ", "\"\<Plus\>\""}], "]"}], "  ",
    ":=", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "2"}], ",", "vihmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Minus\>\""}], "]"}], " ", ":=", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rectangle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "vihmax"}], "}"}]}], "]"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", " ", "\"\<Plus\>\""}], "]"}], "  ",
    ":=", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegionIntersection", "[", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonRegion", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Minus\>\""}], "]"}], " ", ":=", 
    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionIntersection", "[", 
       RowBox[{
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", " ", "\"\<Minus\>\""}], "]"}], 
   "  ", ":=", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"RegionIntersection", "[", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"vanItersonSquareLatticeRegion", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonRegion", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", " ", "\"\<Plus\>\""}], "]"}], 
    "  ", ":=", 
    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionIntersection", "[", 
       RowBox[{
        RowBox[{"Rectangle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"vanItersonSquareLatticeRegion", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "3"], ",", "0"}], "}"}], ",", 
        FractionBox["1", "3"]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", " ", "\"\<Plus\>\""}], "]"}], " ", 
   ":=", " ", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"1", "/", "3"}], ",", "0"}], "}"}], ",", 
       RowBox[{"1", "/", "3"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"RegionUnion", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vanItersonSquareLatticeRegion", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", 
       RowBox[{"vanItersonTouchingRegion", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", " ", "\"\<Minus\>\""}], "]"}], " ",
    ":=", " ", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vanItersonSquareLatticeRegion", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RegionUnion", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vanItersonTouchingRegion", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"vanItersonTouchingCircle", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "/.", 
         RowBox[{"Circle", "->", "Disk"}]}], ")"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Plus\>\""}], "]"}], " ", 
   ":=", " ", 
   RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vanItersonTouchingRegion", "[", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"RegionUnion", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vanItersonSquareLatticeRegion", "[", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1"}], "}"}], "]"}], ",", 
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vanItersonRegion", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Minus\>\""}], "]"}], 
    " ", ":=", " ", 
    RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RegionIntersection", "[", 
       RowBox[{
        RowBox[{"Disk", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
          FractionBox["1", "3"], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
        RowBox[{"vanItersonSquareLatticeRegion", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"vanItersonTouchingRegion", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "vanItersonRegionBounds", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegionBounds", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegionBounds", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"vanItersonRegionBounds", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegionBounds", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1.2"}], "}"}]}], "}"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegionBounds", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"1", "/", "3"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vanItersonRegionBounds", "[", "mn_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "vn", ",", "vm", ",", "m", ",", "n"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], "=", 
       RowBox[{"Sort", "[", "mn", "]"}]}], ";", "\[IndentingNewLine]", " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "vn"}], "}"}], "=", " ", 
       RowBox[{"euclideanWindingNumberPair", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      " ", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "vm"}], "}"}], "=", " ", 
       RowBox[{"euclideanWindingNumberPair", "[", 
        RowBox[{"Reverse", "@", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tcCentre", ",", "tcRadius"}], "}"}], "=", " ", 
       RowBox[{"Take", "[", 
        RowBox[{
         RowBox[{"List", "@@", 
          RowBox[{"vanItersonTouchingCircle", "[", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"n", "-", "m"}], ",", "n"}], "}"}], "]"}]}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sort", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"vn", "/", "n"}], ",", 
           RowBox[{"vm", "/", "m"}]}], "}"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "tcRadius"}], "}"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855644196951109*^9, 3.8556442435051813`*^9}, {
   3.8556442773974996`*^9, 3.8556442777872076`*^9}, {3.855644337763382*^9, 
   3.8556443667060375`*^9}, {3.855644402114871*^9, 3.8556444072009015`*^9}, {
   3.8556445884545565`*^9, 3.855644657273993*^9}, {3.8556448078007126`*^9, 
   3.8556448092222214`*^9}, 3.8556448646224737`*^9, 3.8556828016608543`*^9, {
   3.855682984911708*^9, 3.855682996436453*^9}, {3.8556830285186157`*^9, 
   3.855683032322151*^9}, {3.8556830636405907`*^9, 3.85568313128512*^9}, 
   3.8556831681171227`*^9, {3.855697211705018*^9, 3.85569721730469*^9}, {
   3.8556974048522797`*^9, 3.8556974276779356`*^9}, {3.855697945202611*^9, 
   3.855697953505292*^9}, 3.8556983490348167`*^9, {3.8556993317993603`*^9, 
   3.8556993337120667`*^9}, {3.8556994336998167`*^9, 
   3.8556994472000027`*^9}, {3.855699687760087*^9, 3.85569974329163*^9}, 
   3.8556998352155347`*^9, {3.8556999030123405`*^9, 3.855699933698393*^9}, {
   3.8557008672988267`*^9, 3.8557008779778147`*^9}, 3.8557014196378803`*^9, {
   3.8557018236339407`*^9, 3.8557018411415024`*^9}, {3.855719569282797*^9, 
   3.85571965319621*^9}, {3.8557196864223223`*^9, 3.8557198296929436`*^9}, {
   3.8557198698816414`*^9, 3.8557198734206934`*^9}, {3.8557200014627504`*^9, 
   3.855720002962592*^9}, 3.8557200516372585`*^9, {3.855720093703845*^9, 
   3.8557201134609423`*^9}, {3.855720357027399*^9, 3.8557204418236732`*^9}, {
   3.8557204811909904`*^9, 3.855720485658839*^9}, {3.8557205272249975`*^9, 
   3.855720570875128*^9}, {3.8557206198756604`*^9, 3.8557206414465694`*^9}, {
   3.855720729000761*^9, 3.855720737155037*^9}, 3.855720797307765*^9, {
   3.8557209562547975`*^9, 3.8557209607540293`*^9}, {3.8557210081421137`*^9, 
   3.8557210203224735`*^9}, {3.855721358391508*^9, 3.855721364634525*^9}, {
   3.8557214349470844`*^9, 3.8557214351501527`*^9}, {3.855721626880889*^9, 
   3.855721627068346*^9}, {3.8557217283763704`*^9, 3.855721744618619*^9}, {
   3.855727407234249*^9, 3.8557274265475597`*^9}, {3.8557274905266256`*^9, 
   3.8557274942193713`*^9}, 3.855727616549341*^9, 3.855727649757568*^9, {
   3.855727761719077*^9, 3.8557278043236046`*^9}, {3.8557278591135235`*^9, 
   3.855727864818841*^9}, {3.8557279223711033`*^9, 3.8557279690629663`*^9}, {
   3.8557280573748727`*^9, 3.8557281430713806`*^9}, {3.855728605477141*^9, 
   3.855728606675046*^9}, {3.8557286399901714`*^9, 3.8557286415193157`*^9}, {
   3.855729098756754*^9, 3.855729101066241*^9}, {3.8557333855107923`*^9, 
   3.855733387010193*^9}, {3.85573343937353*^9, 3.8557334492167025`*^9}, {
   3.8557334793056407`*^9, 3.855733504875779*^9}, {3.8557335633646317`*^9, 
   3.8557335866956253`*^9}, {3.855733626015273*^9, 3.8557336280020485`*^9}, {
   3.8557337366120234`*^9, 3.855733737268019*^9}, {3.8557339112078247`*^9, 
   3.8557339124106097`*^9}, {3.8557340149576855`*^9, 3.855734025060725*^9}, {
   3.855734153684123*^9, 3.8557342363632326`*^9}, {3.8557343110223694`*^9, 
   3.8557343111629143`*^9}, 3.855734617828326*^9, {3.8557354661053843`*^9, 
   3.8557354912454834`*^9}, {3.8557355244979687`*^9, 3.855735613775644*^9}, {
   3.8557356453039007`*^9, 3.855735658728931*^9}, {3.855735948014431*^9, 
   3.855735951822236*^9}, {3.855736040513607*^9, 3.855736046629585*^9}, {
   3.8558072304383*^9, 3.855807324470791*^9}, {3.855807386278488*^9, 
   3.855807561693119*^9}, {3.855807592710785*^9, 3.855807594488927*^9}, {
   3.855807709197579*^9, 3.8558077112171555`*^9}, {3.8558089092426076`*^9, 
   3.8558089559295845`*^9}, {3.8558091115479345`*^9, 3.855809114621484*^9}, {
   3.8558417817636027`*^9, 3.8558417951650906`*^9}, {3.855842097302449*^9, 
   3.8558421302303457`*^9}, 3.8558424673030987`*^9, {3.855842546412508*^9, 
   3.8558425545683985`*^9}, {3.855842599705015*^9, 3.855842632342739*^9}, {
   3.8558426659088755`*^9, 3.8558427152306848`*^9}, {3.8558427488908567`*^9, 
   3.8558428433774443`*^9}, {3.855844106069541*^9, 3.8558441164288654`*^9}, {
   3.855844176314434*^9, 3.855844202637578*^9}, {3.8558442794745445`*^9, 
   3.8558442903958187`*^9}, {3.8558445529192395`*^9, 3.855844580109114*^9}, {
   3.8558448111820736`*^9, 3.8558448604189014`*^9}, {3.8558449059383626`*^9, 
   3.8558449068407726`*^9}, {3.855846975743848*^9, 3.8558470765241423`*^9}, {
   3.85584713906667*^9, 3.855847176667394*^9}, {3.8558472231999917`*^9, 
   3.855847266706752*^9}, {3.855847298775073*^9, 3.855847328413523*^9}, {
   3.855847362776019*^9, 3.855847399071489*^9}, {3.855847511608082*^9, 
   3.855847516527952*^9}, {3.8558478465873184`*^9, 3.8558478470010986`*^9}, {
   3.855847968305561*^9, 3.8558479752248945`*^9}, {3.8558480581888523`*^9, 
   3.8558481236634483`*^9}, {3.8558482728130884`*^9, 3.855848329140999*^9}, {
   3.855848372358683*^9, 3.8558483837696476`*^9}, {3.8558487864969416`*^9, 
   3.8558488011945944`*^9}, {3.855848947446488*^9, 3.8558490237954535`*^9}, {
   3.855849283051496*^9, 3.8558493135068436`*^9}, {3.8558493533186665`*^9, 
   3.855849356064804*^9}, {3.8558494357843657`*^9, 3.855849443237897*^9}, {
   3.8558494897863417`*^9, 3.8558494904637456`*^9}, {3.8558496537668114`*^9, 
   3.8558496838140306`*^9}, {3.8558497189578934`*^9, 
   3.8558497372561073`*^9}, {3.855849821735343*^9, 3.855849824892229*^9}, {
   3.855852735175435*^9, 3.855852735692707*^9}, {3.8558527822768135`*^9, 
   3.855852799020624*^9}, {3.8558528306188474`*^9, 3.855852831852969*^9}, {
   3.855852921947996*^9, 3.8558530418559523`*^9}, {3.855853115818368*^9, 
   3.8558531405812197`*^9}, {3.8558531856782675`*^9, 3.855853217368184*^9}, {
   3.8558570811998296`*^9, 3.8558571186778774`*^9}},
 CellLabel->
  "In[2291]:=",ExpressionUUID->"89ce2232-e432-4b68-9b4f-222a1a9c3679"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonTouchingCircle", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.855849700153964*^9, 3.8558497145880947`*^9}, {
  3.8558498010278363`*^9, 3.8558498159006987`*^9}},
 CellLabel->
  "In[1918]:=",ExpressionUUID->"9654d9a7-d618-409a-96bb-486c49795424"],

Cell[BoxData[
 RowBox[{"Circle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
   FractionBox["1", "3"], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.8558497104418*^9, 3.855849715614936*^9}, {
  3.855849804532621*^9, 3.8558498167373857`*^9}},
 CellLabel->
  "Out[1918]=",ExpressionUUID->"4a63e5f3-8d76-4453-8484-96ad1e2b5d0e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"euclideanDelta", "[", 
  RowBox[{"{", 
   RowBox[{"3", ",", "5"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.855847757673951*^9, 3.855847764033309*^9}},
 CellLabel->
  "In[1513]:=",ExpressionUUID->"0d6681e3-716c-4d38-88b4-973e6920c52c"],

Cell[CellGroupData[{

Cell[BoxData["1"], "Input",
 CellChangeTimes->{3.855848341182786*^9},
 CellLabel->
  "In[1596]:=",ExpressionUUID->"6393d4c5-1ea6-41d0-9ae6-c09882dd85f3"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.855848343994273*^9},
 CellLabel->
  "Out[1596]=",ExpressionUUID->"53ccf904-b7db-4cfb-8660-c3287c6662e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", "44"], ",", 
    FractionBox["1", 
     RowBox[{"62", " ", 
      SqrtBox["3"]}]], ",", 
    FractionBox[
     SqrtBox["3"], "362"]}], "}"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.8558493755975842`*^9, 3.855849397546994*^9}},
 CellLabel->
  "In[1828]:=",ExpressionUUID->"fc395509-1451-46c4-8d74-49bf97a278ce"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.022727272727272728`", ",", "0.009312101115961707`", ",", 
   "0.004784670739140544`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8558493770597086`*^9, 3.855849398351451*^9}},
 CellLabel->
  "Out[1828]=",ExpressionUUID->"9328a266-3b02-4e21-97ed-6b3042426ac9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonRegionBounds", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "11"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.855847524854267*^9, 3.855847535308185*^9}, {
   3.855847841274678*^9, 3.8558478416773*^9}, 3.8558483909172955`*^9, {
   3.855849382206881*^9, 3.855849385116457*^9}},
 CellLabel->
  "In[1827]:=",ExpressionUUID->"7e2aea8e-f820-4fc7-862c-9bcb7274d4f3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "44"], ",", 
   FractionBox["1", 
    RowBox[{"62", " ", 
     SqrtBox["3"]}]], ",", 
   FractionBox[
    SqrtBox["3"], "362"]}], "}"}]], "Echo",
 CellChangeTimes->{
  3.855849385859676*^9},ExpressionUUID->"35d62ad1-6af9-4550-833f-\
dc9cdd0d2ca8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     FractionBox["3", "11"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "44"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8558475369129677`*^9, 3.8558478420280066`*^9, 3.855848392165775*^9, {
   3.855849319271566*^9, 3.855849324546508*^9}, {3.8558493641995354`*^9, 
   3.855849385889104*^9}},
 CellLabel->
  "Out[1827]=",ExpressionUUID->"0eb4dcb3-b6f5-458f-b833-5be7598d6ea1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8558444231749306`*^9, 
  3.855844429801654*^9}},ExpressionUUID->"9425ad09-48b2-4cde-b40c-\
6feadea3a0a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"euclideanDelta", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.855842736134622*^9, 3.8558427403183327`*^9}},
 CellLabel->
  "In[828]:=",ExpressionUUID->"306ba192-7e63-4a1f-80e3-22734d7c3d90"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.8558427416176643`*^9},
 CellLabel->
  "Out[828]=",ExpressionUUID->"5e9dcdd8-fc93-471b-9b93-dd114cf94539"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vanItersonRegionBounds", "[", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.8558418919127326`*^9, 3.8558419007520046`*^9}, {
  3.855842160669148*^9, 3.855842172654236*^9}, {3.855842896974633*^9, 
  3.855842905103964*^9}, {3.8558472020641828`*^9, 3.8558472164043474`*^9}},
 CellLabel->
  "In[1569]:=",ExpressionUUID->"6bd65a7c-b9f2-4a4d-a391-5968da1ed70b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "3"], ",", 
     FractionBox["2", "5"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "30"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.855841901548687*^9, {3.8558421536121273`*^9, 3.8558421731016135`*^9}, 
   3.85584284997293*^9, {3.8558428980683565`*^9, 3.8558429059133005`*^9}, 
   3.855844209536641*^9, 3.8558442941078568`*^9, 3.855847079794171*^9, {
   3.8558472045918384`*^9, 3.85584721725156*^9}, {3.8558472887488947`*^9, 
   3.8558473132810545`*^9}, 3.8558473544440155`*^9, 3.855847405031591*^9, 
   3.8558475196644907`*^9, 3.8558475722177258`*^9, 3.855847979440632*^9},
 CellLabel->
  "Out[1569]=",ExpressionUUID->"72aa9a53-0e3b-438d-ae06-cfc30ca4968b"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8558472078332376`*^9, 
  3.855847210300963*^9}},ExpressionUUID->"24b4078a-b76a-49ec-963f-\
ca03183bf2b2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonTriplePointLeft", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "7"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8558176923659143`*^9, 3.855817720567898*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"84f7d4d1-d93e-4a34-9c8c-231072c68b1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["17", "62"], ",", 
   FractionBox["1", 
    RowBox[{"62", " ", 
     SqrtBox["3"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.8558177075167065`*^9, 3.8558177219678974`*^9}},
 CellLabel->
  "Out[456]=",ExpressionUUID->"957becee-3234-4d20-85c8-a931a58017fd"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gmnTheorem", "[", "w_", "]"}], " ", ":=", " ", 
  FractionBox[
   RowBox[{
    RowBox[{"u", "  ", "w"}], "-", " ", "v"}], 
   RowBox[{" ", 
    RowBox[{
     RowBox[{"m", "   ", "w"}], "-", "  ", "n"}]}]]}]], "Input",
 CellChangeTimes->{{3.855834905327149*^9, 3.855834933858324*^9}},
 CellLabel->
  "In[681]:=",ExpressionUUID->"d81fa8ed-4ff1-483f-a813-f69608649486"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"gmnSymbolic", "[", "w_", "]"}], " ", ":=", " ", 
   FractionBox[
    RowBox[{
     RowBox[{"u", "  ", 
      SubscriptBox["\[CapitalDelta]", "nm"], " ", "w"}], "+", " ", "v"}], 
    RowBox[{" ", 
     RowBox[{
      RowBox[{"m", "  ", 
       SubscriptBox["\[CapitalDelta]", "nm"], " ", "w"}], "+", " ", 
      "n"}]}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"m", ",", "n", ",", "u", ",", "v"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaSquaredOne", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[CapitalDelta]", ",", "nm"}], "]"}], ",", "2"}], "]"}], "->",
       " ", "1"}], " ", ",", 
     RowBox[{
      RowBox[{"Power", "[", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[CapitalDelta]", ",", "nm"}], "]"}], ",", "3"}], "]"}], "->", 
      SubscriptBox["\[CapitalDelta]", "nm"]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"gmnTheoremValues", " ", "=", " ", 
  RowBox[{"<|", " ", 
   RowBox[{
    RowBox[{"\"\<Zero\>\"", "->", " ", 
     RowBox[{"gmnTheorem", "[", "0", "]"}]}], ",", 
    RowBox[{"\"\<Square\>\"", "->", " ", 
     RowBox[{"Together", "/@", 
      RowBox[{"(", 
       RowBox[{"ComplexExpand", "@", 
        RowBox[{"ReIm", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ComplexExpand", "[", 
               RowBox[{"gmnTheorem", "[", "I", "]"}], "]"}], " ", "/.", " ", 
              RowBox[{"First", "@", 
               RowBox[{"Solve", "[", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"n", " ", "u"}], " ", "-", " ", 
                   RowBox[{"m", " ", "v"}]}], "==", " ", 
                  SubscriptBox["\[CapitalDelta]", "nm"]}], ",", "v"}], 
                "]"}]}]}], " ", "//", "Expand"}], ")"}], " ", "//.", "  ", 
           "deltaSquaredOne"}], ")"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<Triple\>\"", "->", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tripleplt", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ComplexExpand", "@", 
             RowBox[{"ReIm", "@", 
              RowBox[{"ComplexExpand", "[", 
               RowBox[{"gmnTheorem", "[", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "+", " ", 
                 RowBox[{"I", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}]}], "]"}], 
               "]"}]}]}], " ", "//", "Simplify"}], ")"}], " ", "/.", " ", 
          RowBox[{"First", "@", 
           RowBox[{"Solve", "[", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"n", " ", "u"}], " ", "-", " ", 
               RowBox[{"m", " ", "v"}]}], "==", " ", 
              SubscriptBox["\[CapitalDelta]", "nm"]}], ",", "v"}], 
            "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Expand", ",", 
             RowBox[{"(", "tripleplt", "  ", ")"}]}], "]"}], "  ", "//.", 
           "  ", "deltaSquaredOne"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Apart", "  ", "/@", " ", 
         RowBox[{"(", 
          RowBox[{"res", "  ", "//.", " ", "deltaSquaredOne"}], ")"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "|>"}]}], "\[IndentingNewLine]", 
 RowBox[{"gmnSymbolicValues", " ", "=", " ", 
  RowBox[{"<|", " ", 
   RowBox[{
    RowBox[{"\"\<Zero\>\"", "->", " ", 
     RowBox[{"gmnSymbolic", "[", "0", "]"}]}], ",", 
    RowBox[{"\"\<Square\>\"", "->", " ", 
     RowBox[{"Together", "/@", 
      RowBox[{"(", 
       RowBox[{"ComplexExpand", "@", 
        RowBox[{"ReIm", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"ComplexExpand", "[", 
               RowBox[{"gmnSymbolic", "[", "I", "]"}], "]"}], " ", "/.", " ", 
              RowBox[{"First", "@", 
               RowBox[{"Solve", "[", "  ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"n", " ", "u"}], " ", "-", " ", 
                   RowBox[{"m", " ", "v"}]}], "==", " ", 
                  SubscriptBox["\[CapitalDelta]", "nm"]}], ",", "v"}], 
                "]"}]}]}], " ", "//", "Expand"}], ")"}], " ", "//.", "  ", 
           "deltaSquaredOne"}], ")"}], "]"}]}], ")"}]}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<Triple\>\"", "->", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tripleplt", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ComplexExpand", "@", 
             RowBox[{"ReIm", "@", 
              RowBox[{"ComplexExpand", "[", 
               RowBox[{"gmnSymbolic", "[", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], "+", " ", 
                 RowBox[{"I", " ", 
                  RowBox[{
                   RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}]}], "]"}], 
               "]"}]}]}], " ", "//", "Simplify"}], ")"}], " ", "/.", " ", 
          RowBox[{"First", "@", 
           RowBox[{"Solve", "[", "  ", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"n", " ", "u"}], " ", "-", " ", 
               RowBox[{"m", " ", "v"}]}], "==", " ", 
              SubscriptBox["\[CapitalDelta]", "nm"]}], ",", "v"}], 
            "]"}]}]}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"Expand", ",", 
             RowBox[{"(", "tripleplt", "  ", ")"}]}], "]"}], "  ", "//.", 
           "  ", "deltaSquaredOne"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Apart", "/@", " ", 
          RowBox[{"(", "res", " ", ")"}]}], "//.", " ", 
         "deltaSquaredOne"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "|>"}]}]}], "Input",
 CellChangeTimes->{{3.8558075516150293`*^9, 3.8558075831080666`*^9}, {
   3.855807615102189*^9, 3.855807617043359*^9}, {3.85581587940107*^9, 
   3.855815888339246*^9}, {3.855815920217666*^9, 3.8558160049915285`*^9}, {
   3.855816041010927*^9, 3.85581622202623*^9}, {3.8558162538174195`*^9, 
   3.8558163127173634`*^9}, {3.8558163489320126`*^9, 3.855816366187022*^9}, {
   3.8558164527451625`*^9, 3.8558164784451675`*^9}, {3.8558178157508364`*^9, 
   3.8558179476037827`*^9}, {3.8558179806007223`*^9, 
   3.8558179965472794`*^9}, {3.85582579967319*^9, 3.8558258749938097`*^9}, {
   3.8558259257743645`*^9, 3.8558259661811104`*^9}, {3.855826027098937*^9, 
   3.8558260274161053`*^9}, {3.8558261203672523`*^9, 
   3.8558261215503416`*^9}, {3.855826658485482*^9, 3.855826793248165*^9}, {
   3.8558269903287888`*^9, 3.8558272061226864`*^9}, {3.855827283106532*^9, 
   3.8558273107923803`*^9}, {3.855827890444236*^9, 3.8558280024975634`*^9}, {
   3.85582855115207*^9, 3.855828740337594*^9}, {3.855828775374426*^9, 
   3.855828793086855*^9}, {3.855828833528839*^9, 3.85582884249936*^9}, {
   3.8558288907836313`*^9, 3.8558289276379623`*^9}, 3.8558289646062894`*^9, {
   3.85582972884261*^9, 3.855829761196162*^9}, {3.8558349552770996`*^9, 
   3.855834974864735*^9}, {3.855835218273596*^9, 3.8558352227007694`*^9}, {
   3.8558361101438475`*^9, 3.8558361137286744`*^9}, {3.8558362155953617`*^9, 
   3.8558362365011363`*^9}, {3.855836475508526*^9, 3.8558364900058427`*^9}},
 CellLabel->
  "In[726]:=",ExpressionUUID->"5b5b0379-9c5f-4ebb-bfac-593bbf379370"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Zero\"\>", "\[Rule]", 
    FractionBox["v", "n"]}], ",", 
   RowBox[{"\<\"Square\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["m", "2"], " ", "u"}], "+", 
        RowBox[{
         SuperscriptBox["n", "2"], " ", "u"}], "-", 
        RowBox[{"n", " ", 
         SubscriptBox["\[CapitalDelta]", "nm"]}]}], 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["n", "2"]}], ")"}]}]], ",", 
      RowBox[{"-", 
       FractionBox[
        SubscriptBox["\[CapitalDelta]", "nm"], 
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         SuperscriptBox["n", "2"]}]]}]}], "}"}]}], ",", 
   RowBox[{"\<\"Triple\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox["u", "m"], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", 
           RowBox[{"2", " ", "n"}]}], ")"}], " ", 
         SubscriptBox["\[CapitalDelta]", "nm"]}], 
        RowBox[{"2", " ", "m", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", "n"}], "+", 
           SuperscriptBox["n", "2"]}], ")"}]}]]}], ",", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SqrtBox["3"], " ", 
         SubscriptBox["\[CapitalDelta]", "nm"]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "-", 
           RowBox[{"m", " ", "n"}], "+", 
           SuperscriptBox["n", "2"]}], ")"}]}]]}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8558365818163853`*^9},
 CellLabel->
  "Out[729]=",ExpressionUUID->"6db87ef4-9b6e-4c7d-998f-921becb7ab6b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Zero\"\>", "\[Rule]", 
    FractionBox["v", "n"]}], ",", 
   RowBox[{"\<\"Square\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["m", "2"], " ", "u"}], "+", 
        RowBox[{
         SuperscriptBox["n", "2"], " ", "u"}], "-", 
        RowBox[{"n", " ", 
         SubscriptBox["\[CapitalDelta]", "nm"]}]}], 
       RowBox[{"m", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["n", "2"]}], ")"}]}]], ",", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["m", "2"], "+", 
        SuperscriptBox["n", "2"]}]]}], "}"}]}], ",", 
   RowBox[{"\<\"Triple\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"m", " ", "u"}]}], 
        SuperscriptBox["m", "2"]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["m", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["n", "2"]}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox["m", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["m", "2"], "+", 
           SuperscriptBox["n", "2"], "+", 
           RowBox[{"m", " ", "n", " ", 
            SubscriptBox["\[CapitalDelta]", "nm"]}]}], ")"}]}]]}], ",", 
      FractionBox[
       SqrtBox["3"], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["m", "2"], "+", 
          SuperscriptBox["n", "2"], "+", 
          RowBox[{"m", " ", "n", " ", 
           SubscriptBox["\[CapitalDelta]", "nm"]}]}], ")"}]}]]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.8558365818575773`*^9},
 CellLabel->
  "Out[730]=",ExpressionUUID->"d27f3d84-a1a8-4dbc-9517-f18161744d0b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SqrtBox["3"], " ", 
     SubscriptBox["\[CapitalDelta]", "nm"]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["m", "2"], "-", 
       RowBox[{"m", " ", "n"}], "+", 
       SuperscriptBox["n", "2"]}], ")"}]}]]}], "//", " ", 
  "TeXForm"}]], "Input",
 CellChangeTimes->{{3.8558366019298773`*^9, 3.85583660705097*^9}},
 CellLabel->
  "In[731]:=",ExpressionUUID->"607380fe-9eb2-4ca4-97e6-c3be2acbe5ea"],

Cell["\<\
-\\frac{\\sqrt{3} \\Delta _{\\text{nm}}}{2 \\left(m^2-m n+n^2\\right)}\
\>", "Output",
 CellChangeTimes->{3.8558366076875443`*^9},
 CellLabel->
  "Out[731]//TeXForm=",ExpressionUUID->"cb32c071-1a18-4bc7-bba9-ddf4ca0c92ee"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    FractionBox["u", "m"], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "-", 
        RowBox[{"2", " ", "n"}]}], ")"}], " ", 
      SubscriptBox["\[CapitalDelta]", "nm"]}], 
     RowBox[{"2", " ", "m", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["m", "2"], "-", 
        RowBox[{"m", " ", "n"}], "+", 
        SuperscriptBox["n", "2"]}], ")"}]}]]}], ")"}], "//", 
  "TeXForm"}]], "Input",
 CellChangeTimes->{{3.8558365407887297`*^9, 3.8558365520741763`*^9}},
 CellLabel->
  "In[725]:=",ExpressionUUID->"a5711208-e59e-4333-b682-63f09ed687cb"],

Cell["\<\
\\frac{(m-2 n) \\Delta _{\\text{nm}}}{2 m \\left(m^2-m \
n+n^2\\right)}+\\frac{u}{m}\
\>", "Output",
 CellChangeTimes->{
  3.855835482066743*^9, 3.8558361145835466`*^9, {3.8558362293662443`*^9, 
   3.85583623740639*^9}, {3.855836479827151*^9, 3.8558364904906445`*^9}, {
   3.8558365465674343`*^9, 3.8558365525929995`*^9}},
 CellLabel->
  "Out[725]//TeXForm=",ExpressionUUID->"1c3e5639-4a3a-4dab-ba54-ddaef919a868"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TeXForm", "/@", 
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["m", "2"], " ", "u"}], "+", 
      RowBox[{
       SuperscriptBox["n", "2"], " ", "u"}], "-", 
      RowBox[{"n", " ", 
       SubscriptBox["\[CapitalDelta]", "nm"]}]}], 
     RowBox[{"m", " "}]], ",", 
    RowBox[{"-", 
     SubscriptBox["\[CapitalDelta]", "nm"]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.8558352855760555`*^9, 3.855835313566862*^9}},
 CellLabel->"",ExpressionUUID->"333cca2e-a53d-4c99-854f-b6fef05f7f4f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox["\<\"\\\\frac{m^2 u+n^2 u-n \\\\Delta _{\\\\text{nm}}}{m \
\\\\left(m^2+n^2\\\\right)}\"\>",
    TeXForm[$CellContext`m^(-1) ($CellContext`m^2 + $CellContext`n^2)^(-1) \
($CellContext`m^2 $CellContext`u + $CellContext`n^2 $CellContext`u - \
$CellContext`n Subscript[$CellContext`\[CapitalDelta], $CellContext`nm])],
    AutoDelete->True,
    Editable->True], ",", 
   InterpretationBox["\<\"-\\\\frac{\\\\Delta _{\\\\text{nm}}}{m^2+n^2}\"\>",
    TeXForm[-($CellContext`m^2 + $CellContext`n^2)^(-1) 
     Subscript[$CellContext`\[CapitalDelta], $CellContext`nm]],
    AutoDelete->True,
    Editable->True]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8558289327966523`*^9, 3.855828965718271*^9, {3.855829730124403*^9, 
   3.8558297617964106`*^9}, 3.8558349759543686`*^9, 3.8558352233505363`*^9, 
   3.855835296939644*^9},
 CellLabel->
  "Out[692]=",ExpressionUUID->"d702e229-69c3-4392-97fa-372b8dbd8a13"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["deltaSquaredOne"], "Input",
 CellLabel->
  "In[644]:=",ExpressionUUID->"774a50d7-cdda-4439-840b-a98742bdab33"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SubsuperscriptBox["\[CapitalDelta]", "nm", "2"], "\[Rule]", "1"}], ",", 
   RowBox[{
    SubsuperscriptBox["\[CapitalDelta]", "nm", "3"], "\[Rule]", 
    SubscriptBox["\[CapitalDelta]", "nm"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8558287256848135`*^9, 3.855828768903366*^9}},
 CellLabel->
  "Out[644]=",ExpressionUUID->"0a3a63a8-2390-4f61-a7d9-3309c1541752"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Evaluate", "/@", " ", 
  RowBox[{"(", 
   RowBox[{"gmnSymbolicValues", " ", "/.", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m", "->", "1"}], ",", 
      RowBox[{"n", "->", "1"}]}], "}"}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.8558165316331043`*^9, 3.8558165701633906`*^9}, 
   3.855816610095239*^9, {3.8558276702418036`*^9, 3.8558277308313627`*^9}},
 CellLabel->
  "In[578]:=",ExpressionUUID->"97e14d70-fbf4-4dc1-98a9-56e86347b2c4"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"Zero\"\>", "\[Rule]", 
    RowBox[{"v", " ", 
     SubscriptBox["\[CapitalDelta]", "nm"]}]}], ",", 
   RowBox[{"\<\"Square\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["\[CapitalDelta]", "nm"]}]}], ",", 
      FractionBox["1", "2"]}], "}"}]}], ",", 
   RowBox[{"\<\"Triple\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], "+", 
       RowBox[{"u", " ", 
        SubscriptBox["\[CapitalDelta]", "nm"]}]}], ",", 
      FractionBox[
       SqrtBox["3"], "2"]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.855816525380396*^9, 3.8558165643372135`*^9}, 
   3.8558166128905*^9, {3.8558276821746964`*^9, 3.855827731835126*^9}},
 CellLabel->
  "Out[578]=",ExpressionUUID->"af8970f7-d50b-4b41-b030-f2492eb17b07"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", " "}]], "Input",
 CellChangeTimes->{{3.855816263274438*^9, 
  3.8558162719585805`*^9}},ExpressionUUID->"f8b86df2-71ba-4568-8d83-\
ed4909797a40"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   SubsuperscriptBox["\[CapitalDelta]", "nm", "2"], "//", 
   "InputForm"}]}]], "Input",
 CellChangeTimes->{{3.8558164441439266`*^9, 3.855816446075955*^9}},
 CellLabel->
  "In[443]:=",ExpressionUUID->"eea7b967-2239-457b-a8c4-3b689b5226dc"],

Cell["Subscript[\[CapitalDelta], nm]^2", "Output",
 CellChangeTimes->{{3.85581626418602*^9, 3.8558162676131496`*^9}, 
   3.855816374112928*^9, 3.855816446740228*^9},
 CellLabel->
  "Out[443]//InputForm=",ExpressionUUID->"fb160555-c9e8-4316-97a9-\
18799cb70338"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.855807336086633*^9, 
  3.8558073503641653`*^9}},ExpressionUUID->"959f5f21-570f-448d-8192-\
2d457bc3812d"],

Cell[BoxData[{
 RowBox[{"w1", " ", "=", 
  RowBox[{"vanItersonPolygon", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Plus\>\""}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"w2", "=", " ", 
  RowBox[{"vanItersonPolygon", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Minus\>\""}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.855735832016914*^9, 3.85573585346303*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"175fac63-ec16-4877-8e60-61d791026109"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graphics", "[", 
  RowBox[{"{", 
   RowBox[{"w1", ",", "w2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8557358588753686`*^9, 3.855735917045906*^9}},
 CellLabel->
  "In[428]:=",ExpressionUUID->"f2717e97-c107-4912-aa05-47db1cd5ab75"],

Cell[BoxData[
 GraphicsBox[{PolygonBox[CompressedData["
1:eJxd1H8w1GkcB/BN03SaC9VRV0b0446zs8npamK93VGZwrSu4mpT6PfRsqzY
wSCKrFryu9HVppQf1XXoKmVjNyxZdlJh7ddpDHVX1o8cIffV3Xxv5nlmvvPM
a57P8/58nn++VgEC74MGLBbrAP3N7C8iHG4MHKAwYeKtKzHXwIg1s7qht5du
KorSgPWf5XbFsqzyVsYyjmL65EAL45NsHV/4zf9u2KEPe6xqZizZvopz0eUp
Yy8P335xZSPjBe4SmQ9bxfiZq5zvIKtnnIMRswVL6hjvdrRufZumZGy+np+q
mq1gTH2av4aYV07M94iY5wHR/3eiXwWRf4fIu0ncv07Uy4j6i0R9LtEvi7if
QbxHSuSdJd6TSuQnE/mnifxTjN9Y7ecs5SUyfm9itzjNOoHxv3sc4VjC0YTF
hCMJRxAOJywkHEo4hDCLdU28Ylf2RwriaMk066MAQ69uLQym3bnF5ov1mlDk
5o6G+NK+0bTbT/NACK4nV+06U8+TXA++GoYcB1Xll9MUBP7LRu6IRFDw3cV6
+jwgJf24q+cJzCrf84OCdpDtvMICyyhoAnweZtKuinQ4f2VYjKkBbps/bdnt
ctXXddGojakstaW96Jm6R58Xi+CC3nUVUxSaXpi+/8kyHjbuAefW0vZa/TjO
ZjgBDyMOH780SWHNkU1KwZNE8AeODHnTVpVSbupbSfAzHrcwoL0waKLHIe8U
DF2KnE9M0Hl+bQW5psngpZYOH/5AoSx/HV8nTYEoKFx2eZyCh6GzP++MBLwx
JDqNUXBV7p9wTDiH+UGhfb+NUphy4hy14KZjtuho7YZhCteSz0zKHDIx9i5T
YTdAITzk0C4X2xws19s/v/CGQqpmbZaJVT4ydr6SR/VS6JnXPYtjVoClZTXf
StspLPWdtyY19jL2qgsVokYKtbqx1+cFhWgbdjvIfkBB8b1hZMPeIjiZ9nHM
MincibvCXWZXhkr9fJdA+v/Ub26auzLqV7zjH1vBYVPIKJU2p20vh1mxZHP2
nzr8xc4X3zW/i2b7QrZcpsPQDucMY+091MfnNLbxdEg0ertzbloVmvtfxswd
70LKAe09I041vqpI+uxsbhf2LRzY90QnR2BJjf6mXRcM/FJN+s1rUG+14YLy
sRY+ZUZVkdtrsUe5kbfLQwvhqrrFnpEKBG1c9Mu61k50i6Y2NGUoMR3vs7Wd
14mtbIOnKQVP4CG4UDTV0oHBkWGbU5l1+JAYaTbyYwdcfROKq0Pq8Xe1cQO3
tx3VgVeD+KsboMibWe2Y82lvgGbV8e7TY+0Qxly8HXhOBfUci1DuoQ7g1fJL
ovxG3LLuPTJL1wG1yn5QWNIEvyuO97ft7cQ2sVN2wf2nkF9eLKzo6URljff9
j7XN4GvdRoODtQj7LsEgRqnGiEdx89CkFoezHnm/92vBoLhP/VrahaSXUvct
z1tw7A/rzfNtdPj85yWWIvdWPB9Nz7ZS6nByt+CmV0Ur/gEJ8I3I
    "]], PolygonBox[CompressedData["
1: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
    "]]}]], "Output",
 CellChangeTimes->{{3.8557358896961813`*^9, 3.855735917451914*^9}},
 CellLabel->
  "Out[428]=",ExpressionUUID->"6121f6a4-b67f-453a-a07d-0e3945a2bce0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RegionBounds", "[", 
  RowBox[{"vanItersonPolygon", "[", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8557357937546115`*^9, 3.8557358046293397`*^9}},
 CellLabel->
  "In[420]:=",ExpressionUUID->"b6e0dd25-b530-4960-9073-16d3f6b5e80c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.4999988490004746`", ",", "0.4999999698765385`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.364313746362688`*^-6", ",", "0.00005242877050624737`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8557358057384186`*^9},
 CellLabel->
  "Out[420]=",ExpressionUUID->"7fb57bc4-7666-4281-ba2f-1cd965d0c7b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"vanItersonPolygon", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Minus\>\""}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.8557357157266617`*^9, 3.8557357182261257`*^9}},
 CellLabel->
  "In[414]:=",ExpressionUUID->"3bae8004-1f68-4b77-add5-079bf0eb71ed"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["Polygon",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready", 
    Typeset`spolygon$$ = Polygon[CompressedData["
1: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
     "]]}, 
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Hue[0.6, 0.3, 0.85], 
              PolygonBox[CompressedData["
1:eJxNmHlcTVsbgCMqZEh0DRFF6KaQlGK9aBAlQ2VInwiRzGM0Eo6ZkEihi4ii
4YRuJRqURAlp3klIKknFScP3vqvk9s/5Pb+zz17PWXutZ+/TcIdNC1Z3lpKS
EnWSkqLXVy6dI+a0CnAwrynNWLwO0s9Lthggr1eVTI0cvB6cwku+9kE+7hpQ
vOvLRgioWnrofYsAJUu/iNWLNsOwE1XKkcjN8csy5Uy2QvcRK166IReeTVJc
FroNPlT57zNCvhqimNu/3w541E3FQgb5couhgafrTti+bc4Pz2YBzrYajzoy
ezf0d6jroYd8Ldz3/diIPTAn2/Tl5yYBQsXWOR4D3cD9SG9rVfx8S+6d4dGf
PEAmKEUhFY+3aroZrVrkBTJmrQarkOM6H8zqYrIPrLs2X5Xg5wuyrvSzDfWG
mNyDMiJkQ/XHeQr9DoDNs+sX5JFX5OoburoehOH5WbrevwSYOEon+lG9CFJP
nhzwrVGAh9pmKVWbDsNdrxm2kRIBwmdn2KSvOgbJS8rL5v0UoFOU16OsxSeh
fsF6y4wGAXz27z+0U90HsnfYJY6oFyAoR0/V/sppMFw61932uwDP+2g+/Dbw
LKz3ShDsvgowxGh0co68HwTqCN9fVaD/kqYBz1ouwGe5KwsSPggQPD9nSe+a
AFgW7/ajLk+APfoVE0LWBMFiT8n61mcCvH5yL73c+hoEVD/3L4kVoMJvvuly
uAFjl34zHecrgEjP6uj/uofBzuHX9CWrBdiwvVT9X4cICN//xNlGSwCTvGnh
CZPEMC3A5vrK6mLo9+VNYXjrPfj+j865mcHF0Dl8gZR0XAyUqQ/W1VhYDDmm
HvJa6+Jg9p6/Txq0FIHrQov1IXIJMGBJ3zN3LxXBPWmfwNr0R3Da9Gj5M70i
eGDlYT5ULhHiW890+/i0EC7FFe2qMkgCzRb70bttCqF6Yp8txg7JsGedmbZZ
QQEMW5scdN0tBcpKXdKu2xVA9RML3RzRE2iJ0LsoW5gPq6aIasZ7pYKNxCZ4
3LJ8+Fe0YPlK+zSYOrfywYHKPBjX8MZXGPgUki/QXx505a9PYd7k4ogGjTxY
uM65JGJNGgRGlHwNe5wLkguV06y0UkHt7vS/tJflgrgxTuVTdQoMNzFPfyOV
C7J63edV30oGZZlzE7RvvYUl4t4mCquT4Lh/humIpW8hqtvnceaqiVC3sKFw
Zv+34CXr2tWo8hGYbyy4t6EgB5amDtZqvJ0AuZKXOxZueAsJWnL//KhIACn+
l9v++ghkfX6+fhObCwdiluS5FCWAt/073Qc780BJkusevSMB2O2Nl2O18iFE
6t22qU8fgopHkYVaaT4MCgo/65wXD35hnmvmnywAReleg0xuxoG3gq7do4mF
0NDjYeZq/ViQPvqsSuplIYz6edin7lgMeE5WCfnXoQjELkm7/UPuw6+UxD1h
5UXQMyF47Z7T0TB6d1Bc1IpieOjbq3mURRQ4bxetSM4oBl+9seLAgnCYWTak
V/1oAcwTrs5ZdSwU8p8Hd3HbIcAI6fvlA9RugE4XzdcREQK4l4+s0BYFgVfS
6WjvpwLkmPvGj7AOBIXcysd9iwQIDLMyLjrsBxo6HvFTcL07x6wwG3DlLBy6
eN7EulIAv+t168SRPmB7LrqLC+6Xa7d+iWQMT4Hly08l1rUCjPVxLWo6eBzi
RvjMaMT99XO6pVyMzxHImN9VRwX3Y49Ni/RalA/DsY8Gn+CHAGkDHV8+uCqC
F7cnh/+D+9cxU+ZmWvgBcA+zLPmE+9tY5tkWuThvCM5TqnPH/b9T5mAXlrQP
DtbcyO6JfZDvUqdUmboXXm5ymTcS34/UOOFxKMgTGoddad6L7OskY/ss1B1U
s1NvFSO73vTQ7fXAFcy9vy4yxM/bf2roMz9pN2yf+FfX88hG6psqz7zYBQEf
WGQd8pjVn1Jz8nZAyjlH+/nYJ/lr9lcHftgGtpsaoz2R3ZMGK8RWbIXqmSfk
7yDXlL71sKvZguskOqY79u+20RUx+7EJ9l8Y1MsAeTssfJr+YwN8n+zp4ISs
ZyhfvPCnMzjkv793HrlxUmJt6U8nyNpj1iMNOWmCi+wmyRqAwWH2P5APamkp
/5KshjuxCmJ17O8sjbJxosaV8KGH8TKGrDUaDJ83OoCy3U65hch91f1NFH+t
gKNN+XYHkEO4jz0kWvSUDUTeyn3+B40BECFGHsd9lsL4qi1LM5Al3GcJrJ16
rWsZciL3WQSXj+fc/YV8jPvYQE6RnK0i3p9suI8V1HZV1VZBnsh9FkAvLcMu
f7f+9pkPJh4b7sxAvs995sLy4IPelshHuM8ccHtxebEtsin3MYfzDQ/GOiJ3
1iOfWSAemt15K3I895kJWaZf3roju3AfE6jc2CXsMI3PfYygsbOP30kan/vM
ADm/Ift8kWtGks90UEuYtCgIWcR9AMZZJU2/QefjPlOBfZqrGYZswH0MwcK1
UCkKuYnPz2Sw7e3UKabDRw/WXq3/8hDZg/vowk69fTnJyNO4jw647017loo8
nPtMgP3Pej1Op+/H52c8+NhfvJ2F/JH7aMP5kHdXXiEHcJ+xcPn7qHM5yAu4
z98QPHXj0TxkOT4/YyBMJPYq7PAZBeKXjTsE5K3cZyTEDp7uXIo8mvuowcNp
ZR/eI0/gPqqQuFq0/ANyMZ+f4fD07nObcjqe+6hAxuvNWZ/penOfIZAlUTT/
gpxkQD6D4dXQ+ymVNL98fgZCjpHttGpkZR3y+Qvy1zb/+xX5KPfpD0XHr+h+
o/XAfRRh2bDaWmLNMeTTF0oijcJrkd/z+VGAsrcfNeqQrxqTT29wXKdfTvye
+/SE8qbD1+uR1fj89IB1JwscGpBXcp9u8GX42GE/OnxkYb3Yo4j4jTb5dIVq
0yz/n8j9/yYfadDus1tCHM3npzNszhu+WELfn/t0glrnbf0bkTX4/LQyHV3l
7cQXGPk0s+0tydnEcnx+frHo1A3jfyHv1CUfCWs4pXSK+MM48vnB9GwTqomt
NcmnnrmorZ3ThJw4iny+swGH4tyI69TJp5Y9qOwTSjyS+3xjPD8d1+sr86f8
0HwZkk8VM6D8IMtwny+M5wfZSZ98PjOeH+SMSeTziQ2i/CBr65LPB8bzg3xr
LPm8Z/KUnw6fUsbz0+HzjvH8ICvMIh+B8fwgPzAlnyLG84Nsb0w+BayS8oPc
dQb55DGeH+R8fr3eshOUH+S7I8nnDSum/CAvVCOfV0yG8kPXQ5V8shnPD3Lz
MPJ5yXh+kM2mkk8m4/lBXjOFfJ4znh96Hufr5xnj+UEONiCfp4znBzllMvmk
Mp4f5DJ98klhPD/IXfTJJ4nx/CCf1SOfRHaO8kPrU498HjOeH+Qp3CeBWVN+
aP31JJ94Vk75QZ4kTz6xzI3yQ9+3B/nEsD6UH+Rd3cnnPrtG+UE+3418olm1
4bvHxKO7HVaf3ihm+pQj5Bg58otiGZQfml9Z8olgSjb3nhOvk62fu+RXOFtO
OUKu70l+d9ktyhFyY1/yC2N1lCPklr/I7zZjlCNk6SHkF8IOUY5o/auS3w2W
TTlClh9FfteZMuWI1ocm+VxljpQfZKXx5BPEjmoUfOTfR4d8rrBwyhGy7nry
ucwaKT/Iccto/ItMhfKD3LqIxr/AjCk/yDPm0/h+zInyg3xgNo3vy05QfpDT
jGj8MyyKcoPcYyqN78NMfTd8Jx5aUIfjn2K5lB/kQD7+Scbzg1yrugjn4zhr
pvwgd7cnn6PsFOUHWfXiY/Q5zFQpP7T/uY+I8fwgp8tqo88BNpPyg1zKfbwZ
zw/N12VaP/tYPuWH5t/zAvrtZespPx0+noznhu6feT1xfFeWRrnpGH8386Hc
dIy/i42gvND6flqK421jVZSTjvNvYfcoJx3n38R4Plrp9wqd35mVUT46zu/E
eD6Qq0xc6fmF9aVcIN/g51/JeB7ofrQ9gJ5PWAHloeP89mwa5QB5UY0sPY8w
vv07zreIbaTti/zY/yw9P7C25/aS9ud3KSm8mPz9tte5rKqdO/N3F7Pydu7C
2Y6VtHPbp5ezsFUlnK0D13zamOnA9jx9xPmmQeaLokurmZlWEOdjchPvWWxc
y/qf2cu55PrFwNipzqz0xwrOE42kD2j03MjC7Wb85/jNbLa69H+O38bKvia1
/Dl+J/OI2c/5UMm69RcKXdgAbxPOhe7ZVnKhriwKf70Tu0TpG+5y9WCWSql8
vo9sn6uw7boXKxdEzX/Ot4/tCzHjXKxw/+e77d5MeVu35j/n38/myxzl11sq
/SWeX8QqM805vyjbn5qgeJgdxF/nf8Y7wmI1T/D1UxNwWfXj7OOsJqH3rz/j
nWIjrHwa/4znw5Z87MvZ/yCNd5olyitJ/ozni1vYj6/vOHYAx/NjmjoDf/4Z
7zw7t0SZ749vfLyLrNVThe+nRSUy3W0GXWJrg1Xr/4x3hWVnjOT78SIfL4gZ
fh/N96/l6KEl84yvsmsDNWv/jH+N7XKcUEO8qYTGu8FKjunyPgzfV3lH6/1N
NjtKn/ejuIHGv8WUpYD3xchAFscPY18tTCqII+dt/Jb0+S5bvM3sM7GO5FRk
/M1wlnjBnPfKJwp97CKY78f5vGdpDH2SI9lancVlHT6aYmbotYz3UN8G5+NM
NOv1nBZku9+ve0zsuKWwwyc9homiduXz+8U+q3OBE2KZrZRHLjHeZ7vb+Mcx
Kf8jr4lj1dDPKYEF6/jxnvcPRB/lx8zi+dUMfjzNz/5EVusYnka8Pwp9KpPY
eal4fr+IpetjlcKm+tOGEGD8G/SJfcIOPS990OFz5CnTWvNVzPtNPrXp7LVU
UzjxHPKxzWDDJvYP4debfMZksvVrtPj9T4l8mrLYA/+ZFzqu16psJv1iuQ/x
iBj0yXjFLDvt4fdXySz00XnD/CfSBmz3uZjDxl9M2ULMvqHPujzm9qLYibgf
+WTns7ROP1d0zI9BIbNfq7GA2HYM+nQTWMMLO/58IP4HfSpL2HHdkxP49x+H
PtalbETAY1XixIfoE/eexXWu69vho/aBWTnRBsfrmYs+Rz+yfZOOvm/57WP7
mQ0MjH9FbOKJPokVLFy6Jqnlt49GJSvOsr7W8ttHUs3kL1EQ2n3KapiB89DV
Lb99LGqZkz4FAo+PRx/xd3a+a/nIlt8+g+vZk2wKRruPdwNT20DBwN7Xos8C
CVtg4Hqj+bfPv43MS7ZE1PzbR7WJFQZRQNp9vrWwyVMoIHg+8imRgnM5U9Lp
+dNKG33MOkPtZgpKu0+4NMztkWVOHDYbff7qCqH0777fPp4y4JhPQWn3sewG
idsbLInDvNDnXndQ6f2oN7FUL/QZKg+5RhSYdp+qXnDahQLT7lPcB8zDdp+l
5/Mw8jHtC11KKTjtPncU4aHSFb+fv33694dd5hQcfJ983JWgQkzBQf6OPhYD
4ernykD6/SC7F33Eg8BuqJcKsZh8lJUhU0QBQiafL0NhxjcKEH6efIqGQbQt
BQifr8jHRBVGJ1OA2n3C1ODi2Gna9Hsnn3z6jYRefhSkdh83dahzogC1+5iP
gTWv8gyr6HianygNyJ9CQRJgKfkM1oRHvedgkASwI58KLbheSgESwBh9BhaN
gyPRFKA2nyzjCbD5EAWozedQqA4sXEoBavOBfrowRYsC1Obzw3USyL2mALX5
OJpPhupgClCbz5AoA3i1mwIkwGb0eTNoClxSoQDh8zT6GFUwWJdCAcJ+ok9e
4TTQdaYA4f0GfU4ZzwAphTUYoDYfs1AjyLhHAWrzaVU0AT87CpAAq9Hnvqsp
aN2kAOF46KNuPgskcyhA+PscfYoiZ0PydwoQ3u/Qx3eQBSwFCpAAZ9BHusIS
ao9QgASYiz4xhfPgcA4FSIDX6LPZeAEMU6UAtfmMDrWC+xsoQHj/Rh9B0QYs
YyhAbT5+rgvBbR4FqM1HxnwJKAZQgARoQJ/4SFu49YkCJIAb+uwYZAe5HhQg
AUTo8/7zMpBRyrSj/4/MQp+QwuUwMYwCJEAm+iw3dgAHYwoQ/v5EnwGhK+FU
AQVIgAL0yVRcDfFbKUACOKCPyNURUhXqJfY0f8Oh1crCCf4Pbk1Kpw==
               "]]}, ImageSize -> 
             Dynamic[{5.25, 3.5} (CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification])]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Number of points: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["391", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Embedding dimension: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Hue[0.6, 0.3, 0.85], 
              PolygonBox[CompressedData["
1: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
               "]]}, ImageSize -> 
             Dynamic[{5.25, 3.5} (CurrentValue["FontCapHeight"]/
                AbsoluteCurrentValue[Magnification])]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Number of points: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["391", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Embedding dimension: \"", "SummaryItemAnnotation"],
                  "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Type: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  DynamicBox[
                   ToBoxes[
                    Quiet[
                    Apply[Region`PolygonDump`polygonType, 
                    Region`PolygonDump`computeType[Typeset`spolygon$$]]], 
                    StandardForm], SynchronousUpdating -> False, 
                   TrackedSymbols :> {}, CachedValue :> 
                   AnimatorBox[
                    0, {0, Infinity}, AppearanceElements -> "ProgressSlider", 
                    ImageSize -> 20]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Bounds: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  DynamicBox[
                   ToBoxes[
                    Region`PolygonDump`iRegionBounds[Typeset`spolygon$$], 
                    StandardForm], SynchronousUpdating -> False, 
                   TrackedSymbols :> {}, CachedValue :> 
                   AnimatorBox[
                    0, {0, Infinity}, AppearanceElements -> "ProgressSlider", 
                    ImageSize -> 20]], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Area: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  DynamicBox[
                   ToBoxes[
                    Region`PolygonDump`iArea[Typeset`spolygon$$], 
                    StandardForm], SynchronousUpdating -> False, 
                   TrackedSymbols :> {}, CachedValue :> 
                   AnimatorBox[
                    0, {0, Infinity}, AppearanceElements -> "ProgressSlider", 
                    ImageSize -> 20]], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  Polygon[CompressedData["
1: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
   "]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.855735721273469*^9},
 CellLabel->
  "Out[414]=",ExpressionUUID->"2212887d-175d-4fd9-9e37-50b047fb609f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DiscretizeRegion", "@", 
  RowBox[{"vanItersonRegion", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], ",", " ", "\"\<Minus\>\""}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.855735404094116*^9, 3.8557354055000906`*^9}, 
   3.855735502597705*^9},
 CellLabel->
  "In[413]:=",ExpressionUUID->"e52ad1df-a317-4ddf-b147-6f050dbe0327"],

Cell[BoxData[
 GraphicsBox[
  TagBox[
   DynamicModuleBox[{Typeset`mesh = {
    MeshRegion, {Method -> {"PropagateMarkers" -> False}}}}, 
    TagBox[GraphicsComplexBox[CompressedData["
1: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

      "], 
      {Hue[0.6, 0.3, 0.95], EdgeForm[Hue[0.6, 0.3, 0.75]], 
       TagBox[PolygonBox[CompressedData["
1:eJxNmHe8z2UUx59HGUUllJWQKCqlqDRJe2lrUSFpaCDlJtlxbyJZlXB1dSuy
r4u099577629qT7v1/n8Xu4fn9c5z/5+z3OezznP07L3ZSddWi2l9ENOaRPJ
94WDhEOFg4X3hLPU9pRkZ6GrsJnQQagljM8hO1hH7iHUrNJ+i+ThwnEu0z5X
8lzhCun3Cm8JnYRLhDeEwWqbJzlfspFkY2EXoZ2wQnVThZnCHGFf1b0pXMgY
19F2mzBbuFlYlmPcfcKB6jtV6C39EMnpwinSp/Ctwk1CDdXdIbnYdtlUuIc5
JY8SThDOUHmQ5GIBGzYXsvst8LjbhWOFk4WTVHel5FLhVukzhAnCkZSxkfRi
YTvpzVKMZx7mLmU8a7I3qhsqWSEsdDv9tseWOcbOEboLpwnHqO4qyeXC8cJs
YV//J2sVW58uNKW/MIv9V/lE9krYXfphkjPZR+mtJHcQrpe+j2SJ8KzQUhin
urHuQ/tWKfS6wo6WlKk/VXhQOLtK29b4mMbVxj7SB0leJHmn8Ifwp/C7cIXq
95Q8QPheeEz4Qqih+iclvxZaCNeqPBwbCHVUHiI5WrhA+kjJLf0vfPM5kh8L
29EuXIZthWlCF+EIoYHqH5b8TOgvlAl7C6Ny2OE6yZ0lJ0reIKwSVgtlOfy5
RKh0/Z3CturbET+V3FnyQ9sFmzDPTp6rXFjjOeupro3QmrFCkeouz2G71rZl
PevUnU45x3+x5l3CNvap3XL4VQOvc6NQP4W8W2jOuVF5e8mzJBtK1nU/vo0+
+3NeUti4k3Ct9NVCU+kPSH4izBC6CUd7jt4p5jlQuEZ6pdBH2ELlLHwnfYPw
jP3hfMlakn9L9hW+SbGPW9jv2IPXvSfs+YUp9h0fuSSHn2Cni1PY6lIg/R3h
YukD+BehXw4uOh9/yMF7vSR7YmPpC1NwZI8cPHma5EDJRcKJOfzkBMnuwmDp
S/jnHP9+FOddGCJ9WQpePCQHN3aVvFpyBT6dg2f2l9xPKJK+UtgrB5/sKdlB
GCZ9Ff+e47zvKrkL/i59jXC/0ErlEZJrhXbSr5N8CL+SPkqymWQbYaT0R4X6
0sdINsE3c5SfUPkrYZywpcrnusxeXZ9iv/6VfFr4T9iccy887n0qTrFvnJG9
Upy9G4TnUvDwRMnnU/DwjZIvpOCZSZIvpuDGyZIvpeClmyRfTsFjUyRfScFR
nCPO0CkpeJ79hetPVd2ZOdaA84k78P7xqjs5x3rwG3wOxx2BnXOsDT/D23B0
F9UdluM74El4Fa7srLqDcnwTHAs/w7N7qG6fHN8Hl+Lnc4W2qmsvvCr9NerZ
Z8lh+EAOTkFS5lzNF95OEePgQmIefDgU38vBhX0516p7Vxhgf8bv75H8IEUc
h8+I63Da5fbrhbYHdiEWn25/xr8H2S7EuMH26yW2B3Yhlg2xXy+zPbALsaab
/Rn/Hmq7ELOK7NcrbQ/swtkfZr/Gn+EP9hAOGW6/xp/hoh4pfBj0sF/j3zvm
8PdGkjuw39Jb5Igv8Okolx9KweE9JUcL20h/JAVHjnGZczBWqGNfx5eJRb1S
nAF4kDOxqerPk6wu2Ufon8OnfxV+FH4R/hFIDPqliJXESbipv8eQW+Gb+Chx
Bn/EL+FLfBBfJIfC7/A/chB8DZ8jv8C/8DNiPj6Fb5Wm8KeO9i9yqStz5FZI
yq/bj/An8qeL8I8cfoakTF7GGeIswZP4F7z4rv0IfyJHPBs75PAzJGVyyZaS
rYWPUkjKxDdiQuMccQFJ+WNha+mfpogND7tMnCUGrE8RE4jzxAJifTW1f5mC
g9gnuIl9e9Jt5ADEir9S8BDc9G0KrlrveT/3Pn/vOem7LgWX1fYejhd+8Fj2
lfzjZ+Eny82t/+Ixhf3/1eN+9pjfUuQvtT1nbZf/cPuf7rPO38G3F/sb4U98
6Dz71OduW2//2mD7fOs1C3y8zv+9wf3+sb2wW7b9sBU2w483yeHXNa3XMLBl
Tft7vyp9a7o/54OcrZf3h32qZbvW8b4QD4jxxAdiOu2M6eM24glx5QnvJXNy
9uiPT+Abde0j+AY+QowiVnGWOcOc5Xo+3w3sP7T1dF/aOeOcdc4x57mh+WJk
Cv7AF8+xb9Y3HzQxrzS139JOPsVajGN8M/MTPEW+RN70UQodHoJ/4KGmnquR
zwb9OBvE51bmMfIyOG1EijNDPsgZIm4TrwtxeydzGvkj8YT496rLbT0f88KT
5GbkB3Ap+QJ5A3cE1mE98kG4g3wQLiG2ElfnpohhlOEacjbyD7iafIS8hDsO
/D3MZfgbHu/oNVkbPofLh3ttOIv14TBiOvGcuEkcpQzHkQeRD3Hn4u5DPkTs
IIYUua2Dv4k4AifyLXAkOQP5AjGamE0ZDiUmkXsRo7gfkXuRd13tOnTWYT1i
FpzL+nAwOQn5CPkA+QFlOJoYSCwk1+OuR55HTOzmOvLerl6P+Aink/fB8eQ8
5DvkHuQilIkBxFviLnkl901ySuJvF9dxHznS6xGLiRmsQwwhpyKfIs8h76FM
jCGuk78S57mDk7+Suw50HXp3r0fcJyaxDjGKXII8As6H6ynD9eQR5BPky9yb
yJXJKzq7rmuKdViPHIPYQO5MrCAPJAckTyN2UiYuEmeIN+Tj5OrkN8SdTq7j
raCn1yOfIY6yDnGVfIlcibhGPKNMPCMf4j5AfsS9kryfnH+A69D7ej3iHfGP
dYiH3BvKU9wdyLnIvcpdR9tAz8e85GbkdLxjEHOJtdxPiL3clbgncQ/lPtoi
hU4Oxx2Fecn56EcOSAwnlhd5PuYlppMjctchR2QO5irce8gxuPtwHyXn4E7K
XXdE3nj3JQ+nDkleTh/uUqPdj3v8mBz3Yu7IY11umaIf7dybaeOez5vO7py/
HO8/vPXwhsI7xxLOYo43Gd5jpuV4q+DNgjcM3iF4g+D9gXeIlUIT6bPw6xzv
N9yTubtyb22b4m7MXZh7KPdW7qLcYWnnfnu369q4vnCvXZTjPae6sDbH+8e9
/tbx/o/SHP/B//BGMyVvfCcpdnmaJe0VOd6k5vh/b3P7bhq/a4p/4G1puueg
babrZrg8wXXTbKOVnrPCtijYhn58d+ENqapd53mOmR57i1H43qn+Bup4p8IW
kzzPrd6n2z3fZOulLjP3LP8j+8F/8SbHXmM73sxKbbP2Bv8/23ZYWmWOEs9T
YVnicdie98HlXptvaO85Ct+BLLzrzfaczD/P5eXew8J4/ol3vHb2G95QeI/h
LabStsXWvDHyHfe5Hn9rmOKdBn/C9/A33nF4Syy8xVBfbn2i+zawD1LG/3iL
wR/rW9azH7IH+OIC65O8D2utN/f54JxUs04d/oq+wH0XuH8ztxV7b/HxxW5b
5LlruK667Yx+h9sWVbHXEpfZ66Xe73nWZ7me/V/h/SvULfYeTPY+LPf8K7wH
a6yX2dYl3osKy8Zpo+8jC3xQaF/lseXeR96H51unraF5YpX70L7a9WXuV+n9
4lsKPlHueSv9XWX+tmUuF9vWE6rYHVv/D5t7tK8=
         "]],
        Annotation[#, "Geometry"]& ]}],
     MouseAppearanceTag["LinkHand"]],
    AllowKernelInitialization->False],
   "MeshGraphics",
   AutoDelete->True,
   Editable->False,
   Selectable->False],
  DefaultBaseStyle->{
   "MeshGraphics", FrontEnd`GraphicsHighlightColor -> 
    Hue[0.1, 1, 0.7]}]], "Output",
 CellChangeTimes->{
  3.855734857261285*^9, 3.855735405999917*^9, {3.855735503503497*^9, 
   3.8557355321802044`*^9}, 3.855735617306553*^9, 3.8557356621239953`*^9, 
   3.855735705374324*^9},
 CellLabel->
  "Out[413]=",ExpressionUUID->"0c62c5b7-983e-4202-a50c-e8cde21444f1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonTouchingCircle", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "1"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.8557333781495595`*^9, 3.8557333797896824`*^9}, {
  3.85573353070466*^9, 3.855733541007781*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"2fda0fdf-188a-4efa-b5c7-caac68248956"],

Cell[BoxData[
 RowBox[{"Circle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
   FractionBox["1", "3"], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.855733358439652*^9, 3.8557333803052197`*^9}, {
   3.8557335288769464`*^9, 3.8557335414920883`*^9}, 3.855733929717824*^9},
 CellLabel->
  "Out[210]=",ExpressionUUID->"d482eef0-d0a3-4dba-9c84-ba032eb8702b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonRegion", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", " ", "\"\<Plus\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.855729219737553*^9, 3.855729250449196*^9}, 
   3.855733336747863*^9},
 CellLabel->"In[74]:=",ExpressionUUID->"21dd3422-9100-451f-be41-adba364fd210"],

Cell[BoxData[
 RowBox[{"BooleanRegion", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"#1", "&&", 
     RowBox[{"!", "#2"}]}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
       FractionBox["1", "3"], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "4"], ",", "0"}], "}"}], ",", 
       FractionBox["1", "4"], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.8557292349084787`*^9, 3.8557292510115614`*^9}, 
   3.8557333395752735`*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"ce8bbc61-bb96-40f7-8977-d46bad2c1b93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonTouchingCircle", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{3.855729206575639*^9},
 CellLabel->
  "In[641]:=",ExpressionUUID->"0348bca6-b70b-42ae-9e25-8673c8f30084"],

Cell[BoxData[
 RowBox[{"Circle", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
   FractionBox["1", "3"], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.8557292068878193`*^9},
 CellLabel->
  "Out[641]=",ExpressionUUID->"8949e2bf-3577-4e86-8e37-3136199d7ecb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vanItersonSquareLatticeRegion", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.855727522216586*^9, 3.8557275354539237`*^9}, {
  3.8557275806838264`*^9, 3.8557276067133703`*^9}},
 CellLabel->
  "In[409]:=",ExpressionUUID->"c46bf089-7155-4627-8952-f999e52d4337"],

Cell[BoxData[
 RowBox[{"Disk", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "2"], ",", "0"}], "}"}], ",", 
   FractionBox["1", "2"], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.855727522841267*^9, 3.855727536031949*^9}, {
  3.8557275842767663`*^9, 3.855727607197509*^9}},
 CellLabel->
  "Out[409]=",ExpressionUUID->"0df1a004-8723-4ee5-8ae3-172e2a660b58"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"regionToPolygon", "[", "r_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "rb", ",", "g", ",", "cblines", ",", "x", ",", "y", ",", "xy", ",", 
        "c"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rb", "=", 
        RowBox[{"RegionBoundary", "[", "r", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cblines", " ", "=", " ", 
        RowBox[{
         RowBox[{"MeshCells", "[", 
          RowBox[{"rb", ",", "1"}], "]"}], " ", "/.", " ", 
         RowBox[{
          RowBox[{"Line", "[", 
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "]"}], " ", "\[Rule]", " ", 
          RowBox[{"UndirectedEdge", "[", 
           RowBox[{"x", ",", "y"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"g", " ", "=", " ", 
        RowBox[{"Graph", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MeshCells", "[", 
            RowBox[{"rb", ",", "0"}], "]"}], "/.", " ", 
           RowBox[{
            RowBox[{"Point", "[", "xy_", "]"}], "\[Rule]", "xy"}]}], ",", 
          "cblines", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"VertexCoordinates", "\[Rule]", 
            RowBox[{"MeshPrimitives", "[", 
             RowBox[{"rb", ",", "0"}], "]"}]}], "/.", " ", 
           RowBox[{
            RowBox[{"Point", "[", "xy_", "]"}], "\[Rule]", "xy"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"c", " ", "=", " ", 
        RowBox[{"First", "@", 
         RowBox[{"ConnectedGraphComponents", "[", "g", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Polygon", "[", 
        RowBox[{"AnnotationValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"c", ",", 
            RowBox[{"FindHamiltonianPath", "[", "c", "]"}]}], "}"}], ",", 
          "VertexCoordinates"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[163]:=",ExpressionUUID->"1347374d-2251-4f35-9934-ed961a99d828"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.855311404272331*^9, 3.855311420071045*^9}},
 CellLabel->
  "In[1070]:=",ExpressionUUID->"d72fa5a0-f57a-464d-b94a-ba5a1ed78558"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8552684126331196`*^9, 3.8552684365878887`*^9}, {
  3.855268579006343*^9, 3.85526858577037*^9}, {3.85528262738344*^9, 
  3.8552826581994414`*^9}, {3.8552845540377445`*^9, 3.8552845887810407`*^9}, {
  3.8552847123182063`*^9, 3.8552847578330746`*^9}, {3.8552868326574273`*^9, 
  3.85528683984324*^9}, {3.8552868720333643`*^9, 3.8552868814657717`*^9}},
 CellLabel->
  "In[1071]:=",ExpressionUUID->"6871eb47-e026-49b4-a961-141fe934878b"],

Cell[BoxData[""], "Input",
 CellLabel->
  "In[1072]:=",ExpressionUUID->"40e1441d-6268-4dbc-8c14-20077b26c5c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generating intervals", "Subsection",
 CellTags->"c:2",ExpressionUUID->"106a7670-7c2e-44a9-bc75-00ccc971332c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"mnuvi", "[", 
    RowBox[{"m_", ",", "n_", ",", "u_", ",", "v_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dmaster", ",", "minterval", ",", "ninterval"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"interval", " ", "on", " ", 
        RowBox[{"which", " ", "[", "md", "]"}]}], "=", 
       RowBox[{
        RowBox[{"u", " ", 
         RowBox[{"and", " ", "[", "nd", "]"}]}], "=", "v"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmaster", " ", "=", " ", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"minterval", " ", "=", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"u", "+", 
          RowBox[{"Interval", "[", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ")"}], "/", "m"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ninterval", " ", "=", "  ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v", "+", 
          RowBox[{"Interval", "[", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "2"}], ",", 
             RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ")"}], "/", "n"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"IntervalIntersection", "[", 
       RowBox[{"dmaster", ",", "minterval", ",", "ninterval"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generatingInterval", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "u", ",", "v", ",", "up", ",", "vp", ",", "resplus", ",", "resminus", 
       ",", "res", ",", "dmaster"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"dmaster", " ", "=", " ", 
       RowBox[{"Interval", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], " ", "}"}], "=", " ", 
       RowBox[{"euclideanWindingNumberPair", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"resplus", "=", 
       RowBox[{"mnuvi", "[", 
        RowBox[{"m", ",", "n", ",", "u", ",", "v"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"vp", " ", "=", " ", 
       RowBox[{"n", "-", "v"}]}], ";", " ", 
      RowBox[{"up", " ", "=", " ", 
       RowBox[{"m", "-", " ", "u"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"resminus", " ", "=", 
       RowBox[{"mnuvi", "[", 
        RowBox[{"m", ",", "n", ",", "up", ",", "vp"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"IntervalUnion", "[", 
        RowBox[{"resminus", ",", "resplus"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "res"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"generatingOpposedInterval", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "u", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], "=", 
       RowBox[{"euclideanWindingNumberPair", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "  ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"m", "\[Equal]", "1"}], ",", " ", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"2", "n"}], ")"}]}], ",", 
            RowBox[{"1", "/", "n"}]}], "}"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Interval", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"u", "/", "m"}], ",", 
            RowBox[{"v", "/", "n"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Min", "[", "res", "]"}], "\[GreaterEqual]", " ", 
         RowBox[{"1", "/", "2"}]}], ",", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"1", "-", "res"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8550929112297106`*^9, {3.8550946914835014`*^9, 3.855094721744014*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"09918ae3-f4b8-4a6b-965a-8f3bc3205f0f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Principal Vectors", "Section",
 CellTags->"c:3",ExpressionUUID->"71246585-5db0-4ca4-924e-1cdbf414d8c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"euclideanReduction", "[", "pq_", "]"}], "  ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "uv", ",", "it", ",", "firstShorter", ",", "dotPositive", ",", 
       "reduceSecond", ",", "isPrincipal", ",", "positiveRise", ",", 
       "positiveVec"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"firstShorter", "[", 
        RowBox[{"{", 
         RowBox[{"u_", ",", "v_"}], "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u2", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"u", " ", ".", " ", "u"}], "]"}]}], ",", 
           RowBox[{"v2", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"v", " ", ".", " ", "v"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"If", " ", "[", " ", 
          RowBox[{
           RowBox[{"u2", " ", "<", " ", "v2"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", "u"}], "}"}]}], "]"}]}], "]"}]}], ";", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"dotPositive", "[", 
        RowBox[{"{", 
         RowBox[{"u_", ",", "v_"}], "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"If", " ", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"u", " ", ".", " ", "v"}], " ", ">", " ", "0"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", 
           RowBox[{"-", "v"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"reduceSecond", "[", 
        RowBox[{"{", 
         RowBox[{"u_", ",", "v_"}], "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"u", " ", ".", " ", 
            RowBox[{"(", 
             RowBox[{"v", "-", "u"}], ")"}]}], "]"}], "  ", ">", "  ", 
          RowBox[{"Abs", "[", 
           RowBox[{"u", " ", ".", " ", "v"}], " ", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", 
           RowBox[{"u", "-", "v"}]}], "}"}]}], "]"}]}], ";", "\t", "\n", "\t", 
      RowBox[{
       RowBox[{"isPrincipal", "[", 
        RowBox[{"{", 
         RowBox[{"u_", ",", "v_"}], "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u2", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"u", " ", ".", " ", "u"}], "]"}]}], ",", 
           RowBox[{"v2", "=", 
            RowBox[{"Simplify", "[", 
             RowBox[{"v", " ", ".", " ", "v"}], "]"}]}]}], "}"}], ",", "\n", 
         "\t", 
         RowBox[{
          RowBox[{"u2", "  ", "<=", "  ", "v2"}], " ", "&&", " ", 
          RowBox[{"0", "  ", "<=", " ", 
           RowBox[{"u", " ", ".", " ", "v"}]}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"u", " ", ".", " ", "v"}], " ", "<=", " ", 
           RowBox[{"u2", " ", "/", "2"}]}]}]}], "\n", "\t", "]"}]}], " ", ";",
       "\n", 
      RowBox[{
       RowBox[{"positiveRise", "[", "uvp_", "]"}], " ", ":=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"positiveVec", ",", "uvp"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"positiveVec", "[", 
        RowBox[{"{", 
         RowBox[{"ud_", ",", "uh_"}], "}"}], "]"}], " ", ":=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"uh", ">", "0"}], ",", 
         RowBox[{"{", 
          RowBox[{"ud", ",", "uh"}], "}"}], ",", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"uh", "<", "0"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "ud"}], ",", 
             RowBox[{"-", "uh"}]}], "}"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"h", "=", "0"}], " ", "*)"}], " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Abs", "[", "ud", "]"}], ",", "0"}], "}"}]}], "]"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"uv", " ", "=", " ", "pq"}], ";", "\n", 
      RowBox[{"it", "=", "1"}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"isPrincipal", "[", "uv", "]"}]}], ",", " ", "\n", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"it", "++"}], ";", "  ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"it", ">", "20"}], ",", 
            RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\n", 
          RowBox[{"uv", " ", "=", " ", 
           RowBox[{"firstShorter", "[", "uv", "]"}]}], ";", "\n", 
          RowBox[{"uv", " ", "=", " ", 
           RowBox[{"dotPositive", "[", "uv", "]"}]}], ";", "\n", 
          RowBox[{"uv", " ", "=", " ", 
           RowBox[{"reduceSecond", "[", "uv", "]"}]}], ";", "\n", 
          RowBox[{"uv", " ", "=", " ", 
           RowBox[{"Simplify", " ", "/@", "uv"}]}], " ", ";"}], "\n", "}"}]}],
        "]"}], ";", "\n", "\n", 
      RowBox[{"uv", " ", "=", " ", 
       RowBox[{"firstShorter", "[", "uv", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "not", " ", "needed", " ", "but", " ", "just", " ", "to", " ", "be", 
        " ", "clear"}], " ", "*)"}], " ", "\n", 
      RowBox[{"uv", " ", "=", " ", 
       RowBox[{"positiveRise", "[", "uv", "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"only", " ", "do", " ", "this", " ", "at", " ", "the", " ", 
        RowBox[{"end", " ", "!"}]}], " ", "*)"}], "\n", "uv"}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8550966749663973`*^9, 3.855096693606402*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"3968a2a7-342e-4cc7-b6dc-0d81163f88bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"euclideanShortestPair", "[", 
     RowBox[{"{", 
      RowBox[{"pm_", ",", "pn_"}], "}"}], "]"}], " ", ":=", " ", "\n", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "in", " ", "the", " ", "lattice", " ", "generated", " ", "by", " ", 
       "pm", " ", "and", " ", "pn"}], ",", " ", 
      RowBox[{"what", " ", "is", " ", "the", " ", "shortest", " ", 
       RowBox[{"pair", " ", "?"}]}]}], " ", "*)"}], "\n", 
    RowBox[{"euclideanReduction", "[", 
     RowBox[{"{", 
      RowBox[{"pm", ",", "pn"}], "}"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"tgetPrincipalVectorsDH", "[", 
     RowBox[{"{", 
      RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "uv", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"uv", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", "h"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "d"}], ",", 
            RowBox[{"-", "h"}]}], "}"}]}], "}"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}], " ", "and", " ", 
         RowBox[{"(", 
          RowBox[{"d", ",", "h"}], ")"}], " ", "are", " ", "a", " ", 
         "generating", " ", "pair"}], " ", "*)"}], "\n", 
       RowBox[{"euclideanShortestPair", "[", "uv", "]"}]}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"vectorNorm2", "[", "x_", "]"}], " ", ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"x", " ", ".", " ", "x"}], "]"}]}], ";"}], " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tgetThreeParastichyVectorsDH", "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pv", ",", "psum", ",", "pdiff", ",", "pthird", ",", "pvectors"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pv", "=", 
       RowBox[{"tgetPrincipalVectorsDH", "[", 
        RowBox[{"{", 
         RowBox[{"d", ",", "h"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"psum", " ", "=", " ", 
       RowBox[{
        RowBox[{"pv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"pv", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pdiff", " ", "=", " ", 
       RowBox[{
        RowBox[{"pv", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"pv", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pdiff", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "<", "0"}], ",", " ", 
        RowBox[{"pdiff", " ", "=", " ", 
         RowBox[{"-", "pdiff"}]}]}], "]"}], ";", 
      RowBox[{"pthird", " ", "=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"vectorNorm2", "[", "psum", "]"}], "<=", " ", 
          RowBox[{"vectorNorm2", "[", "pdiff", "]"}]}], ",", "psum", ",", 
         "pdiff"}], "]"}]}], ";", 
      RowBox[{"pvectors", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"pv", ",", "pthird"}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "sometimes", " ", "the", " ", "fourth", " ", "can", " ", "be", " ", 
        "the", " ", "same", " ", "length", " ", "as", " ", "the", " ", 
        "third", " ", "but", " ", "we", " ", 
        RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "mark", " ", 
        "this"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"numberate", "[", 
       RowBox[{"pvectors", ",", " ", "h"}], "]"}]}]}], "\n", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rawpnumber", "[", 
    RowBox[{"v_", ",", "h_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "d"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"v", "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], ",", 
        RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"m", " ", "=", 
       RowBox[{"Abs", "[", 
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"v", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
           "/", "h"}], " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", " ", "=", " ", 
       RowBox[{"v", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"if", " ", "d"}], "=", 
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
          "then", " ", "there", " ", "is", " ", "another", " ", "parastichy", 
           " ", "vector", " ", "with", " ", "d"}], "=", 
          RowBox[{"1", "/", "2"}]}], ";", " ", 
         RowBox[{"if", " ", "d", " ", "not", " ", 
          RowBox[{"in", " ", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "]"}], " ", "also", " ", "a", " ", 
          "complementary", " ", "vector"}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"d", "\[Equal]", " ", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Round", "[", "d", "]"}], " ", "\[NotEqual]", " ", "0"}]}], 
        ",", " ", 
        RowBox[{"m", " ", "=", " ", 
         RowBox[{"hat", "[", "m", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "m"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numberate", "[", 
    RowBox[{"pvectors_", ",", " ", "h_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pnumbers", ",", "onepos", ",", "hatpos"}], "}"}], ",", 
     RowBox[{
      RowBox[{"pnumbers", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"rawpnumber", "[", 
           RowBox[{"#", ",", "h"}], "]"}], "&"}], ",", "pvectors"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"onepos", " ", "=", " ", 
       RowBox[{"Position", "[", 
        RowBox[{"pnumbers", ",", "1", ",", "1"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "onepos", "]"}], ">=", " ", "2"}], ",", " ", 
        RowBox[{
         RowBox[{"hatpos", " ", "=", " ", 
          RowBox[{"onepos", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", " ", 
         RowBox[{
          RowBox[{"pnumbers", "[", 
           RowBox[{"[", "hatpos", "]"}], "]"}], " ", "=", " ", 
          RowBox[{"hat", "[", "1", "]"}]}]}]}], "]"}], ";", 
      RowBox[{"Association", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "->", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], " ", "&"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{"pnumbers", ",", "pvectors"}], "}"}], "]"}]}], "]"}], 
       "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[168]:=",ExpressionUUID->"5f9d3a98-a46c-4729-b5b2-bbd9e7f9b1ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattice geometry", "Section",
 CellTags->"c:4",ExpressionUUID->"77926345-0f95-41d8-996a-3a72d3c1f138"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeCreateDH", "[", 
     RowBox[{"{", 
      RowBox[{"d_", ",", "0"}], "}"}], "]"}], " ", ":=", " ", "Nothing"}], 
   ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"silently", " ", "drop", " ", "from", " ", "lists"}], " ", "*)"}], 
  " ", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeCreateDH", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d_", ",", "h_"}], "}"}], ",", 
      RowBox[{"cylinderLU_", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}], ",", 
      RowBox[{"firstnEqual_", ":", "1"}]}], "]"}], "  ", ":=", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "lattice", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"lattice", " ", "=", " ", 
        RowBox[{"Association", " ", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\"\<d\>\"", "->", " ", "d"}], "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<h\>\"", "->", " ", "h"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"always", " ", "has", " ", "periodicity", " ", 
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}]}], ";", " ", 
            RowBox[{
            "this", " ", "is", " ", "how", " ", "much", " ", "of", " ", "it", 
             " ", "we", " ", 
             RowBox[{"display", ":"}]}]}], " ", "*)"}], " ", 
          "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<cylinder\>\"", " ", "->", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", 
               RowBox[{"1", "/", "2"}]}], "}"}], ",", "cylinderLU"}], "}"}]}],
           " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "the", " ", "region", " ", "of", " ", "the", " ", "unscaled"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
             "Euclidean", " ", "cylinder", " ", "we", " ", "display", "  ", 
              "nodes", " ", "from"}], ";", " ", 
             RowBox[{"normally", " ", "the", " ", "same"}]}], ",", " ", 
            RowBox[{
            "but", " ", "not", " ", "if", " ", "we", " ", "are", " ", 
             "applying", " ", "a", " ", "scaling", " ", "to", " ", "it"}]}], 
           " ", "*)"}], "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<nodeCylinder\>\"", " ", "->", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", 
               RowBox[{"1", "/", "2"}]}], "}"}], ",", "cylinderLU"}], "}"}]}],
           " ", "\[IndentingNewLine]", ",", 
          RowBox[{"\"\<parastichyVectors\>\"", " ", "->", "  ", 
           RowBox[{"tgetThreeParastichyVectorsDH", "[", 
            RowBox[{"{", 
             RowBox[{"d", ",", "h"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"\"\<scalings\>\"", "\[Rule]", " ", 
           RowBox[{"<|", "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lattice", " ", "=", 
        RowBox[{"Prepend", "[", 
         RowBox[{"lattice", ",", 
          RowBox[{"{", " ", 
           RowBox[{"\"\<parastichyNumbers\>\"", "->", " ", 
            RowBox[{"tgetParastichyNumbersGroupedByLength", "[", 
             RowBox[{"lattice", ",", "firstnEqual"}], "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"lattice", " ", "=", " ", 
        RowBox[{"Append", "[", 
         RowBox[{"lattice", ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<namedLatticePoints\>\"", "->", " ", 
            RowBox[{"lNamedLatticePoints", "[", "lattice", "]"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "lattice"}]}], "\n", "]"}]}], 
   ";"}], "\n"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[174]:=",ExpressionUUID->"271f6e36-7b08-4aa4-9a63-151b065c5857"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"tgetParastichyNumbersGroupedByLength", "[", 
      RowBox[{"lattice_", ",", "firstnEqual_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pv", ",", "pvlengths", ",", "pva", ",", "i"}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pv", " ", "=", " ", 
         RowBox[{"latticeParastichyVectors", "[", "lattice", "]"}]}], ";", 
        RowBox[{"pvlengths", " ", "=", 
         RowBox[{"Map", "[", 
          RowBox[{"vectorNorm2", ",", "pv"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pvlengths", " ", "=", " ", 
         RowBox[{"SortBy", "[", 
          RowBox[{"pvlengths", ",", "N"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", "  ", 
         RowBox[{
          RowBox[{
          "only", " ", "if", " ", "we", " ", "make", " ", "eg", " ", 
           "hexagonal", " ", "lattices"}], ",", " ", 
          RowBox[{
          "the", " ", "lengths", " ", "may", " ", "be", " ", "algebraically", 
           " ", "but", " ", "not", " ", "numerically", " ", "equal", " ", 
           "so", " ", "we", " ", "force", " ", "them"}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "2"}], ",", 
          RowBox[{"i", "\[LessEqual]", "firstnEqual"}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pvlengths", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
           RowBox[{"pvlengths", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"pva", " ", "=", " ", 
         RowBox[{"GroupBy", "[", 
          RowBox[{"pvlengths", ",", "Identity", ",", 
           RowBox[{
            RowBox[{"Sort", "[", 
             RowBox[{"Keys", "[", "#", "]"}], "]"}], "&"}]}], "]"}]}], ";", 
        RowBox[{"Association", "[", 
         RowBox[{"Map", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"pva", "[", "#", "]"}], "->", " ", "#"}], " ", "&"}], 
           ",", " ", 
           RowBox[{"Keys", "[", "pva", "]"}]}], "]"}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "latticeParastichyNumbersGroupedByLength", "[", "lattice_", "]"}], " ", ":=",
      " ", 
     RowBox[{"Keys", "[", 
      RowBox[{"lattice", "[", "\"\<parastichyNumbers\>\"", "]"}], "]"}]}], 
    ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeParastichyNumbers", "[", "lattice_", "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pnumbers", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pnumbers", " ", "=", 
         RowBox[{
         "latticeParastichyNumbersGroupedByLength", "[", "lattice", "]"}]}], 
        ";", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Sort", ",", "pnumbers"}], "]"}], "]"}]}]}], "\n", "]"}]}], 
    ";"}], "\n", "\n"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8252427002152443`*^9, 3.8252427569662285`*^9}, 
   3.825243171441821*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"747d76d5-80d4-4ff4-9fb6-18e4fa01af7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"at", " ", "some", " ", "point"}], ",", " ", 
    RowBox[{"rename", " ", 
     RowBox[{"lattice", "[", "\"\<cylinder\>\"", "]"}], " ", "to", " ", 
     RowBox[{"lattice", "[", "\"\<displayCylinder\>\"", "]"}], " ", "and", 
     " ", "rationalise"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"latticeGetCylinder", "[", "lattice_", "]"}], " ", ":=", " ", 
     RowBox[{"lattice", "[", "\"\<cylinder\>\"", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeGetCylinderLU", "[", "lattice_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"lattice", "[", "\"\<cylinder\>\"", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeGetNodeCylinder", "[", "lattice_", "]"}], " ", ":=", " ", 
     RowBox[{"lattice", "[", "\"\<nodeCylinder\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeGetNodeCylinderLU", "[", "lattice_", "]"}], " ", ":=", 
     " ", 
     RowBox[{
      RowBox[{"lattice", "[", "\"\<nodeCylinder\>\"", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeSetDisplayCylinder", "[", 
      RowBox[{"lattice_", ",", "cylinder_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", "lattice"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<cylinder\>\"", "]"}], " ", "=", " ", 
         "cylinder"}], ";", "\[IndentingNewLine]", "res"}]}], "\n", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeSetDisplayCylinderLU", "[", 
      RowBox[{"lattice_", ",", "cylinderLU_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "cyl"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", "lattice"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cyl", "=", " ", 
         RowBox[{"lattice", "[", "\"\<cylinder\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cyl", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "cylinderLU"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<cylinder\>\"", "]"}], " ", "=", " ", 
         "cyl"}], ";", "\[IndentingNewLine]", "res"}]}], "\n", "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "resets", " ", "both", " ", "clyinder", " ", "and", " ", 
      "nodeCylinder"}], ",", " ", 
     RowBox[{"might", " ", "break", " ", "otherwise"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeSetCylinderLU", "[", 
      RowBox[{"lattice_", ",", "cylinderLU_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", "lattice"}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"latticeSetDisplayCylinderLU", "[", 
          RowBox[{"res", ",", "cylinderLU"}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"latticeSetNodeCylinderLU", "[", 
          RowBox[{"res", ",", "cylinderLU"}], "]"}]}], " ", ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], "\n", 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"latticeSetNodeCylinderLU", "[", 
      RowBox[{"lattice_", ",", "cylinderLU_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", ",", "cyl"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", "lattice"}], ";", "\[IndentingNewLine]", 
        RowBox[{"cyl", "=", " ", 
         RowBox[{"lattice", "[", "\"\<nodeCylinder\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cyl", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", "cylinderLU"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<nodeCylinder\>\"", "]"}], " ", "=", " ", 
         "cyl"}], ";", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"res", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\"\<namedLatticePoints\>\"", "->", " ", 
             RowBox[{"lNamedLatticePoints", "[", "res", "]"}]}], "}"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], "\n", "]"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8386453958504004`*^9, 3.838645460246694*^9}, {
  3.83864550775636*^9, 3.8386455100995474`*^9}, {3.8386455471798663`*^9, 
  3.8386455942937684`*^9}, {3.8546917330647745`*^9, 3.8546917719053783`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"9fb040ce-c4ac-4e5e-ae0b-0b1b998cdaaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeLabel", "[", "lattice_", "]"}], " ", ":=", " ", 
   RowBox[{"latticeParastichyNumbersGroupedByLength", "[", "lattice", "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeLabelText", "[", 
    RowBox[{"lattice_", ",", 
     RowBox[{"upto_", ":", "2"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ll", ",", "tos"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ll", " ", "=", "  ", 
       RowBox[{"latticeLabel", "[", "lattice", "]"}]}], " ", ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tos", "[", 
        RowBox[{"hat", "[", "n_", "]"}], "]"}], " ", ":=", " ", 
       RowBox[{"\"\<\\!\\(\\*OverscriptBox[\\(\>\"", " ", "<>", " ", 
        RowBox[{"ToString", "[", "n", "]"}], " ", "<>", " ", 
        "\"\<\\), \\(^\\)]\\)\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tos", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"ToString", "[", "n", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"tos", "[", "x_", "]"}], " ", ":=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"x", "===", 
            RowBox[{"hat", "[", "1", "]"}]}], ",", 
           "\"\<\\!\\(\\*OverscriptBox[\\(1\\), \\(^\\)]\\)\>\"", ",", 
           RowBox[{"ToString", "[", "x", "]"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ll", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{"tos", ",", "ll", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", 
      RowBox[{"ll", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringRiffle", "[", 
           RowBox[{"#", ",", "\"\<=\>\""}], "]"}], "&"}], ",", "ll"}], 
        "]"}]}], ";", 
      RowBox[{"ll", " ", "=", " ", 
       RowBox[{"StringRiffle", "[", 
        RowBox[{
         RowBox[{"Take", "[", 
          RowBox[{"ll", ",", 
           RowBox[{"UpTo", "[", "upto", "]"}]}], "]"}], ",", "\"\<,\>\""}], 
        "]"}]}]}]}], "\n", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825240871673643*^9, 3.825240955065938*^9}, {
  3.8252410387287045`*^9, 3.8252410467997646`*^9}, {3.825241255707658*^9, 
  3.8252413152776995`*^9}, {3.839392510588379*^9, 3.839392520068358*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"8f1e7f40-bb03-414f-beb6-6d3cb343cd2f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeLabelPosition", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "cyl", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"cyl", "=", 
        RowBox[{"latticeGetCylinder", "[", "lattice", "]"}]}], ";", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cyl", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"cyl", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"top", " ", "left"}], " ", "*)"}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyVectors", "[", "lattice_", "]"}], " ", ":=", 
    " ", 
    RowBox[{"lattice", "[", "\"\<parastichyVectors\>\"", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticePrincipalParastichyPair", "[", "lattice_", "]"}], " ", ":=",
    " ", 
   RowBox[{"Take", "[", 
    RowBox[{
     RowBox[{"latticeParastichyNumbers", "[", "lattice", "]"}], ",", "2"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"latticePrincipal3ParastichyNumbers", "[", "lattice_", "]"}], " ", ":=", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"latticeParastichyNumbers", "[", "lattice", "]"}], ",", "3"}], 
   "]"}]}]}], "Code",
 CellLabel->
  "In[189]:=",ExpressionUUID->"d8dc7c93-074e-4218-aab6-f30e8f98101b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lNamedLatticePoints", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nmin", ",", "nmax", ",", "irange", ",", "points", ",", "h", ",", 
        "cylinderLU"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", " ", "=", " ", 
        RowBox[{"lattice", "[", "\"\<h\>\"", "]"}]}], ";", 
       RowBox[{"cylinderLU", "=", 
        RowBox[{
         RowBox[{"lattice", "[", "\"\<nodeCylinder\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nmin", ",", "nmax"}], "}"}], "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Ceiling", "[", 
           RowBox[{
            RowBox[{"Min", "[", "cylinderLU", "]"}], "/", "h"}], "]"}], ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Max", "[", "cylinderLU", "]"}], "/", "h"}], "]"}]}], 
         "}"}]}], ";", 
       RowBox[{"irange", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"nmin", ",", "nmax"}], "}"}]}], ";", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"Association", "[", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "->", 
            RowBox[{"N", "@", 
             RowBox[{"First", "@", 
              RowBox[{"latticePointWithCopies", "[", 
               RowBox[{"lattice", ",", "i"}], "]"}]}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "nmin", ",", "nmax"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", "points"}]}], "\n", "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"will", " ", "break", " ", "any", " ", "multijugacy"}], " ", 
   "*)"}], " ", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lCalculateLatticePoints", "[", "lattice_", "]"}], " ", ":=", 
    "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "nmin", ",", "nmax", ",", "irange", ",", "points", ",", "h", ",", 
        "cylinderLU"}], "}"}], ",", 
      RowBox[{
       RowBox[{"h", " ", "=", " ", 
        RowBox[{"lattice", "[", "\"\<h\>\"", "]"}]}], ";", 
       RowBox[{"cylinderLU", "=", 
        RowBox[{
         RowBox[{"lattice", "[", "\"\<nodeCylinder\>\"", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nmin", ",", "nmax"}], "}"}], "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Ceiling", "[", 
           RowBox[{
            RowBox[{"Min", "[", "cylinderLU", "]"}], "/", "h"}], "]"}], ",", 
          RowBox[{"Floor", "[", 
           RowBox[{
            RowBox[{"Max", "[", "cylinderLU", "]"}], "/", "h"}], "]"}]}], 
         "}"}]}], ";", 
       RowBox[{"irange", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"nmin", ",", "nmax"}], "}"}]}], ";", 
       RowBox[{"points", " ", "=", " ", 
        RowBox[{"N", "@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"latticePointWithCopies", "[", 
              RowBox[{"lattice", ",", "i"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nmin", ",", "nmax"}], "}"}]}], "]"}], ",", 
           "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", "points"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticePoints", "[", "lattice_", "]"}], " ", ":=", " ", 
   RowBox[{"Values", "[", 
    RowBox[{"lattice", "[", "\"\<namedLatticePoints\>\"", "]"}], " ", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeNamedPoints", "[", "lattice_", "]"}], "  ", ":=", " ", 
    RowBox[{"lattice", "[", "\"\<namedLatticePoints\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticePoints", "[", 
    RowBox[{"lattice_", ",", "scalingFunction_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "if", " ", "there", " ", "is", " ", "a", " ", "scaling", " ", 
        "function"}], ",", " ", 
       RowBox[{
       "it", " ", "takes", " ", "the", " ", "original", " ", "set", " ", "of",
         " ", "points", " ", "and", " ", "maps", " ", "them", " ", "to", " ", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"scaling", "[", "cylinderU", "]"}]}], " "}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{"latticeScaling", "[", 
        RowBox[{"lattice", ",", "scalingFunction"}], "]"}], ",", 
       RowBox[{"latticePoints", "[", "lattice", "]"}]}], "]"}]}], "\n", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeNamedPoints", "[", 
     RowBox[{"lattice_", ",", "scalingFunction_"}], "]"}], " ", ":=", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"latticeScaling", "[", 
         RowBox[{"lattice", ",", "scalingFunction"}], "]"}], ",", 
        RowBox[{"latticeNamedPoints", "[", "lattice", "]"}]}], "]"}]}], "\n", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeGraphicPoints", "[", "lattice_", "]"}], " ", ":=", "  ", 
   RowBox[{"Point", "[", 
    RowBox[{"latticePoints", "[", "lattice", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeGraphicsPoint", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Point", "[", 
    RowBox[{"latticePoint", "[", 
     RowBox[{"lattice", ",", "m"}], "]"}], "]"}]}], ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.8393929846466913`*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"160c58a1-ef3d-41cf-a124-21b773cca1eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mod", "[", "x_", "]"}], " ", ":=", "  ", 
    RowBox[{"x", " ", "-", " ", 
     RowBox[{"Round", "[", "x", "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lpoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"d_", ",", "h_"}], "}"}], ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"mod", " ", "[", 
      RowBox[{"d", " ", "m"}], "]"}], " ", ",", " ", 
     RowBox[{"m", " ", "h"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lpoint", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d_", ",", "h_"}], "}"}], ",", 
      RowBox[{"hat", "[", "m_", "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"j", ",", "jp", ",", "jm"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", 
        RowBox[{"lpoint", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"d", ",", "h"}], "}"}], ",", "m"}], "]"}]}], ";", " ", 
       RowBox[{"jp", " ", "=", " ", 
        RowBox[{"j", " ", "-", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}]}], ";", " ", 
       RowBox[{"jm", " ", "=", " ", 
        RowBox[{"j", "+", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"should", " ", "just", " ", "test", " ", 
           RowBox[{"j", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ">", "0"}], "..."}], " ", 
        "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"jp", " ", ".", " ", "jp"}], " ", "<", " ", 
          RowBox[{"jm", " ", ".", " ", "jm"}]}], ",", " ", "jp", ",", "jm"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticePoint", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", 
   RowBox[{"lpoint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"lattice", "[", "\"\<d\>\"", "]"}], ",", 
       RowBox[{"lattice", "[", "\"\<h\>\"", "]"}]}], "}"}], ",", "m"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticePointWithCopies", "[", 
     RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cylinder", ",", "lp", ",", "i", ",", "x"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "including", " ", "periodic", " ", "copies", " ", "within", " ", "the",
         " ", "display", " ", "cylinder"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinder", " ", "=", " ", 
        RowBox[{"latticeGetCylinder", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lp", " ", "=", " ", 
        RowBox[{"latticePoint", "[", 
         RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "cylinder", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[Equal]", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}], ",", 
            RowBox[{"1", "/", "2"}]}], "}"}]}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", "lp", "}"}], "]"}]}], "]"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"should", " ", "be", " ", "the", " ", "same"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"x", " ", "=", " ", 
        RowBox[{
        "lp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"lp", " ", "+", " ", 
           RowBox[{"i", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", "0"}], "}"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Ceiling", "[", 
             RowBox[{
              RowBox[{"cylinder", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-", "x"}],
              "]"}], ",", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"cylinder", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", "x"}],
              "]"}]}], "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeVector", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"latticePoint", "[", 
      RowBox[{"lattice", ",", "m"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 InitializationCell->True,
 CellFrameColor->GrayLevel[0.75],
 CellLabel->
  "In[201]:=",ExpressionUUID->"ed44a0b0-8df1-4677-b699-4ec099bc13d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticePointH", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"latticePoint", "[", 
     RowBox[{"lattice", ",", "m"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticePointD", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"latticePoint", "[", 
     RowBox[{"lattice", ",", "m"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeRise", "[", "lattice_", "]"}], " ", ":=", " ", 
   RowBox[{"lattice", "[", "\"\<h\>\"", "]"}]}], " ", ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeDivergence", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"latticePointD", "[", 
     RowBox[{"lattice", ",", "1"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"will", " ", "be", " ", "the", " ", "same", " ", "as", " ", 
      RowBox[{"lattice", "[", "\"\<d\>\"", "]"}], " ", "for"}], " ", "-", 
     RowBox[{"1", "/", "2"}]}], "<", "d", "<", 
    RowBox[{"1", "/", "2"}]}], " ", "*)"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeVectorLength", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Norm", "[", " ", 
    RowBox[{"latticeVector", "[", 
     RowBox[{"lattice", ",", "m"}], "]"}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[207]:=",ExpressionUUID->"31857182-9d4a-4c09-830d-2e0d13c97d84"],

Cell[CellGroupData[{

Cell["Graphics[] helper functions", "Subsection",
 CellTags->"c:5",ExpressionUUID->"3b42b4ce-96ea-437e-a8bf-c325fc88c783"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeGraphicRegion", "[", 
     RowBox[{"lattice_", ",", "scalingFunction_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{
       "scalingFunction", ",", "\[IndentingNewLine]", "\"\<Disk\>\"", ",", 
        RowBox[{"glatticeDisk", "[", "lattice", "]"}], ",", 
        "\[IndentingNewLine]", "\"\<Arena\>\"", ",", 
        RowBox[{"glatticeScaledRegion", "[", 
         RowBox[{"lattice", ",", "\"\<Arena\>\""}], "]"}], ",", 
        "\[IndentingNewLine]", "\"\<StemStretch\>\"", ",", 
        RowBox[{"glatticeStemRegion", "[", "lattice", "]"}], ",", 
        "\[IndentingNewLine]", "\"\<StemBulge\>\"", ",", 
        RowBox[{"glatticeScaledRegion", "[", 
         RowBox[{"lattice", ",", "\"\<StemBulge\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"glatticeDisk", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cylinderLU", ",", "func", ",", "innerOuter"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{"latticeGetCylinderLU", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"func", "[", "z_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"latticeScaling", "[", 
           RowBox[{"lattice", ",", "\"\<Disk\>\""}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "z"}], "}"}], "]"}], "\[LeftDoubleBracket]", "1",
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"innerOuter", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"func", ",", 
          RowBox[{"Reverse", "[", "cylinderLU", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"innerOuter", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{"Ramp", " ", ",", "innerOuter"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"innerOuter", " ", "=", " ", 
        RowBox[{"Sort", "[", "innerOuter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"First", "@", "innerOuter"}], "\[Equal]", "0"}], ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"Last", "[", "innerOuter", "]"}]}], "]"}], ",", 
         RowBox[{"Annulus", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "innerOuter"}], "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"glatticeScaledRegion", "[", 
     RowBox[{"lattice_", ",", "scalingFunctionName_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "region", ",", "dregion", ",", "displayCylinder", ",", "cylinder", ",",
         "bfunc", ",", "x", ",", "z"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinder", "=", " ", 
        RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"bfunc", " ", "=", " ", 
        RowBox[{"latticeScaling", "[", 
         RowBox[{"lattice", ",", "scalingFunctionName"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"region", " ", "=", " ", 
        RowBox[{"Region", "@", 
         RowBox[{"ParametricRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"bfunc", "[", 
              RowBox[{"{", 
               RowBox[{"x", ",", "z"}], "}"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "<=", " ",
                "x", " ", "<=", " ", 
               RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", "&&",
               " ", 
              RowBox[{
               RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], " ", "<=",
                " ", "z", " ", "<=", " ", 
               RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "z"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"displayCylinder", " ", "=", " ", 
        RowBox[{"latticeGetCylinder", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dregion", " ", "=", " ", 
        RowBox[{"DiscretizeRegion", "[", 
         RowBox[{"region", ",", "displayCylinder"}], "]"}]}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "mma", " ", "bug", " ", "sets", " ", "region", " ", "boundary", " ", 
         "wrongly"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"regionToPolygon", "@", 
        RowBox[{"RegionBoundary", "[", "dregion", "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"glatticeStemRegion", "[", "lattice_", "]"}], " ", ":=", "  ", 
   RowBox[{"Rectangle", "@@", 
    RowBox[{"Transpose", "@", 
     RowBox[{"latticeGetCylinder", "[", "lattice", "]"}]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellFrame->{{0, 0}, {0.5, 0}},
 InitializationCell->True,
 CellFrameColor->GrayLevel[0.75],
 CellChangeTimes->{{3.8386463652156725`*^9, 3.8386465558945312`*^9}, {
   3.8386465877820206`*^9, 3.8386466155199294`*^9}, {3.83865279157946*^9, 
   3.838652793582093*^9}, {3.8387083202976837`*^9, 3.8387083292728014`*^9}, {
   3.8387089304477787`*^9, 3.8387089944083366`*^9}, {3.838709043388149*^9, 
   3.838709048577855*^9}, {3.838709713218342*^9, 3.8387097374786477`*^9}, {
   3.8387097746983185`*^9, 3.8387098386484947`*^9}, 3.8387098853035007`*^9, {
   3.8419124293721943`*^9, 3.841912445609736*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"4313befb-6793-4e9b-82e4-a740cf47c2c0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parastichy lines", "Section",
 CellTags->"c:6",ExpressionUUID->"9046147e-0ca0-4272-b5af-5ffff81b37e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticePrincipal3ParastichyLines", "[", "lattice_", "]"}], " ", ":=",
     " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"latticeParastichyLines", "[", 
        RowBox[{"lattice", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"latticePrincipal3ParastichyNumbers", "[", "lattice", "]"}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticePrincipalParastichyLines", "[", "lattice_", "]"}], " ", ":=",
     " ", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"latticeParastichyLines", "[", 
        RowBox[{"lattice", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"latticePrincipalParastichyPair", "[", "lattice", "]"}]}], 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"barem", "[", "m_", "]"}], " ", ":=", 
   RowBox[{"m", " ", "/.", " ", 
    RowBox[{"hat", " ", "->", " ", "Identity"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"zeroParastichyQ", "[", "m_", "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"barem", "[", "m", "]"}], " ", "==", " ", "0"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichySlope", "[", 
     RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parastichyVectorM", ",", "pSlope"}], "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"parastichyVectorM", " ", "=", " ", 
        RowBox[{"latticePoint", "[", 
         RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\n", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"parastichyVectorM", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], " ", ",", 
         RowBox[{"Return", "[", "\[Infinity]", "]"}]}], "]"}], ";", "\n", 
       RowBox[{
        RowBox[{"parastichyVectorM", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", 
        RowBox[{"parastichyVectorM", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyVerticalSeparation", "[", 
     RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"parastichyVectorM", ",", "pSlope"}], "}"}], ",", "\n", " ", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"latticeRise", "[", "lattice", "]"}], "]"}]}], "]"}], ";", 
       "\n", 
       RowBox[{"parastichyVectorM", " ", "=", " ", 
        RowBox[{"latticePoint", "[", 
         RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\n", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"parastichyVectorM", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], " ", ",", 
         RowBox[{"Return", "[", "0", "]"}]}], "]"}], ";", "\n", 
       RowBox[{"pSlope", " ", "=", " ", 
        RowBox[{
         RowBox[{"parastichyVectorM", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", 
         RowBox[{"parastichyVectorM", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\n", 
       RowBox[{
        RowBox[{"latticeRise", "[", "lattice", "]"}], "/", "pSlope"}]}]}], 
     "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeParastichyHorizontalSeparation", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", 
        RowBox[{"Return", "[", "1", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"1", "/", 
       RowBox[{"barem", "[", "m", "]"}]}]}]}], "\n", "]"}]}], 
  ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[216]:=",ExpressionUUID->"ec135d8a-a107-4dc2-ad4a-43b270460e6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"linelineIntersection", "[", 
     RowBox[{"line1_", ",", "line2_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x1", ",", "y1", ",", "x2", ",", "y2", ",", "x3", ",", "y3", ",", "x4",
         ",", "y4", ",", "x", ",", "y", ",", "m1", ",", "m2"}], "}"}], ",", 
      "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2"}], "}"}]}], " ", "}"}], " ", "=", " ", 
        "line1"}], ";", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"x3", ",", "y3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x4", ",", "y4"}], "}"}]}], "}"}], " ", "=", " ", 
        "line2"}], ";", "\n", 
       RowBox[{"m1", " ", "=", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", "y1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x2", ",", "y2", ",", "1"}], "}"}]}], "}"}]}], ";", "\n", 
       RowBox[{"m2", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"x", ",", "y", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x3", ",", "y3", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x4", ",", "y4", ",", "1"}], "}"}]}], "}"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}], "  ", "/.", " ", 
        RowBox[{
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Det", "[", "m1", "]"}], "==", "0"}], ",", 
             RowBox[{
              RowBox[{"Det", "[", "m2", "]"}], "==", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[223]:=",ExpressionUUID->"0f597f0e-259c-4c9e-8547-bf6c0029a582"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"latticeParastichyCylinderIntersection", "[", 
    RowBox[{"lattice_", ",", "m_", ",", "topbottom_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "arena", ",", "arenaBottomIntersection", ",", "arenaTopIntersection"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"arena", " ", "=", " ", 
       RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"arenaBottomIntersection", " ", "=", " ", 
       RowBox[{
        RowBox[{"linelineIntersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "  ", 
            RowBox[{"latticeVector", "[", 
             RowBox[{"lattice", ",", "m"}], "]"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"arenaTopIntersection", " ", "=", " ", 
       RowBox[{
        RowBox[{"linelineIntersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "  ", 
             RowBox[{
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"arena", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", "  ", 
            RowBox[{"latticeVector", "[", 
             RowBox[{"lattice", ",", "m"}], "]"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"topbottom", "===", "Bottom"}], ",", 
        "arenaBottomIntersection", ",", "arenaTopIntersection"}], "]"}]}]}], 
    "\n", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[224]:=",ExpressionUUID->"f7d5ea60-fa52-44f8-9723-1133378a324a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "a", " ", "set", " ", "of", " ", "xz", " ", 
     "points", " ", "on", " ", "the", " ", "euclidean", " ", "cylinder", " ", 
     "through", " ", "which", " ", "m", " ", "distinct", " ", "m"}], "-", 
    RowBox[{"parastichies", " ", "will", " ", "go"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyXZThrough", "[", 
     RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", "  ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "arena", ",", "ilowerB", ",", " ", "iupperB", ",", "translationD", ",",
         "arenaBottomIntersection"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"arena", " ", "=", " ", 
        RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"translationD", " ", "=", " ", 
           RowBox[{"latticeParastichyVerticalSeparation", "[", 
            RowBox[{"lattice", ",", "0"}], "]"}]}], ";", 
          RowBox[{"ilowerB", " ", "=", " ", 
           RowBox[{"-", 
            RowBox[{"Floor", "[", 
             RowBox[{
              RowBox[{"(", "  ", 
               RowBox[{"-", " ", 
                RowBox[{"arena", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
              "/", "translationD"}], "]"}]}]}], ";", 
          RowBox[{"iupperB", " ", "=", " ", 
           RowBox[{"Floor", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"arena", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}], ")"}], "/",
              " ", "translationD"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"arena", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"i", " ", "*", "  ", "translationD"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "ilowerB", ",", "iupperB"}], "}"}]}], "]"}], 
           "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"or", " ", "a", " ", "slope"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"translationD", "=", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{"latticeParastichyHorizontalSeparation", "[", 
          RowBox[{"lattice", ",", "m"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"arenaBottomIntersection", " ", "=", " ", 
        RowBox[{
         RowBox[{"linelineIntersection", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "  ", 
              RowBox[{
               RowBox[{"arena", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{"arena", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
             ",", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"arena", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"arena", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}]}],
             "}"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", "  ", 
             RowBox[{"latticeVector", "[", 
              RowBox[{"lattice", ",", "m"}], "]"}]}], "}"}]}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       RowBox[{"ilowerB", " ", "=", " ", 
        RowBox[{"-", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{"arenaBottomIntersection", " ", "-", " ", 
             RowBox[{"arena", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}], 
           "/", "translationD"}], "]"}]}]}], ";", 
       RowBox[{"iupperB", " ", "=", " ", 
        RowBox[{"Floor", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"arena", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "-", " ", 
            "arenaBottomIntersection"}], " ", ")"}], "/", " ", 
          "translationD"}], "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"arenaBottomIntersection", "+", " ", 
             RowBox[{"i", " ", "*", "  ", "translationD"}]}], ",", 
            RowBox[{"arena", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "ilowerB", ",", "iupperB"}], "}"}]}], "]"}], 
        "]"}]}]}], "\n", "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[225]:=",ExpressionUUID->"0c1e4629-1682-4457-9cd0-fc4162accfbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeParastichyLines", "[", 
    RowBox[{"lattice_", ",", "m_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xtable", " ", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xtable", "=", " ", 
       RowBox[{"latticeParastichyXZThrough", "[", 
        RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"latticeParastichyLinesThroughXZ", "[", 
          RowBox[{"lattice", ",", "m", ",", "#"}], "]"}], "&"}], ",", 
        "xtable"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeParastichyLines", "[", 
    RowBox[{"lattice_", ",", "m_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"latticeParastichyLinesThroughXZ", "[", 
    RowBox[{"lattice", ",", "m", ",", 
     RowBox[{"latticePoint", "[", 
      RowBox[{"lattice", ",", "k"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeParastichyLinesAbove", "[", 
    RowBox[{"lattice_", ",", "m_", ",", "k_"}], "]"}], " ", ":=", " ", 
   RowBox[{"latticeParastichyLinesAboveXZ", "[", 
    RowBox[{"lattice", ",", "m", ",", 
     RowBox[{"latticePoint", "[", 
      RowBox[{"lattice", ",", "k"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[226]:=",ExpressionUUID->"40674fc5-0c93-433a-a884-ebb2d09eb028"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyLinesAboveXZ", "[", 
     RowBox[{"lattice_", ",", "m_", ",", "throughxz_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"res", ",", "cylinderLU", ",", "lines"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{"latticeGetNodeCylinderLU", "[", "lattice", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cylinderLU", "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
        RowBox[{"throughxz", " ", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"latticeSetNodeCylinderLU", "[", 
         RowBox[{"lattice", ",", "cylinderLU"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"lines", " ", "=", " ", 
        RowBox[{"latticeParastichyLinesThroughXZ", "[", 
         RowBox[{"res", ",", "m", ",", "throughxz"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "lines"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyLinesThroughXZ", "[", 
     RowBox[{"lattice_", ",", "m_", ",", "throughxz_"}], "]"}], " ", ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "pvecslope", ",", "bottom", ",", "top", ",", "cylinder", ",", 
        "cylinderLU", ",", "line"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cylinder", " ", "=", " ", 
        RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}]}], ";", 
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{
        "cylinder", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
       ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"zeroParastichyQ", "[", "m", "]"}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"parastichy", " ", "is", " ", "horizontal"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"line", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cylinder", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "throughxz", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cylinder", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "throughxz", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", "or", " ", "*)"}], " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"latticePoint", "[", 
              RowBox[{"lattice", ",", "m"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{"parastichy", " ", "is", " ", "vertical"}], " ", "*)"}], 
           " ", "\[IndentingNewLine]", 
           RowBox[{"line", " ", "=", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "throughxz", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "throughxz", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"cylinder", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], 
               "}"}]}], "}"}]}], ",", "\n", 
           RowBox[{"(*", " ", 
            RowBox[{"or", " ", "general", " ", "case"}], " ", "*)"}], " ", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"pvecslope", " ", "=", " ", 
             RowBox[{"latticeParastichySlope", "[", 
              RowBox[{"lattice", ",", "m"}], "]"}]}], ";", 
            RowBox[{"bottom", " ", "=", " ", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "cylinderLU", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "throughxz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}], "/", "pvecslope"}], 
                " ", "+", 
                RowBox[{
                "throughxz", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", " ", 
               RowBox[{
               "cylinderLU", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
            RowBox[{"top", "        ", "=", " ", 
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "cylinderLU", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "-", 
                   RowBox[{
                   "throughxz", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ")"}], "/", "pvecslope"}], 
                "+", 
                RowBox[{
                "throughxz", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ",", 
               RowBox[{
               "cylinderLU", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"line", " ", "=", " ", 
             RowBox[{"splitLineOverCylinder", "[", 
              RowBox[{"cylinder", ",", "bottom", ",", "pvecslope"}], "]"}]}], 
            ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Line", "[", "line", "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"splitLineOverCylinder", "[", 
    RowBox[{"cylinder_", ",", "bottom_", ",", "pvecslope_"}], "]"}], " ", ":=",
    " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"line", ",", "lastXZ", ",", "i", ",", "nextX", ",", "nextZ"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"line", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lastXZ", " ", "=", " ", "bottom"}], ";", "\[IndentingNewLine]", 
      RowBox[{"i", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nextX", " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"pvecslope", ">", "0"}], ",", " ", 
            RowBox[{"cylinder", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"cylinder", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"nextZ", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "lastXZ", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"nextX", "-", 
              RowBox[{
              "lastXZ", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ")"}], "*", " ", 
            "pvecslope"}]}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "assumes", " ", "cylinder", " ", "width", " ", "a", " ", "multiple",
            " ", "of", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"nextZ", ">", " ", 
            RowBox[{"cylinder", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nextZ", " ", "=", "  ", 
             RowBox[{"cylinder", "\[LeftDoubleBracket]", 
              RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"nextX", " ", "=", " ", 
             RowBox[{
              RowBox[{
              "lastXZ", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"nextZ", "-", 
                 RowBox[{
                 "lastXZ", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], ")"}], "/", 
               "pvecslope"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"line", " ", "=", " ", 
          RowBox[{"Append", "[", 
           RowBox[{"line", ",", 
            RowBox[{"{", 
             RowBox[{"lastXZ", ",", 
              RowBox[{"{", 
               RowBox[{"nextX", ",", "nextZ"}], "}"}]}], "}"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"i", "++"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"i", "<", " ", "50"}], " ", "&&", " ", 
          RowBox[{"nextZ", "  ", "<", " ", 
           RowBox[{"cylinder", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "2"}], "\[RightDoubleBracket]"}]}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"While", " ", "body"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lastXZ", " ", "=", " ", 
          RowBox[{"Last", "@", 
           RowBox[{"Last", "[", "line", "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "lastXZ", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          " ", "=", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"pvecslope", ">", "0"}], ",", " ", 
            RowBox[{"cylinder", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"cylinder", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], " ", 
           "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "line"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.8550964320077395`*^9},
 CellLabel->
  "In[229]:=",ExpressionUUID->"4ffac8f4-70f5-4584-9adc-55d4b4e11621"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"latticeParallelogram", "[", 
    RowBox[{"lattice_", ",", "m_", ",", "n_", ",", "through_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"origin", ",", "pm", ",", "pn"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"origin", " ", "=", " ", 
       RowBox[{"latticePoint", "[", 
        RowBox[{"lattice", ",", "through"}], "]"}]}], ";", " ", 
      RowBox[{"pm", "=", 
       RowBox[{"latticePoint", "[", 
        RowBox[{"lattice", ",", "m"}], "]"}]}], ";", 
      RowBox[{"pn", "=", 
       RowBox[{"latticePoint", "[", 
        RowBox[{"lattice", ",", "n"}], "]"}]}], ";", "\n", " ", 
      RowBox[{"{", " ", 
       RowBox[{"origin", ",", " ", 
        RowBox[{"origin", "+", "pm"}], ",", 
        RowBox[{"origin", "+", "pm", "+", "pn"}], ",", 
        RowBox[{"origin", "+", "pn"}], ",", "origin"}], "}"}]}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[232]:=",ExpressionUUID->"a3249bf0-c159-4ec7-b33c-36858e93f1d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeGraphicsCylinder", "[", "lattice_", "]"}], " ", ":=", "  ", 
   RowBox[{"Rectangle", " ", "@@", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"latticeGetCylinder", "[", "lattice", "]"}], "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeGraphicsPlotRange", "[", "lattice_", "]"}], " ", ":=", 
   "  ", 
   RowBox[{"latticeGetCylinder", "[", "lattice", "]"}]}], 
  ";"}], "\n"}], "Code",
 CellLabel->
  "In[233]:=",ExpressionUUID->"68c05707-c9a3-4aec-93a3-4561ca180740"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Drawing van Iterson space", "Chapter",ExpressionUUID->"286689ea-f57d-45dd-88cf-a1c9dfe9faec"],

Cell[CellGroupData[{

Cell["Renormalisations", "Section",
 CellTags->"c:10",ExpressionUUID->"120ec840-1542-465e-b6c1-6997170dd997"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeRenormalised", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tran", ",", "zn", ",", "w1", ",", "pm", ",", "pn"}], "}"}], 
      ",", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "rotate", " ", "and", " ", "scale", " ", "so", " ", "that", " ", 
         "the", " ", "old", " ", "m"}], "-", 
        RowBox[{
        "th", " ", "parastichy", " ", "vector", " ", "is", " ", "now", " ", 
         RowBox[{"(", 
          RowBox[{"1", ",", "0"}], ")"}]}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pm", ",", "pn"}], "}"}], " ", "=", " ", 
        RowBox[{"latticePrincipalParastichyPair", "[", "lattice", "]"}]}], 
       ";", 
       RowBox[{"tran", " ", "=", " ", 
        RowBox[{"latticeRenormalisationTransformation", "[", 
         RowBox[{"lattice", ",", "pm"}], "]"}]}], " ", ";", 
       RowBox[{"(*", " ", 
        RowBox[{
        "that", " ", "maps", " ", "m", " ", "to", " ", "0.", " ", "we", " ", 
         "need", " ", "a", " ", "linearly", " ", "independent", " ", "n"}], 
        " ", "*)"}], 
       RowBox[{"zn", " ", "=", " ", 
        RowBox[{"latticePoint", "[", 
         RowBox[{"lattice", ",", "pn"}], "]"}]}], ";", 
       RowBox[{"w1", " ", "=", " ", 
        RowBox[{"tran", " ", "[", " ", "zn", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"should", " ", "already", " ", "have"}], " ", "-", 
           RowBox[{"1", "/", "2"}]}], "<", "d", "<", 
          RowBox[{"1", "/", "2"}]}], ";", " ", 
         RowBox[{
          RowBox[{
          "role", " ", "of", " ", "this", " ", "is", " ", "to", " ", "change",
            " ", "w_"}], "-", 
          RowBox[{"1", " ", "to", " ", "w1"}]}]}], " ", "*)"}], "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"w1", " ", "=", " ", 
        RowBox[{"dhPrincipalPoint", "[", "w1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"latticeCreateDH", "[", "w1", "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dhPrincipalPoint", "[", 
     RowBox[{"{", 
      RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "principaldh", "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"principaldh", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"mod", "[", "d", "]"}], ",", "h"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"h", ">", "0"}], ",", "principaldh", ",", 
         RowBox[{"-", "principaldh"}]}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeRenormalisationTransformation", "[", 
     RowBox[{"lattice_", ",", "mvec_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mEnd", ",", "mVectorLength", ",", "rot", ",", "sca", ",", "tran"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mEnd", " ", "=", " ", 
        RowBox[{"latticePoint", "[", 
         RowBox[{"lattice", ",", "mvec"}], "]"}]}], ";", 
       RowBox[{"mVectorLength", " ", "=", " ", 
        RowBox[{"latticeVectorLength", "[", 
         RowBox[{"lattice", ",", "mvec"}], "]"}]}], ";", 
       RowBox[{"rot", " ", "=", " ", 
        RowBox[{"RotationTransform", "[", 
         RowBox[{"{", 
          RowBox[{"mEnd", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}], "]"}]}], ";", 
       RowBox[{"sca", " ", "=", " ", 
        RowBox[{"ScalingTransform", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "mVectorLength"}], ",", 
           RowBox[{"1", "/", "mVectorLength"}]}], "}"}], "]"}]}], ";", 
       RowBox[{"tran", " ", "=", " ", 
        RowBox[{"Composition", "[", 
         RowBox[{"sca", ",", "rot"}], "]"}]}], ";", "tran"}]}], "\n", "]"}]}],
    ";"}], "\n"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[235]:=",ExpressionUUID->"7ba1adf9-9d69-47f9-812c-0bdee4154695"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lattices by transformation", "Section",
 CellTags->"c:11",ExpressionUUID->"4d850d9d-a43e-4628-a50b-f40398683284"],

Cell[CellGroupData[{

Cell["Mobius function definitions", "Subsection",
 CellTags->"c:12",ExpressionUUID->"1eb2456a-c522-43a0-918e-904840db080a"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"relative", " ", "to", " ", 
    RowBox[{"(", 
     RowBox[{"0", ",", "1"}], " ", ")"}], " ", "not", " ", "used"}], " ", 
   "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"hMN", "[", 
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "[", "w_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], "=", " ", 
         RowBox[{"windingNumberPair", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        RowBox[{"hMNUV", "[", 
         RowBox[{"m", ",", "n", ",", "u", ",", "v", ",", "w"}], "]"}]}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hMNRealPair", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "=", "xy"}], ";", " ", 
          RowBox[{"ReIm", "[", 
           RowBox[{
            RowBox[{"hMN", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", 
            RowBox[{"x", " ", "+", "  ", 
             RowBox[{"I", " ", "y"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
    ";", "\n", 
    RowBox[{
     RowBox[{"hMNRealPairReflection", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"hMNRealPair", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", "xy", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "x"}], ",", "y"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hMNInDHalf", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"euclideanDelta", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}], "\[Equal]", "1"}], ",", 
       RowBox[{"hMNRealPair", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}], ",", 
       RowBox[{"hMNRealPairReflection", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hMNUV", "[", 
      RowBox[{"m_", ",", "n_", ",", "u_", ",", "v_", ",", "w_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "u"}], " ", "w"}], " ", "+", " ", "v"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "m"}], " ", "w"}], " ", "+", " ", "n"}], ")"}]}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hMNUV", "[", 
      RowBox[{"m_", ",", "n_", ",", "u_", ",", "v_", ",", 
       RowBox[{"DirectedInfinity", "[", "_", "]"}]}], "]"}], ":=", 
     RowBox[{"u", "/", "m"}]}], ";"}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.855096470185218*^9},
 CellLabel->
  "In[238]:=",ExpressionUUID->"069d6b81-4257-4625-bcbc-7b29be5343f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"relative", " ", "to", " ", 
    RowBox[{"(", 
     RowBox[{"1", ",", "0"}], ")"}]}], "  ", "*)"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"gMN", "[", 
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "[", "w_", "]"}], ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"u", ",", "v"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        RowBox[{"gMNUV", "[", 
         RowBox[{"m", ",", "n", ",", "u", ",", "v", ",", "w"}], "]"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNRealPair", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "=", "xy"}], ";", " ", 
          RowBox[{"ReIm", "[", 
           RowBox[{
            RowBox[{"gMN", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", 
            RowBox[{"x", " ", "+", "  ", 
             RowBox[{"I", " ", "y"}]}], "]"}], "]"}]}]}], "]"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNRealPairReflection", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"gMNRealPair", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", "xy", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "-", "x"}], ",", "y"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNInDHalf", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], " ", "=", " ", 
           RowBox[{"N", "@", 
            RowBox[{
             RowBox[{"gMNRealPair", "[", 
              RowBox[{"{", 
               RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", "xy", "]"}]}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"x", "-", 
            RowBox[{"Round", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "0"}], ",", 
            RowBox[{"x", "=", 
             RowBox[{"-", "x"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"Abs", "[", "y", "]"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "gMNInDHalfExact", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNInDHalfSymbolic", "[", 
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "xy", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], " ", "=", " ", 
           RowBox[{
            RowBox[{"gMNRealPair", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", "xy", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"x", " ", "=", " ", 
           RowBox[{"x", "-", 
            RowBox[{"Round", "[", "x", "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"x", "<", "0"}], ",", 
            RowBox[{"x", "=", 
             RowBox[{"-", "x"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"gMNInDHalf", "[", 
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "  ", ":=", " ", 
      "\[IndentingNewLine]", " ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"euclideanDelta", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}], "\[Equal]", "1"}], ",", 
        RowBox[{"gMNRealPair", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}], ",", 
        RowBox[{"gMNRealPairReflection", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNUV", "[", 
      RowBox[{"m_", ",", "n_", ",", "u_", ",", "v_", ",", "w_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"v", " ", "w"}], " ", "+", " ", "u"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"n", " ", "w"}], " ", "+", " ", "m"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"gMNUV", "[", 
      RowBox[{"m_", ",", "n_", ",", "u_", ",", "v_", ",", 
       RowBox[{"DirectedInfinity", "[", "_", "]"}]}], "]"}], ":=", 
     RowBox[{"v", "/", "n"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825574529278529*^9, 3.82557454059359*^9}, {
   3.85468988870369*^9, 3.854689923968774*^9}, 3.855094737068076*^9, {
   3.8550951992389126`*^9, 3.8550952014559994`*^9}, 3.855158348506257*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"cdad9cdf-5323-4f53-9cd5-504c77f033b4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"viiMoebiusTransform", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"u_", ",", "v_"}], "}"}]}], "}"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", "m", " ", "u"}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", "m", " ", "u"}], "+", 
       RowBox[{"n", " ", "v"}], "-", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "u"}], "+", 
          RowBox[{"m", " ", "v"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
       SuperscriptBox["n", "2"]}]], ",", 
     FractionBox["h", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
       SuperscriptBox["n", "2"]}]]}], "}"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[246]:=",ExpressionUUID->"64d1cd4c-166a-4b8f-8647-f16d1b0e3317"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mvnu1", ",", "z1d", ",", "z1h"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "h", ",", "m", ",", "v", ",", "n", ",", "u"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mvnu1", " ", "=", " ", 
        RowBox[{
         RowBox[{"Solve", "[", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m", " ", "v"}], " ", "-", " ", 
             RowBox[{"n", " ", "u"}]}], " ", "\[Equal]", "1"}], ",", " ", 
           "v"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"z1d", ",", "z1h"}], "}"}], " ", "=", " ", 
        "\[IndentingNewLine]", " ", 
        RowBox[{"Simplify", "/@", 
         RowBox[{"(", " ", 
          RowBox[{"ComplexExpand", "@", " ", 
           RowBox[{"ReIm", " ", "[", 
            RowBox[{"gMNUV", "[", 
             RowBox[{"m", ",", "n", ",", "u", ",", "v", ",", 
              RowBox[{"d", "+", " ", 
               RowBox[{"I", " ", "h"}]}]}], "]"}], "]"}]}], " ", ")"}]}]}], 
       ";", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"z1d", ",", "z1h"}], "}"}], " ", "-", " ", 
         RowBox[{
          RowBox[{"viiMoebiusTransform", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"u", ",", "v"}], "}"}]}], "}"}], "]"}], "[", 
          RowBox[{"{", 
           RowBox[{"d", ",", "h"}], "}"}], "]"}]}], " ", "/.", " ", 
        "mvnu1"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8551582374137506`*^9, 3.8551582914071093`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"0df27c0f-8f6c-4941-9898-370ea0f133d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", "m", " ", "u"}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", "m", " ", "u"}], "+", 
       FractionBox[
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"n", " ", "u"}]}], ")"}]}], "m"], "-", 
       RowBox[{"d", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "n", " ", "u"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
       SuperscriptBox["n", "2"]}]]}], "+", 
    FractionBox[
     RowBox[{
      RowBox[{"m", " ", 
       RowBox[{"(", 
        RowBox[{"u", "+", 
         FractionBox[
          RowBox[{"d", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"n", " ", "u"}]}], ")"}]}], "m"]}], ")"}]}], "+", 
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"d", " ", "u"}], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["d", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"n", " ", "u"}]}], ")"}]}], "m"], "+", 
         FractionBox[
          RowBox[{
           SuperscriptBox["h", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"n", " ", "u"}]}], ")"}]}], "m"]}], ")"}]}]}], 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "+", 
         SuperscriptBox["h", "2"]}], ")"}], " ", 
       SuperscriptBox["n", "2"]}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["h", 
      RowBox[{
       RowBox[{
        SuperscriptBox["d", "2"], " ", 
        SuperscriptBox["m", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["h", "2"], " ", 
        SuperscriptBox["m", "2"]}], "-", 
       RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
       SuperscriptBox["n", "2"]}]]}], "+", 
    FractionBox["h", 
     RowBox[{
      SuperscriptBox["m", "2"], "+", 
      RowBox[{"2", " ", "d", " ", "m", " ", "n"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["d", "2"], "+", 
         SuperscriptBox["h", "2"]}], ")"}], " ", 
       SuperscriptBox["n", "2"]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8551582927867117`*^9, {3.8551692441630397`*^9, 3.8551692455220704`*^9}, 
   3.855209721144474*^9, 3.855211851198328*^9, 3.855257056712225*^9, 
   3.8552821734958954`*^9, 3.8552858885607386`*^9, 3.855303736834793*^9, {
   3.8553039443610077`*^9, 3.8553039453607693`*^9}, {3.855338435949729*^9, 
   3.8553384376212115`*^9}, 3.8555337900434666`*^9, 3.855536564842189*^9, 
   3.8555369505579033`*^9, 3.8557085633346863`*^9, 3.855719817285468*^9, 
   3.8558089613341913`*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"bb659cc2-3dbd-4df9-9a48-10e4f0ed1a04"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"latticeMoebiusTransform", "[", "mn_", "]"}], "[", "dh_", "]"}], 
    " ", ":=", " ", 
    RowBox[{
     RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", "dh", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeMoebiusTransform", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "\[Infinity]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeMoebiusTransform", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"0.", ",", "0."}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "\[Infinity]"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeMoebiusTransform", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "h_"}], "}"}], "]"}], "  ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{"d", ",", "h"}], "}"}]}], ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[248]:=",ExpressionUUID->"a60dc9aa-eb69-42c0-8476-088c0ecdb808"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Find special lattices", "Subsection",
 CellTags->"c:13",ExpressionUUID->"634d7633-eb03-4f97-a11a-992d8c562bb6"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"latticeHexagonal", " ", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], ",", 
       RowBox[{"cylinderLU_", ":", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}]}], "]"}], " ", ":=", 
     " ", "\[IndentingNewLine]", 
     RowBox[{"latticeCreateDH", "[", 
      RowBox[{
       RowBox[{"latticeDHHexagonal", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}], ",", "cylinderLU", ",", "3"}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\n"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[252]:=",ExpressionUUID->"2dfe3646-0eed-47e4-a4f6-ba3736c3e885"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeDHNonOpposedTC", "[", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "  ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"xy", ",", "r", ",", "angles", ",", "circle"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"circle", " ", "=", "  ", 
        RowBox[{"viiPrimaryNonOpposed", "[", 
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", "*)"}], 
     RowBox[{
      RowBox[{"circle", " ", "=", "  ", 
       RowBox[{"vanItersonTouchingCirclePrimaryNonOpposed", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"circle", "\[Equal]", "Nothing"}], ",", 
        RowBox[{"Return", "[", "Nothing", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xy", ",", "r", ",", "angles"}], "}"}], " ", "=", " ", 
       RowBox[{"List", " ", "@@", " ", "circle"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"angles", " ", "=", " ", 
       RowBox[{"Mean", "[", "angles", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xy", " ", "+", " ", 
       RowBox[{"r", " ", "*", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "angles", "]"}], ",", 
          RowBox[{"Sin", "[", "angles", "]"}]}], "}"}]}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeTriplePoint", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"latticeDHHexagonal", "[", 
     RowBox[{"{", 
      RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
   RowBox[{
    RowBox[{"latticeDHHexagonal", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], "  ", ":=", " ", 
    RowBox[{
     RowBox[{"latticeMoebiusTransform", "[", 
      RowBox[{"{", 
       RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", " ", 
     RowBox[{"{", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}], "]"}]}], ";"}], 
  "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeTouchingCircle", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], ",", 
     RowBox[{"cylinderLU_", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"latticeCreateDH", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"latticeMoebiusTransform", "[", 
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"5", 
          RowBox[{"\[Pi]", "/", "12"}]}], "]"}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"5", 
          RowBox[{"\[Pi]", "/", "12"}]}], "]"}]}], "}"}], "]"}], ",", 
     "cylinderLU", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeEquiLength", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], ",", 
     RowBox[{"cylinderLU_", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"ie", " ", "p", " ", "numbers", " ", "are", " ", 
      RowBox[{"(", 
       RowBox[{"m", "+", "n"}], ")"}]}], ",", 
     RowBox[{"m", "=", "n"}]}], " ", "*)"}], 
   RowBox[{"latticeCreateDH", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"latticeMoebiusTransform", "[", 
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{"\[Pi]", "/", "6"}], "]"}], ",", 
        RowBox[{"Sin", "[", 
         RowBox[{"\[Pi]", "/", "6"}], "]"}]}], "}"}], "]"}], ",", 
     "cylinderLU"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeOrthogonal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], ",", 
     RowBox[{"cylinderLU_", ":", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"latticeCreateDH", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"latticeMoebiusTransform", "[", 
       RowBox[{"{", 
        RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", " ", 
      RowBox[{"{", " ", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", "cylinderLU", ",", "2"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeWithMN", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m_", ",", "n_"}], "}"}], ",", 
      RowBox[{"cylinderLU_", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2"}], ",", "3.2"}], "}"}]}]}], "]"}], " ", ":=", " ", 
    RowBox[{"latticeCreateDH", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"latticeMoebiusTransform", "[", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], "]"}], "[", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", "3", "]"}], "/", 
            RowBox[{"(", "2", ")"}]}], "-", ".25"}], ")"}]}], "}"}], "]"}], 
      ",", "cylinderLU"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n"}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855572912122774*^9, 3.8555729267175846`*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"4d546aaa-4af5-4437-873c-9c4362adc80a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeCircles", "[", "lattice_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "latticeMargin", ",", "lplus", ",", "lminus", ",", "r", ",", 
        "cylinderLU", ",", "latticep"}], "}"}], ",", 
      RowBox[{
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{
         RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"cylinderLU", " ", "=", " ", 
        RowBox[{"cylinderLU", " ", "+", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"latticeRise", "[", "lattice", "]"}]}], ",", 
           RowBox[{"latticeRise", "[", "lattice", "]"}]}], "}"}]}]}], ";", 
       RowBox[{"latticeMargin", " ", "=", " ", 
        RowBox[{"latticeSetCylinderLU", "[", 
         RowBox[{"lattice", ",", "cylinderLU"}], "]"}]}], ";", 
       RowBox[{"latticep", " ", "=", "  ", 
        RowBox[{"latticePoints", "[", "latticeMargin", "]"}]}], " ", ";", 
       RowBox[{"lplus", " ", "=", " ", 
        RowBox[{"latticep", "+", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"Length", "[", "latticep", "]"}]}], "]"}]}]}], ";", 
       RowBox[{"lminus", " ", "=", "  ", 
        RowBox[{"latticep", " ", "+", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"Length", "[", "latticep", "]"}]}], "]"}]}]}], ";", 
       RowBox[{"r", " ", "=", 
        RowBox[{"latticeDiskRadius", "[", "latticeMargin", "]"}]}], ";", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Circle", "[", 
           RowBox[{"#", ",", "r"}], "]"}], "&"}], ",", 
         RowBox[{"Join", "[", " ", 
          RowBox[{"latticep", ",", "lplus", ",", "lminus"}], "]"}]}], 
        "]"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"latticeDiskRadius", "[", "lattice_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pv1", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"pv1", " ", "=", " ", 
       RowBox[{
        RowBox[{"latticeParastichyVectors", "[", "lattice", "]"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"latticePrincipalParastichyPair", "[", "lattice", "]"}], 
         "]"}], "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{"Norm", "[", "pv1", " ", "]"}], "/", "2"}]}]}], "\n", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[259]:=",ExpressionUUID->"70d8dcc1-a612-44f2-8551-a9711e17b982"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["van Iterson regions", "Section",
 CellTags->"c:14",ExpressionUUID->"326fb5ea-9225-4cd1-a35e-623fb280064d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"viiPrimaryOpposed", "[", "mn_", "]"}], "  ", ":=", " ", 
     RowBox[{"getCircleBranch", "[", 
      RowBox[{"mn", ",", "\"\<Opposed\>\""}], "]"}]}], ";", "\n", 
    RowBox[{
     RowBox[{"viiPrimaryNonOpposed", "[", "mn_", "]"}], "  ", ":=", " ", 
     RowBox[{"getCircleBranch", "[", 
      RowBox[{"mn", ",", "\"\<NonOpposed\>\""}], "]"}]}], ";"}], "\n", "*)"}],
   "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"getCircleBranch", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m_", ",", "n_"}], "}"}], ",", "scalingFunction_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mn", ",", "angle", ",", "upperpt", ",", "lowerpt", ",", "res", ",", 
         "centre", ",", "r", ",", "theta12", ",", "branch"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mn", " ", "=", " ", 
         RowBox[{"Sort", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"branch", " ", "=", " ", 
         RowBox[{"vanItersonTouchingCirclePrimary", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"viiPrimaryIsEverNonOpposed", "[", "mn", "]"}]}], ",", 
          "\n", "\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"scalingFunction", "==", "\"\<Opposed\>\""}], ",", " ", 
            RowBox[{"Return", "[", "branch", "]"}], ",", 
            RowBox[{"Return", "[", 
             RowBox[{"Nothing", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"angle", " ", "=", " ", 
         RowBox[{"circleAngleAtLine", "[", 
          RowBox[{"branch", ",", 
           RowBox[{"viiOrthostichyD", "[", "mn", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"upperpt", " ", "=", " ", 
         RowBox[{"viiTriplePoint", "[", 
          RowBox[{"viiUpperPair", "[", "mn", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lowerpt", " ", "=", " ", 
         RowBox[{"viiTriplePoint", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"centre", ",", "r", ",", "theta12"}], "}"}], " ", "=", " ", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "branch"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"scalingFunction", "==", "\"\<NonOpposed\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Circle", "[", 
            RowBox[{"centre", ",", "r", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xyToArg", "[", 
                 RowBox[{"branch", ",", "upperpt"}], "]"}], ",", "angle"}], 
               "}"}]}]}], "]"}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"res", " ", "=", " ", 
           RowBox[{"Circle", "[", 
            RowBox[{"centre", ",", "r", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xyToArg", "[", 
                 RowBox[{"branch", ",", "lowerpt"}], "]"}], ",", "angle"}], 
               "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";"}]}], "\n", "]"}]}], ";"}], 
   "*)"}], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.855094017794074*^9, 3.8550940218015146`*^9}, 
   3.8550947390676055`*^9, {3.855536317764454*^9, 3.8555363209512033`*^9}, 
   3.8555543027938538`*^9, 3.855573410104148*^9, 3.8555735428230143`*^9, 
   3.855580962004178*^9, {3.855581021578024*^9, 3.855581079297778*^9}},
 CellLabel->
  "In[261]:=",ExpressionUUID->"0773a166-7467-4bd4-b754-8597efe2292b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"viiMNSemiCircle", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "m", ",", "n", ",", "u", ",", "v", ",", "dbar"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", " ", 
         RowBox[{"Sort", "[", "mn", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"m", "\[Equal]", "1"}], " ", "&&", " ", 
           RowBox[{"n", "\[Equal]", "1"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"InfiniteLine", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "}"}], "]"}], 
           "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "-", 
            RowBox[{"m", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", 
          RowBox[{"{", 
           RowBox[{"m", ",", "n"}], "}"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"dbar", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"n", " ", "v"}], " ", "-", " ", 
            RowBox[{"m", " ", "u"}]}], " ", ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "-", 
            RowBox[{"m", "^", "2"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{"dbar", ",", " ", "0"}], "}"}], ",", "r", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiUpperPair", "[", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "n_"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"n", "-", "m"}], "]"}], ",", 
      RowBox[{"Min", "[", 
       RowBox[{"m", ",", "n"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiPrimarySegment", "[", "mn_", "]"}], " ", ":=", "  ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"upperTP", ",", "lowerTP", ",", "m", ",", "n"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"lowerTP", ",", "upperTP"}], "}"}], " ", "=", " ", 
         RowBox[{
         "vanItersonTouchingCirclePrimaryBoundingBox", "[", "mn", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"subSegment", "[", 
         RowBox[{
          RowBox[{"viiMNSemiCircle", "[", "mn", "]"}], ",", "upperTP", ",", 
          "lowerTP"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"viiPrimarySegment", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"Line", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Sqrt]", "3"}], ")"}], "/", "2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "/", "2"}], ",", 
          RowBox[{"1", "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"\[Sqrt]", "3"}]}], ")"}]}]}], "}"}]}], "}"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"viiPrimarySegment", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", "=", " ", 
     RowBox[{"Circle", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Pi]", "/", "3"}], ",", 
         RowBox[{"\[Pi]", "/", "2"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"viiMNOrthoCircle", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "n", ",", "u", ",", "v", ",", "um", ",", "vn"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"m", ",", "n"}], "}"}], "=", " ", "mn"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"u", ",", "v"}], "}"}], " ", "=", " ", 
         RowBox[{"euclideanWindingNumberPair", "[", "mn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"um", ",", "vn"}], "}"}], " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"u", "/", "m"}], ",", 
           RowBox[{"v", "/", "n"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", " ", 
         RowBox[{
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"um", "+", "vn"}], ")"}], "/", "2"}], ",", " ", "0"}], 
           "}"}], ",", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"vn", "-", "um"}], "]"}], "/", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dr", "[", "r_", "]"}], " ", ":=", " ", 
     RowBox[{"DiscretizeRegion", "[", "r", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Clear", "[", "viiRegion", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
       "\"\<Plus\>\"", ",", 
       RowBox[{"hmax_", ":", "20"}]}], "]"}], "  ", ":=", " ", 
     RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "2"}], ",", "hmax"}], "}"}]}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
       "\"\<Minus\>\"", ",", 
       RowBox[{"hmax_", ":", "20"}]}], "]"}], " ", ":=", 
     RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Rectangle", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "hmax"}], "}"}]}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], " ", 
     ":=", 
     RowBox[{"RegionUnion", "[", 
      RowBox[{
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
         "\"\<Plus\>\""}], "]"}], ",", 
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
         "\"\<Minus\>\""}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
       "\"\<Plus\>\""}], "]"}], "  ", ":=", " ", 
     RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RegionIntersection", "[", 
        RowBox[{
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
       "\"\<Minus\>\""}], "]"}], " ", ":=", " ", 
     RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"RegionIntersection", "[", 
        RowBox[{
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"Disk", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], " ", 
     ":=", 
     RowBox[{"RegionUnion", "[", 
      RowBox[{
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
         "\"\<Plus\>\""}], "]"}], ",", 
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
         "\"\<Minus\>\""}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<All\>\""}], "]"}], " ", ":=",
      " ", 
     RowBox[{"RegionUnion", "[", 
      RowBox[{
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], 
       ",", 
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"Reverse", "@", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\"\<Ordered\>\""}], 
        "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<All\>\""}], "]"}], " ", "=",
      " ", 
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "\"\<All\>\""}], "]"}]}], ";", 
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<All\>\""}], "]"}], " ", ":=",
      " ", 
     RowBox[{"viiRegion", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiRegion", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], "]"}], " ", ":=", " ", 
    RowBox[{"viiRegion", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiRegion", "[", 
      RowBox[{"mn_", ",", "\"\<All\>\""}], "]"}], " ", ":=", " ", 
     RowBox[{"RegionUnion", "[", 
      RowBox[{
       RowBox[{"viiRegion", "[", 
        RowBox[{"mn", ",", "\"\<Ordered\>\""}], "]"}], ",", 
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"Reverse", "@", "mn"}], ",", "\"\<Ordered\>\""}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", ",", "1"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{"\"\<Fix bug with region order\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
           "\"\<Minus\>\""}], "]"}], "  ", ":=", "   ", "\[IndentingNewLine]", 
         RowBox[{"RegionIntersection", "[", " ", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"RegionDifference", "[", 
            RowBox[{
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}], ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"viiMNOrthoCircle", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", "/.", " ", 
              RowBox[{"Circle", "\[Rule]", " ", "Disk"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
           "\"\<Plus\>\""}], "]"}], "  ", ":=", "   ", "\[IndentingNewLine]", 
         RowBox[{"RegionIntersection", "[", " ", 
          RowBox[{
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "]"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"RegionDifference", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"viiMNOrthoCircle", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], "]"}], " ", "/.", " ", 
              RowBox[{"Circle", "\[Rule]", " ", "Disk"}]}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "3"], ",", "0"}], "}"}], ",", 
               FractionBox["1", "3"], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], 
         " ", ":=", 
         RowBox[{"RegionUnion", "[", 
          RowBox[{
           RowBox[{"viiRegion", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
             "\"\<Plus\>\""}], "]"}], ",", 
           RowBox[{"viiRegion", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
             "\"\<Minus\>\""}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"2", ",", "1"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], 
         " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "m", ",", "n", ",", "outer", ",", "inner1", ",", "inner2"}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"outer", " ", "=", " ", 
             RowBox[{"Rectangle", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "/", "2"}], ",", "1"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner1", " ", "=", " ", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
               FractionBox["1", "3"], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner2", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3"}], "}"}], "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"RegionDifference", "[", " ", 
             RowBox[{
              RowBox[{"RegionIntersection", "[", 
               RowBox[{"outer", ",", "inner1"}], "]"}], ",", "inner2"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], 
         " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "m", ",", "n", ",", "outer", ",", "inner1", ",", "inner2"}], 
            "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"outer", " ", "=", " ", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["1", "3"], ",", "0"}], "}"}], ",", 
               FractionBox["1", "3"], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner1", " ", "=", 
             RowBox[{"Disk", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["2", "3"], ",", "0"}], "}"}], ",", 
               FractionBox["1", "3"], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "\[Pi]"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner2", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{"2", ",", "3"}], "}"}], "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"RegionDifference", "[", 
             RowBox[{"outer", ",", 
              RowBox[{"RegionUnion", "[", 
               RowBox[{"inner1", ",", "inner2"}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "this", " ", "is", " ", "the", " ", "bit", " ", "that", " ", "will", 
          " ", "probably", " ", "work", " ", "if", " ", "i", " ", 
          RowBox[{"concentrate", ".", " ", "but"}], " ", "it", " ", 
          RowBox[{"doesn", "'"}], "t"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{"mn_", ",", "\"\<All\>\""}], "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "m", ",", "n", ",", "outer", ",", "inner", ",", "outer1", ",", 
             "outer2", ",", "inner1", ",", "inner2"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", " ", 
             RowBox[{"Sort", "[", "mn", "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"outer1", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"n", "-", "m"}], "]"}], ",", "m"}], "}"}], "]"}], "/.",
               " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            RowBox[{"outer2", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"n", "-", "m"}], "]"}], ",", "n"}], "}"}], "]"}], "/.",
               " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"euclideanDelta", "[", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "n"}], "}"}], "]"}], "\[Equal]", "1"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"outer", " ", "=", " ", 
               RowBox[{"RegionDifference", "[", 
                RowBox[{"outer2", ",", "outer1"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"outer", " ", "=", " ", 
               RowBox[{"RegionIntersection", "[", 
                RowBox[{"outer1", ",", "outer2"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"inner1", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{"m", ",", 
                 RowBox[{"n", "+", "m"}]}], "}"}], "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner2", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{"n", ",", 
                 RowBox[{"n", "+", "m"}]}], "}"}], "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner", " ", "=", " ", 
             RowBox[{"RegionUnion", "[", 
              RowBox[{"inner1", ",", "inner2"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"RegionDifference", "[", 
             RowBox[{"outer", ",", "inner"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{"mn_", ",", "\"\<Ordered\>\""}], "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n", ",", "outer", ",", "inner"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "n"}], "}"}], "=", "mn"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"outer", " ", "=", " ", 
             RowBox[{"viiRegion", "[", 
              RowBox[{"mn", ",", "\"\<All\>\""}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"inner", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNSemiCircle", "[", 
               RowBox[{"{", 
                RowBox[{"m", ",", "n"}], "}"}], "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"m", "<", "n"}], ",", "\[IndentingNewLine]", 
              RowBox[{"RegionDifference", "[", 
               RowBox[{"outer", ",", "inner"}], "]"}], "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"RegionIntersection", "[", 
               RowBox[{"outer", ",", "inner"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"viiRegion", "[", 
          RowBox[{"mn_", ",", "\"\<Ordered\>\"", ",", "sign_"}], "]"}], " ", ":=",
          " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n", ",", "outer", ",", "inner"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"outer", " ", "=", "  ", 
             RowBox[{"viiRegion", "[", 
              RowBox[{"mn", ",", "\"\<Ordered\>\""}], "]"}]}], ";", 
            RowBox[{"inner", " ", "=", " ", 
             RowBox[{
              RowBox[{"viiMNOrthoCircle", "[", "mn", "]"}], "/.", " ", 
              RowBox[{"Circle", "\[Rule]", "Disk"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"sign", "\[Equal]", "\"\<Minus\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"RegionDifference", "[", 
               RowBox[{"outer", ",", "inner"}], "]"}], "\[IndentingNewLine]", 
              ",", "\[IndentingNewLine]", 
              RowBox[{"RegionIntersection", "[", 
               RowBox[{"outer", ",", "inner"}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", ")"}]}], 
     RowBox[{"(*", " ", 
      RowBox[{
      "end", " ", "of", " ", "code", " ", "unused", " ", "cos", " ", "of", 
       " ", "bug"}], " ", "*)"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "tRegionBase", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tRegionBase", "[", 
      RowBox[{"\"\<Ordered\>\"", ",", " ", "sign_"}], "]"}], " ", ":=", "  ", 
     RowBox[{
      RowBox[{"tRegionBase", "[", 
       RowBox[{"\"\<Ordered\>\"", ",", " ", "sign"}], "]"}], " ", "=", " ", 
      RowBox[{"regionToPolygon", "[", 
       RowBox[{"DiscretizeRegion", "[", 
        RowBox[{"viiRegion", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\"", ",", 
          "sign"}], "]"}], "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tRegionBase", "[", "\"\<Ordered\>\"", "]"}], " ", ":=", "  ", 
     RowBox[{
      RowBox[{"tRegionBase", "[", "\"\<Ordered\>\"", "]"}], " ", "=", " ", 
      RowBox[{"regionToPolygon", "[", 
       RowBox[{"DiscretizeRegion", "[", 
        RowBox[{"viiRegion", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<Ordered\>\""}], "]"}], 
        "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tRegionBase", "[", "\"\<All\>\"", "]"}], " ", ":=", "  ", 
     RowBox[{
      RowBox[{"tRegionBase", "[", "\"\<All\>\"", "]"}], " ", "=", " ", 
      RowBox[{"regionToPolygon", "[", "\[IndentingNewLine]", 
       RowBox[{"DiscretizeRegion", "[", 
        RowBox[{"viiRegion", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0"}], "}"}], ",", "\"\<All\>\""}], "]"}], "]"}],
        "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"transformPolygon", "[", 
      RowBox[{"poly_", ",", "function_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Polygon", "[", " ", 
      RowBox[{"function", "  ", "/@", " ", 
       RowBox[{"(", 
        RowBox[{"First", "@", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "poly"}], "]"}]}], ")"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"special", " ", "case"}], " ", "*)"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiPolygon", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", "args__"}], "]"}], " ", ":=", 
     "  ", 
     RowBox[{"regionToPolygon", "[", 
      RowBox[{"DiscretizeRegion", "[", 
       RowBox[{"viiRegion", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "args"}], "]"}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"base", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiPolygon", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", "args__"}], "]"}], " ", ":=", 
    "  ", 
    RowBox[{"tRegionBase", "[", "args", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"transform", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiPolygon", "[", 
     RowBox[{"mn_", ",", "args__"}], "]"}], " ", ":=", "  ", 
    RowBox[{"transformPolygon", "[", 
     RowBox[{
      RowBox[{"tRegionBase", "[", "args", "]"}], ",", 
      RowBox[{"gMNInDHalf", "[", "mn", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"viiPolygon", "[", "mn_", "]"}], " ", ":=", " ", 
    RowBox[{"viiPolygon", "[", 
     RowBox[{"mn", ",", "\"\<All\>\""}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiTriplePoint", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiTriplePoint", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}], " ", ":=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], "}"}]}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"algo", " ", "gives", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", "/", "2"}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}]}], ")"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiLabelPoint", "[", "mn_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], "/", 
         RowBox[{"(", 
          RowBox[{"5", "/", "2"}], ")"}]}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiTouchingCircleLabel", "[", "mn_", "]"}], " ", ":=", "  ", 
     RowBox[{
      RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"viiTouchingCircleLabelNonPrimary", "[", "mn_", "]"}], " ", ":=",
      "  ", 
     RowBox[{
      RowBox[{"gMNInDHalf", "[", "mn", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sqrt", "[", "3", "]"}]}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.854689547605377*^9, 3.8546895502960806`*^9}, {
   3.85468966864818*^9, 3.8546898676523952`*^9}, {3.85469014191934*^9, 
   3.8546901697139645`*^9}, {3.8550940503491197`*^9, 
   3.8550940641345634`*^9}, {3.8550941238112783`*^9, 3.8550941321018147`*^9}, 
   3.8551590340464087`*^9, 3.8553088293363695`*^9, 3.855536270422347*^9, 
   3.855536615896058*^9, 3.855536763608198*^9, 3.855536858539434*^9, 
   3.855536917013774*^9, 3.8555537937987375`*^9, 3.8555809966807613`*^9, {
   3.855642832196293*^9, 3.8556428340632167`*^9}, 3.855644150706664*^9, 
   3.855697923737864*^9, {3.855701948382531*^9, 3.855701949365902*^9}, {
   3.8557020678440347`*^9, 3.8557020741315975`*^9}},
 CellLabel->
  "In[262]:=",ExpressionUUID->"4094927b-6dd3-45bb-ab30-bbdb351c5e41"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"viiTouchingCircleLabelNonPrimary", "[", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "]"}], " ", "=", " ", 
    RowBox[{
     RowBox[{"gMNInDHalf", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", "3", "]"}], "/", "2"}], ",", 
       RowBox[{"1", "/", "2"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[290]:=",ExpressionUUID->"140214a0-1d4a-4a6e-beac-e216872603b6"],

Cell[CellGroupData[{

Cell["Get Region and Transform to work together", "Subsection",
 CellTags->"c:15",ExpressionUUID->"7151a561-8371-40cf-b9d7-0e40d21a4a5a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "11430"}], "/", "why"}], "-", "doesnt", "-", 
     "normal", "-", "work", "-", "on", "-", "geometrictransformation"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "at", " ", "one", " ", "point", " ", "this", " ", "was", " ", "needed"}], 
    " ", "-", " ", 
    RowBox[{"may", " ", "not", " ", "be", " ", "at", " ", "present"}]}], " ", 
   "*)"}], " ", "\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NormalizeGraphics", "[", "g_", "]"}], ":=", 
    RowBox[{"Internal`InheritedBlock", "[", 
     RowBox[{
      RowBox[{"{", "System`Private`InternalNormal", "}"}], ",", 
      RowBox[{
       RowBox[{"Unprotect", "[", "System`Private`InternalNormal", "]"}], ";", 
       "\n", 
       RowBox[{
        RowBox[{"System`Private`InternalNormal", "[", 
         RowBox[{
          RowBox[{"gr", ":", 
           RowBox[{
           "_Rotate", "|", "_Translate", "|", "_Scale", "|", 
            "_GeometricTransformation"}]}], ",", "_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"tmp", "=", 
            RowBox[{"Quiet", "[", 
             RowBox[{
              RowBox[{"transform2D", "[", "gr", "]"}], ",", 
              RowBox[{"TransformedRegion", "::", "reg"}]}], "]"}]}], "}"}], 
          ",", 
          RowBox[{"tmp", "/;", 
           RowBox[{
            RowBox[{"Head", "[", "tmp", "]"}], "=!=", 
            "TransformedRegion"}]}]}], "]"}]}], ";", "\n", 
       RowBox[{"Normal", "[", 
        RowBox[{"g", ",", 
         RowBox[{"{", 
          RowBox[{
          "Rotate", ",", "Scale", ",", "Translate", ",", 
           "GeometricTransformation"}], "}"}]}], "]"}]}]}], "]"}]}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"transform2D", "[", 
     RowBox[{"Rotate", "[", 
      RowBox[{"g_", ",", "r_", ",", "p___"}], "]"}], "]"}], ":=", 
    RowBox[{"TransformedRegion", "[", 
     RowBox[{"g", ",", 
      RowBox[{"RotationTransform", "[", 
       RowBox[{"r", ",", 
        RowBox[{"absolutePosition", "[", 
         RowBox[{"g", ",", "p"}], "]"}]}], "]"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"transform2D", "[", 
     RowBox[{"Translate", "[", 
      RowBox[{"g_", ",", "t_"}], "]"}], "]"}], ":=", 
    RowBox[{"TransformedRegion", "[", 
     RowBox[{"g", ",", 
      RowBox[{"TranslationTransform", "[", "t", "]"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"transform2D", "[", 
     RowBox[{"Scale", "[", 
      RowBox[{"g_", ",", "s_", ",", "p___"}], "]"}], "]"}], ":=", 
    RowBox[{"TransformedRegion", "[", 
     RowBox[{"g", ",", 
      RowBox[{"ScalingTransform", "[", 
       RowBox[{"s", ",", 
        RowBox[{"absolutePosition", "[", 
         RowBox[{"g", ",", "p"}], "]"}]}], "]"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"transform2D", "[", 
     RowBox[{"GeometricTransformation", "[", 
      RowBox[{"g_", ",", "tf_"}], "]"}], "]"}], ":=", 
    RowBox[{"TransformedRegion", "[", 
     RowBox[{"g", ",", 
      RowBox[{"tf", "/.", 
       RowBox[{
        RowBox[{"Except", "[", "_TransformationRegion", "]"}], ":>", 
        RowBox[{"AffineTransform", "[", "tf", "]"}]}]}]}], "]"}]}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"absolutePosition", "[", "g_", "]"}], ":=", 
    RowBox[{"absolutePosition", "[", 
     RowBox[{"g", ",", 
      RowBox[{"{", 
       RowBox[{"Center", ",", "Center"}], "}"}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"absolutePosition", "[", 
     RowBox[{"g_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"h", ":", 
         RowBox[{"(", 
          RowBox[{"Left", "|", "Center", "|", "Right"}], ")"}]}], ",", 
        RowBox[{"v", ":", 
         RowBox[{"(", 
          RowBox[{"Top", "|", "Center", "|", "Bottom"}], ")"}]}]}], "}"}]}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"hrange", ",", "vrange"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"hrange", ",", "vrange"}], "}"}], "=", 
        RowBox[{
         RowBox[{"RegionBounds", "[", "g", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{";;", "2"}], "]"}], "]"}]}], ";", "\n", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"h", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Left", "->", "Min"}], ",", 
              RowBox[{"Center", "->", "Mean"}], ",", 
              RowBox[{"Right", "->", "Max"}]}], "}"}]}], "]"}], "[", "hrange",
           "]"}], ",", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"v", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Bottom", "->", "Min"}], ",", 
              RowBox[{"Center", "->", "Mean"}], ",", 
              RowBox[{"Top", "->", "Max"}]}], "}"}]}], "]"}], "[", "vrange", 
          "]"}]}], "}"}]}]}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"absolutePosition", "[", 
     RowBox[{"g_", ",", "spec_"}], "]"}], ":=", "spec"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[291]:=",ExpressionUUID->"6ee4c1a5-230a-49d0-bc04-e3bbf8f6a143"]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Noneuclidean lattices", "Chapter",
 CellTags->"c:7",ExpressionUUID->"31f5f89c-75cc-447a-a7cf-89500a98046e"],

Cell["\<\
scalingFunction is the name of a z - stretch function stored in the lattice
For Disk this will be used to map the cylinder onto a disk
For StemStretch onto a z-stretched cylinder
For Arena a general x-z map
\
\>", "Text",ExpressionUUID->"98245449-c76f-4385-9e97-7b621caa1344"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeSetScaling", "[", 
    RowBox[{"lattice_", ",", "funcNameValue_"}], "]"}], " ", ":=", " ", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", "lattice"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "[", "\"\<scalings\>\"", "]"}], " ", "=", " ", 
       RowBox[{"AppendTo", "[", 
        RowBox[{
         RowBox[{"res", "[", "\"\<scalings\>\"", "]"}], ",", 
         "funcNameValue"}], "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeScaling", "[", 
     RowBox[{"lattice_", ",", "scalingFunction_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", " ", "=", " ", 
        RowBox[{
         RowBox[{"lattice", "[", "\"\<scalings\>\"", "]"}], "[", 
         "scalingFunction", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MissingQ", "[", "res", "]"}], ",", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<No \>\"", ",", " ", "scalingFunction", " ", ",", " ", 
           "\"\< scaling set\>\""}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"latticeParastichyFunctions", "[", 
     RowBox[{"lattice_", ",", "m_", ",", "k_", ",", "scalingFunction_"}], 
     "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "cylinderLU", ",", "xInner", ",", "xOuter", ",", "data", ",", "xzfunc",
         ",", "scalefunc", ",", "funcs", ",", "interp", ",", "segments"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"scalefunc", " ", "=", " ", 
        RowBox[{"latticeScaling", "[", 
         RowBox[{"lattice", ",", "scalingFunction"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"scalingFunction", "\[Equal]", "\"\<Disk\>\""}], ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"mapping", " ", "to", " ", "periodic", " ", "coordinates"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"cylinderLU", "=", " ", 
           RowBox[{"latticeGetNodeCylinderLU", "[", "lattice", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xOuter", " ", "=", " ", 
           RowBox[{
            RowBox[{"latticeParastichyCylinderIntersection", "[", 
             RowBox[{"lattice", ",", "m", ",", "Bottom"}], "]"}], "+", " ", 
            RowBox[{"k", " ", "*", " ", 
             RowBox[{"latticeParastichyHorizontalSeparation", "[", 
              RowBox[{"lattice", ",", "m"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"xInner", " ", "=", " ", 
           RowBox[{"xOuter", " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "cylinderLU", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "-", 
               RowBox[{
               "cylinderLU", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ")"}], "/", 
             RowBox[{"latticeParastichySlope", "[", 
              RowBox[{"lattice", ",", "m"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"data", " ", "=", " ", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"{", " ", 
              RowBox[{
               RowBox[{"{", "0", "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"xOuter", ",", 
                 RowBox[{
                 "cylinderLU", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"xInner", ",", 
                 RowBox[{
                 "cylinderLU", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "}"}]}], "}"}]}], "}"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"xzfunc", " ", "=", " ", 
           RowBox[{"Interpolation", "[", 
            RowBox[{"data", ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"funcs", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", "t", "}"}], ",", 
              RowBox[{"scalefunc", "[", 
               RowBox[{"xzfunc", "[", "t", "]"}], "]"}]}], "]"}], "}"}]}], 
          ";"}], "\[IndentingNewLine]", ",", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"for", " ", "\"\<Arena\>\""}], ",", " ", 
           "\"\<StemStretch\>\"", ",", " ", 
           RowBox[{
           "need", " ", "the", " ", "image", " ", "of", " ", "the", " ", 
            "parastichy", " ", "line", " ", "in", " ", "the", " ", 
            "cylinder"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"segments", " ", "=", 
            RowBox[{"First", "[", 
             RowBox[{"List", "@@", 
              RowBox[{"latticeParastichyLinesAbove", "[", 
               RowBox[{"lattice", ",", "m", ",", "k"}], "]"}]}], "]"}]}], 
           ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"segments", " ", "=", 
           RowBox[{"First", "[", 
            RowBox[{"List", "@@", 
             RowBox[{"latticeParastichyLines", "[", 
              RowBox[{"lattice", ",", "m", ",", "k"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"interp", "[", "seg_", "]"}], ":=", " ", 
           RowBox[{"Function", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "seg", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               RowBox[{"(", 
                RowBox[{"1", "-", "t"}], ")"}]}], "+", " ", 
              RowBox[{
               RowBox[{
               "seg", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               " ", "t"}]}]}], " ", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"funcs", " ", "=", " ", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{"t", ",", 
                RowBox[{"scalefunc", "[", 
                 RowBox[{
                  RowBox[{"interp", "[", "#", "]"}], "[", "t", "]"}], "]"}]}],
                "]"}], "&"}], ",", "segments"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "funcs"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[299]:=",ExpressionUUID->"910b2c6f-1be3-43dd-9ff6-2f9a62ab6b83"],

Cell[CellGroupData[{

Cell["Stem shape functions", "Section",
 CellTags->"c:17",ExpressionUUID->"ed8ddcf0-71d9-4eac-80ea-60c4e1cffce2"],

Cell["Probably need to be rewritten but used by Goethe", "Text",ExpressionUUID->"abacfbd2-49da-4c99-aed0-4e55aaac23b3"],

Cell["\<\
u, goes from 0 to 1 as angular parameter, 
v goes from 0 to 1 while s goes from 0 to smax while z goes over cylinderLU
s is the arc length measured along the boudary of the bulge=arc length in \
vertical direction on surface
map between s and v (hence z) is nonlinear for curved radius=circumference /2\
\[Pi]  functions
a rise of 1 in base (x,z) lattice is an increase of s by 1 in (u,s) lattice \
\>", "Text",ExpressionUUID->"eb1d524f-5a93-4aca-a40c-07f2c9c89878"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "stemAddShape", "]"}], ";", 
    RowBox[{
     RowBox[{"stemAddShape", "[", 
      RowBox[{"lattice_", ",", "circumferenceFunction_", ",", 
       RowBox[{"unrolling_", ":", "1"}]}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "stem", ",", "surfaceFunctionUV", ",", "displayCylinder", ",", 
         "vFunctionArcLength", ",", "xyScaling", ",", "radius", ",", "rmax"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stem", " ", "=", "  ", 
         RowBox[{"Append", "[", 
          RowBox[{"lattice", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<circumferenceFunctionV\>\"", "->", "circumferenceFunction"}],
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"vFunctionArcLength", " ", "=", " ", 
         RowBox[{"tcalcStemVofS", "[", "stem", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "hide", " ", "gory", " ", "details", " ", "behinf", " ", "local", 
          " ", "var", " ", "name"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"stem", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"stem", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<vArcLengthInverseS\>\"", "->", " ", "vFunctionArcLength"}], 
            "}"}]}], "]"}]}], ";", 
        RowBox[{"stem", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"stem", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<arcLengthSRange\>\"", "->", " ", 
             RowBox[{"N", "@", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{
                 RowBox[{"stemSOfV", "[", "stem", "]"}], "[", "1", "]"}]}], 
               "}"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"surfaceFunctionUV", " ", "=", " ", 
         RowBox[{"stemMakeSurfaceFunctionUV", "[", 
          RowBox[{"stem", ",", "unrolling"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"stem", " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{"stem", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<surfaceXYZofUV\>\"", "->", " ", "surfaceFunctionUV"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"displayCylinder", " ", "=", " ", 
         RowBox[{"latticeGetCylinder", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rmax", " ", "=", 
         RowBox[{"tFindMaxRadius", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"displayCylinder", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "rmax"}], ",", "rmax"}], "}"}], ",", " ", 
           RowBox[{"MinMax", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"surfaceFunctionUV", "[", 
                RowBox[{"0", ",", "0"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"surfaceFunctionUV", "[", 
                RowBox[{"0", ",", "1"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], "}"}]}], ";", 
        RowBox[{"stem", " ", "=", " ", 
         RowBox[{"latticeSetDisplayCylinder", "[", 
          RowBox[{"stem", ",", "displayCylinder"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "stem"}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stemShapeFunctionUV", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"stem", "[", "\"\<surfaceXYZofUV\>\"", "]"}]}], ";"}], " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stemRadiusFunctionV", "[", "stem_", "]"}], " ", ":=", 
     RowBox[{"Function", "[", 
      RowBox[{"v", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"stem", "[", "\"\<circumferenceFunctionV\>\"", "]"}], "[", 
         "v", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "\[Pi]"}], ")"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stemVofS", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"stem", "[", "\"\<vArcLengthInverseS\>\"", "]"}]}], ";"}], " ", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stemSetDisplayRadius", "[", 
      RowBox[{"stem_", ",", "radius_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "displayCylinder", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"displayCylinder", " ", "=", " ", 
         RowBox[{"latticeGetCylinder", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"displayCylinder", "[", 
          RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
         RowBox[{"1.05", "*", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "radius"}], ",", "radius"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"latticeSetDisplayCylinder", "[", 
         RowBox[{"stem", ",", "displayCylinder"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"tFindMaxRadius", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"radius", ",", "rmax"}], "}"}], ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"often", " ", "fails"}], "..."}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"radius", "[", 
          RowBox[{"v_", "?", "NumericQ"}], "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{"stemRadiusFunctionV", "[", "stem", "]"}], "[", "v", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Off", "[", 
         RowBox[{
          RowBox[{"NIntegrate", "::", "inumr"}], ",", 
          RowBox[{"Interpolation", "::", "indat"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rmax", " ", "=", 
         RowBox[{"1.05", " ", "*", " ", 
          RowBox[{
           RowBox[{"FindMaximum", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"radius", "[", "v", "]"}], ",", 
               RowBox[{"0", "<", " ", "v", "<", "1"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"v", ",", 
               RowBox[{"1", "/", "2"}]}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"On", "[", 
         RowBox[{
          RowBox[{"NIntegrate", "::", "inumr"}], ",", 
          RowBox[{"Interpolation", "::", "indat"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "rmax"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\n"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[302]:=",ExpressionUUID->"66e2aad7-8082-45bd-b590-744c333e3e65"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "true", " ", "but", " ", "not", " ", "needed", "\[IndentingNewLine]", 
      RowBox[{"stemRadiusFunctionS", "[", "stem_", "]"}]}], " ", ":=", 
     RowBox[{"Function", "[", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{"stemRadiusFunctionV", "[", "stem", "]"}], "[", 
        RowBox[{
         RowBox[{"stem", "[", "\"\<vArcLengthInverseS\>\"", "]"}], "[", "s", 
         "]"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "work", " ", "in", " ", "arc", " ", "length", " ", "parameter", " ", "s"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"stemSOfV", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"func", "=", 
         RowBox[{"stemRadiusFunctionV", "[", "stem", "]"}]}], "}"}], ",", " ", 
       RowBox[{"Function", "[", 
        RowBox[{
         RowBox[{"{", "v", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "s", "}"}], ",", 
           RowBox[{"N", "@", 
            RowBox[{"ArcLength", "[", 
             RowBox[{
              RowBox[{"func", "[", "s", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "0", ",", "v"}], "}"}]}], "]"}]}]}], "]"}]}],
         "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "invert", " ", "*)"}], " ", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"tcalcStemVofS", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "sofVTable", "}"}], ",", "\n", "      ", 
       RowBox[{"(*", " ", 
        RowBox[{"maps", " ", 
         RowBox[{"(", 
          RowBox[{"0", ",", "smax"}], " ", ")"}], " ", "to", " ", 
         RowBox[{"(", 
          RowBox[{"0", ",", "1"}], ")"}]}], "  ", "*)"}], " ", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"sofVTable", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"stemSOfV", "[", "stem", "]"}], "[", "v", "]"}], ",", 
             "v"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"v", ",", "0", ",", "1", ",", "0.01"}], "}"}]}], "]"}]}], 
        ";", 
        RowBox[{"Interpolation", "[", "sofVTable", "]"}]}]}], " ", 
      RowBox[{"(*", " ", 
       RowBox[{"store", " ", "instance", " ", "stem", 
        RowBox[{"<|", "|>"}], " ", "so", " ", "we", " ", 
        RowBox[{"don", "'"}], "t", " ", "recalculate"}], " ", "*)"}], " ", 
      "\n", "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stemMakeSurfaceFunctionUV", "[", 
      RowBox[{"stem_", ",", "unrolling_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cylinderLU", ",", "surfaceCylinderLU", ",", "r", ",", "smax", ",", 
         "func"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"smax", " ", "=", " ", 
         RowBox[{
          RowBox[{"stem", "[", "\"\<arcLengthSRange\>\"", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cylinderLU", " ", "=", 
         RowBox[{"latticeGetNodeCylinderLU", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"surfaceCylinderLU", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"cylinderLU", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", "smax"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"r", " ", "=", " ", 
         RowBox[{"stemRadiusFunctionV", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "a", " ", "radius", " ", "function", " ", "of", " ", "1", " ", 
           "will", " ", "correspond", " ", "to", " ", "a", " ", "cylinder", 
           " ", "with", " ", "circumference", "  ", "2", " ", "pi"}], "  ", 
          ".."}], " ", "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "allow", " ", "it", " ", "to", " ", "be", " ", "a", " ", 
          "rolled", " ", "cylinder"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"unroll", "[", "s_", "]"}], " ", ":=", " ", 
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "offset", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"offset", " ", "=", " ", 
             RowBox[{
              RowBox[{"\[Pi]", " ", "s"}], " ", "+", 
              RowBox[{"\[Pi]", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Function", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"u", ",", "v"}], "}"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"r", "[", "v", "]"}], "*", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"1", "/", "s"}]}], "}"}], "+", 
                   RowBox[{
                    RowBox[{"1", "/", "s"}], " ", "*", " ", 
                    RowBox[{"{", " ", 
                    RowBox[{
                    RowBox[{"Cos", "[", " ", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Pi]", "  ", "s", " ", "u"}], "   ", 
                    "-", "offset"}], " ", "]"}], ",", "  ", 
                    RowBox[{"Sin", "[", " ", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Pi]", " ", "s", " ", "u"}], " ", "-",
                     "offset"}], "]"}]}], "}"}]}]}], ")"}]}], ",", " ", 
                RowBox[{"tHeightFunctionCylinder", "[", 
                 RowBox[{"surfaceCylinderLU", ",", "v"}], "]"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"unroll", "[", "0", "]"}], " ", "=", " ", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "v"}], "}"}], ",", 
           RowBox[{"2", "*", "\[Pi]", " ", "*", " ", 
            RowBox[{"r", "[", "v", "]"}], "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"u", "-", 
                RowBox[{"1", "/", "2"}]}], ")"}], ",", "0"}], "}"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"func", "  ", "=", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"unrolling", "==", "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"u", ",", "v"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"r", "[", "v", "]"}], " ", "*", " ", 
                RowBox[{"Cos", "[", " ", 
                 RowBox[{"2", " ", "\[Pi]", " ", "u"}], "]"}]}], ",", " ", 
               RowBox[{
                RowBox[{"r", "[", "v", "]"}], " ", "*", " ", 
                RowBox[{"Sin", "[", " ", 
                 RowBox[{"2", " ", "\[Pi]", " ", "u"}], "]"}]}], ",", " ", 
               RowBox[{"tHeightFunctionCylinder", "[", 
                RowBox[{"surfaceCylinderLU", ",", "v"}], "]"}]}], "}"}]}], 
            " ", "]"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
           RowBox[{"unroll", "[", "unrolling", "]"}]}], "\[IndentingNewLine]",
           "]"}]}], ";", "\[IndentingNewLine]", "func"}]}], "\n", "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"tHeightFunctionCylinder", "[", 
      RowBox[{"cylinderLU_", ",", "v_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"cylinderLU", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "+", " ", 
      RowBox[{"v", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"cylinderLU", "[", 
          RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
         RowBox[{"cylinderLU", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tSFunctionCylinder", "[", 
     RowBox[{"cylinderLU_", ",", "h_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"h", "-", 
       RowBox[{"cylinderLU", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"cylinderLU", "[", 
        RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
       RowBox[{"cylinderLU", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"stemSurfaceFunctionUS", "[", "stem_", "]"}], " ", ":=", " ", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"surfaceFunction", ",", "sFunction"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"surfaceFunction", " ", "=", " ", 
          RowBox[{"stem", "[", "\"\<surfaceXYZofUV\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"sFunction", " ", "=", " ", 
          RowBox[{"stem", "[", "\"\<vArcLengthInverseS\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Function", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"u", ",", "s"}], "}"}], ",", 
           RowBox[{"surfaceFunction", "[", 
            RowBox[{"u", ",", 
             RowBox[{"sFunction", "[", "s", "]"}]}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\n", "\n", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\n", 
     RowBox[{
      RowBox[{"stemShapeFunctionUS", "[", "stem_", "]"}], " ", ":=", " ", 
      RowBox[{"Function", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "s"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stemShapeFunctionUV", "[", "stem", "]"}], "[", 
         RowBox[{"u", ",", 
          RowBox[{
           RowBox[{"stem", "[", "\"\<vArcLengthInverseS\>\"", "]"}], "[", "s",
            "]"}]}], "]"}]}], "\n", "]"}]}], ";", "\n", "\n", 
     RowBox[{
      RowBox[{"stemShapeLU", "[", "lattice_", "]"}], " ", ":=", " ", 
      RowBox[{"MinMax", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
           RowBox[{"0", ",", "0"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";"}], "\n", 
    "\[IndentingNewLine]", "\n", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\n"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[308]:=",ExpressionUUID->"9e4f3636-5a29-406a-940e-387e6a02b4a2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"stemParastichyOfV", "[", 
       RowBox[{"stem_", ",", "m_", ",", "n_"}], "]"}], "[", "v_", "]"}], " ", 
     ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dL", ",", "pslope", ",", "h", ",", "vscale", ",", "shapeLU"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dL", " ", "=", " ", 
         RowBox[{
          RowBox[{"latticeParastichyCylinderIntersection", "[", 
           RowBox[{"stem", ",", "m", ",", "Bottom"}], "]"}], "+", 
          RowBox[{"n", "*", 
           RowBox[{"latticeParastichyHorizontalSeparation", "[", 
            RowBox[{"stem", ",", "m"}], "]"}]}]}]}], ";", 
        RowBox[{"pslope", " ", "=", " ", 
         RowBox[{"latticeParastichySlope", "[", 
          RowBox[{"stem", ",", "m"}], "]"}]}], ";", 
        RowBox[{"shapeLU", " ", "=", 
         RowBox[{"stemShapeLU", "[", "stem", "]"}]}], ";", 
        RowBox[{"vscale", " ", "=", " ", 
         RowBox[{
          RowBox[{"shapeLU", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"shapeLU", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
         "h", " ", "ranges", " ", "over", " ", "this", " ", "as", " ", "v", 
          " ", "goes", " ", "from", " ", "0", " ", "to", " ", "1"}], " ", 
         "*)"}], " ", "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", "  ", 
         RowBox[{"v", " ", "*", " ", "vscale"}]}], " ", ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"stemPositionDH", "[", 
         RowBox[{"stem", ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"dL", " ", "+", 
             RowBox[{"h", " ", "/", "pslope"}]}], ",", "h"}], "}"}]}], 
         "]"}]}]}], " ", "\n", "]"}]}], ";"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"stemParastichyOfV", "[", 
       RowBox[{"stem_", ",", "m_", ",", "n_"}], "]"}], "[", "v_", "]"}], " ", 
     ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "s", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", " ", "=", "  ", 
         RowBox[{
          RowBox[{"stemSOfV", "[", "stem", "]"}], "[", "v", "]"}]}], ";", " ",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stemParastichyOfS", "[", 
          RowBox[{"stem", ",", "m", ",", "n"}], "]"}], "[", "s", "]"}]}]}], 
      " ", "\n", "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"stemParastichyOfS", "[", 
       RowBox[{"stem_", ",", "m_", ",", "n_"}], "]"}], "[", "s_", "]"}], " ", 
     ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dL", ",", "pslope", ",", "h", ",", "baseCylinderLU", ",", "smax", 
         ",", "u", ",", "v"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dL", " ", "=", " ", 
         RowBox[{
          RowBox[{"latticeParastichyCylinderIntersection", "[", 
           RowBox[{"stem", ",", "m", ",", "Bottom"}], "]"}], "+", 
          RowBox[{"n", "*", 
           RowBox[{"latticeParastichyHorizontalSeparation", "[", 
            RowBox[{"stem", ",", "m"}], "]"}]}]}]}], ";", 
        RowBox[{"pslope", " ", "=", " ", 
         RowBox[{"latticeParastichySlope", "[", 
          RowBox[{"stem", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"baseCylinderLU", " ", "=", " ", 
         RowBox[{"latticeGetNodeCylinderLU", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"smax", " ", "=", " ", 
         RowBox[{
          RowBox[{"stem", "[", "\"\<arcLengthSRange\>\"", "]"}], "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", " ", "=", "  ", 
         RowBox[{
          RowBox[{"s", "/", "smax"}], " ", "*", "  ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "baseCylinderLU", " ", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], "-", " ", 
            RowBox[{
            "baseCylinderLU", " ", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ")"}]}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"u", " ", "=", "  ", 
         RowBox[{"dL", " ", "+", 
          RowBox[{"h", " ", "/", "pslope"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"u", "  ", "=", " ", 
         RowBox[{"u", " ", "-", " ", 
          RowBox[{"Round", "[", "u", "]"}], "+", 
          RowBox[{"1", "/", "2"}]}]}], " ", ";", "\[IndentingNewLine]", 
        RowBox[{"v", " ", "=", " ", 
         RowBox[{
          RowBox[{"stemVofS", "[", "stem", "]"}], "[", "s", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stemShapeFunctionUV", "[", "stem", "]"}], "[", " ", 
         RowBox[{"u", ",", "v"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"stemDHToUV", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", "dh", "}"}], ",", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "d", ",", "h", ",", "u", ",", "s", ",", "v", ",", "cylinderLU"}], 
          "}"}], ",", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{
           "dh", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ";", 
          RowBox[{"h", "=", 
           RowBox[{
           "dh", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"u", " ", "=", " ", 
           RowBox[{"d", " ", "-", " ", 
            RowBox[{"Round", "[", "d", "]"}], "+", 
            RowBox[{"1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"cylinderLU", " ", "=", 
           RowBox[{"latticeGetNodeCylinderLU", "[", "stem", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"smax", " ", "=", "  ", 
           RowBox[{
            RowBox[{"stem", "[", "\"\<arcLengthSRange\>\"", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"s", " ", "=", " ", 
           RowBox[{"smax", "*", 
            RowBox[{"tSFunctionCylinder", "[", 
             RowBox[{"cylinderLU", ",", "h"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", " ", 
           RowBox[{
            RowBox[{"stemVofS", "[", "stem", "]"}], "[", "s", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"u", ",", "v"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}],
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"stemPoints", "[", "stem_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"basePoints", ",", "uvPoints", ",", "uvToXYZ"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"basePoints", " ", "=", " ", 
         RowBox[{"latticeNamedPoints", "[", "stem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"uvPoints", " ", "=", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{"stemDHToUV", "[", "stem", "]"}], ",", "basePoints"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"uvToXYZ", " ", "[", 
          RowBox[{"{", 
           RowBox[{"u_", ",", "v_"}], "}"}], "]"}], " ", ":=", " ", 
         RowBox[{
          RowBox[{"stemShapeFunctionUV", "[", "stem", "]"}], "[", " ", 
          RowBox[{"u", ",", "v"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{"uvToXYZ", ",", "uvPoints"}], "]"}]}]}], "\n", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[313]:=",ExpressionUUID->"2cffcd16-486f-4a8f-a49c-774e91d06a08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"stemPointsUpToV", "[", 
      RowBox[{"lattice_", ",", "v_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pts", "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"pts", " ", "=", " ", 
         RowBox[{"stemPoints", "[", "lattice", "]"}]}], ";", "\n", 
        RowBox[{"Select", "[", 
         RowBox[{"pts", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], " ", "<", "   ", 
            RowBox[{
             RowBox[{
              RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
              RowBox[{"0", ",", "v"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}]}], "\n", 
      "]"}]}], ";"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"stemArcPointsUpToV", "[", 
      RowBox[{"lattice_", ",", "v_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "pts", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"pts", " ", "=", " ", 
         RowBox[{"stemArcPoints", "[", "lattice", "]"}]}], ";", 
        RowBox[{"Select", "[", 
         RowBox[{"pts", ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Last", "[", "#", "]"}], " ", "<", "   ", 
            RowBox[{
             RowBox[{
              RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
              RowBox[{"0", ",", "v"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}]}], "\n", 
      "]"}]}], ";", "\n", "\n", "\n", "\n", 
    RowBox[{
     RowBox[{"stemArcPoints", "[", "lattice_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"cylinderLU", ",", "shapeLU", ",", "subLattice"}], "}"}], ",",
        "\n", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"display", " ", "points", " ", "with", " ", "0"}], "<", "v",
           "<", " ", 
          RowBox[{
          "1", " ", "\n", "but", " ", "map", " ", "h", " ", "to", " ", 
           "arclength", " ", "s"}]}], ",", " ", 
         RowBox[{"not", " ", "v"}], ",", " ", 
         RowBox[{
         "so", " ", "need", " ", "a", " ", "slightly", " ", "taller", " ", 
          "lattice"}]}], " ", "*)"}], "\n", 
       RowBox[{
        RowBox[{"cylinderLU", "=", " ", 
         RowBox[{"latticeGetNodeCylinderLU", "[", "lattice", "]"}]}], ";", 
        "\n", 
        RowBox[{"shapeLU", " ", "=", " ", 
         RowBox[{"MinMax", "@", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
              RowBox[{"0", ",", "0"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"stemShapeFunctionUV", "[", "lattice", "]"}], "[", 
              RowBox[{"0", ",", "1"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";", "\n", 
        RowBox[{"cylinderLU", " ", "=", " ", 
         RowBox[{"MinMax", "@", 
          RowBox[{"IntervalIntersection", "[", 
           RowBox[{
            RowBox[{"Interval", "@", "cylinderLU"}], ",", 
            RowBox[{"Interval", "@", "shapeLU"}]}], "]"}]}]}], ";", "\n", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "ensure", " ", "cylinder", " ", "is", " ", "within", " ", "shape"}],
           ",", " ", 
          RowBox[{
          "so", " ", "its", " ", "h", " ", "will", " ", "map", " ", "to", " ",
            "a", " ", "v", " ", 
           RowBox[{
            RowBox[{"within", " ", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ".", " ", "Otherwise"}], " ", 
           "the", " ", "spline", " ", "is", " ", "unevaluated", " ", "and", 
           " ", "slows", " ", "down", " ", "the", " ", "graphics"}]}], " ", 
         "*)"}], " ", "\n", 
        RowBox[{"subLattice", " ", "=", " ", 
         RowBox[{"latticeSetCylinderLU", "[", 
          RowBox[{"lattice", ",", "cylinderLU"}], "]"}]}], ";", "\n", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"stemArcPositionDH", "[", 
            RowBox[{"lattice", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"latticePoints", "[", "subLattice", "]"}]}], "]"}]}]}], 
      "\n", "]"}]}], ";"}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellLabel->
  "In[317]:=",ExpressionUUID->"bcdae9f6-03b1-469c-92f5-54075be29bc4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"stemPositionDH", "[", 
     RowBox[{"lattice_", ",", 
      RowBox[{"{", 
       RowBox[{"d_", ",", "h_"}], "}"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"stemShapeFunctionUS", "[", "lattice", "]"}], " ", "@@", 
     RowBox[{
      RowBox[{"stemDHToUS", "[", "lattice", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"d", ",", "h"}], "}"}], "]"}]}]}], ";"}], "*)"}]], "Code",
 CellLabel->
  "In[318]:=",ExpressionUUID->"7720d08e-c2ce-4c6e-ac33-5d185da4d7de"],

Cell[BoxData["\n"], "Code",
 CellLabel->
  "In[319]:=",ExpressionUUID->"5c4247fd-a7cd-4206-b517-c62471ef7213"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"stemParastichyOfS", "[", 
      RowBox[{"stem_", ",", "m_", ",", "n_"}], "]"}], "[", "v_", "]"}], " ", ":=",
     " \t", 
    RowBox[{
     RowBox[{"stemParastichyOfV", "[", 
      RowBox[{"stem", ",", "m", ",", "n"}], "]"}], "[", 
     RowBox[{
      RowBox[{"stemVInverseArcLengthFunctionS", "[", "stem", "]"}], "[", "v", 
      "]"}], " ", "]"}]}], ";"}], "*)"}]], "Code",
 CellLabel->
  "In[320]:=",ExpressionUUID->"86a01d75-debd-4aeb-80ce-c6791159548e"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["3 d partial", "Chapter",ExpressionUUID->"54237d9e-cd02-4aae-b420-359214b966e2"],

Cell["\<\
These functions  are used by \[OpenCurlyDoubleQuote]Lattice on Stem.nb\
\[CloseCurlyDoubleQuote] for the 2020 Part III pictures\
\>", "Text",ExpressionUUID->"7bcfa54d-7c84-4fbb-a252-bb714c592bf1"],

Cell[CellGroupData[{

Cell["3 d through a spline", "Section",
 CellTags->"c:16",ExpressionUUID->"0a79b818-3575-492a-bdfc-8e6d14fea23f"],

Cell["used for diagrams to be obsoleted by stem functions", "Text",ExpressionUUID->"e332bf78-ab80-4b9e-b624-8b83e54c5349"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"latticeAddStem", "[", 
    RowBox[{"lattice_", ",", "shape_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "res", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"Append", "[", 
        RowBox[{"lattice", ",", 
         RowBox[{"spline3D", "->", " ", "shape"}]}], "]"}]}], ";", "\n", 
      RowBox[{"shapeLU", " ", "=", " ", 
       RowBox[{"MinMax", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"shape", "[", 
            RowBox[{"0", ",", "0"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"shape", "[", 
            RowBox[{"0", ",", "1"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"res", " ", "=", " ", 
       RowBox[{"latticeSetCylinderLU", "[", 
        RowBox[{"res", ",", "shapeLU"}], "]"}]}], ";", "\n", "res"}]}], "\n", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lattice3DradiusFunction", "[", 
     RowBox[{"lattice_", ",", "v_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xy", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"xy", "=", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
           RowBox[{"0", ",", "v"}], "]"}], ",", "2"}], "]"}]}], ";", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"xy", " ", ".", " ", "xy"}], "]"}]}]}], "\n", "]"}]}], ";"}], 
  "\n", 
  RowBox[{"(*", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"lattice3DZFunction", "[", 
      RowBox[{"lattice_", ",", "v_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
       RowBox[{"0", ",", "v"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lattice3DDHToUV", "[", "lattice_", "]"}], "[", 
    RowBox[{"{", 
     RowBox[{"d_", ",", "h_"}], "}"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "shapeLU", "}"}], ",", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "d", " ", "maps", " ", "to", " ", "u", " ", "as", " ", "this", " ", 
        "is", " ", "periodic", " ", "in", " ", "spline"}], ",", "  ", 
       RowBox[{
       "v", " ", "goes", " ", "from", " ", "0", " ", "to", " ", "1", " ", 
        "as", " ", "h", " ", "goes", " ", "over", " ", "shapeLU", " ", "of", 
        " ", "spline", " ", "z", " ", "values"}]}], " ", "*)"}], " ", "\n", 
     RowBox[{
      RowBox[{"shapeLU", " ", "=", " ", 
       RowBox[{"MinMax", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
            RowBox[{"0", ",", "0"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
            RowBox[{"0", ",", "1"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{
       RowBox[{"vofh", "[", "hp_", "]"}], " ", ":=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hp", "-", 
          RowBox[{"shapeLU", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"shapeLU", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"shapeLU", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "v", " ", "from", " ", "0", " ", "to", " ", "1", " ", "over", " ", 
        "shape"}], " ", "*)"}], "\n", 
      RowBox[{"{", 
       RowBox[{"d", ",", 
        RowBox[{"vofh", "[", "h", "]"}]}], "}"}]}]}], "\n", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lattice3DPosition", "[", 
     RowBox[{"lattice_", ",", 
      RowBox[{"{", 
       RowBox[{"d_", ",", "h_"}], "}"}]}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"lattice", "[", "spline3D", "]"}], " ", "@@", 
     RowBox[{
      RowBox[{"lattice3DDHToUV", "[", "lattice", "]"}], "[", 
      RowBox[{"{", 
       RowBox[{"d", ",", "h"}], "}"}], "]"}]}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"lattice3DPoints", "[", "lattice_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cylinderLU", ",", "shapeLU", ",", "subLattice"}], "}"}], ",", 
    "\n", 
    RowBox[{
     RowBox[{"cylinderLU", "=", " ", 
      RowBox[{
       RowBox[{"latticeGetNodeCylinder", "[", "lattice", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", 
     RowBox[{"shapeLU", " ", "=", " ", 
      RowBox[{"MinMax", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
           RowBox[{"0", ",", "0"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
           RowBox[{"0", ",", "1"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";", "\n", 
     RowBox[{"cylinderLU", " ", "=", " ", 
      RowBox[{"MinMax", "@", 
       RowBox[{"IntervalIntersection", "[", 
        RowBox[{
         RowBox[{"Interval", "@", "cylinderLU"}], ",", 
         RowBox[{"Interval", "@", "shapeLU"}]}], "]"}]}]}], ";", "\n", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "ensure", " ", "cylinder", " ", "is", " ", "within", " ", "shape"}], 
       ",", " ", 
       RowBox[{
       "so", " ", "its", " ", "h", " ", "will", " ", "map", " ", "to", " ", 
        "a", " ", "v", " ", 
        RowBox[{
         RowBox[{"within", " ", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ".", " ", "Otherwise"}], " ", "the",
         " ", "spline", " ", "is", " ", "unevaluated", " ", "and", " ", 
        "slows", " ", "down", " ", "the", " ", "graphics"}]}], " ", "*)"}], 
     " ", "\n", 
     RowBox[{"subLattice", " ", "=", " ", 
      RowBox[{"latticeSetCylinderLU", "[", 
       RowBox[{"lattice", ",", "cylinderLU"}], "]"}]}], ";", "\n", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lattice3DPosition", "[", 
         RowBox[{"lattice", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"latticePoints", "[", "subLattice", "]"}]}], "]"}]}]}], "\n", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lattice3DParastichyOfV", "[", 
     RowBox[{"lattice_", ",", "m_", ",", "n_"}], "]"}], "[", "v_", "]"}], " ",
    ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dL", ",", "pslope", ",", "h", ",", "vscale"}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{"dL", " ", "=", " ", 
       RowBox[{
        RowBox[{"latticeParastichyCylinderIntersection", "[", 
         RowBox[{"lattice", ",", "m", ",", "Bottom"}], "]"}], "+", "\n", 
        RowBox[{"n", "*", 
         RowBox[{"latticeParastichyHorizontalSeparation", "[", 
          RowBox[{"lattice", ",", "m"}], "]"}]}]}]}], ";", "\n", 
      RowBox[{"pslope", " ", "=", " ", 
       RowBox[{"latticeParastichySlope", "[", 
        RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\n", 
      RowBox[{"shapeLU", " ", "=", " ", 
       RowBox[{"MinMax", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
            RowBox[{"0", ",", "0"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
            RowBox[{"0", ",", "1"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"vscale", " ", "=", " ", 
       RowBox[{
        RowBox[{"shapeLU", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"shapeLU", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "h", " ", "ranges", " ", "over", " ", "this", " ", "as", " ", "v", " ",
         "goes", " ", "from", " ", "0", " ", "to", " ", "1"}], " ", "*)"}], 
      " ", "\n", 
      RowBox[{"h", " ", "=", "  ", 
       RowBox[{"v", " ", "*", " ", "vscale"}]}], " ", ";", " ", "\n", 
      RowBox[{"lattice3DPosition", "[", 
       RowBox[{"lattice", ",", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"dL", " ", "+", 
           RowBox[{"h", " ", "/", "pslope"}]}], ",", "h"}], "}"}]}], 
       "]"}]}]}], " ", "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"lattice3DParastichyOfV", "[", 
     RowBox[{"lattice_", ",", "m_"}], "]"}], "[", "v_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ilower", ",", "iupper"}], " ", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ilower", ",", "iupper"}], "}"}], "=", " ", 
       RowBox[{"latticeParastichyRangeObsolete", "[", 
        RowBox[{"lattice", ",", "m"}], "]"}]}], ";", "\n", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"lattice3DParastichyOfV", "[", 
          RowBox[{"lattice", ",", "m", ",", "n"}], "]"}], "[", "v", "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "ilower", ",", "iupper"}], "}"}]}], "]"}]}]}], 
    "\n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"lattice3DPointsUpToV", "[", 
    RowBox[{"lattice_", ",", "v_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pts", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"pts", " ", "=", " ", 
       RowBox[{"lattice3DPoints", "[", "lattice", "]"}]}], ";", "\n", 
      RowBox[{"Select", "[", 
       RowBox[{"pts", ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Last", "[", "#", "]"}], " ", "<", "   ", 
          RowBox[{
           RowBox[{
            RowBox[{"lattice", "[", "spline3D", "]"}], "[", 
            RowBox[{"0", ",", "v"}], "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}], "\n"}], "Input",
 InitializationCell->True,
 CellLabel->
  "In[321]:=",ExpressionUUID->"59e08977-0f76-452e-9af6-a2440b990a9a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.85564410170374*^9, 
  3.8556827761636667`*^9},ExpressionUUID->"01d90169-32f5-408e-86f0-\
e627f6f3d1c4"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{949, 474},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->{
 "WelcomeScreenSettings" -> {"FEStarting" -> False}, 
  "CodeFormatter" -> {
   "ToolbarState" -> False, "ToolbarAccentColor" -> RGBColor["#2497b7"]}},
Magnification:>0.85,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"69b45cde-221a-446a-9819-08e78d1dbbdd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "c:1"->{
  Cell[1137, 38, 106, 1, 57, "Section",ExpressionUUID->"dafb00cf-9865-4e0d-8243-84db3f549a19",
   CellTags->"c:1"]},
 "c:2"->{
  Cell[179673, 4174, 115, 1, 45, "Subsection",ExpressionUUID->"106a7670-7c2e-44a9-bc75-00ccc971332c",
   CellTags->"c:2"]},
 "c:3"->{
  Cell[184944, 4319, 109, 1, 57, "Section",ExpressionUUID->"71246585-5db0-4ca4-924e-1cdbf414d8c1",
   CellTags->"c:3"]},
 "c:4"->{
  Cell[198744, 4690, 108, 1, 56, "Section",ExpressionUUID->"77926345-0f95-41d8-996a-3a72d3c1f138",
   CellTags->"c:4"]},
 "c:5"->{
  Cell[228904, 5479, 122, 1, 46, "Subsection",ExpressionUUID->"3b42b4ce-96ea-437e-a8bf-c325fc88c783",
   CellTags->"c:5"]},
 "c:6"->{
  Cell[235636, 5638, 108, 1, 56, "Section",ExpressionUUID->"9046147e-0ca0-4272-b5af-5ffff81b37e9",
   CellTags->"c:6"]},
 "c:10"->{
  Cell[265381, 6398, 109, 1, 57, "Section",ExpressionUUID->"120ec840-1542-465e-b6c1-6997170dd997",
   CellTags->"c:10"]},
 "c:11"->{
  Cell[269833, 6519, 119, 1, 57, "Section",ExpressionUUID->"4d850d9d-a43e-4628-a50b-f40398683284",
   CellTags->"c:11"]},
 "c:12"->{
  Cell[269977, 6524, 123, 1, 45, "Subsection",ExpressionUUID->"1eb2456a-c522-43a0-918e-904840db080a",
   CellTags->"c:12"]},
 "c:13"->{
  Cell[289249, 7088, 117, 1, 45, "Subsection",ExpressionUUID->"634d7633-eb03-4f97-a11a-992d8c562bb6",
   CellTags->"c:13"]},
 "c:14"->{
  Cell[298778, 7362, 112, 1, 57, "Section",ExpressionUUID->"326fb5ea-9225-4cd1-a35e-623fb280064d",
   CellTags->"c:14"]},
 "c:15"->{
  Cell[338034, 8381, 137, 1, 45, "Subsection",ExpressionUUID->"7151a561-8371-40cf-b9d7-0e40d21a4a5a",
   CellTags->"c:15"]},
 "c:7"->{
  Cell[343617, 8540, 113, 1, 58, "Chapter",ExpressionUUID->"31f5f89c-75cc-447a-a7cf-89500a98046e",
   CellTags->"c:7"]},
 "c:17"->{
  Cell[351450, 8731, 113, 1, 55, "Section",ExpressionUUID->"ed8ddcf0-71d9-4eac-80ea-60c4e1cffce2",
   CellTags->"c:17"]},
 "c:16"->{
  Cell[385092, 9574, 113, 1, 57, "Section",ExpressionUUID->"0a79b818-3575-492a-bdfc-8e6d14fea23f",
   CellTags->"c:16"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"c:1", 396529, 9888},
 {"c:2", 396656, 9891},
 {"c:3", 396790, 9894},
 {"c:4", 396921, 9897},
 {"c:5", 397052, 9900},
 {"c:6", 397186, 9903},
 {"c:10", 397318, 9906},
 {"c:11", 397451, 9909},
 {"c:12", 397584, 9912},
 {"c:13", 397720, 9915},
 {"c:14", 397856, 9918},
 {"c:15", 397989, 9921},
 {"c:7", 398124, 9924},
 {"c:17", 398256, 9927},
 {"c:16", 398389, 9930}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 351, 7, 38, "Input",ExpressionUUID->"0c63ea52-7fb0-493b-bb7d-4edd448cd6cb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[934, 31, 178, 3, 58, "Chapter",ExpressionUUID->"6e622f36-b0ac-4664-8d98-e8bdd1e37010"],
Cell[CellGroupData[{
Cell[1137, 38, 106, 1, 57, "Section",ExpressionUUID->"dafb00cf-9865-4e0d-8243-84db3f549a19",
 CellTags->"c:1"],
Cell[1246, 41, 5840, 109, 346, "Input",ExpressionUUID->"d65299de-a7b4-4028-bfad-df211f871af8",
 InitializationCell->True],
Cell[7089, 152, 4892, 77, 166, "Input",ExpressionUUID->"b3379e87-4e63-4a79-8911-97a1ca53c1a6",
 InitializationCell->True],
Cell[11984, 231, 7181, 152, 442, "Input",ExpressionUUID->"a5cdef2c-f8c2-4138-91c2-7451c12c4570",
 InitializationCell->True],
Cell[19168, 385, 7164, 166, 493, "Input",ExpressionUUID->"7036ebfe-030a-49e0-b87d-b224cd9134b9",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26381, 557, 160, 3, 58, "Chapter",ExpressionUUID->"de368bc0-235c-41d2-9a9d-306682b7b46a"],
Cell[CellGroupData[{
Cell[26566, 564, 157, 3, 45, "Subsection",ExpressionUUID->"568cea66-98e0-4905-8ae7-07ed56da9aef"],
Cell[26726, 569, 8982, 215, 430, "Input",ExpressionUUID->"1e9fad43-8743-42b5-a24f-c278f9aa1ebb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[35745, 789, 161, 3, 32, "Subsection",ExpressionUUID->"f94db409-52ef-4b5f-a556-b11eb1fc13ad"],
Cell[35909, 794, 8984, 192, 447, "Input",ExpressionUUID->"5b70e54d-e622-4347-b9ad-75bc348cc649",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[44930, 991, 164, 3, 45, "Subsection",ExpressionUUID->"9018438c-054d-4bf6-9f53-331d4b15410a"],
Cell[45097, 996, 28178, 725, 2013, "Input",ExpressionUUID->"2a6f8a99-dda3-4048-9102-1b1225ad8242",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[73312, 1726, 164, 3, 45, "Subsection",ExpressionUUID->"d3c5b46f-d312-4a31-b1ca-48111f6dce9e"],
Cell[73479, 1731, 21633, 551, 1339, "Input",ExpressionUUID->"89ce2232-e432-4b68-9b4f-222a1a9c3679",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[95137, 2286, 329, 7, 25, "Input",ExpressionUUID->"9654d9a7-d618-409a-96bb-486c49795424"],
Cell[95469, 2295, 440, 12, 42, "Output",ExpressionUUID->"4a63e5f3-8d76-4453-8484-96ad1e2b5d0e"]
}, Open  ]],
Cell[95924, 2310, 264, 6, 23, "Input",ExpressionUUID->"0d6681e3-716c-4d38-88b4-973e6920c52c"],
Cell[CellGroupData[{
Cell[96213, 2320, 153, 3, 23, InheritFromParent,ExpressionUUID->"6393d4c5-1ea6-41d0-9ae6-c09882dd85f3"],
Cell[96369, 2325, 154, 3, 27, "Output",ExpressionUUID->"53ccf904-b7db-4cfb-8660-c3287c6662e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96560, 2333, 389, 12, 47, "Input",ExpressionUUID->"fc395509-1451-46c4-8d74-49bf97a278ce"],
Cell[96952, 2347, 302, 7, 27, "Output",ExpressionUUID->"9328a266-3b02-4e21-97ed-6b3042426ac9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97291, 2359, 395, 8, 25, "Input",ExpressionUUID->"7e2aea8e-f820-4fc7-862c-9bcb7274d4f3"],
Cell[97689, 2369, 307, 11, 40, "Echo",ExpressionUUID->"35d62ad1-6af9-4550-833f-dc9cdd0d2ca8"],
Cell[97999, 2382, 524, 15, 42, "Output",ExpressionUUID->"0eb4dcb3-b6f5-458f-b833-5be7598d6ea1"]
}, Open  ]],
Cell[98538, 2400, 154, 3, 23, "Input",ExpressionUUID->"9425ad09-48b2-4cde-b40c-6feadea3a0a9"],
Cell[CellGroupData[{
Cell[98717, 2407, 265, 6, 23, "Input",ExpressionUUID->"306ba192-7e63-4a1f-80e3-22734d7c3d90"],
Cell[98985, 2415, 155, 3, 27, "Output",ExpressionUUID->"5e9dcdd8-fc93-471b-9b93-dd114cf94539"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99177, 2423, 444, 9, 25, "Input",ExpressionUUID->"6bd65a7c-b9f2-4a4d-a391-5968da1ed70b"],
Cell[99624, 2434, 795, 18, 42, "Output",ExpressionUUID->"72aa9a53-0e3b-438d-ae06-cfc30ca4968b"]
}, Open  ]],
Cell[100434, 2455, 154, 3, 23, "Input",ExpressionUUID->"24b4078a-b76a-49ec-963f-ca03183bf2b2"],
Cell[CellGroupData[{
Cell[100613, 2462, 276, 6, 23, "Input",ExpressionUUID->"84f7d4d1-d93e-4a34-9c8c-231072c68b1b"],
Cell[100892, 2470, 313, 9, 46, "Output",ExpressionUUID->"957becee-3234-4d20-85c8-a931a58017fd"]
}, Open  ]],
Cell[101220, 2482, 401, 11, 37, "Input",ExpressionUUID->"d81fa8ed-4ff1-483f-a813-f69608649486"],
Cell[CellGroupData[{
Cell[101646, 2497, 8115, 191, 385, "Input",ExpressionUUID->"5b5b0379-9c5f-4ebb-bfac-593bbf379370"],
Cell[109764, 2690, 1880, 58, 51, "Output",ExpressionUUID->"6db87ef4-9b6e-4c7d-998f-921becb7ab6b"],
Cell[111647, 2750, 1921, 59, 51, "Output",ExpressionUUID->"d27f3d84-a1a8-4dbc-9517-f18161744d0b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113605, 2814, 508, 16, 47, "Input",ExpressionUUID->"607380fe-9eb2-4ca4-97e6-c3be2acbe5ea"],
Cell[114116, 2832, 232, 5, 38, "Output",ExpressionUUID->"cb32c071-1a18-4bc7-bba9-ddf4ca0c92ee"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114385, 2842, 646, 20, 47, "Input",ExpressionUUID->"a5711208-e59e-4333-b682-63f09ed687cb"],
Cell[115034, 2864, 424, 9, 38, "Output",ExpressionUUID->"1c3e5639-4a3a-4dab-ba54-ddaef919a868"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115495, 2878, 563, 16, 41, "Input",ExpressionUUID->"333cca2e-a53d-4c99-854f-b6fef05f7f4f"],
Cell[116061, 2896, 965, 20, 28, "Output",ExpressionUUID->"d702e229-69c3-4392-97fa-372b8dbd8a13"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117063, 2921, 124, 2, 23, "Input",ExpressionUUID->"774a50d7-cdda-4439-840b-a98742bdab33"],
Cell[117190, 2925, 421, 10, 30, "Output",ExpressionUUID->"0a3a63a8-2390-4f61-a7d9-3309c1541752"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117648, 2940, 472, 11, 25, "Input",ExpressionUUID->"97e14d70-fbf4-4dc1-98a9-56e86347b2c4"],
Cell[118123, 2953, 998, 28, 46, "Output",ExpressionUUID->"af8970f7-d50b-4b41-b030-f2492eb17b07"]
}, Open  ]],
Cell[119136, 2984, 190, 4, 40, "Input",ExpressionUUID->"f8b86df2-71ba-4568-8d83-ed4909797a40"],
Cell[CellGroupData[{
Cell[119351, 2992, 279, 7, 26, "Input",ExpressionUUID->"eea7b967-2239-457b-a8c4-3b689b5226dc"],
Cell[119633, 3001, 261, 5, 37, "Output",ExpressionUUID->"fb160555-c9e8-4316-97a9-18799cb70338"]
}, Open  ]],
Cell[119909, 3009, 154, 3, 23, "Input",ExpressionUUID->"959f5f21-570f-448d-8192-2d457bc3812d"],
Cell[120066, 3014, 540, 15, 40, "Input",ExpressionUUID->"175fac63-ec16-4877-8e60-61d791026109"],
Cell[CellGroupData[{
Cell[120631, 3033, 261, 6, 23, "Input",ExpressionUUID->"f2717e97-c107-4912-aa05-47db1cd5ab75"],
Cell[120895, 3041, 7943, 132, 380, "Output",ExpressionUUID->"6121f6a4-b67f-453a-a07d-0e3945a2bce0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128875, 3178, 311, 7, 23, "Input",ExpressionUUID->"b6e0dd25-b530-4960-9073-16d3f6b5e80c"],
Cell[129189, 3187, 382, 10, 31, "Output",ExpressionUUID->"7fb57bc4-7666-4281-ba2f-1cd965d0c7b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129608, 3202, 336, 9, 23, "Input",ExpressionUUID->"3bae8004-1f68-4b77-add5-079bf0eb71ed"],
Cell[129947, 3213, 30941, 540, 55, "Output",ExpressionUUID->"2212887d-175d-4fd9-9e37-50b047fb609f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160925, 3758, 384, 10, 23, "Input",ExpressionUUID->"e52ad1df-a317-4ddf-b147-6f050dbe0327"],
Cell[161312, 3770, 11801, 205, 380, "Output",ExpressionUUID->"0c62c5b7-983e-4202-a50c-e8cde21444f1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173150, 3980, 325, 7, 23, "Input",ExpressionUUID->"2fda0fdf-188a-4efa-b5c7-caac68248956"],
Cell[173478, 3989, 468, 12, 44, "Output",ExpressionUUID->"d482eef0-d0a3-4dba-9c84-ba032eb8702b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173983, 4006, 331, 8, 23, "Input",ExpressionUUID->"21dd3422-9100-451f-be41-adba364fd210"],
Cell[174317, 4016, 873, 27, 44, "Output",ExpressionUUID->"ce8bbc61-bb96-40f7-8977-d46bad2c1b93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175227, 4048, 249, 6, 25, "Input",ExpressionUUID->"0348bca6-b70b-42ae-9e25-8673c8f30084"],
Cell[175479, 4056, 368, 11, 42, "Output",ExpressionUUID->"8949e2bf-3577-4e86-8e37-3136199d7ecb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175884, 4072, 333, 7, 25, "Input",ExpressionUUID->"c46bf089-7155-4627-8952-f999e52d4337"],
Cell[176220, 4081, 439, 12, 42, "Output",ExpressionUUID->"0df1a004-8723-4ee5-8ae3-172e2a660b58"]
}, Open  ]],
Cell[176674, 4096, 2186, 55, 186, "Input",ExpressionUUID->"1347374d-2251-4f35-9934-ed961a99d828",
 InitializationCell->True],
Cell[178863, 4153, 176, 3, 23, "Input",ExpressionUUID->"d72fa5a0-f57a-464d-b94a-ba5a1ed78558"],
Cell[179042, 4158, 481, 7, 23, "Input",ExpressionUUID->"6871eb47-e026-49b4-a961-141fe934878b"],
Cell[179526, 4167, 110, 2, 23, "Input",ExpressionUUID->"40e1441d-6268-4dbc-8c14-20077b26c5c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[179673, 4174, 115, 1, 45, "Subsection",ExpressionUUID->"106a7670-7c2e-44a9-bc75-00ccc971332c",
 CellTags->"c:2"],
Cell[179791, 4177, 5116, 137, 411, "Input",ExpressionUUID->"09918ae3-f4b8-4a6b-965a-8f3bc3205f0f",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[184944, 4319, 109, 1, 57, "Section",ExpressionUUID->"71246585-5db0-4ca4-924e-1cdbf414d8c1",
 CellTags->"c:3"],
Cell[185056, 4322, 5883, 151, 413, "Input",ExpressionUUID->"3968a2a7-342e-4cc7-b6dc-0d81163f88bd",
 InitializationCell->True],
Cell[190942, 4475, 7765, 210, 576, "Input",ExpressionUUID->"5f9d3a98-a46c-4729-b5b2-bbd9e7f9b1ef",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[198744, 4690, 108, 1, 56, "Section",ExpressionUUID->"77926345-0f95-41d8-996a-3a72d3c1f138",
 CellTags->"c:4"],
Cell[198855, 4693, 4155, 100, 346, "Input",ExpressionUUID->"271f6e36-7b08-4aa4-9a63-151b065c5857",
 InitializationCell->True],
Cell[203013, 4795, 3473, 87, 315, "Input",ExpressionUUID->"747d76d5-80d4-4ff4-9fb6-18e4fa01af7c",
 InitializationCell->True],
Cell[206489, 4884, 5274, 124, 626, "Input",ExpressionUUID->"9fb040ce-c4ac-4e5e-ae0b-0b1b998cdaaa",
 InitializationCell->True],
Cell[211766, 5010, 2552, 63, 187, "Input",ExpressionUUID->"8f1e7f40-bb03-414f-beb6-6d3cb343cd2f",
 InitializationCell->True],
Cell[214321, 5075, 1488, 44, 162, "Code",ExpressionUUID->"d8dc7c93-074e-4218-aab6-f30e8f98101b"],
Cell[215812, 5121, 6174, 161, 578, "Input",ExpressionUUID->"160c58a1-ef3d-41cf-a124-21b773cca1eb",
 InitializationCell->True],
Cell[221989, 5284, 5321, 146, 366, "Input",ExpressionUUID->"ed44a0b0-8df1-4677-b699-4ec099bc13d3",
 InitializationCell->True],
Cell[227313, 5432, 1566, 43, 106, "Input",ExpressionUUID->"31857182-9d4a-4c09-830d-2e0d13c97d84",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[228904, 5479, 122, 1, 46, "Subsection",ExpressionUUID->"3b42b4ce-96ea-437e-a8bf-c325fc88c783",
 CellTags->"c:5"],
Cell[229029, 5482, 6558, 150, 544, "Input",ExpressionUUID->"4313befb-6793-4e9b-82e4-a740cf47c2c0",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[235636, 5638, 108, 1, 56, "Section",ExpressionUUID->"9046147e-0ca0-4272-b5af-5ffff81b37e9",
 CellTags->"c:6"],
Cell[235747, 5641, 4046, 113, 447, "Input",ExpressionUUID->"ec135d8a-a107-4dc2-ad4a-43b270460e6d",
 InitializationCell->True],
Cell[239796, 5756, 2325, 66, 151, "Input",ExpressionUUID->"0f597f0e-259c-4c9e-8547-bf6c0029a582",
 InitializationCell->True],
Cell[242124, 5824, 3261, 84, 151, "Input",ExpressionUUID->"f7d5ea60-fa52-44f8-9723-1133378a324a",
 InitializationCell->True],
Cell[245388, 5910, 5518, 126, 345, "Input",ExpressionUUID->"0c1e4629-1682-4457-9cd0-fc4162accfbb",
 InitializationCell->True],
Cell[250909, 6038, 1523, 39, 120, "Input",ExpressionUUID->"40674fc5-0c93-433a-a884-ebb2d09eb028",
 InitializationCell->True],
Cell[252435, 6079, 11159, 263, 800, "Input",ExpressionUUID->"4ffac8f4-70f5-4584-9adc-55d4b4e11621",
 InitializationCell->True],
Cell[263597, 6344, 1062, 27, 87, "Input",ExpressionUUID->"a3249bf0-c159-4ec7-b33c-36858e93f1d7",
 InitializationCell->True],
Cell[264662, 6373, 546, 15, 74, "Code",ExpressionUUID->"68c05707-c9a3-4aec-93a3-4561ca180740"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[265257, 6394, 99, 0, 57, "Chapter",ExpressionUUID->"286689ea-f57d-45dd-88cf-a1c9dfe9faec"],
Cell[CellGroupData[{
Cell[265381, 6398, 109, 1, 57, "Section",ExpressionUUID->"120ec840-1542-465e-b6c1-6997170dd997",
 CellTags->"c:10"],
Cell[265493, 6401, 4303, 113, 412, "Input",ExpressionUUID->"7ba1adf9-9d69-47f9-812c-0bdee4154695",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[269833, 6519, 119, 1, 57, "Section",ExpressionUUID->"4d850d9d-a43e-4628-a50b-f40398683284",
 CellTags->"c:11"],
Cell[CellGroupData[{
Cell[269977, 6524, 123, 1, 45, "Subsection",ExpressionUUID->"1eb2456a-c522-43a0-918e-904840db080a",
 CellTags->"c:12"],
Cell[270103, 6527, 3992, 113, 218, "Input",ExpressionUUID->"069d6b81-4257-4625-bcbc-7b29be5343f5",
 InitializationCell->True],
Cell[274098, 6642, 6816, 187, 496, "Input",ExpressionUUID->"cdad9cdf-5323-4f53-9cd5-504c77f033b4",
 InitializationCell->True],
Cell[280917, 6831, 1617, 50, 107, "Input",ExpressionUUID->"64d1cd4c-166a-4b8f-8647-f16d1b0e3317",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[282559, 6885, 2026, 54, 152, "Input",ExpressionUUID->"0df27c0f-8f6c-4941-9898-370ea0f133d5",
 InitializationCell->True],
Cell[284588, 6941, 3238, 95, 57, "Output",ExpressionUUID->"bb659cc2-3dbd-4df9-9a48-10e4f0ed1a04"]
}, Open  ]],
Cell[287841, 7039, 1371, 44, 136, "Input",ExpressionUUID->"a60dc9aa-eb69-42c0-8476-088c0ecdb808",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[289249, 7088, 117, 1, 45, "Subsection",ExpressionUUID->"634d7633-eb03-4f97-a11a-992d8c562bb6",
 CellTags->"c:13"],
Cell[289369, 7091, 792, 22, 119, "Input",ExpressionUUID->"2dfe3646-0eed-47e4-a4f6-ba3736c3e885",
 InitializationCell->True],
Cell[290164, 7115, 5760, 168, 397, "Input",ExpressionUUID->"4d546aaa-4af5-4437-873c-9c4362adc80a",
 InitializationCell->True],
Cell[295927, 7285, 2802, 71, 249, "Input",ExpressionUUID->"70d8dcc1-a612-44f2-8551-a9711e17b982",
 InitializationCell->True]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[298778, 7362, 112, 1, 57, "Section",ExpressionUUID->"326fb5ea-9225-4cd1-a35e-623fb280064d",
 CellTags->"c:14"],
Cell[298893, 7365, 4175, 99, 414, "Input",ExpressionUUID->"0773a166-7467-4bd4-b754-8597efe2292b",
 InitializationCell->True],
Cell[303071, 7466, 34323, 890, 2662, "Input",ExpressionUUID->"4094927b-6dd3-45bb-ab30-bbdb351c5e41",
 InitializationCell->True],
Cell[337397, 8358, 612, 19, 55, "Input",ExpressionUUID->"140214a0-1d4a-4a6e-beac-e216872603b6",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[338034, 8381, 137, 1, 45, "Subsection",ExpressionUUID->"7151a561-8371-40cf-b9d7-0e40d21a4a5a",
 CellTags->"c:15"],
Cell[338174, 8384, 5382, 149, 461, "Input",ExpressionUUID->"6ee4c1a5-230a-49d0-bc04-e3bbf8f6a143",
 InitializationCell->True]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[343617, 8540, 113, 1, 58, "Chapter",ExpressionUUID->"31f5f89c-75cc-447a-a7cf-89500a98046e",
 CellTags->"c:7"],
Cell[343733, 8543, 286, 6, 105, "Text",ExpressionUUID->"98245449-c76f-4385-9e97-7b621caa1344"],
Cell[344022, 8551, 7403, 176, 588, "Input",ExpressionUUID->"910b2c6f-1be3-43dd-9ff6-2f9a62ab6b83",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[351450, 8731, 113, 1, 55, "Section",ExpressionUUID->"ed8ddcf0-71d9-4eac-80ea-60c4e1cffce2",
 CellTags->"c:17"],
Cell[351566, 8734, 119, 0, 28, "Text",ExpressionUUID->"abacfbd2-49da-4c99-aed0-4e55aaac23b3"],
Cell[351688, 8736, 476, 8, 105, "Text",ExpressionUUID->"eb1d524f-5a93-4aca-a40c-07f2c9c89878"],
Cell[352167, 8746, 7215, 176, 653, "Input",ExpressionUUID->"66e2aad7-8082-45bd-b590-744c333e3e65",
 InitializationCell->True],
Cell[359385, 8924, 11442, 279, 1041, "Input",ExpressionUUID->"9e4f3636-5a29-406a-940e-387e6a02b4a2",
 InitializationCell->True],
Cell[370830, 9205, 8099, 199, 750, "Input",ExpressionUUID->"2cffcd16-486f-4a8f-a49c-774e91d06a08",
 InitializationCell->True],
Cell[378932, 9406, 4597, 115, 392, "Input",ExpressionUUID->"bcdae9f6-03b1-469c-92f5-54075be29bc4",
 InitializationCell->True],
Cell[383532, 9523, 538, 15, 41, "Code",ExpressionUUID->"7720d08e-c2ce-4c6e-ac33-5d185da4d7de"],
Cell[384073, 9540, 110, 2, 56, "Code",ExpressionUUID->"5c4247fd-a7cd-4206-b517-c62471ef7213"],
Cell[384186, 9544, 538, 15, 41, "Code",ExpressionUUID->"86a01d75-debd-4aeb-80ce-c6791159548e"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[384773, 9565, 85, 0, 49, "Chapter",ExpressionUUID->"54237d9e-cd02-4aae-b420-359214b966e2"],
Cell[384861, 9567, 206, 3, 29, "Text",ExpressionUUID->"7bcfa54d-7c84-4fbb-a252-bb714c592bf1"],
Cell[CellGroupData[{
Cell[385092, 9574, 113, 1, 57, "Section",ExpressionUUID->"0a79b818-3575-492a-bdfc-8e6d14fea23f",
 CellTags->"c:16"],
Cell[385208, 9577, 122, 0, 29, "Text",ExpressionUUID->"e332bf78-ab80-4b9e-b624-8b83e54c5349"],
Cell[385333, 9579, 10448, 283, 789, "Input",ExpressionUUID->"59e08977-0f76-452e-9af6-a2440b990a9a",
 InitializationCell->True],
Cell[395784, 9864, 151, 3, 22, "Input",ExpressionUUID->"01d90169-32f5-408e-86f0-e627f6f3d1c4"]
}, Open  ]]
}, Open  ]]
}
]
*)

