(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67309,       1483]
NotebookOptionsPosition[     65739,       1447]
NotebookOutlinePosition[     66204,       1465]
CellTagsIndexPosition[     66161,       1462]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"AutoGeneratedPackage", "->", "Automatic"}]}], "]"}], ";"}], 
  "\n"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"7d77eaad-7cce-48eb-b198-8dc4dd759adc"],

Cell[CellGroupData[{

Cell["Chain code", "Section",
 CellChangeTimes->{{3.8595354332704773`*^9, 
  3.8595354401520576`*^9}},ExpressionUUID->"6ab48122-af17-4dcf-b0ec-\
7c9b2b450180"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskZ", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_", ",", "z_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", "z"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", "x"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskXZ", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskRightX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"x", "+", "r"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskLeftX", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"x", "-", "r"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberRight", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"right", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberRight", "[", 
      RowBox[{"left", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberLeft", "[", "n_", "]"}], " ", ":=", " ", 
     RowBox[{"left", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberLeft", "[", 
      RowBox[{"right", "[", "n_", "]"}], "]"}], " ", ":=", " ", "n"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveDiskRight", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "+", "1"}], ",", "z"}], "}"}], ",", "r"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveDiskLeft", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      "\[IndentingNewLine]", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "-", "1"}], ",", "z"}], "}"}], ",", "r"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberedDiskRight", "[", 
      RowBox[{"n_", "->", "d_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"moveNumberRight", "[", "n", "]"}], "->", 
      RowBox[{"moveDiskRight", "[", "d", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"moveNumberedDiskLeft", "[", 
      RowBox[{"n_", "->", "d_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"moveNumberLeft", "[", "n", "]"}], "->", 
      RowBox[{"moveDiskLeft", "[", "d", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getDisk", "[", 
      RowBox[{"n_", ",", "run_"}], "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], "[", "n", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"getDisk", "[", 
      RowBox[{
       RowBox[{"right", "[", "n_", "]"}], ",", "run_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"moveDiskRight", "[", 
      RowBox[{"getDisk", "[", 
       RowBox[{"n", ",", "run"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diskIsLeft", "[", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=", 
    RowBox[{"x", "<", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diskIsRight", "[", 
     RowBox[{"Disk", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=", 
    RowBox[{"x", ">", 
     RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskIsNormalised", "[", "d_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"!", " ", 
        RowBox[{"diskIsLeft", "[", "d", "]"}]}], ")"}], " ", "&&", " ", 
      RowBox[{"(", 
       RowBox[{"!", " ", 
        RowBox[{"diskIsRight", "[", "d", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskAndVisibleCopies", "[", 
      RowBox[{"Disk", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "z_"}], "}"}], ",", "r_"}], "]"}], "]"}], " ", ":=",
      " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "+", "r"}], ">", 
          RowBox[{"1", "/", "2"}]}], ",", 
         RowBox[{"moveDiskLeft", "[", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], "]"}], ",", 
         RowBox[{"Nothing", "[", "]"}]}], "]"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "-", "r"}], "<", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "2"}]}], ",", 
         RowBox[{"moveDiskRight", "[", 
          RowBox[{"Disk", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "z"}], "}"}], ",", "r"}], "]"}], "]"}], ",", 
         RowBox[{"Nothing", "[", "]"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextRadius", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "highestZ", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"highestZ", "=", 
         RowBox[{"Max", "@", 
          RowBox[{"Map", "[", 
           RowBox[{"diskZ", ",", 
            RowBox[{"Values", "@", 
             RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}]}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"run", "[", "\"\<Arena\>\"", "]"}], "[", 
          "\"\<rFunction\>\"", "]"}], "[", "highestZ", "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"nextDiskNumber", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"Max", "@", 
       RowBox[{"Keys", "[", 
        RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], "]"}]}], "+", 
      "1"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.8616891647790556`*^9, {3.8617683530486383`*^9, 
   3.8617683859390097`*^9}, 3.86176864328798*^9, {3.8618567493688416`*^9, 
   3.8618567645549335`*^9}},ExpressionUUID->"c79fdebc-f9ae-4df7-a656-\
4383f6352b8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"currentSupportDisks", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", "  ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"chain", ",", "lefts", ",", "rights"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"Last", "@", 
        RowBox[{"run", "[", "\"\<CompletedChains\>\"", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"Join", "[", 
        RowBox[{"chain", ",", 
         RowBox[{"run", "[", "\"\<CurrentChain\>\"", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"chain", " ", "=", " ", 
       RowBox[{"SortBy", "[", 
        RowBox[{"chain", ",", 
         RowBox[{
          RowBox[{"diskX", "[", 
           RowBox[{"getDisk", "[", 
            RowBox[{"#", ",", "run"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"lefts", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"moveNumberedDiskLeft", "[", 
           RowBox[{"#", "->", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "run"}], "]"}]}], "]"}], "&"}], ",", "chain"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"lefts", " ", "=", " ", 
       RowBox[{"First", " ", "/@", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"lefts", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diskRightX", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], "+", "nextR"}], ">=", 
            " ", 
            RowBox[{
             RowBox[{"-", "1"}], "/", "2"}]}], " ", "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rights", " ", "=", "  ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"moveNumberedDiskRight", "[", 
           RowBox[{"#", "->", 
            RowBox[{"getDisk", "[", 
             RowBox[{"#", ",", "run"}], "]"}]}], "]"}], "&"}], ",", "chain"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rights", " ", "=", 
       RowBox[{"First", " ", "/@", " ", 
        RowBox[{"Select", "[", 
         RowBox[{"rights", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diskLeftX", "[", 
              RowBox[{"Last", "[", "#", "]"}], "]"}], "-", "nextR"}], "<=", 
            " ", 
            RowBox[{"1", "/", "2"}]}], " ", "&"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Join", "[", 
       RowBox[{"lefts", ",", "chain", ",", "rights"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"diskPairCanSupport", "[", 
   RowBox[{"run_", ",", "nextR_", ",", "n1_", ",", "n2_"}], "]"}], " ", ":=", 
  " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"diskRightX", "[", 
     RowBox[{"getDisk", "[", 
      RowBox[{"n1", ",", "run"}], "]"}], "]"}], " ", "+", " ", 
    RowBox[{"2", " ", "*", " ", "nextR"}]}], " ", "<=", " ", 
   RowBox[{"diskRightX", "[", 
    RowBox[{"getDisk", "[", 
     RowBox[{"n2", ",", "run"}], "]"}], "]"}], " ", 
   "\[IndentingNewLine]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8618609832942944`*^9, 3.861861061074704*^9}, {
   3.861861110410298*^9, 3.8618611849953966`*^9}, {3.8618612835319247`*^9, 
   3.861861293180356*^9}, {3.86186148247342*^9, 3.8618615591943808`*^9}, {
   3.86186759473781*^9, 3.861867635995823*^9}, {3.8618682143968873`*^9, 
   3.8618682191102877`*^9}, {3.861868356297555*^9, 3.861868366856969*^9}, {
   3.861868401097106*^9, 3.8618684788548923`*^9}, {3.861868517852971*^9, 
   3.8618685682815886`*^9}, {3.8618686017215767`*^9, 3.861868803803029*^9}, {
   3.861869057053732*^9, 3.861869228341298*^9}, {3.8618701303426723`*^9, 
   3.861870190027537*^9}, {3.8618702800840073`*^9, 3.8618703073118696`*^9}, 
   3.8618704425420823`*^9},
 CellLabel->
  "In[749]:=",ExpressionUUID->"0a65e49c-b2c5-44c1-beed-0dda6949a9df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"potentialHorizontalOverlaps", "[", 
     RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"supportDisks", ",", "supportPairs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"supportDisks", " ", "=", " ", 
        RowBox[{"currentSupportDisks", "[", 
         RowBox[{"run", ",", "nextR"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "supportDisks", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"supportPairs", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "<", " ", 
          RowBox[{"Length", "[", "supportDisks", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "i"}], ",", 
           RowBox[{"j", "<=", " ", 
            RowBox[{"Length", "[", "supportDisks", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"diskPairCanSupport", "[", 
              RowBox[{"run", ",", "nextR", ",", 
               RowBox[{"supportDisks", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", 
               RowBox[{"supportDisks", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"supportPairs", " ", "=", " ", 
              RowBox[{"Append", "[", 
               RowBox[{"supportPairs", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"supportDisks", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", 
                  RowBox[{"supportDisks", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "supportPairs", "]"}], ";", 
       "\[IndentingNewLine]", "supportPairs"}]}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"disksWithinHorizontalRight", "[", 
     RowBox[{"run_", ",", "extendedDisks_", ",", "n_", ",", "nextR_"}], "]"}],
     " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rhs", ",", "rightPossible"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rhs", " ", "=", " ", 
        RowBox[{"diskRightX", "[", 
         RowBox[{
          RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], "[", "n", "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Keys", "@", 
        RowBox[{"Association", "@", 
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{"Normal", "[", "extendedDisks", "]"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"diskRightX", "[", 
               RowBox[{"Last", "[", "#", "]"}], "]"}], ">", " ", "rhs"}], " ",
              "&&", " ", 
             RowBox[{
              RowBox[{"diskLeftX", "[", 
               RowBox[{"Last", "[", "#", "]"}], "]"}], "<", 
              RowBox[{"rhs", " ", "+", " ", 
               RowBox[{"2", " ", "*", " ", "nextR"}]}]}]}], "&"}]}], 
          "]"}]}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksRight", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extendedDisks", ",", "extendedDisksRight"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", "=", " ", 
       RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extendedDisksRight", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"extendedDisks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diskX", "[", "#", "]"}], "+", "1"}], "<=", " ", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", "nextR"}]}], " ", "&"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"extendedDisksRight", " ", "=", " ", 
       RowBox[{"Association", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberedDiskRight", ",", 
          RowBox[{"Normal", "[", "extendedDisksRight", "]"}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "extendedDisks"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksLeft", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"extendedDisks", ",", "extendedDisksLeft"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", "=", " ", 
       RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extendedDisksLeft", " ", "=", " ", 
       RowBox[{"Select", "[", 
        RowBox[{"extendedDisks", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"diskX", "[", "#", "]"}], "-", "1"}], " ", ">=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", " ", "1"}], "/", "2"}], " ", "-", " ", "nextR"}]}], 
          " ", "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"extendedDisksLeft", " ", "=", " ", 
       RowBox[{"Association", "[", 
        RowBox[{"Map", "[", 
         RowBox[{"moveNumberedDiskLeft", ",", 
          RowBox[{"Normal", "[", "extendedDisksLeft", "]"}]}], "]"}], "]"}]}],
       ";", "\[IndentingNewLine]", "extendedDisksLeft"}]}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"extendDisksLeftRight", "[", 
    RowBox[{"run_", ",", "nextR_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "extendedDisks", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"extendedDisks", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{
         RowBox[{"run", "[", "\"\<CurrentDisks\>\"", "]"}], ",", " ", 
         RowBox[{"extendDisksRight", "[", 
          RowBox[{"run", ",", "nextR"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"extendedDisks", " ", "=", " ", "\[IndentingNewLine]", 
       RowBox[{"Append", "[", 
        RowBox[{"extendedDisks", ",", " ", 
         RowBox[{"extendDisksLeft", "[", 
          RowBox[{"run", ",", "nextR"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "extendedDisks"}]}], " ", "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.86176811167383*^9, 3.8617682597197723`*^9}, {
   3.8617682940446005`*^9, 3.8617683208015947`*^9}, {3.861768396085757*^9, 
   3.861768466468691*^9}, {3.8617685127149725`*^9, 3.8617685274257803`*^9}, {
   3.8617685607421083`*^9, 3.8617685613503017`*^9}, {3.8617686239130816`*^9, 
   3.8617686243819647`*^9}, {3.8617686618849783`*^9, 
   3.8617686637751493`*^9}, {3.86176870938266*^9, 3.861768732367918*^9}, {
   3.8617701791317883`*^9, 3.861770256473044*^9}, {3.8617703228119564`*^9, 
   3.8617706374593897`*^9}, {3.8617706674910555`*^9, 3.861770854104594*^9}, 
   3.8617709024525056`*^9, {3.861771049078973*^9, 3.861771086242021*^9}, {
   3.861771117016026*^9, 3.8617712281706324`*^9}, {3.861771288493409*^9, 
   3.861771288633948*^9}, {3.861771380372183*^9, 3.8617714035295935`*^9}, {
   3.8617717107871904`*^9, 3.8617717354626474`*^9}, {3.8618558187788935`*^9, 
   3.8618558541525946`*^9}, {3.861855897042087*^9, 3.8618560184508553`*^9}, {
   3.8618560728951387`*^9, 3.861856109387108*^9}, {3.8618561406783648`*^9, 
   3.8618562129205*^9}, {3.8618562503742313`*^9, 3.861856262851577*^9}, {
   3.861856738894947*^9, 3.861856741225368*^9}, {3.8618606232744007`*^9, 
   3.861860627379337*^9}, {3.861860671745571*^9, 3.8618606728382387`*^9}, {
   3.8618607071326227`*^9, 3.861860707523094*^9}, {3.861860759939664*^9, 
   3.8618607622057204`*^9}, {3.8618688416478133`*^9, 3.861868867189494*^9}, {
   3.8618689713267174`*^9, 3.861868995260337*^9}, 3.861869120738061*^9, {
   3.861869260209362*^9, 3.861869408995321*^9}, {3.8618694821002164`*^9, 
   3.8618694873020487`*^9}, {3.8618695207349653`*^9, 3.861869537897152*^9}, {
   3.8618696514563837`*^9, 3.8618696550676675`*^9}, {3.8618702166609*^9, 
   3.861870220472766*^9}, {3.86187085672344*^9, 
   3.8618708744693584`*^9}},ExpressionUUID->"0d48f50d-3e32-4b1e-860d-\
a7823b19968a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"initializeCurrentOverlaps", "[", "run_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nextR", ",", "res"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextR", "=", " ", 
        RowBox[{"nextRadius", "[", "run", "]"}]}], ";", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"possibleOverlaps", " ", "=", " ", 
        RowBox[{"potentialHorizontalOverlaps", "[", 
         RowBox[{"run", ",", "nextR"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"possibleOverlaps", " ", "=", " ", 
        RowBox[{"Complement", "[", 
         RowBox[{"possibleOverlaps", ",", 
          RowBox[{"run", "[", "\"\<UsedOverlaps\>\"", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"res", "=", "run"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentOverlaps\>\"", "]"}], "=", " ", 
        "possibleOverlaps"}], ";", "\[IndentingNewLine]", "res"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"setGraphCoordinates", "[", "run_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "g", ",", "nxy"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", "=", " ", 
       RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nxy", "[", "n_", "]"}], " ", ":=", " ", 
       RowBox[{"diskXZ", "@", 
        RowBox[{"getDisk", "[", 
         RowBox[{"n", ",", "res"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"Graph", "[", 
        RowBox[{"g", ",", 
         RowBox[{"VertexCoordinates", "->", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"nxy", "[", "#", "]"}]}], "&"}], ",", 
            RowBox[{"VertexList", "[", "g", "]"}]}], "]"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"g", " ", "=", " ", 
       RowBox[{"Graph", "[", 
        RowBox[{"g", ",", 
         RowBox[{"PlotTheme", "\[Rule]", "\"\<Labeled\>\""}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}], "=", "g"}], ";", 
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.8616891647790556`*^9, {3.86168991404274*^9, 
   3.8616899178617325`*^9}, {3.8616904359936657`*^9, 
   3.8616904612958555`*^9}, {3.8617713554075007`*^9, 3.86177136615466*^9}, {
   3.861771529586708*^9, 3.8617715651251936`*^9}, {3.8617717150362234`*^9, 
   3.861771724387151*^9}, 3.861771969724106*^9, 3.861772130778466*^9, {
   3.8618707759742775`*^9, 3.861870776552259*^9}, {3.861870823540469*^9, 
   3.8618708260418425`*^9}},ExpressionUUID->"42f9121c-e31e-4ddf-88fc-\
a070f493771f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"completeChain", "[", "run_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"res", ",", "i", ",", 
      RowBox[{"complete", "=", "False"}], ",", "chainNumber", ",", 
      "previousChain", ",", "completedChain"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", " ", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"res", " ", "=", " ", 
      RowBox[{"initializeCurrentOverlaps", "[", "res", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", " ", "4"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"nextDiskNumber", "[", "res", "]"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", 
         RowBox[{"addNextDisk", "[", "res", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"initializeCurrentOverlaps", "[", "res", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"complete", " ", "=", " ", 
         RowBox[{"currentChainIsComplete", "[", "res", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"complete", ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", "complete"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", "\"\<chain incomplete\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "res", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"previousChain", " ", "=", " ", 
      RowBox[{"Last", "[", 
       RowBox[{"res", "[", "\"\<CompletedChains\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<PastDisks\>\"", "]"}], "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<PastDisks\>\"", "]"}], ",", 
        RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"completedChain", " ", "=", "  ", 
      RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"chainNumber", " ", "=", " ", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Keys", "[", 
         RowBox[{"res", "[", "\"\<CompletedChains\>\"", "]"}], "]"}], "]"}], 
       "+", "1"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CompletedChains\>\"", "]"}], "=", " ", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CompletedChains\>\"", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"chainNumber", "->", "completedChain"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], "=", " ", 
      RowBox[{"KeyTake", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], ",", 
        "completedChain"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"res", "[", "\"\<CurrentOverlaps\>\"", "]"}], " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]",
      "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.861684358629258*^9, 3.861684524240922*^9}, 
   3.861684576473754*^9, {3.8616846176312237`*^9, 3.8616847132073975`*^9}, {
   3.8616850134328413`*^9, 3.86168501704149*^9}, {3.861685048105015*^9, 
   3.8616850784193096`*^9}, {3.8616851234082212`*^9, 
   3.8616852027446823`*^9}, {3.861685371069314*^9, 3.8616853712842484`*^9}, {
   3.8616859082014556`*^9, 3.8616859210857525`*^9}, {3.861686056906653*^9, 
   3.861686123610694*^9}, {3.861688774038667*^9, 3.861688774198612*^9}, {
   3.8616888216547055`*^9, 3.861688828539577*^9}, {3.861688866608322*^9, 
   3.861688874186267*^9}, {3.8616889140833178`*^9, 3.861688950502099*^9}, 
   3.861689001171564*^9, {3.861689204822542*^9, 3.8616892759751277`*^9}, {
   3.861689413105137*^9, 3.861689421578429*^9}, {3.8616894718935575`*^9, 
   3.861689545046216*^9}, {3.861689613115652*^9, 3.8616896296398883`*^9}, 
   3.861689777517949*^9, 3.861689923485132*^9, {3.861690349412821*^9, 
   3.861690375698805*^9}, {3.8617713082464485`*^9, 3.8617713200718336`*^9}, {
   3.861772807301606*^9, 3.861772810800974*^9}, 3.861772872800007*^9, 
   3.8617734237668533`*^9, {3.861773566079151*^9, 3.86177359053448*^9}, {
   3.8617736209803843`*^9, 3.8617736407257657`*^9}, {3.8618596208212905`*^9, 
   3.8618596239807587`*^9}, {3.8618697184427385`*^9, 
   3.8618697186145725`*^9}, {3.8618703757759724`*^9, 3.8618703759634113`*^9}, 
   3.8618707268751297`*^9},ExpressionUUID->"6dbf7845-f16b-4a34-8ebf-\
111941a4cda1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"currentChainIsComplete", "[", "run_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"edgeList", ",", "lhs", ",", "rhs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"edgeList", " ", "=", " ", 
      RowBox[{"EdgeList", "@", 
       RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lhs", " ", "=", " ", 
      RowBox[{"First", "[", 
       RowBox[{"run", "[", "\"\<CurrentChain\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rhs", " ", "=", " ", 
      RowBox[{"Last", "[", 
       RowBox[{"run", "[", "\"\<CurrentChain\>\"", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{"edgeList", ",", 
        RowBox[{"(", 
         RowBox[{"rhs", " ", "\[UndirectedEdge]", " ", 
          RowBox[{"right", "[", "lhs", "]"}]}], ")"}]}], "]"}], " ", "||", 
      " ", 
      RowBox[{"MemberQ", "[", 
       RowBox[{"edgeList", ",", "\[IndentingNewLine]", 
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"right", "[", "lhs", "]"}], " ", "\[UndirectedEdge]", " ", 
          "rhs"}], ")"}]}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8616839026344147`*^9, 3.8616839520673313`*^9}, {
  3.861683999119978*^9, 3.8616840041373234`*^9}, {3.8616840511513433`*^9, 
  3.861684168167019*^9}, {3.8616842013933973`*^9, 3.86168423611084*^9}, {
  3.8616842750865345`*^9, 3.8616843373281612`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"13d281b0-6a41-489c-b446-b5db095d3c80"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"addNextDisk", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"next", ",", "path", ",", "n", ",", "g"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"next", "=", 
         RowBox[{"findNextNormalizedDisk", "[", "run", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"n", "=", " ", 
         RowBox[{"nextDiskNumber", "[", "run", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", " ", "run"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"res", "[", "\"\<CurrentDisks\>\"", "]"}], ",", 
           RowBox[{"n", "->", 
            RowBox[{"next", "[", "\"\<Disk\>\"", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], ",", "n"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", "=", " ", 
         RowBox[{"SortBy", "[", 
          RowBox[{
           RowBox[{"res", "[", "\"\<CurrentChain\>\"", "]"}], " ", ",", 
           RowBox[{
            RowBox[{"diskX", "[", 
             RowBox[{"getDisk", "[", 
              RowBox[{"#", ",", "res"}], "]"}], "]"}], "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"removeList", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}], " ", ",", 
           RowBox[{"Reverse", "@", 
            RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"moveNumberLeft", "/@", 
            RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"moveNumberLeft", "/@", " ", 
            RowBox[{"(", 
             RowBox[{"Reverse", "@", 
              RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}]}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<UsedOverlaps\>\"", "]"}], " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"res", "[", "\"\<UsedOverlaps\>\"", "]"}], ",", 
           "removeList"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"g", " ", "=", " ", 
         RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"g", "=", " ", 
         RowBox[{"EdgeAdd", "[", 
          RowBox[{"g", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], " ", "\[UndirectedEdge]", " ", 
              "n"}], ",", "\[IndentingNewLine]", 
             RowBox[{"n", " ", "\[UndirectedEdge]", " ", 
              RowBox[{
               RowBox[{"next", "[", "\"\<RestsOn\>\"", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], " ", "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"res", "[", "\"\<ContactGraph\>\"", "]"}], "=", "g"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"setGraphCoordinates", "[", "res", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", 
         RowBox[{"initializeCurrentOverlaps", "[", "res", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findNextNormalizedDisk", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "res", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", "=", " ", 
         RowBox[{"findNextDisk", "[", "run", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"diskIsLeft", "[", 
           RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "=", 
            RowBox[{"moveDiskRight", "[", 
             RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<RestsOn\>\"", "]"}], "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"moveNumberRight", ",", 
              RowBox[{"res", "[", "\"\<RestsOn\>\"", "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"diskIsRight", "[", 
           RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "=", 
            RowBox[{"moveDiskLeft", "[", 
             RowBox[{"res", "[", "\"\<Disk\>\"", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"res", "[", "\"\<RestsOn\>\"", "]"}], "=", " ", 
            RowBox[{"Map", "[", 
             RowBox[{"moveNumberLeft", ",", 
              RowBox[{"res", "[", "\"\<RestsOn\>\"", "]"}]}], "]"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<Adding \>\"", ",", "res"}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findNextDisk", "[", "run_", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nextR", ",", "locations", ",", "nextPair", ",", "nextDisk"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nextR", "=", " ", 
         RowBox[{"N", "@", 
          RowBox[{"nextRadius", "[", "run", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locations", " ", "=", " ", 
         RowBox[{"Association", "@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "->", 
              RowBox[{"overlapLocations", "[", 
               RowBox[{"#", ",", "nextR", ",", "run"}], "]"}]}], "&"}], ",", 
            RowBox[{"run", "[", "\"\<CurrentOverlaps\>\"", "]"}]}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "locations", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"locations", " ", "=", " ", 
         RowBox[{"DeleteMissing", "[", "locations", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locations", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"locations", ",", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"diskX", "[", "#", "]"}], ">=", 
              RowBox[{
               RowBox[{"-", "1"}], "/", "2"}]}], " ", "&&", " ", 
             RowBox[{
              RowBox[{"diskX", "[", "#", "]"}], "<=", 
              RowBox[{"1", "/", "2"}]}]}], " ", "&"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locations", " ", "=", " ", 
         RowBox[{"SortBy", "[", 
          RowBox[{"locations", ",", "diskZ"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"locations", " ", "=", " ", 
         RowBox[{"deleteIntersectingDisks", "[", 
          RowBox[{"run", ",", "locations", ",", "nextR"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"locations", "=", " ", 
         RowBox[{"List", "@@", 
          RowBox[{"First", "@", 
           RowBox[{"Normal", "@", "locations"}]}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nextPair", ",", "nextDisk"}], "}"}], "=", "locations"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"<|", 
          RowBox[{
           RowBox[{"\"\<Disk\>\"", "->", "nextDisk"}], ",", 
           RowBox[{"\"\<RestsOn\>\"", "->", "nextPair"}]}], "|>"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"deleteIntersectingDisks", "[", 
      RowBox[{"run_", ",", "locations_", ",", "nextR_"}], "]"}], " ", ":=", 
     " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"extendedDisks", ",", "res"}], "}"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"extendedDisks", " ", "=", " ", 
         RowBox[{"extendDisksLeftRight", "[", 
          RowBox[{"run", ",", " ", "nextR"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"locationIntersectsQ", "[", "d_", "]"}], " ", ":=", 
         "\[IndentingNewLine]", 
         RowBox[{"Or", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"diskdiskIntersectionQ", "[", 
              RowBox[{"d", ",", "#"}], "]"}], "&"}], ",", 
            RowBox[{"Values", "@", "extendedDisks"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Select", "[", 
          RowBox[{"locations", ",", 
           RowBox[{
            RowBox[{"Not", "[", 
             RowBox[{"locationIntersectsQ", "[", "#", "]"}], "]"}], "&"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "res"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskdiskIntersectionQ", "[", 
      RowBox[{
       RowBox[{"Disk", "[", 
        RowBox[{"xy1_", ",", "r1_"}], "]"}], ",", 
       RowBox[{"Disk", "[", 
        RowBox[{"xy2_", ",", "r2_"}], "]"}]}], "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"xy1", "-", "xy2"}], ",", "2"}], "]"}], "<=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"r1", "+", " ", "r2"}], ")"}], "^", "2"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"overlapLocations", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n1_", ",", "n2_"}], "}"}], ",", "r_", ",", "run_"}], "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Disk", "[", 
        RowBox[{
         RowBox[{"diskdiskUpperTouchingPoint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"getDisk", "[", 
              RowBox[{"n1", ",", "run"}], "]"}], ",", 
             RowBox[{"getDisk", "[", 
              RowBox[{"n2", ",", "run"}], "]"}]}], "}"}], ",", "r"}], "]"}], 
         ",", "r"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8595355232689533`*^9, 3.859535548507656*^9}, {
   3.8595355812605634`*^9, 3.8595356039837217`*^9}, 3.859535980427695*^9, {
   3.859537787961735*^9, 3.8595378166902814`*^9}, {3.8595378709849052`*^9, 
   3.8595378746659107`*^9}, {3.859548408766249*^9, 3.859548693435357*^9}, {
   3.8595487252177143`*^9, 3.8595487384123473`*^9}, {3.8595487837338943`*^9, 
   3.859548787225625*^9}, {3.8595491546797457`*^9, 3.8595494001917853`*^9}, {
   3.8595494501740446`*^9, 3.859549673906193*^9}, {3.8595497211610394`*^9, 
   3.859549803463643*^9}, {3.859549845328841*^9, 3.8595498883756323`*^9}, {
   3.859549930705818*^9, 3.8595499353586044`*^9}, {3.859550030796769*^9, 
   3.8595501741262956`*^9}, {3.8595502262812786`*^9, 3.859550412498247*^9}, {
   3.859550443832056*^9, 3.859550494098281*^9}, {3.8595505397155266`*^9, 
   3.859550547454463*^9}, {3.85955070979223*^9, 3.8595507836269436`*^9}, {
   3.8595508136598835`*^9, 3.8595509504636335`*^9}, {3.8595509811128488`*^9, 
   3.8595512599373693`*^9}, {3.859551304158172*^9, 3.8595513453854275`*^9}, {
   3.859551385384552*^9, 3.8595515088071985`*^9}, {3.8595515447332945`*^9, 
   3.8595515614999976`*^9}, {3.8595515950630026`*^9, 
   3.8595516578334994`*^9}, {3.8595516932079616`*^9, 
   3.8595517507798724`*^9}, {3.859551797128462*^9, 3.8595517976263065`*^9}, {
   3.8595518324398346`*^9, 3.859551880416995*^9}, {3.8595519137728386`*^9, 
   3.859551970693408*^9}, {3.85955213640696*^9, 3.859552186595783*^9}, 
   3.8595522234488077`*^9, {3.859552261174758*^9, 3.859552426402605*^9}, {
   3.859552457238233*^9, 3.859552487979121*^9}, {3.8595525499163485`*^9, 
   3.859552550868485*^9}, {3.859552597707198*^9, 3.8595530395370884`*^9}, {
   3.85955315670238*^9, 3.85955324310651*^9}, {3.859553337061211*^9, 
   3.8595535638123627`*^9}, {3.8595537406967225`*^9, 
   3.8595538067525034`*^9}, {3.8595542024270816`*^9, 
   3.8595542740313644`*^9}, {3.8595544170603085`*^9, 
   3.8595544261811695`*^9}, {3.859554462238783*^9, 3.8595545119539566`*^9}, {
   3.859554584195531*^9, 3.859554609389391*^9}, {3.8595546417929797`*^9, 
   3.859554644321248*^9}, {3.8595547473448496`*^9, 3.859554757465744*^9}, {
   3.8595547965785494`*^9, 3.859554908658832*^9}, {3.859554984163625*^9, 
   3.859555055178321*^9}, {3.859977168308877*^9, 3.8599772360124283`*^9}, {
   3.8599774858451896`*^9, 3.8599775182970247`*^9}, {3.859977556168625*^9, 
   3.859977558766972*^9}, {3.8599778958906813`*^9, 3.859977936298822*^9}, {
   3.859977986519406*^9, 3.859978066115001*^9}, {3.859978986338558*^9, 
   3.859979015515856*^9}, {3.8599790865231757`*^9, 3.8599791149053965`*^9}, {
   3.859979210488615*^9, 3.8599792209787817`*^9}, {3.8599803493924475`*^9, 
   3.859980369407977*^9}, 3.859981094869953*^9, {3.859981542769067*^9, 
   3.8599815542265873`*^9}, {3.8599816585624447`*^9, 3.859981737266111*^9}, {
   3.8599819412556067`*^9, 3.85998229214895*^9}, {3.8599824173074923`*^9, 
   3.8599824459186573`*^9}, {3.8599824792581797`*^9, 
   3.8599825127621636`*^9}, {3.8599826363795695`*^9, 3.859982648636608*^9}, {
   3.859984040220494*^9, 3.859984045941535*^9}, {3.861166531658287*^9, 
   3.861166534048344*^9}, {3.8611665847980003`*^9, 3.8611666058699408`*^9}, {
   3.8611670609268503`*^9, 3.861167067769003*^9}, {3.86116718145362*^9, 
   3.861167182451355*^9}, 3.8611672409243827`*^9, 3.8611673161922445`*^9, {
   3.8611674333273335`*^9, 3.861167452192051*^9}, {3.861167501164098*^9, 
   3.8611675022977824`*^9}, {3.861167619735695*^9, 3.8611676197825613`*^9}, {
   3.8614439267260885`*^9, 3.86144395904889*^9}, {3.8614440181464033`*^9, 
   3.861444084651805*^9}, {3.861444124088*^9, 3.8614441289374475`*^9}, {
   3.8614443330709553`*^9, 3.8614443461096983`*^9}, {3.861444471440876*^9, 
   3.8614444714628196`*^9}, {3.8614455922409363`*^9, 
   3.8614456567442904`*^9}, {3.8614457141066823`*^9, 3.861445771061937*^9}, {
   3.8614458461617503`*^9, 3.8614459098362207`*^9}, {3.8614461825111723`*^9, 
   3.8614463315295115`*^9}, 3.8615226258504825`*^9, {3.8615232977144775`*^9, 
   3.861523383487955*^9}, {3.8615234228435163`*^9, 3.8615235691817493`*^9}, {
   3.861523614745119*^9, 3.8615237181398773`*^9}, {3.8615237613224726`*^9, 
   3.86152379359902*^9}, {3.8615250303066454`*^9, 3.861525096345803*^9}, {
   3.861525168970804*^9, 3.861525181969638*^9}, {3.86152526522633*^9, 
   3.8615252693841705`*^9}, 3.861682893847972*^9, {3.861683084885602*^9, 
   3.8616831060185394`*^9}, {3.8616831769699*^9, 3.8616831908450947`*^9}, {
   3.8616835027652345`*^9, 3.8616836265377464`*^9}, 3.861683658602107*^9, 
   3.8616839005435715`*^9, 3.861684567380087*^9, {3.861685253020944*^9, 
   3.8616853458383093`*^9}, {3.861685457877714*^9, 3.861685524343441*^9}, {
   3.861685566060768*^9, 3.8616856175873985`*^9}, 3.8616857932526894`*^9, {
   3.861685829506477*^9, 3.8616858299597845`*^9}, {3.861688603446192*^9, 
   3.861688615129272*^9}, {3.86169034328926*^9, 3.8616903641702642`*^9}, {
   3.8616906028614054`*^9, 3.861690613889862*^9}, {3.8616906847476935`*^9, 
   3.8616906922771196`*^9}, 3.861690764753615*^9, {3.861772170133756*^9, 
   3.8617722079492044`*^9}, {3.8617722871804495`*^9, 3.86177231837619*^9}, 
   3.861772380747596*^9, 3.861772972599372*^9, {3.8617730788870215`*^9, 
   3.861773116019061*^9}, {3.861773236570961*^9, 3.861773237133318*^9}, 
   3.8617733085850763`*^9, {3.8618544290335045`*^9, 3.8618544339073277`*^9}, {
   3.8618545247340236`*^9, 3.8618545691624084`*^9}, 3.8618546263267117`*^9, {
   3.8618547123451824`*^9, 3.8618547198592353`*^9}, {3.861854927478796*^9, 
   3.86185495453036*^9}, {3.8618549923765907`*^9, 3.8618550751680417`*^9}, {
   3.8618552098386374`*^9, 3.861855210136306*^9}, {3.8618554045898485`*^9, 
   3.861855475183138*^9}, {3.8618563608325615`*^9, 3.8618564345676575`*^9}, {
   3.8618565114209447`*^9, 3.861856512327812*^9}, {3.8618566113717766`*^9, 
   3.861856611527938*^9}, {3.8618568248134055`*^9, 3.8618568368332787`*^9}, {
   3.861856924970784*^9, 3.8618570384314375`*^9}, {3.8618571729812574`*^9, 
   3.861857351538889*^9}, {3.861857480053604*^9, 3.8618575189173813`*^9}, {
   3.8618575508223395`*^9, 3.8618575787857976`*^9}, {3.861857610256908*^9, 
   3.861857623584346*^9}, {3.8618576564143443`*^9, 3.8618576566173725`*^9}, {
   3.8618576875291414`*^9, 3.861857783072259*^9}, 3.8618597252801557`*^9, {
   3.861870578647255*^9, 
   3.8618706222833543`*^9}},ExpressionUUID->"513aff78-73d8-4540-b0a3-\
eb2e825bb45a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"for", " ", "some", " ", "ics"}], ",", " ", 
    RowBox[{
     RowBox[{"couldn", "'"}], "t", " ", "guarantee", " ", "the", " ", "lower",
      " ", "one", " ", "is", " ", "discardable"}], ",", "\[IndentingNewLine]", 
    RowBox[{
    "but", " ", "should", " ", "be", " ", "provided", " ", "pattern", " ", 
     "is", " ", "a", " ", "dropped", " ", "coin", " ", "one"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"diskdiskUpperTouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "lrPoints", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lrPoints", "=", " ", 
         RowBox[{"diskdisktouchingPoint", "[", 
          RowBox[{"pairDisks", ",", "r"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MissingQ", "[", "lrPoints", "]"}], ",", 
          RowBox[{"Return", "[", "lrPoints", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Last", "[", 
         RowBox[{"SortBy", "[", 
          RowBox[{"lrPoints", ",", 
           RowBox[{
            RowBox[{"N", "@", 
             RowBox[{"Last", "[", "#", "]"}]}], "&"}]}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"diskdisktouchingPoint", "[", 
      RowBox[{"pairDisks_", ",", "r_"}], "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "xy1", ",", "xy2", ",", "r1", ",", "r2", ",", "interdisk", ",", 
         "sTriangle", ",", "triangle", "\[IndentingNewLine]", ",", 
         "rTrianglePT", ",", "lTrianglePT", ",", "transform"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"xy1", ",", "r1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xy2", ",", "r2"}], "}"}]}], "}"}], "=", " ", 
         RowBox[{"List", "@@@", " ", "pairDisks"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"interdisk", " ", "=", " ", 
         RowBox[{"Norm", "[", 
          RowBox[{"xy1", "-", "xy2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"interdisk", " ", ">", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"r1", "+", "r"}], ")"}], " ", "+", 
            RowBox[{"(", " ", 
             RowBox[{"r2", " ", "+", " ", "r"}], ")"}]}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Off", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sTriangle", " ", "=", 
         RowBox[{"SSSTriangle", "[", 
          RowBox[{
           RowBox[{"r", "+", "r2"}], ",", 
           RowBox[{"r", "+", "r1"}], ",", "interdisk"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"On", "[", 
         RowBox[{"SSSTriangle", "::", "tri"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "sTriangle", "]"}], "===", "SSSTriangle"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"Missing", "[", "]"}], "]"}]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Abort", "[", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"triangle", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@", "sTriangle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"transform", " ", "=", 
         RowBox[{"Composition", "[", 
          RowBox[{
           RowBox[{"TranslationTransform", "[", "xy1", "]"}], ",", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"triangle", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "-", 
               RowBox[{"triangle", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], ",", 
              RowBox[{"xy2", "-", "xy1"}]}], "}"}], "]"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"transform", "[", "triangle", "]"}], ")"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lTrianglePT", " ", "=", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ReflectionTransform", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{"90", " ", "Degree"}], "]"}], "[", 
              RowBox[{"xy2", "-", "xy1"}], "]"}], ",", "xy1"}], "]"}], ")"}], 
          "[", "rTrianglePT", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"rTrianglePT", ",", "lTrianglePT"}], "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.856890650008703*^9, 3.85689067286756*^9}, {
   3.8568920185899725`*^9, 3.8568920625893984`*^9}, {3.8571152866804256`*^9, 
   3.8571153034394283`*^9}, {3.8571171134824324`*^9, 
   3.8571171413767424`*^9}, {3.8571171853168*^9, 3.8571172283028445`*^9}, 
   3.8571269932151995`*^9, {3.857127151449848*^9, 3.857127168930334*^9}, {
   3.8571273299195204`*^9, 3.8571273327408686`*^9}, {3.8571273879771347`*^9, 
   3.8571274361429415`*^9}, {3.8571274968993864`*^9, 
   3.8571275846370783`*^9}, {3.8571277374939375`*^9, 3.857127777817645*^9}, {
   3.8595520546920843`*^9, 3.8595521077101665`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f84550c7-7952-4387-a527-80b00981d42e"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{718.5, 474.},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2cc5cbc0-b64c-4b9f-972e-d2d4fd863fe9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 331, 9, 70, "Input",ExpressionUUID->"7d77eaad-7cce-48eb-b198-8dc4dd759adc",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[914, 33, 159, 3, 74, "Section",ExpressionUUID->"6ab48122-af17-4dcf-b0ec-7c9b2b450180"],
Cell[1076, 38, 12213, 286, 855, "Input",ExpressionUUID->"c79fdebc-f9ae-4df7-a656-4383f6352b8d",
 InitializationCell->True],
Cell[13292, 326, 4089, 101, 322, "Input",ExpressionUUID->"0a65e49c-b2c5-44c1-beed-0dda6949a9df",
 InitializationCell->True],
Cell[17384, 429, 9067, 201, 1161, "Input",ExpressionUUID->"0d48f50d-3e32-4b1e-860d-a7823b19968a",
 InitializationCell->True],
Cell[26454, 632, 7694, 135, 427, "Input",ExpressionUUID->"42f9121c-e31e-4ddf-88fc-a070f493771f",
 InitializationCell->True],
Cell[34151, 769, 5401, 111, 803, "Input",ExpressionUUID->"6dbf7845-f16b-4a34-8ebf-111941a4cda1",
 InitializationCell->True],
Cell[39555, 882, 1683, 41, 175, "Input",ExpressionUUID->"13d281b0-6a41-489c-b446-b5db095d3c80",
 InitializationCell->True],
Cell[41241, 925, 18249, 370, 1874, "Input",ExpressionUUID->"513aff78-73d8-4540-b0a3-eb2e825bb45a",
 InitializationCell->True],
Cell[59493, 1297, 6230, 147, 720, "Input",ExpressionUUID->"f84550c7-7952-4387-a527-80b00981d42e",
 InitializationCell->True]
}, Open  ]]
}
]
*)

